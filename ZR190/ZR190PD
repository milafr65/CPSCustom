******* ZR190PD 104.1.2 <1276646216>
      ******************************************************************
      *MODIFICATION LOG:                                               *
      *MOD ID   PROGRAMMER   DATE      DESCRIPTION                     *
      *------   ----------   --------  --------------------------------*
      *GW0106                01/2006   ADDED LOGIC FOR 7000-ACCOUNT-  
      *                                DATA.
      *GW                    07/2006   CHANGE TO 7000-ACCOUNT-DATA FOR 
      *                                CDSP LATE FEES      
      *         M. HUNTER    04/15/11  COPIED AR190 TO ZR190 AND 
      *                                REAPPLIED ABOVE MODIFICATIONS.
      * FP5751  SDB          04/30/14  Add new account code for company 
      *                                2000 in paragraph 
      *                              7000-ACCOUNT-DATA (Search on FP5751)
      * FP3199  SDB          06/12/17 ADDED NEW ACCOUNTS FOR CO=2000
      *         SDB          11/2018  ADDED NEW ACCOUNTS FOR CO=2000         
      *================================================================
     ******************************************************************
       050-EDIT-PARAMETERS             SECTION 10.
      ******************************************************************
       050-START.

           MOVE PRM-COMPANY            TO DB-COMPANY.
           PERFORM 840-FIND-ACOSET1.
           IF (ARCOMP-NOTFOUND)
               MOVE PRM-COMPANY        TO CRT-ERR-VAR1
               MOVE 050                TO CRT-ERROR-NBR
               MOVE WS-TRUE            TO WS-PARAMETER-ERROR
               PERFORM 780-PRINT-ERROR-MSG
               GO TO 050-END.

           MOVE PRM-COMPANY            TO EDJBHDWS-COMPANY.
           MOVE PRM-JRNL-BOOK-NBR      TO EDJBHDWS-JRNL-BOOK-NBR.
           MOVE "AR"                   TO EDJBHDWS-SYSTEM.
           MOVE CRT-USER-NAME          TO EDJBHDWS-OPERATOR.
           PERFORM 635-EDIT-JBOOKHDR-70.
           IF (ERROR-FOUND)
               MOVE WS-TRUE            TO WS-PARAMETER-ERROR
               PERFORM 780-PRINT-ERROR-MSG
               GO TO 050-END.

       050-END.

      ******************************************************************
       100-PROGRAM-CONTROL             SECTION 10.
      ******************************************************************
       100-START.

           PERFORM 1000-OPEN-WORKFLOW-DB.
           PERFORM 600-BEGIN-BROADCAST.
           MOVE "Y"                    TO ZR190WS-DO-RPT1-BROADCAST.
           MOVE PRM-PRINT-FILE         TO ZR190WS-PRINT-FILE-1.

           MOVE 051                    TO CRT-MSG-NBR.
           PERFORM 780-DISPLAY-MSG.

           PERFORM 1000-DO-ARDISTRIB.

           PERFORM 910-AUDIT-BEGIN.
           MOVE "CUST"                 TO MXTSLWS-OBJ-TYPE.
           PERFORM 7000-TIMESTAMP-MX-LIST.
           PERFORM 920-AUDIT-END.

           PERFORM 605-END-BROADCAST.

       100-END.

      ******************************************************************
       1000-DO-ARDISTRIB               SECTION 50.
      ******************************************************************
       1000-START.

           MOVE HHMMSS                 TO ZR190WS-RUN-TIME.
           PERFORM 840-FIND-CKPSET1.
           IF  (CKPOINT-FOUND)
           AND (CKP-RESTART-INFO       NOT = SPACES)
               MOVE CKP-RESTART-INFO   TO WS-RESTART-INFO 
               MOVE WS-TRUE            TO PROGRAM-RESTARTING
           ELSE   
               MOVE WS-FALSE           TO PROGRAM-RESTARTING
               INITIALIZE                 WS-RESTART-INFO.

           MOVE ACO-DEP-INST-CODE       TO ZR190WS-DEP-INST-CODE.
           MOVE ACO-CURRENCY-CD         TO ZR190WS-ACO-CURR.
           MOVE ACO-CUST-GROUP          TO DB-CUST-GROUP.
           PERFORM 840-FIND-ACGSET1.

           IF (PROGRAM-RESTARTING      = WS-TRUE)
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEA    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190A-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEB    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190B-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEC    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190C-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMED    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190D-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEE    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190E-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEF    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190F-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEG    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190G-NAME
               MOVE WS-RESTART-PATH-NAME    TO ZR190WS-PATH-NAME
               MOVE WS-RESTART-FILENAMEH    TO ZR190WS-FILE-NAME
               PERFORM 9000-STRING-FILE-NAME
               MOVE ZR190WS-TEMP-FILE-NAME  TO WS-WZR190H-NAME
               MOVE WS-RESTART-PGM          TO ZR190WS-PROG-SEQ-NBR
               OPEN I-O WZR190A-FILE
               OPEN I-O WZR190B-FILE
               OPEN I-O WZR190C-FILE
               OPEN I-O WZR190D-FILE
               OPEN I-O WZR190E-FILE
               OPEN I-O WZR190F-FILE
               OPEN I-O WZR190G-FILE
               OPEN I-O WZR190H-FILE
               IF (WS-RESTART-PHASE    = 1)
                   GO TO 1000-ARAPPLICATION
               ELSE
               IF (WS-RESTART-PHASE    = 2 OR 3 OR 4 OR 5 OR 6)
                   GO TO 1000-SET-ARDISTRIB-WORK
               ELSE
               IF (WS-RESTART-PHASE    = 7)
                   GO TO 1000-PRINT-WORK.

      *******NORMAL START********

           INITIALIZE ZR190WS-PROG-SEQ-NBR.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190A-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-PATH-NAME   TO WS-RESTART-PATH-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEA.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190B-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEB.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190C-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEC.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190D-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMED.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190E-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEE.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190F-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEF.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190G-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEG.

           PERFORM 900-BUILD-TMP-FILE-NAME.
           MOVE WS-TMP-FILE         TO WS-WZR190H-NAME.
           PERFORM 9000-SUBSTRING-FILE-NAME.
           MOVE ZR190WS-FILE-NAME   TO WS-RESTART-FILENAMEH.

           OPEN I-O WZR190A-FILE.
           OPEN I-O WZR190B-FILE.
           OPEN I-O WZR190C-FILE.
           OPEN I-O WZR190D-FILE.
           OPEN I-O WZR190E-FILE.
           OPEN I-O WZR190F-FILE.
           OPEN I-O WZR190G-FILE.
           OPEN I-O WZR190H-FILE.

           PERFORM 910-AUDIT-BEGIN.
           PERFORM 840-MODIFY-CKPSET1.
           MOVE 1                    TO WS-RESTART-PHASE.
           MOVE PRM-COMPANY          TO WS-RESTART-COMPANY.
           MOVE ZR190WS-PROG-SEQ-NBR TO WS-RESTART-PGM.
           MOVE WS-RESTART-INFO      TO CKP-RESTART-INFO.
           PERFORM 820-STORE-CKPOINT.
           PERFORM 920-AUDIT-END.

       1000-ARAPPLICATION.

           PERFORM 910-AUDIT-BEGIN.

           IF (PROGRAM-RESTARTING       = WS-FALSE)
               MOVE PRM-COMPANY         TO DB-COMPANY
               MOVE SPACES              TO DB-TRANS-TYPE
               MOVE SPACES              TO DB-INVOICE
               MOVE ZEROES              TO DB-PAYMENT-SEQ
               MOVE ZEROES              TO DB-BATCH-NBR
               MOVE ZEROES              TO DB-APP-SEQ
               MOVE ARASET4-COMPANY     TO WS-DB-BEG-RNG
               PERFORM 850-FIND-BEGRNG-ARASET4
           ELSE
               MOVE PRM-COMPANY         TO DB-COMPANY
               MOVE WS-RESTART-TYPE     TO DB-TRANS-TYPE
               MOVE WS-RESTART-NBR      TO DB-INVOICE
               MOVE WS-RESTART-PAY-SEQ  TO DB-PAYMENT-SEQ
               MOVE WS-RESTART-BATCH    TO DB-BATCH-NBR
               MOVE WS-RESTART-APP-SEQ  TO DB-APP-SEQ
               PERFORM 850-FIND-NLT-ARASET4
               IF  (ARAPPLIED-FOUND)
               AND (ARA-COMPANY         = DB-COMPANY)
               AND (ARA-TRANS-TYPE      = DB-TRANS-TYPE)
               AND (ARA-INVOICE         = DB-INVOICE)
               AND (ARA-PAYMENT-SEQ     = DB-PAYMENT-SEQ)
               AND (ARA-BATCH-NBR       = DB-BATCH-NBR)
               AND (ARA-APP-SEQ         = DB-APP-SEQ)
                   PERFORM 860-FIND-NEXT-ARASET4.

       1000-ADJUST.

           INITIALIZE ZR190WS-DOC-COUNTER
                      ZR190WS-CBS-COUNTER.

           MOVE "RL"                   TO IFSCATWS-SOURCE-CODE.
           PERFORM 625-GET-SC-CATEGORIES-70.

           MOVE 500                    TO ZR190WS-ELEMENT-TYPE.
           MOVE PRM-COMPANY            TO ZR190WS-ELEMENT-VALUE.
           PERFORM 610-BEG-ELEMENT-TAG.

           PERFORM 1010-DO-ARAPPLIED
           THRU    1010-END
               UNTIL (ARAPPLIED-NOTFOUND)
               OR    (ARA-COMPANY           NOT = PRM-COMPANY).
           PERFORM 920-AUDIT-END.

           MOVE WS-FALSE            TO PROGRAM-RESTARTING.

       1000-SET-ARDISTRIB-WORK.

           PERFORM 910-AUDIT-BEGIN.
           PERFORM 1200-SET-ARDISTRIB-WORK
           THRU    1200-END.
           PERFORM 920-AUDIT-END.

       1000-PRINT-WORK.

           PERFORM 910-AUDIT-BEGIN.
           PERFORM 4000-DO-REPORT
           THRU    4000-END.
           PERFORM 920-AUDIT-END.

           MOVE WS-WZR190A-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190B-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190C-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190D-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190E-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190F-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190G-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.
           MOVE WS-WZR190H-NAME      TO WS-TMP-FILE.
           PERFORM 901-REMOVE-TMP-FILE.

           IF (WS-RESTART-APPL-FL        = WS-TRUE)
               MOVE T11-REPORT-MESSAGE   TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
           ELSE
               MOVE T12-REPORT-MESSAGE   TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP.

           MOVE 500                    TO ZR190WS-ELEMENT-TYPE.
           MOVE PRM-COMPANY            TO ZR190WS-ELEMENT-VALUE.
           PERFORM 615-END-ELEMENT-TAG.

           GO TO 1000-END.

      ******************************************************************
       1010-DO-ARAPPLIED.
      ******************************************************************

           IF (ARA-STATUS              NOT = 4)
               GO TO 1010-NEXT.

           MOVE "N"                    TO ARWS-CHARGEBACK-FL.
           IF (ARA-ADJ-SEQ             NOT = ZEROS)
               MOVE PRM-COMPANY        TO DB-COMPANY
               MOVE ARA-TRANS-TYPE     TO DB-TRANS-TYPE
               MOVE ARA-INVOICE        TO DB-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO DB-PAYMENT-SEQ
               MOVE ARA-BATCH-NBR      TO DB-BATCH-NBR
               MOVE ARA-APP-SEQ        TO DB-APP-SEQ
               MOVE ZEROS              TO DB-ADJ-SEQ
               MOVE ADJSET1-APP-SEQ    TO WS-DB-BEG-RNG
               PERFORM 850-FIND-BEGRNG-ADJSET1
               MOVE "N"                TO ZR190WS-REV-FL
               PERFORM 1300-CHECK-ADJ-STATUS
               THRU    1300-END
                   UNTIL (ARADJUST-NOTFOUND)
                   OR    (ZR190WS-REV-FL   = "Y")
               IF (ZR190WS-REV-FL          = "Y")
                   GO TO 1010-NEXT.

           ADD  1                      TO ZR190WS-DOC-COUNTER.
           MOVE ARA-TRANS-TYPE         TO DB-TRANS-TYPE.
           MOVE ARA-INVOICE            TO DB-INVOICE.
           IF (ARA-TRANS-TYPE          = "I" OR "D" OR "C")
               MOVE ARA-COMPANY        TO DB-COMPANY
               MOVE ARA-PAYMENT-SEQ    TO DB-PAYMENT-SEQ
               PERFORM 840-FIND-AROSET1
               MOVE ARO-ALT-TYPE       TO DB-TRANS-TYPE
               PERFORM 840-FIND-ARHSET1
               IF  (AROIHDR-FOUND)
               AND (AROITEMS-FOUND)
                   MOVE ARH-ORIG-AMT       TO ZR190WS-ARH-ORIG-AMT
                   MOVE ARH-TRAN-AMT       TO ZR190WS-ARH-TRAN-AMT
                   MOVE ARH-DIST-SEQ       TO ZR190WS-DIST-SEQ
                   MOVE ARH-TAX-FL         TO ZR190WS-TAX-FL
                   MOVE ARH-PROCESS-LEVEL  TO ZR190WS-PROCESS-LEVEL
                   MOVE ARH-SALESMAN       TO ZR190WS-SALESMAN
                   MOVE ARO-COMPANY        TO ZR190WS-COMPANY
                   MOVE ARO-CUSTOMER       TO ZR190WS-CUSTOMER
                   MOVE ARO-TRANS-TYPE     TO ZR190WS-TRANS-TYPE
                   MOVE ARO-ALT-TYPE       TO ZR190WS-ALT-TYPE
                   MOVE ARO-INVOICE        TO ZR190WS-INVOICE
                   MOVE ARO-PAYMENT-SEQ    TO ZR190WS-PAYMENT-SEQ
                   MOVE ARO-ALT-TYPE       TO ZR190WS-ALT-TYPE
                   MOVE ARO-APPLD-AMT      TO ZR190WS-APPLD-AMT
                   MOVE ARO-ADJ-AMT        TO ZR190WS-ARO-ADJ-AMT
                   MOVE ARO-ORIG-APP-AMT   TO ZR190WS-ARO-ORIG-APP-AMT
                   MOVE ARO-ORIG-ADJ-AMT   TO ZR190WS-ARO-ORIG-ADJ-AMT
                   MOVE ARO-TRAN-AMT       TO ZR190WS-TRAN-AMT
                   MOVE ARO-ORIG-AMT       TO ZR190WS-ORIG-AMT
                   MOVE ARH-ORIG-ND        TO ZR190WS-ORIG-ND
                   MOVE ARO-TRANS-DATE     TO ZR190WS-TRANS-DATE
                   MOVE ARO-DUE-DATE       TO ZR190WS-DUE-DATE
                   MOVE ARO-ACTIVITY       TO ZR190WS-ACTIVITY
                   MOVE ARO-ACCT-CATEGORY  TO ZR190WS-ACCT-CATEGORY
                   MOVE ARO-ACTIVITY-GRP   TO ZR190WS-ACTIVITY-GRP
                   MOVE ARO-CONTRACT       TO ZR190WS-CONTRACT
                   MOVE ARH-BANK-INST-CODE TO ZR190WS-BANK-INST-CODE
                   MOVE ARH-CURR-MUDV      TO ZR190WS-CURR-MUDV
                   MOVE ARH-ORIG-CURRENCY  TO ZR190WS-ORIG-CURRENCY
                   MOVE ARH-ORIG-RATE      TO ZR190WS-ORIG-RATE
                   MOVE ARH-GROUP-RATE     TO ZR190WS-GROUP-RATE
                   MOVE ARH-GROUP-MUDV     TO ZR190WS-GROUP-MUDV
                   MOVE ARH-BATCH-NBR      TO ZR190WS-BATCH-NBR
                   MOVE ARO-LAST-FC-DATE   TO ZR190WS-LAST-FC-DATE
                   MOVE ARO-APPLIED-SEQ    TO ZR190WS-APP-SEQ
                   MOVE ARO-DISPUTE-SEQ    TO ZR190WS-DISPUTE-SEQ
                   MOVE ARH-CUST-PO-NBR    TO ZR190WS-CUST-PO-NBR
                   MOVE ARH-XREF-TYPE      TO ZR190WS-XREF-TYPE
                   MOVE ARH-XREF-NBR       TO ZR190WS-XREF-NBR
                   MOVE ARH-TRANS-USER1    TO ZR190WS-TRANS-USER1
                   MOVE ARH-TRANS-USER2    TO ZR190WS-TRANS-USER2
                   MOVE ARH-TRANS-USER3    TO ZR190WS-TRANS-USER3
                   MOVE ARH-TRANS-USER4    TO ZR190WS-TRANS-USER4
                   MOVE ARH-TRANS-USER5    TO ZR190WS-TRANS-USER5
                   MOVE ARO-SORT-1         TO ZR190WS-SORT-1
                   MOVE ARO-SORT-2         TO ZR190WS-SORT-2
                   MOVE ARO-SORT-3         TO ZR190WS-SORT-3
                   MOVE ARO-SORT-4         TO ZR190WS-SORT-4.

           IF (ARA-TRANS-TYPE          = "P")
               MOVE ARA-BATCH-NBR      TO DB-BATCH-NBR
               MOVE ARA-PAYMENT-SEQ    TO DB-PAYMENT-SEQ
               PERFORM 840-FIND-APMSET1
               IF (ARPAYMENT-FOUND)
                   INITIALIZE ZR190WS-ACTIVITY
                              ZR190WS-ACCT-CATEGORY
                              ZR190WS-ACTIVITY-GRP
                              ZR190WS-CONTRACT
                              ZR190WS-SALESMAN
                              ZR190WS-DISPUTE-SEQ
                              ZR190WS-CUST-PO-NBR
                              ZR190WS-XREF-TYPE
                              ZR190WS-XREF-NBR
                              ZR190WS-TRANS-USER1
                              ZR190WS-TRANS-USER2
                              ZR190WS-TRANS-USER3
                              ZR190WS-TRANS-USER4
                              ZR190WS-TRANS-USER5
                              ZR190WS-LAST-FC-DATE
                              ZR190WS-BANK-INST-CODE
                   MOVE APM-DIST-SEQ       TO ZR190WS-DIST-SEQ
                   MOVE APM-PROCESS-LEVEL  TO ZR190WS-PROCESS-LEVEL
                   MOVE APM-COMPANY        TO ZR190WS-COMPANY
                   MOVE APM-CUSTOMER       TO ZR190WS-CUSTOMER
                   MOVE APM-TRANS-TYPE     TO ZR190WS-TRANS-TYPE
                   MOVE APM-TRANS-NBR      TO ZR190WS-INVOICE
                   MOVE APM-PAYMENT-SEQ    TO ZR190WS-PAYMENT-SEQ
                   MOVE APM-APPLD-AMT      TO ZR190WS-APPLD-AMT
                   MOVE APM-ADJ-AMT        TO ZR190WS-ARO-ADJ-AMT
                   MOVE APM-TRAN-AMT       TO ZR190WS-TRAN-AMT
                   MOVE APM-ORIG-AMT       TO ZR190WS-ORIG-AMT
                   MOVE APM-ORIG-ND        TO ZR190WS-ORIG-ND
                   MOVE APM-GL-DATE        TO ZR190WS-TRANS-DATE
                   MOVE APM-GL-DATE        TO ZR190WS-DUE-DATE
                   MOVE APM-CURR-MUDV      TO ZR190WS-CURR-MUDV
                   MOVE APM-ORIG-CURRENCY  TO ZR190WS-ORIG-CURRENCY
                   MOVE APM-ORIG-RATE      TO ZR190WS-ORIG-RATE
                   MOVE APM-GROUP-RATE     TO ZR190WS-GROUP-RATE
                   MOVE APM-GROUP-MUDV     TO ZR190WS-GROUP-MUDV
                   MOVE APM-BATCH-NBR      TO ZR190WS-BATCH-NBR
                   MOVE APM-ACTIVITY-GRP   TO ZR190WS-ACTIVITY-GRP
                   MOVE APM-ACTIVITY       TO ZR190WS-ACTIVITY
                   MOVE APM-CONTRACT       TO ZR190WS-CONTRACT
                   MOVE APM-APPLIED-SEQ    TO ZR190WS-APP-SEQ.

           IF (ARA-CR-ADJ-AMT NOT = ZEROES)
               MOVE ARA-CR-COMPANY      TO DB-COMPANY
               MOVE ARA-CR-TYPE         TO DB-TRANS-TYPE
               MOVE ARA-CR-NBR          TO DB-INVOICE
               MOVE ARA-CR-PYMNT-SEQ    TO DB-PAYMENT-SEQ
               MOVE ARA-CR-BATCH        TO DB-BATCH-NBR
               MOVE ARA-CR-APP-SEQ      TO DB-APP-SEQ
               MOVE ZEROS               TO DB-ADJ-SEQ
               MOVE ADJSET1-APP-SEQ     TO WS-DB-BEG-RNG
               MOVE WS-TRUE             TO ZR190WS-CREDIT
               PERFORM 850-FIND-BEGRNG-ADJSET1
               PERFORM 1100-DO-ARADJUST
               THRU    1100-END
                   UNTIL (ARADJUST-NOTFOUND).

           IF (ARA-ADJ-SEQ NOT = ZEROS)
               MOVE ARA-COMPANY         TO DB-COMPANY   
               MOVE ARA-TRANS-TYPE      TO DB-TRANS-TYPE
               MOVE ARA-INVOICE         TO DB-INVOICE
               MOVE ARA-PAYMENT-SEQ     TO DB-PAYMENT-SEQ
               MOVE ARA-BATCH-NBR       TO DB-BATCH-NBR
               MOVE ARA-APP-SEQ         TO DB-APP-SEQ
               MOVE ZEROS               TO DB-ADJ-SEQ
               MOVE ADJSET1-APP-SEQ     TO WS-DB-BEG-RNG
               PERFORM 850-FIND-BEGRNG-ADJSET1
               MOVE WS-FALSE            TO ZR190WS-CREDIT
               PERFORM 1100-DO-ARADJUST
               THRU    1100-END
                   UNTIL (ARADJUST-NOTFOUND).

           IF (ARA-APPLD-AMT            NOT = ZEROS)
      *--- DON'T CREATE DEBIT RNA AND CREDIT AR IF AR-CODE IS EQUAL
      *--- RNA CODE
      *--- UNLESS THERE IS A GAIN/LOSS AND THE CODES EQUAL
               IF (ARA-COMPANY     NOT = ARA-CR-COMPANY)
               OR (ARA-AR-CODE     NOT = ARA-OFFSET-CODE)
               OR (ARA-CR-APP-AMT  NOT = ARA-APPLD-AMT)
                   IF (ARA-CR-TYPE          = "P")
                       PERFORM 3200-BUILD-WORK-1
                       THRU    3200-END
                   ELSE
                   IF (ARA-CR-TYPE         = "C")
                       PERFORM 3300-BUILD-WORK-2
                       THRU    3300-END
                   END-IF
               END-IF
               IF (ARA-CR-TYPE         = "C")
                   IF  (ARA-COMPANY    = ARA-CR-COMPANY)
                   AND (ARA-AR-CODE    = ARA-OFFSET-CODE)
                   AND (ACO-DTL-APPL   = "Y")
                       PERFORM 3300-BUILD-WORK-2
                       THRU    3300-END.

           IF  (ARA-APPLD-AMT        NOT = ARA-CR-APP-AMT)
           AND (ACO-MULTI-CURR-FL    = "Y")
           AND (ARA-APP-CURR         = "M")
           AND (ARA-APPLD-AMT        = ARA-ORIG-APP-AMT)
               IF (ARA-COMPANY             NOT = ARA-CR-COMPANY)
                   MOVE ARA-CR-COMPANY     TO DB-COMPANY
                   PERFORM 840-FIND-ACOSET1
                   MOVE ACO-CURRENCY-CD    TO ZR190WS-CR-COMP-CURR
                   MOVE PRM-COMPANY        TO DB-COMPANY
                   PERFORM 840-FIND-ACOSET1
                   IF (ACO-CURRENCY-CD     NOT = ZR190WS-CR-COMP-CURR)
                       GO TO 1010-CONT
                   END-IF
               END-IF
               COMPUTE ZR190WS-RND-AMT = ARA-CR-APP-AMT
                                       - ARA-APPLD-AMT
               COMPUTE ZR190WS-RND-AMT = ZR190WS-RND-AMT
                                       * NEGATIVE-ONE
               IF  (ZR190WS-PMT-GAIN-LOSS-FL    = WS-TRUE)
                  IF (ZR190WS-PMT-GAIN-LOSS-AMT = ZR190WS-RND-AMT)
                      GO TO 1010-CONT
                  ELSE
                      COMPUTE ZR190WS-RND-AMT   = ZR190WS-RND-AMT  
                                             - ZR190WS-PMT-GAIN-LOSS-AMT
                  END-IF
               END-IF
               PERFORM 3700-BUILD-WORK-8
               THRU    3700-END.

       1010-CONT.
           IF (ZR190WS-DISPUTE-SEQ      > ZERO)
               MOVE WS-FALSE            TO ZR190WS-REC-FOUND
               MOVE ZR190WS-COMPANY     TO DB-COMPANY
               MOVE ZR190WS-CUSTOMER    TO DB-CUSTOMER
               MOVE ZR190WS-TRANS-TYPE  TO DB-TRANS-TYPE
               MOVE ZR190WS-INVOICE     TO DB-INVOICE
               MOVE ZR190WS-PAYMENT-SEQ TO DB-PAYMENT-SEQ
               INITIALIZE DB-SEQ
               MOVE ADPSET1-PAYMENT-SEQ TO WS-DB-BEG-RNG
               PERFORM 850-MODIFY-BEGRNG-ADPSET1

               PERFORM 3900-CHECK-ARDISPUTE
               THRU    3900-END
                   UNTIL (ARDISPUTE-NOTFOUND)
                   OR    (ZR190WS-REC-FOUND   = WS-TRUE)
               IF (ZR190WS-REC-FOUND          = WS-TRUE)
                   PERFORM 1012-ARDISPUTE
                   THRU    1012-END.

           IF (ZR190WS-LAST-FC-DATE      = ZEROS)
               MOVE ARA-COMPANY          TO DB-COMPANY
               MOVE ZR190WS-CUSTOMER     TO DB-CUSTOMER
               PERFORM 840-FIND-ACMSET1
               MOVE ZR190WS-DUE-DATE     TO WSDR-FR-DATE
               PERFORM 900-DATE-TO-JULIAN
               ADD ACM-FIN-GRAC-DAYS     TO WSDR-JULIAN-DAYS
               PERFORM 900-JULIAN-TO-DATE.

           COMPUTE ZR190WS-MISC-AMT ROUNDED = ZR190WS-APPLD-AMT
                                            + ZR190WS-ARO-ADJ-AMT.
           IF (ARA-TRANS-TYPE                = "I" OR "D" OR "C")
               IF (ARA-APP-SOURCE  = "R")
                   MOVE SPACES               TO ARA-RESULT-FL
               ELSE
               IF (ARA-APP-SEQ               < ZR190WS-APP-SEQ)
               OR (ZR190WS-MISC-AMT          NOT = ZR190WS-TRAN-AMT)
                   IF (ARA-DEPOSIT-DATE      > WSDR-FR-DATE)
                       MOVE "D"              TO ARA-RESULT-FL
                   ELSE
                       MOVE "P"              TO ARA-RESULT-FL
               ELSE
               IF (ARA-DEPOSIT-DATE          > WSDR-FR-DATE)
                   MOVE "L"                  TO ARA-RESULT-FL
               ELSE
                   MOVE "F"                  TO ARA-RESULT-FL.

           MOVE ARA-RESULT-FL            TO WS-RESULT-FL.     

           IF  (ARA-TRANS-TYPE           = "I")
           AND (ARA-CR-TYPE              = "P")
               MOVE ZR190WS-COMPANY      TO ARWS-COMPANY
               MOVE ZR190WS-CUSTOMER     TO ARWS-CUSTOMER
               MOVE ARA-APPLD-AMT        TO ARWS-TRAN-AMT
               MOVE ARA-DEPOSIT-DATE     TO WSDR-FR-DATE
               PERFORM 900-DATE-TO-JULIAN
               MOVE WSDR-JULIAN-DAYS          TO ZR190WS-DEPOSIT-JULIAN
               MOVE ZR190WS-TRANS-DATE   TO WSDR-FR-DATE
               PERFORM 900-DATE-TO-JULIAN
               COMPUTE ARWS-DAY    ROUNDED = ZR190WS-DEPOSIT-JULIAN
                                           - WSDR-JULIAN-DAYS
               MOVE ZR190WS-DUE-DATE     TO WSDR-FR-DATE
               PERFORM 900-DATE-TO-JULIAN
               COMPUTE ARWS-DAY2 ROUNDED   = ZR190WS-DEPOSIT-JULIAN
                                           - WSDR-JULIAN-DAYS
               MOVE ZEROS                  TO ARWS-GL-DATE
               IF (ARA-RESULT-FL            = "D")
                   MOVE "D"                TO ARWS-RESULT-FL
               END-IF
               IF (ARA-RESULT-FL           = "F")
                   MOVE "F"                TO ARWS-RESULT-FL
               ELSE
                   MOVE "C"                TO ARWS-RESULT-FL
               END-IF
               MOVE "Y"                    TO ARWS-SKIP-MX-UPDATE
               PERFORM 700-UPDATE-TOTALS.

           MOVE WS-FALSE                   TO ZR190WS-CREDIT-FL.

           IF  (ARA-CR-TYPE                = "C")
           AND (ARA-PREPAY-FLAG            = 2)
               MOVE ARA-CR-COMPANY         TO DB-COMPANY
               MOVE ARA-CR-TYPE            TO DB-TRANS-TYPE
               MOVE ARA-CR-NBR             TO DB-INVOICE   
               INITIALIZE DB-PAYMENT-SEQ
               PERFORM 850-FIND-NLT-AROSET1
               IF  (AROITEMS-FOUND)
               AND (ARO-COMPANY            = DB-COMPANY)
               AND (ARO-TRANS-TYPE         = DB-TRANS-TYPE)
               AND (ARO-INVOICE            = DB-INVOICE)
                   IF  (ARA-CR-COMPANY     = ARA-COMPANY)
                   AND (ARA-CR-NBR         = ARA-INVOICE)
                   AND (ZR190WS-ALT-TYPE   = ARO-ALT-TYPE)
                       GO TO 1010-CONT-TAX
                   END-IF
                   MOVE ARO-ALT-TYPE       TO DB-TRANS-TYPE
                   PERFORM 840-MODIFY-ARHSET1
                   IF  (AROIHDR-FOUND)
                   AND (ARH-TAX-FL             = "Y")
                       MOVE WS-TRUE            TO ZR190WS-CREDIT-FL
                       MOVE ZR190WS-TRANS-DATE TO ZR190WS-SV-TRANS-DATE
                       MOVE ZR190WS-DIST-SEQ   TO ZR190WS-SV-DIST-SEQ
                       MOVE ZR190WS-TAX-FL     TO ZR190WS-SV-TAX-FL
                       MOVE ARH-TRANS-DATE     TO ZR190WS-SV-TRANS-DATE
                       MOVE ARH-DIST-SEQ       TO ZR190WS-DIST-SEQ
                       MOVE ARH-TAX-FL         TO ZR190WS-TAX-FL
                       MOVE ARA-COMPANY        TO TXOCF-COMPANY
                       MOVE "O"                TO TXOCF-FUNCTION
                       PERFORM 2000-ACCESS-TAX-FILES-70
                       IF (ERROR-FOUND)
                           INITIALIZE CRT-ERROR-NBR
                                      CRT-ERROR-CAT
                       END-IF
                       INITIALIZE DB-DIST-SEQ
                       PERFORM 850-FIND-NLT-AMDSET6
                       PERFORM 5000-TAX-POINT
                       THRU    5000-END
                           UNTIL (ARDISTRIB-NOTFOUND)
                           OR    (AMD-COMPANY      NOT = DB-COMPANY)
                           OR    (AMD-TRANS-TYPE   NOT = DB-TRANS-TYPE)
                           OR    (AMD-INVOICE      NOT = DB-INVOICE)
                       MOVE WS-FALSE           TO ZR190WS-CREDIT-FL
                       MOVE ARA-COMPANY            TO TXOCF-COMPANY
                       MOVE "C"                    TO TXOCF-FUNCTION
                       PERFORM 2000-ACCESS-TAX-FILES-70
                       IF (ERROR-FOUND)
                           INITIALIZE CRT-ERROR-NBR
                                      CRT-ERROR-CAT
                       END-IF
                       MOVE ZR190WS-DIST-SEQ   TO ARH-DIST-SEQ
                       PERFORM 820-STORE-AROIHDR
                       MOVE ZR190WS-SV-TRANS-DATE TO ZR190WS-TRANS-DATE
                       MOVE ZR190WS-SV-DIST-SEQ   TO ZR190WS-DIST-SEQ
                       MOVE ZR190WS-SV-TAX-FL     TO ZR190WS-TAX-FL
                   END-IF
                   IF (ZR190WS-TAX-FL          = "Y")
                       MOVE ARA-COMPANY        TO TXOCF-COMPANY
                       MOVE "O"                TO TXOCF-FUNCTION
                       PERFORM 2000-ACCESS-TAX-FILES-70
                       IF (ERROR-FOUND)
                           INITIALIZE CRT-ERROR-NBR
                                      CRT-ERROR-CAT
                       END-IF
                       MOVE WS-FALSE           TO ZR190WS-CREDIT-FL
                       MOVE ZR190WS-COMPANY         TO DB-COMPANY
                       MOVE ZR190WS-ALT-TYPE        TO DB-TRANS-TYPE
                       MOVE ZR190WS-INVOICE         TO DB-INVOICE   
                       INITIALIZE DB-DIST-SEQ
                       PERFORM 850-FIND-NLT-AMDSET6
                       PERFORM 5000-TAX-POINT
                       THRU    5000-END
                           UNTIL (ARDISTRIB-NOTFOUND)
                           OR    (AMD-COMPANY      NOT = DB-COMPANY)
                           OR    (AMD-TRANS-TYPE   NOT = DB-TRANS-TYPE)
                           OR    (AMD-INVOICE      NOT = DB-INVOICE)
                       MOVE WS-FALSE           TO ZR190WS-CREDIT-FL
                       MOVE ARA-COMPANY            TO TXOCF-COMPANY
                       MOVE "C"                    TO TXOCF-FUNCTION
                       PERFORM 2000-ACCESS-TAX-FILES-70
                       IF (ERROR-FOUND)
                           INITIALIZE CRT-ERROR-NBR
                                      CRT-ERROR-CAT
                       END-IF
                       MOVE ARA-COMPANY        TO DB-COMPANY
                       MOVE ZR190WS-ALT-TYPE   TO DB-TRANS-TYPE
                       MOVE ARA-INVOICE        TO DB-INVOICE  
                       PERFORM 840-MODIFY-ARHSET1
                       MOVE ZR190WS-DIST-SEQ   TO ARH-DIST-SEQ
                       PERFORM 820-STORE-AROIHDR.

       1010-CONT-TAX.

           MOVE WS-FALSE                   TO ZR190WS-CREDIT-FL.

           IF  (ARA-CR-TYPE                = "P")
           AND (ARA-PREPAY-FLAG            = 2)
                MOVE ARA-COMPANY             TO TXOCF-COMPANY
                MOVE "O"                     TO TXOCF-FUNCTION
                PERFORM 2000-ACCESS-TAX-FILES-70
                IF (ERROR-FOUND)
                    INITIALIZE CRT-ERROR-NBR
                               CRT-ERROR-CAT
               END-IF
               MOVE ZR190WS-COMPANY         TO DB-COMPANY
               MOVE ZR190WS-ALT-TYPE        TO DB-TRANS-TYPE
               MOVE ZR190WS-INVOICE         TO DB-INVOICE   
               INITIALIZE DB-DIST-SEQ
               PERFORM 850-FIND-NLT-AMDSET6
               PERFORM 5000-TAX-POINT
               THRU    5000-END
                   UNTIL (ARDISTRIB-NOTFOUND)
                   OR    (AMD-COMPANY      NOT = DB-COMPANY)
                   OR    (AMD-TRANS-TYPE   NOT = DB-TRANS-TYPE)
                   OR    (AMD-INVOICE      NOT = DB-INVOICE)
               MOVE ARA-COMPANY             TO TXOCF-COMPANY
               MOVE "C"                     TO TXOCF-FUNCTION
               PERFORM 2000-ACCESS-TAX-FILES-70
               IF (ERROR-FOUND)
                   INITIALIZE CRT-ERROR-NBR
                              CRT-ERROR-CAT
               END-IF
               IF (AMD-TRANS-TYPE          = "P")
                   MOVE ARA-COMPANY        TO DB-COMPANY
                   MOVE ARA-BATCH-NBR      TO DB-BATCH-NBR
                   MOVE ARA-PAYMENT-SEQ    TO DB-PAYMENT-SEQ
                   PERFORM 840-MODIFY-APMSET1
                   MOVE ZR190WS-DIST-SEQ   TO APM-DIST-SEQ
                   PERFORM 820-STORE-ARPAYMENT
               ELSE
                   MOVE ARA-COMPANY        TO DB-COMPANY
                   MOVE ZR190WS-ALT-TYPE   TO DB-TRANS-TYPE
                   MOVE ARA-INVOICE        TO DB-INVOICE   
                   PERFORM 840-MODIFY-ARHSET1
                   MOVE ZR190WS-DIST-SEQ   TO ARH-DIST-SEQ
                   PERFORM 820-STORE-AROIHDR.

           MOVE ARA-COMPANY                TO DB-COMPANY.
           MOVE ARA-TRANS-TYPE             TO DB-TRANS-TYPE.
           MOVE ARA-INVOICE                TO DB-INVOICE.
           MOVE ARA-PAYMENT-SEQ            TO DB-PAYMENT-SEQ.
           MOVE ARA-BATCH-NBR              TO DB-BATCH-NBR.
           MOVE ARA-APP-SEQ                TO DB-APP-SEQ.
           PERFORM 840-MODIFY-ARASET1.
           MOVE WS-RESULT-FL               TO ARA-RESULT-FL.

           MOVE 5                          TO ARA-STATUS.
           PERFORM 820-STORE-ARAPPLIED.

           PERFORM 840-MODIFY-CKPSET1.
           MOVE 1                      TO WS-RESTART-PHASE.
           MOVE ARA-TRANS-TYPE         TO WS-RESTART-TYPE.
           MOVE ARA-INVOICE            TO WS-RESTART-NBR.
           MOVE ARA-PAYMENT-SEQ        TO WS-RESTART-PAY-SEQ.
           MOVE ARA-BATCH-NBR          TO WS-RESTART-BATCH.
           MOVE ARA-APP-SEQ            TO WS-RESTART-APP-SEQ.
           MOVE ZR190WS-PROG-SEQ-NBR   TO WS-RESTART-PGM.
           MOVE WS-RESTART-INFO        TO CKP-RESTART-INFO.
           PERFORM 820-STORE-CKPOINT.
           PERFORM 920-AUDIT-END.
           PERFORM 910-AUDIT-BEGIN.

       1010-NEXT.
           IF (PROGRAM-RESTARTING = WS-TRUE)
               PERFORM 860-FIND-NEXT-ARASET4
           ELSE
               PERFORM 860-FIND-NXTRNG-ARASET4
           END-IF.

       1010-END.

      ******************************************************************
       1012-ARDISPUTE.
      ******************************************************************

           COMPUTE ZR190WS-MISC-AMT ROUNDED = ZR190WS-APPLD-AMT
                                            + ZR190WS-ARO-ADJ-AMT.

           IF (ZR190WS-MISC-AMT       = ZR190WS-TRAN-AMT)
               PERFORM 830-DELETE-ARDISPUTE
               PERFORM 810-RECREATE-ARDISPUTE
               MOVE ARA-GL-DATE       TO ADP-RESOLV-DATE
               PERFORM 820-STORE-ARDISPUTE
               MOVE ZR190WS-COMPANY   TO ARWS-COMPANY
               MOVE ZR190WS-CUSTOMER  TO ARWS-CUSTOMER
               MOVE "S"               TO ARWS-RESULT-FL
               MOVE ADP-DISPUTE-AMT   TO ARWS-TRAN-AMT
               MOVE ZEROS             TO ARWS-DISPUTE-AMT
               MOVE ZEROS             TO ARWS-GL-DATE
               MOVE ZEROS             TO ARWS-DAY
               MOVE ZEROS             TO ARWS-DAY2
               MOVE ADP-TRANS-TYPE    TO ARWS-TRANS-TYPE
               MOVE "Y"               TO ARWS-SKIP-MX-UPDATE
               PERFORM 700-UPDATE-TOTALS.

           IF (ZR190WS-MISC-AMT       NOT = ZR190WS-TRAN-AMT)
               COMPUTE ZR190WS-MISC-IAMT ROUNDED = ZR190WS-TRAN-AMT
                                                 - ZR190WS-MISC-AMT
               IF (ADP-DISPUTE-AMT        > ZR190WS-MISC-IAMT)
                   PERFORM 830-DELETE-ARDISPUTE
                   PERFORM 810-RECREATE-ARDISPUTE
                   MOVE ARA-GL-DATE       TO ADP-RESOLV-DATE
                   PERFORM 820-STORE-ARDISPUTE

                   MOVE ADP-DISPUTE-AMT TO ARWS-TRAN-AMT
                   MOVE ADP-ORIG-DISP   TO ZR190WS-D-ORIG-DISP
                   MOVE ADP-COMPANY     TO ZR190WS-D-COMPANY
                   MOVE ADP-CUSTOMER    TO ZR190WS-D-CUSTOMER
                   MOVE ADP-TRANS-TYPE  TO ZR190WS-D-TYPE
                   MOVE ADP-INVOICE     TO ZR190WS-D-NBR
                   MOVE ADP-PAYMENT-SEQ TO ZR190WS-D-PAYMENT-SEQ
                   MOVE ADP-DISPUTE-CD  TO ZR190WS-D-DISPUTE-CD
                   MOVE ADP-TRAN-AMT    TO ZR190WS-D-TRAN-AMT
                   MOVE ADP-ORIG-AMT    TO ZR190WS-D-ORIG-AMT
                   MOVE ADP-ORIG-CURRENCY TO ZR190WS-D-CURR
                   MOVE ADP-DISPUTE-DATE  TO ZR190WS-D-DISPUTE-DATE
                   COMPUTE ZR190WS-MISC-OAMT ROUNDED = ZR190WS-ORIG-AMT
                                                     - ZR190WS-MISC-AMT
                   PERFORM 2600-CREATE-ARDISPUTE
                   THRU    2600-END

                   MOVE ARA-COMPANY       TO DB-COMPANY
                   MOVE ARA-TRANS-TYPE    TO DB-TRANS-TYPE
                   MOVE ARA-INVOICE       TO DB-INVOICE
                   MOVE ARA-PAYMENT-SEQ   TO DB-PAYMENT-SEQ
                   PERFORM 840-MODIFY-AROSET1
                   PERFORM 3000-SAVE-ARACPIVOT-ARO
                   MOVE ZR190WS-DISPUTE-SEQ TO ARO-DISPUTE-SEQ
                   PERFORM 3000-UPDATE-ARACPIVOT-ARO
                   PERFORM 820-STORE-AROITEMS
                   MOVE ZR190WS-COMPANY   TO ARWS-COMPANY
                   MOVE ZR190WS-CUSTOMER  TO ARWS-CUSTOMER
                   MOVE "Z"               TO ARWS-RESULT-FL
                   MOVE ZR190WS-MISC-IAMT TO ARWS-DISPUTE-AMT
                   MOVE ZEROS             TO ARWS-GL-DATE
                   MOVE ZEROS             TO ARWS-DAY
                   MOVE ZEROS             TO ARWS-DAY2
                   MOVE ARA-TRANS-TYPE    TO ARWS-TRANS-TYPE
                   MOVE "Y"               TO ARWS-SKIP-MX-UPDATE
                   PERFORM 700-UPDATE-TOTALS.
       1012-END.
     
      ******************************************************************
       1100-DO-ARADJUST.
      ******************************************************************

           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE "AD"                   TO DB-TYPE.
           MOVE ADJ-REASON-CODE        TO DB-REASON-CODE.
           PERFORM 840-FIND-ARRSET1.
           MOVE ARR-REASON-TYPE        TO ZR190WS-ADJ-ARR-TYPE.
           IF (ARR-REASON-TYPE          = "CB")
               IF (ARR-CB-TYPE          = "D")
                   PERFORM 2400-CREATE-AROITEM
                   THRU    2400-END
      *--- WORK 6 IS FOR PRINTING
                   PERFORM 3500-BUILD-WORK-6
                   THRU    3500-END
                   PERFORM 1500-SET-ARDISTRIB-1
                   THRU    1500-END
               ELSE
               IF (ARR-CB-TYPE          = "M")
                   MOVE ARA-COMPANY     TO DB-COMPANY
                   MOVE ARA-TRANS-TYPE  TO DB-TRANS-TYPE
                   MOVE ARA-INVOICE     TO DB-INVOICE
                   MOVE ARA-PAYMENT-SEQ TO DB-PAYMENT-SEQ
                   PERFORM 840-MODIFY-AROSET1
                   PERFORM 3000-SAVE-ARACPIVOT-ARO
                   MOVE 1               TO ARO-STATUS
                   IF (ARR-CB-DISPUTE-CD   NOT = SPACES)
                       PERFORM 2950-CREATE-CB-DISPUTE
                       THRU    2950-END
                   END-IF
                   PERFORM 3000-UPDATE-ARACPIVOT-ARO
                   PERFORM 820-STORE-AROITEMS
                   PERFORM 840-MODIFY-ARHSET1
                   MOVE 1               TO ARH-STATUS
                   PERFORM 820-STORE-AROIHDR
                   MOVE "A"             TO ARPVT-FC
                   PERFORM 2000-ARPVT-PROCESS-TRAN
                   INITIALIZE CRT-ERROR-NBR
                              CRT-ERROR-CAT
                   PERFORM 3500-BUILD-WORK-6
                   THRU    3500-END
                   PERFORM 1500-SET-ARDISTRIB-1
                   THRU    1500-END
               ELSE
               IF (ARR-CB-TYPE          = "S")
                   PERFORM 3400-BUILD-WORK-5
                   THRU    3400-END
      *--- WORK 7 IS FOR PRINTING
                   PERFORM 3600-BUILD-WORK-7
                   THRU    3600-END
                   PERFORM 1600-SET-ARDISTRIB-2
                   THRU    1600-END.

           IF  (ARR-REASON-TYPE        = "OS" OR "DS")
           AND (ARR-DISPUTE-CD         NOT = SPACES)
           AND (ARA-TRANS-TYPE         = "C" OR "D" OR "I")
               PERFORM 2960-CREATE-DISPUTE
               THRU    2960-END.

           IF (ARR-REASON-TYPE          = "CB")
               MOVE ADJ-CREATE-DATE     TO ZR190WS-AMD-TRANS-DATE
               MOVE "06"                TO ZR190WS-UPDATE-SUM.

           IF (ADJ-REASON-CODE          = "CURR")
              PERFORM 2300-SET-ARDISTRIB-9
              THRU    2300-END
           ELSE
              IF (ARR-REASON-TYPE       = "OS")
                  MOVE ZR190WS-TRANS-DATE TO ZR190WS-AMD-TRANS-DATE
                  MOVE "08"             TO ZR190WS-UPDATE-SUM
              ELSE
              IF (ARR-REASON-TYPE       = "DS")
                  MOVE ADJ-CREATE-DATE  TO ZR190WS-AMD-TRANS-DATE
                  MOVE "07"             TO ZR190WS-UPDATE-SUM.

           IF (ADJ-REASON-CODE          NOT = "CURR")
               PERFORM 1700-SET-ARDISTRIB-3
               THRU    1700-END.

           IF (ADJ-REASON-TYPE = "DS")
               INITIALIZE                  ARWS-TRAN-AMT
               MOVE ARO-COMPANY         TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1
               MOVE ARO-CUSTOMER        TO DB-CUSTOMER
               MOVE ARO-COMPANY         TO ARWS-COMPANY
               MOVE ARO-CUSTOMER        TO ARWS-CUSTOMER
               IF (ADJ-TRANS-TYPE = "C")
                   COMPUTE ARWS-EA-DISC-AMT = ADJ-EA-DISC-AMT
                                            * NEGATIVE-ONE
                   COMPUTE ARWS-UE-DISC-AMT = ADJ-UE-DISC-AMT
                                            * NEGATIVE-ONE
               ELSE  
                   MOVE ADJ-EA-DISC-AMT TO ARWS-EA-DISC-AMT
                   MOVE ADJ-UE-DISC-AMT TO ARWS-UE-DISC-AMT
               END-IF
               MOVE ARH-GROUP-RATE      TO ARWS-GROUP-RATE
               MOVE ARH-GROUP-MUDV      TO ARWS-GROUP-MUDV
               MOVE "D"                 TO ARWS-TRANS-TYPE
               MOVE ARA-DEPOSIT-DATE    TO ARWS-GL-DATE
               PERFORM 700-UPDATE-ARCUSTOMER.

           IF (ARR-CB-TYPE              = "D")
               MOVE ARO-COMPANY         TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1
               MOVE ARO-CUSTOMER        TO DB-CUSTOMER
               MOVE ARO-COMPANY         TO ARWS-COMPANY
               MOVE ARO-CUSTOMER        TO ARWS-CUSTOMER
               IF (ARO-TRANS-TYPE = "C")
                   COMPUTE ARWS-TRAN-AMT = ARO-TRAN-AMT
                                         * -1
               ELSE
                   MOVE ARO-TRAN-AMT    TO ARWS-TRAN-AMT
               END-IF
               MOVE ARH-GROUP-RATE      TO ARWS-GROUP-RATE
               MOVE ARH-GROUP-MUDV      TO ARWS-GROUP-MUDV
               MOVE "C"                 TO ARWS-TRANS-TYPE
               MOVE ARA-GL-DATE         TO ARWS-GL-DATE
               MOVE "Y"                 TO ARWS-SKIP-MX-UPDATE
               PERFORM 700-UPDATE-ARCUSTOMER.

           IF (ARR-CB-TYPE              = "M")
               IF (ARA-COMPANY          NOT = ARA-CR-COMPANY)
               OR (ARO-CUSTOMER         NOT = ARA-CR-CUSTOMER)
                   MOVE ARO-COMPANY     TO DB-COMPANY
                   PERFORM 840-FIND-ACOSET1
                   MOVE ARO-CUSTOMER    TO DB-CUSTOMER
                   MOVE ARO-COMPANY     TO ARWS-COMPANY
                   MOVE ARO-CUSTOMER    TO ARWS-CUSTOMER
                   IF (ARO-TRANS-TYPE = "C")
                       COMPUTE ARWS-TRAN-AMT = ARO-TRAN-AMT
                                             * -1
                   ELSE
                       MOVE ARO-TRAN-AMT    TO ARWS-TRAN-AMT
                   END-IF
                   MOVE ARH-GROUP-RATE  TO ARWS-GROUP-RATE
                   MOVE ARH-GROUP-MUDV  TO ARWS-GROUP-MUDV
                   MOVE "C"             TO ARWS-TRANS-TYPE
                   MOVE ARA-GL-DATE     TO ARWS-GL-DATE
                   MOVE "Y"             TO ARWS-SKIP-MX-UPDATE
                   PERFORM 700-UPDATE-ARCUSTOMER.

           IF (ARR-CB-TYPE              NOT = "D" AND "M")
              IF (ARR-REASON-TYPE       = "OS")
                  IF (ADJ-ADJ-AMT       > ZERO)
                      PERFORM 2800-UPDT-PERIOD-BUCKET
                      THRU    2800-END
                  ELSE
                  IF  (ADJ-ADJ-AMT       < ZERO)
                  AND (ARA-APP-SOURCE    = "R")
                      PERFORM 2800-UPDT-PERIOD-BUCKET
                      THRU    2800-END.

           PERFORM 860-FIND-NXTRNG-ADJSET1.

       1100-END.
      ******************************************************************
       1200-SET-ARDISTRIB-WORK.
      ******************************************************************

           IF  (PROGRAM-RESTARTING           = WS-TRUE)
           AND (WS-RESTART-PHASE         NOT = 2)
               GO TO 1200-CONT3.

           IF (PROGRAM-RESTARTING            = WS-FALSE)
               MOVE PRM-COMPANY              TO WF1-COMPANY
               MOVE ZEROS                    TO WF1-CR-COMPANY
               MOVE SPACES                   TO WF1-OFFSET-CODE
               MOVE ZEROS                    TO WF1-GL-DATE
               MOVE SPACES                   TO WF1-APP-CURR-CD
               MOVE SPACES                   TO WF1-TRANS-TYPE
               MOVE SPACES                   TO WF1-INVOICE
               MOVE ZEROS                    TO WF1-PAYMENT-SEQ
               MOVE ZEROS                    TO WF1-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190A
           ELSE
               MOVE WS-FALSE                 TO PROGRAM-RESTARTING
               MOVE WS-RESTART-COMP          TO WF1-COMPANY
               MOVE WS-RESTART-CR-COMP       TO WF1-CR-COMPANY
               MOVE WS-RESTART-OFFSET        TO WF1-OFFSET-CODE
               MOVE WS-RESTART-GL-DATE       TO WF1-GL-DATE
               MOVE WS-RESTART-CURRENCY      TO WF1-APP-CURR-CD
               MOVE WS-RESTART-TYPE          TO WF1-TRANS-TYPE
               MOVE WS-RESTART-NBR           TO WF1-INVOICE
               MOVE WS-RESTART-PAY-SEQ       TO WF1-PAYMENT-SEQ
               MOVE WS-RESTART-APP-SEQ       TO WF1-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190A
               PERFORM
                   UNTIL (WZR190A-NOTFOUND)
                   OR    (WF1-COMPANY      NOT = WS-RESTART-COMP)
                   OR    (WF1-CR-COMPANY   NOT = WS-RESTART-CR-COMP)
                   OR    (WF1-OFFSET-CODE  NOT = WS-RESTART-OFFSET)
                   OR    (WF1-GL-DATE      NOT = WS-RESTART-DATE)
                   OR    (WF1-APP-CURR-CD  NOT = WS-RESTART-CURRENCY)
                   OR    (WF1-TRANS-TYPE   NOT = WS-RESTART-TYPE)
                   OR    (WF1-INVOICE      NOT = WS-RESTART-NBR)
                   OR    (WF1-PAYMENT-SEQ  NOT = WS-RESTART-PAY-SEQ)
                   OR    (WF1-APP-SEQ      NOT = WS-RESTART-APP-SEQ)

                   PERFORM 8600-READ-NEXT-WZR190A
               END-PERFORM.

           IF  (WZR190A-FOUND)
           AND (WF1-COMPANY             = PRM-COMPANY)
               PERFORM
                   UNTIL (WZR190A-NOTFOUND)
                   OR    (WF1-COMPANY      NOT = PRM-COMPANY)
                       MOVE 2              TO WS-RESTART-PHASE
                       MOVE WF1-COMPANY    TO WS-RESTART-COMP
                       MOVE WF1-CR-COMPANY TO WS-RESTART-CR-COMP
                       MOVE WF1-OFFSET-CODE 
                                           TO WS-RESTART-OFFSET
                       MOVE WF1-GL-DATE    TO WS-RESTART-DATE
                       MOVE WF1-APP-CURR-CD      TO WS-RESTART-CURRENCY
                       MOVE WF1-TRANS-TYPE       TO WS-RESTART-TYPE
                       MOVE WF1-INVOICE          TO WS-RESTART-NBR
                       MOVE WF1-PAYMENT-SEQ      TO WS-RESTART-PAY-SEQ
                       MOVE WF1-APP-SEQ          TO WS-RESTART-APP-SEQ
                       MOVE ZR190WS-PROG-SEQ-NBR TO WS-RESTART-PGM
                       PERFORM 840-MODIFY-CKPSET1
                       MOVE WS-RESTART-INFO   TO CKP-RESTART-INFO
                       PERFORM 820-STORE-CKPOINT
                       PERFORM 1900-SET-ARDISTRIB-5
                       THRU    1900-END
                       PERFORM 920-AUDIT-END
                       PERFORM 910-AUDIT-BEGIN
                       PERFORM 8600-READ-NEXT-WZR190A
                       END-PERFORM.

       1200-CONT3.

           IF  (PROGRAM-RESTARTING           = WS-TRUE)
           AND (WS-RESTART-PHASE         NOT = 3)
               GO TO 1200-CONT4.

           IF (PROGRAM-RESTARTING            = WS-FALSE)
               MOVE PRM-COMPANY              TO WF2-COMPANY
               MOVE SPACES                   TO WF2-PROCESS-LEVEL
               MOVE SPACES                   TO WF2-AR-CODE
               MOVE ZEROS                    TO WF2-GL-DATE
               MOVE SPACES                   TO WF2-APP-CURR-CD
               MOVE SPACES                   TO WF2-TRANS-TYPE
               MOVE SPACES                   TO WF2-INVOICE
               MOVE ZEROS                    TO WF2-PAYMENT-SEQ
               MOVE ZEROS                    TO WF2-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190B
           ELSE
               MOVE WS-FALSE                 TO PROGRAM-RESTARTING
               MOVE WS-RESTART-COMP          TO WF2-COMPANY
               MOVE WS-RESTART-PRL           TO WF2-PROCESS-LEVEL
               MOVE WS-RESTART-AR-CODE       TO WF2-AR-CODE
               MOVE WS-RESTART-DATE          TO WF2-GL-DATE
               MOVE WS-RESTART-CURRENCY      TO WF2-APP-CURR-CD
               MOVE WS-RESTART-TYPE          TO WF2-TRANS-TYPE
               MOVE WS-RESTART-NBR           TO WF2-INVOICE
               MOVE WS-RESTART-PAY-SEQ       TO WF2-PAYMENT-SEQ
               MOVE WS-RESTART-APP-SEQ       TO WF2-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190B
               PERFORM
                   UNTIL (WZR190B-NOTFOUND)
                   OR    (WF2-COMPANY       NOT = WS-RESTART-COMP)
                   OR    (WF2-PROCESS-LEVEL NOT = WS-RESTART-PRL)
                   OR    (WF2-AR-CODE       NOT = WS-RESTART-AR-CODE)
                   OR    (WF2-GL-DATE       NOT = WS-RESTART-DATE)
                   OR    (WF2-APP-CURR-CD   NOT = WS-RESTART-CURRENCY)
                   OR    (WF2-TRANS-TYPE    NOT = WS-RESTART-TYPE)
                   OR    (WF2-INVOICE       NOT = WS-RESTART-NBR)
                   OR    (WF2-PAYMENT-SEQ   NOT = WS-RESTART-PAY-SEQ)
                   OR    (WF2-APP-SEQ       NOT = WS-RESTART-APP-SEQ)

                   PERFORM 8600-READ-NEXT-WZR190B
               END-PERFORM.

           IF  (WZR190B-FOUND)
           AND (WF2-COMPANY             = PRM-COMPANY)
               PERFORM
                   UNTIL (WZR190B-NOTFOUND)
                   OR    (WF2-COMPANY      NOT = PRM-COMPANY)
                       MOVE 3                 TO WS-RESTART-PHASE
                       MOVE WF2-COMPANY       TO WS-RESTART-COMP
                       MOVE WF2-PROCESS-LEVEL TO WS-RESTART-PRL
                       MOVE WF2-AR-CODE       TO WS-RESTART-AR-CODE
                       MOVE WF2-GL-DATE       TO WS-RESTART-DATE
                       MOVE WF2-APP-CURR-CD   TO WS-RESTART-CURRENCY
                       MOVE WF2-TRANS-TYPE       TO WS-RESTART-TYPE
                       MOVE WF2-INVOICE          TO WS-RESTART-NBR
                       MOVE WF2-PAYMENT-SEQ      TO WS-RESTART-PAY-SEQ
                       MOVE WF2-APP-SEQ          TO WS-RESTART-APP-SEQ
                       MOVE ZR190WS-PROG-SEQ-NBR TO WS-RESTART-PGM
                       PERFORM 840-MODIFY-CKPSET1
                       MOVE WS-RESTART-INFO     TO CKP-RESTART-INFO
                       PERFORM 820-STORE-CKPOINT
                       PERFORM 2000-SET-ARDISTRIB-6
                       THRU    2000-END
                       PERFORM 920-AUDIT-END
                       PERFORM 910-AUDIT-BEGIN
                   PERFORM 8600-READ-NEXT-WZR190B
               END-PERFORM.

       1200-CONT4.

           IF  (PROGRAM-RESTARTING           = WS-TRUE)
           AND (WS-RESTART-PHASE         NOT = 4)
               GO TO 1200-CONT5.

           IF (PROGRAM-RESTARTING            = WS-FALSE)
               MOVE PRM-COMPANY              TO WF3-COMPANY
               MOVE ZEROS                    TO WF3-CR-COMPANY
               MOVE SPACES                   TO WF3-OFFSET-CODE
               MOVE ZEROS                    TO WF3-GL-DATE
               MOVE SPACES                   TO WF3-APP-CURR-CD
               MOVE SPACES                   TO WF3-TRANS-TYPE
               MOVE SPACES                   TO WF3-INVOICE
               MOVE ZEROS                    TO WF3-PAYMENT-SEQ
               MOVE ZEROS                    TO WF3-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190C
           ELSE
               MOVE WS-FALSE                 TO PROGRAM-RESTARTING
               MOVE WS-RESTART-COMP          TO WF3-COMPANY
               MOVE WS-RESTART-CR-COMP       TO WF3-CR-COMPANY
               MOVE WS-RESTART-OFFSET        TO WF3-OFFSET-CODE
               MOVE WS-RESTART-DATE          TO WF3-GL-DATE
               MOVE WS-RESTART-CURRENCY      TO WF3-APP-CURR-CD
               MOVE WS-RESTART-TYPE          TO WF3-TRANS-TYPE
               MOVE WS-RESTART-NBR           TO WF3-INVOICE
               MOVE WS-RESTART-PAY-SEQ       TO WF3-PAYMENT-SEQ
               MOVE WS-RESTART-APP-SEQ       TO WF3-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190C
               PERFORM
                   UNTIL (WZR190C-NOTFOUND)
                   OR    (WF3-COMPANY      NOT = WS-RESTART-COMP)
                   OR    (WF3-CR-COMPANY   NOT = WS-RESTART-CR-COMP)
                   OR    (WF3-OFFSET-CODE  NOT = WS-RESTART-OFFSET)
                   OR    (WF3-GL-DATE      NOT = WS-RESTART-DATE)
                   OR    (WF3-APP-CURR-CD  NOT = WS-RESTART-CURRENCY)
                   OR    (WF3-TRANS-TYPE   NOT = WS-RESTART-TYPE)
                   OR    (WF3-INVOICE      NOT = WS-RESTART-NBR)
                   OR    (WF3-PAYMENT-SEQ  NOT = WS-RESTART-PAY-SEQ)
                   OR    (WF3-APP-SEQ      NOT = WS-RESTART-APP-SEQ)

                   PERFORM 8600-READ-NEXT-WZR190C
               END-PERFORM.

            IF  (WZR190C-FOUND)
            AND (WF3-COMPANY             = PRM-COMPANY)
               PERFORM
                   UNTIL (WZR190C-NOTFOUND)
                   OR    (WF3-COMPANY      NOT = PRM-COMPANY)
                       MOVE 4              TO WS-RESTART-PHASE
                       MOVE WF3-COMPANY    TO WS-RESTART-COMP
                       MOVE WF3-CR-COMPANY TO WS-RESTART-CR-COMP
                       MOVE WF3-OFFSET-CODE 
                                            TO WS-RESTART-OFFSET
                       MOVE WF3-GL-DATE     TO WS-RESTART-DATE
                       MOVE WF3-APP-CURR-CD TO WS-RESTART-CURRENCY
                       MOVE WF3-TRANS-TYPE       TO WS-RESTART-TYPE
                       MOVE WF3-INVOICE          TO WS-RESTART-NBR
                       MOVE WF3-PAYMENT-SEQ      TO WS-RESTART-PAY-SEQ
                       MOVE WF3-APP-SEQ          TO WS-RESTART-APP-SEQ
                       MOVE ZR190WS-PROG-SEQ-NBR TO WS-RESTART-PGM
                       PERFORM 840-MODIFY-CKPSET1
                       MOVE WS-RESTART-INFO     TO CKP-RESTART-INFO
                       PERFORM 820-STORE-CKPOINT
                       PERFORM 2100-SET-ARDISTRIB-7
                       THRU    2100-END
                       PERFORM 920-AUDIT-END
                       PERFORM 910-AUDIT-BEGIN
                       PERFORM 8600-READ-NEXT-WZR190C
              END-PERFORM.

       1200-CONT5.

           IF  (PROGRAM-RESTARTING           = WS-TRUE)
           AND (WS-RESTART-PHASE             NOT = 5)
               GO TO 1200-CONT6.

           IF (PROGRAM-RESTARTING            = WS-FALSE)
               MOVE PRM-COMPANY              TO WF4-COMPANY
               MOVE SPACES                   TO WF4-PROCESS-LEVEL
               MOVE SPACES                   TO WF4-AR-CODE
               MOVE ZEROS                    TO WF4-GL-DATE
               MOVE SPACES                   TO WF4-APP-CURR-CD
               MOVE SPACES                   TO WF4-TRANS-TYPE
               MOVE SPACES                   TO WF4-INVOICE
               MOVE ZEROS                    TO WF4-PAYMENT-SEQ
               MOVE ZEROS                    TO WF4-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190D
           ELSE
               MOVE WS-FALSE                 TO PROGRAM-RESTARTING
               MOVE WS-RESTART-COMP          TO WF4-COMPANY
               MOVE WS-RESTART-PRL           TO WF4-PROCESS-LEVEL
               MOVE WS-RESTART-AR-CODE       TO WF4-AR-CODE
               MOVE WS-RESTART-DATE          TO WF4-GL-DATE
               MOVE WS-RESTART-CURRENCY      TO WF4-APP-CURR-CD
               MOVE WS-RESTART-TYPE          TO WF4-TRANS-TYPE
               MOVE WS-RESTART-NBR           TO WF4-INVOICE
               MOVE WS-RESTART-PAY-SEQ       TO WF4-PAYMENT-SEQ
               MOVE WS-RESTART-APP-SEQ       TO WF4-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190D
               PERFORM
                   UNTIL (WZR190D-NOTFOUND)
                   OR    (WF4-COMPANY       NOT = WS-RESTART-COMP)
                   OR    (WF4-PROCESS-LEVEL NOT = WS-RESTART-PRL)
                   OR    (WF4-AR-CODE       NOT = WS-RESTART-AR-CODE)
                   OR    (WF4-GL-DATE       NOT = WS-RESTART-DATE)
                   OR    (WF4-APP-CURR-CD   NOT = WS-RESTART-CURRENCY)
                   OR    (WF4-TRANS-TYPE    NOT = WS-RESTART-TYPE)
                   OR    (WF4-INVOICE       NOT = WS-RESTART-NBR)
                   OR    (WF4-PAYMENT-SEQ   NOT = WS-RESTART-PAY-SEQ)
                   OR    (WF4-APP-SEQ       NOT = WS-RESTART-APP-SEQ)

                   PERFORM 8600-READ-NEXT-WZR190D
               END-PERFORM.

            IF  (WZR190D-FOUND)
            AND (WF4-COMPANY             = PRM-COMPANY)
               PERFORM
                   UNTIL (WZR190D-NOTFOUND)
                   OR    (WF4-COMPANY      NOT = PRM-COMPANY)
                       MOVE 5                 TO WS-RESTART-PHASE
                       MOVE WF4-COMPANY       TO WS-RESTART-COMP
                       MOVE WF4-PROCESS-LEVEL TO WS-RESTART-PRL
                       MOVE WF4-AR-CODE       TO WS-RESTART-AR-CODE
                       MOVE WF4-GL-DATE       TO WS-RESTART-DATE
                       MOVE WF4-APP-CURR-CD   TO WS-RESTART-CURRENCY
                       MOVE WF4-TRANS-TYPE       TO WS-RESTART-TYPE
                       MOVE WF4-INVOICE          TO WS-RESTART-NBR
                       MOVE WF4-PAYMENT-SEQ      TO WS-RESTART-PAY-SEQ
                       MOVE WF4-APP-SEQ          TO WS-RESTART-APP-SEQ
                       MOVE ZR190WS-PROG-SEQ-NBR TO WS-RESTART-PGM
                       PERFORM 840-MODIFY-CKPSET1
                       MOVE WS-RESTART-INFO     TO CKP-RESTART-INFO
                       PERFORM 820-STORE-CKPOINT
                       PERFORM 2200-SET-ARDISTRIB-8
                       THRU    2200-END
                       PERFORM 920-AUDIT-END
                       PERFORM 910-AUDIT-BEGIN
                       PERFORM 8600-READ-NEXT-WZR190D
               END-PERFORM.

       1200-CONT6.

           IF  (PROGRAM-RESTARTING           = WS-TRUE)
           AND (WS-RESTART-PHASE             NOT = 6)
               GO TO 1200-END.

           IF (PROGRAM-RESTARTING            = WS-FALSE)
               MOVE PRM-COMPANY              TO WF8-COMPANY
               MOVE ZEROS                    TO WF8-CR-COMPANY   
               MOVE SPACES                   TO WF8-OFFSET-CODE
               MOVE ZEROS                    TO WF8-GL-DATE
               MOVE SPACES                   TO WF8-APP-CURR-CD
               MOVE SPACES                   TO WF8-TRANS-TYPE
               MOVE SPACES                   TO WF8-INVOICE
               MOVE ZEROS                    TO WF8-PAYMENT-SEQ
               MOVE ZEROS                    TO WF8-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190H
           ELSE
               MOVE WS-FALSE                 TO PROGRAM-RESTARTING
               MOVE WS-RESTART-COMP          TO WF8-COMPANY
               MOVE WS-RESTART-CR-COMP       TO WF8-CR-COMPANY   
               MOVE WS-RESTART-OFFSET        TO WF8-OFFSET-CODE
               MOVE WS-RESTART-GL-DATE       TO WF8-GL-DATE
               MOVE WS-RESTART-CURRENCY      TO WF8-APP-CURR-CD
               MOVE WS-RESTART-TYPE          TO WF8-TRANS-TYPE
               MOVE WS-RESTART-NBR           TO WF8-INVOICE
               MOVE WS-RESTART-PAY-SEQ       TO WF8-PAYMENT-SEQ
               MOVE WS-RESTART-APP-SEQ       TO WF8-APP-SEQ
               PERFORM 8500-READ-NLT-WZR190H
               PERFORM
                   UNTIL (WZR190H-NOTFOUND)
                   OR    (WF8-COMPANY       NOT = WS-RESTART-COMP)
                   OR    (WF8-CR-COMPANY    NOT = WS-RESTART-CR-COMP)
                   OR    (WF8-OFFSET-CODE   NOT = WS-RESTART-OFFSET)  
                   OR    (WF8-GL-DATE       NOT = WS-RESTART-DATE)
                   OR    (WF8-APP-CURR-CD   NOT = WS-RESTART-CURRENCY)
                   OR    (WF8-TRANS-TYPE    NOT = WS-RESTART-TYPE)
                   OR    (WF8-INVOICE       NOT = WS-RESTART-NBR)
                   OR    (WF8-PAYMENT-SEQ   NOT = WS-RESTART-PAY-SEQ)
                   OR    (WF8-APP-SEQ       NOT = WS-RESTART-APP-SEQ)

                   PERFORM 8600-READ-NEXT-WZR190H
               END-PERFORM.

            IF  (WZR190H-FOUND)
            AND (WF8-COMPANY             = PRM-COMPANY)
               PERFORM
                   UNTIL (WZR190H-NOTFOUND)
                   OR    (WF8-COMPANY      NOT = PRM-COMPANY)
                       MOVE 6                 TO WS-RESTART-PHASE
                       MOVE WF8-COMPANY       TO WS-RESTART-COMP
                       MOVE WF8-CR-COMPANY    TO WS-RESTART-CR-COMP
                       MOVE WF8-OFFSET-CODE   TO WS-RESTART-OFFSET 
                       MOVE WF8-GL-DATE       TO WS-RESTART-DATE
                       MOVE WF8-APP-CURR-CD   TO WS-RESTART-CURRENCY
                       MOVE WF8-TRANS-TYPE    TO WS-RESTART-TYPE
                       MOVE WF8-INVOICE       TO WS-RESTART-NBR
                       MOVE WF8-PAYMENT-SEQ   TO WS-RESTART-PAY-SEQ
                       MOVE WF8-APP-SEQ       TO WS-RESTART-APP-SEQ
                       MOVE ZR190WS-PROG-SEQ-NBR TO WS-RESTART-PGM
                       PERFORM 840-MODIFY-CKPSET1
                       MOVE WS-RESTART-INFO     TO CKP-RESTART-INFO
                       PERFORM 820-STORE-CKPOINT
                       PERFORM 2900-SET-ARDISTRIB-10
                       THRU    2900-END
                       PERFORM 920-AUDIT-END
                       PERFORM 910-AUDIT-BEGIN
                       PERFORM 8600-READ-NEXT-WZR190H
               END-PERFORM.

       1200-END.
      ******************************************************************
       1300-CHECK-ADJ-STATUS.
      ******************************************************************

           IF (ADJ-REVIEW-STATUS       = 2)
               MOVE "Y"                TO ZR190WS-REV-FL
               GO TO 1300-END.

           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE "AD"                   TO DB-TYPE.
           MOVE ADJ-REASON-CODE        TO DB-REASON-CODE.
           PERFORM 840-FIND-ARRSET1.
           IF (ARR-REASON-TYPE         = "CB")
               MOVE "Y"                TO ARWS-CHARGEBACK-FL.

           PERFORM 860-FIND-NXTRNG-ADJSET1.

       1300-END.
      ******************************************************************
       1500-SET-ARDISTRIB-1.
      ******************************************************************

           MOVE WS-TRUE                TO WS-RESTART-APPL-FL.
           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ARA-AR-CODE            TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT          TO ZR190WS-BASE-ACCTUNIT.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-BATCH-NBR      TO AMD-BATCH-NBR.
           MOVE ZR190WS-CUSTOMER       TO AMD-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL.
           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ADJ-CREATE-DATE        TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           IF (ARA-CR-COMPANY          NOT = ARA-COMPANY)
               MOVE ADJ-ADJ-AMT        TO AMD-TO-COMP-AMT.
           MOVE ADJ-ADJ-AMT            TO AMD-TRAN-AMT.
           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE ADJ-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ADJ-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE ADJ-UNITS              TO AMD-UNITS.
           MOVE 2                      TO AMD-STATUS.
           MOVE ZR190WS-ORIG-ND        TO AMD-ORIG-ND.
           MOVE ZR190WS-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-RATE      TO AMD-ORIG-RATE.
           MOVE ADJ-ORIG-ADJ-AMT       TO AMD-ORIG-AMT.
           MOVE "02"                   TO AMD-UPDATE-SUM.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

GW0106
GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU   7000-END.

           PERFORM 820-STORE-ARDISTRIB.

           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE "AD"                   TO DB-TYPE.
           MOVE ADJ-REASON-CODE        TO DB-REASON-CODE.
           PERFORM 840-FIND-ARRSET1.
           MOVE ARR-CB-ACCT-UNIT       TO ZR190WS-ACCT-UNIT.

           MOVE ZR190WS-PROCESS-LEVEL  TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-APVSET1.

           IF (ARR-ACCT-UNIT-FLAG = "Y")
           OR (APV-ACCT-UNIT      = SPACES)
              MOVE ARR-CB-ACCT-UNIT    TO ZR190WS-ACCT-UNIT
           ELSE
               IF (APV-ACCT-UNIT       NOT = SPACES)
                   INITIALIZE              EDAC60WS-PARMS
                   MOVE ADJ-COMPANY     TO IFACWS-COMPANY
                   MOVE APV-ACCT-UNIT   TO IFACWS-ACCT-UNIT
                   MOVE ARR-CB-ACCOUNT  TO IFACWS-ACCOUNT
                   MOVE ARR-CB-SUB-ACCT TO IFACWS-SUB-ACCOUNT
                   INITIALIZE              IFACWS-ACTIVITY
                                           IFACWS-ACCT-CATEGORY
                   MOVE 2               TO IFACWS-EDIT-TYPE
                   MOVE "Y"             TO IFACWS-BYPASS-SEG-EDIT
                   MOVE "AR"            TO IFACWS-SYSTEM
                   PERFORM 635-EDIT-GLMASTER-60
                   IF  (ERROR-FOUND)
                   AND (IFACWS-CURSOR-POSITION  = "A")
                      MOVE ARR-CB-ACCT-UNIT     TO ZR190WS-ACCT-UNIT
                   ELSE
                      MOVE APV-ACCT-UNIT        TO ZR190WS-ACCT-UNIT.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE ZR190WS-ACCT-UNIT      TO AMD-ACCT-UNIT.
           MOVE ARR-CB-ACCOUNT         TO AMD-ACCOUNT.
           MOVE ARR-CB-SUB-ACCT        TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-BATCH-NBR      TO AMD-BATCH-NBR.
           MOVE ZR190WS-CUSTOMER       TO AMD-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL.
           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ADJ-CREATE-DATE        TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           COMPUTE AMD-TRAN-AMT ROUNDED = ADJ-ADJ-AMT
                                        * NEGATIVE-ONE.
           IF (ARA-CR-COMPANY          NOT = ARA-COMPANY)
               COMPUTE AMD-TO-COMP-AMT ROUNDED = ADJ-ADJ-AMT
                                               * NEGATIVE-ONE.
           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE ADJ-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ADJ-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE ADJ-UNITS              TO AMD-UNITS.
           MOVE 2                      TO AMD-STATUS.
           MOVE ZR190WS-ORIG-ND        TO AMD-ORIG-ND.
           MOVE ZR190WS-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-RATE      TO AMD-ORIG-RATE.
           IF (ZR190WS-CURR-MUDV       = "M")
               COMPUTE AMD-ORIG-AMT ROUNDED = (ADJ-ADJ-AMT
                                            / ZR190WS-ORIG-RATE)
                                            * NEGATIVE-ONE
           ELSE
               COMPUTE AMD-ORIG-AMT ROUNDED = (ADJ-ADJ-AMT
                                            * ZR190WS-ORIG-RATE)
                                            * NEGATIVE-ONE.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

GW0106
GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU   7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       1500-END.
      ******************************************************************
       1600-SET-ARDISTRIB-2.
      ******************************************************************

           MOVE WS-TRUE                TO WS-RESTART-APPL-FL.
           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ARA-AR-CODE            TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT          TO ZR190WS-BASE-ACCTUNIT.

           MOVE ADJ-COMPANY             TO DB-COMPANY.
           MOVE "AD"                    TO DB-TYPE.
           MOVE ADJ-REASON-CODE         TO DB-REASON-CODE.
           PERFORM 840-FIND-ARRSET1.

           MOVE ZR190WS-PROCESS-LEVEL   TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-APVSET1.

           IF (ARR-ACCT-UNIT-FLAG = "Y")
           OR (APV-ACCT-UNIT      = SPACES)
               MOVE ARR-CB-ACCT-UNIT        TO ZR190WS-ACCT-UNIT
           ELSE
               INITIALIZE                      EDAC60WS-PARMS
               MOVE ADJ-COMPANY             TO IFACWS-COMPANY
               MOVE APV-ACCT-UNIT           TO IFACWS-ACCT-UNIT
               MOVE ARR-CB-ACCOUNT          TO IFACWS-ACCOUNT
               MOVE ARR-CB-SUB-ACCT         TO IFACWS-SUB-ACCOUNT
               INITIALIZE                      IFACWS-ACTIVITY
                                               IFACWS-ACCT-CATEGORY
               MOVE 2                       TO IFACWS-EDIT-TYPE
               MOVE "Y"                     TO IFACWS-BYPASS-SEG-EDIT
               MOVE "AR"                    TO IFACWS-SYSTEM
               PERFORM 635-EDIT-GLMASTER-60
               IF  (ERROR-FOUND)
               AND (IFACWS-CURSOR-POSITION  = "A")
                  MOVE ARR-CB-ACCT-UNIT     TO ZR190WS-ACCT-UNIT
               ELSE
                  MOVE APV-ACCT-UNIT        TO ZR190WS-ACCT-UNIT.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE ZR190WS-ACCT-UNIT      TO AMD-ACCT-UNIT.
           MOVE ARR-CB-ACCOUNT         TO AMD-ACCOUNT.
           MOVE ARR-CB-SUB-ACCT        TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZEROS                  TO AMD-BATCH-NBR.
           MOVE ZR190WS-CUSTOMER       TO AMD-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL.
           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-TRANS-DATE     TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           COMPUTE AMD-TRAN-AMT ROUNDED = ADJ-ADJ-AMT
                                        * NEGATIVE-ONE.
           COMPUTE AMD-TO-COMP-AMT ROUNDED = ADJ-ADJ-AMT
                                           * NEGATIVE-ONE.
           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE ZR190WS-ORIG-ND         TO AMD-ORIG-ND.
           MOVE ZR190WS-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-RATE      TO AMD-ORIG-RATE.
           COMPUTE AMD-ORIG-AMT ROUNDED = ADJ-ORIG-ADJ-AMT
                                        * NEGATIVE-ONE.
           MOVE 178                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-MSG2.
           MOVE WF5-CR-NBR             TO ZR190WS-NBR2.
           MOVE ZR190WS-MSG-NBR        TO AMD-DESC.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106      THRU   7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       1600-END.
      ******************************************************************
       1700-SET-ARDISTRIB-3.
      ******************************************************************

           MOVE WS-TRUE                TO WS-RESTART-APPL-FL.
           MOVE ADJ-ADJ-AMT TO WS-TRAN-AMT.                             
                                                                        
           IF (ZR190WS-ADJ-ARR-TYPE = "DS")                             
               IF (ACO-DISC-TAX-RCV = "Y")                              
                    PERFORM 1720-CHECK-FOR-TAX-ON-DISCOUNT
                            THRU 1720-END.

           IF (ZR190WS-CREDIT = WS-TRUE)
               PERFORM 1710-SET-CREDIT-ARDISTRIB-3
               THRU    1710-END
               GO TO 1700-END.

           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ARA-AR-CODE            TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT          TO ZR190WS-BASE-ACCTUNIT.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE ADJ-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE ADJ-ACCOUNT            TO AMD-ACCOUNT.
           MOVE ADJ-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-BATCH-NBR      TO AMD-BATCH-NBR.
           MOVE ZR190WS-CUSTOMER       TO AMD-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL.
           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-AMD-TRANS-DATE TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           MOVE ADJ-ADJ-AMT            TO AMD-TRAN-AMT.
           MOVE ADJ-ADJ-AMT            TO AMD-TO-COMP-AMT.
           MOVE ADJ-ORIG-ADJ-AMT       TO AMD-ORIG-AMT.
           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE ADJ-UNITS              TO AMD-UNITS.
           MOVE ADJ-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ADJ-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE 2                      TO AMD-STATUS.
           MOVE ZR190WS-ORIG-ND        TO AMD-ORIG-ND.
           MOVE ZR190WS-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-RATE      TO AMD-ORIG-RATE.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-TO-COMP-AMT = AMD-TO-COMP-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

           PERFORM 665-EDIT-REMOTE-SITE.
           MOVE "AR"                   TO EDSYWS-SYSTEM.
           PERFORM 540-EDIT-SYSTEM-70.

           IF  ((EDSYWS-AC-COMMIT-FL    = "Y")
           OR   (EDSYWS-GL-COMMIT-FL    = "Y"))
           AND (AMD-ACTIVITY        NOT = SPACES)
           AND (AMD-STATUS              = 2)
           AND ((ZR190WS-ADJ-ARR-TYPE   = "OS")
           OR   (ZR190WS-ADJ-ARR-TYPE   = "DS"))
               MOVE AMD-GL-COMPANY     TO IFUCWS-COMPANY 
               MOVE AMD-ACTIVITY       TO IFUCWS-ACTIVITY
               MOVE "AR"               TO IFUCWS-SYSTEM
               MOVE AMD-INVOICE        TO IFUCWS-INVOICE
               MOVE AMD-ORIG-CURRENCY  TO IFUCWS-CURRENCY-CODE
               MOVE AMD-ACCT-CATEGORY  TO IFUCWS-ACCT-CATEGORY
               MOVE AMD-ACCT-UNIT      TO IFUCWS-ACCT-UNIT
               MOVE AMD-ACCOUNT        TO IFUCWS-ACCOUNT
               MOVE AMD-SUB-ACCT       TO IFUCWS-SUB-ACCOUNT
               MOVE AMD-ORIG-AMT       TO IFUCWS-AMOUNT
               MOVE AMD-UNITS          TO IFUCWS-UNIT
               MOVE AMD-ORIG-ND        TO IFUCWS-TRAN-ND
               MOVE AMD-GL-DATE        TO IFUCWS-TRANS-DATE
               INITIALIZE                 IFUCWS-GLT-OBJ-ID
               INITIALIZE                 IFUCWS-ATN-OBJ-ID
               PERFORM 630-UPDATE-GLCOMMIT-80
               MOVE IFUCWS-GLT-OBJ-ID  TO AMD-GLT-OBJ-ID
               MOVE IFUCWS-ATN-OBJ-ID  TO AMD-ATN-OBJ-ID.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106      THRU   7000-END.

           PERFORM 820-STORE-ARDISTRIB.

           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ARA-AR-CODE            TO DB-AR-CODE.

           PERFORM 840-FIND-RCDSET1.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-BATCH-NBR      TO AMD-BATCH-NBR.
           MOVE ZR190WS-CUSTOMER       TO AMD-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL.
           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-AMD-TRANS-DATE TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.

           COMPUTE AMD-ORIG-AMT ROUNDED = ADJ-ORIG-ADJ-AMT
                                        * NEGATIVE-ONE.
           COMPUTE AMD-TRAN-AMT ROUNDED = ADJ-ADJ-AMT
                                        * NEGATIVE-ONE.
           COMPUTE AMD-TO-COMP-AMT ROUNDED = ADJ-ADJ-AMT
                                           * NEGATIVE-ONE.

           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE ZR190WS-ORIG-ND        TO AMD-ORIG-ND.
           MOVE ZR190WS-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-RATE      TO AMD-ORIG-RATE.
           MOVE ZR190WS-UPDATE-SUM     TO AMD-UPDATE-SUM.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-TO-COMP-AMT = AMD-TO-COMP-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       1700-END.
      ******************************************************************
       1710-SET-CREDIT-ARDISTRIB-3.
      ******************************************************************

           MOVE WS-TRUE                TO WS-RESTART-APPL-FL.
           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ARA-AR-CODE            TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT          TO ZR190WS-BASE-ACCTUNIT.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE ADJ-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE ADJ-ACCOUNT            TO AMD-ACCOUNT.
           MOVE ADJ-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ARA-CR-BATCH           TO AMD-BATCH-NBR.
           MOVE ARA-CR-CUSTOMER        TO AMD-CUSTOMER.
           IF (ARA-CR-TYPE = "P")
               MOVE ARA-CR-COMPANY     TO DB-COMPANY
               MOVE ARA-CR-BATCH       TO DB-BATCH-NBR
               MOVE ARA-CR-PYMNT-SEQ   TO DB-PAYMENT-SEQ
               PERFORM 840-FIND-APMSET1
               MOVE APM-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL
               MOVE APM-ORIG-ND        TO AMD-ORIG-ND
               MOVE APM-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY
               MOVE APM-ORIG-RATE      TO AMD-ORIG-RATE.

           IF (ARA-CR-TYPE = "C")
               MOVE ARA-CR-COMPANY     TO DB-COMPANY
               MOVE ARA-CR-TYPE        TO DB-TRANS-TYPE
               MOVE ARA-CR-NBR         TO DB-INVOICE
               PERFORM 840-FIND-ARHSET1
               MOVE ARH-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL
               MOVE ARH-ORIG-ND        TO AMD-ORIG-ND
               MOVE ARH-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY
               MOVE ARH-ORIG-RATE      TO AMD-ORIG-RATE.

           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-AMD-TRANS-DATE TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           COMPUTE AMD-ORIG-AMT ROUNDED = ADJ-ORIG-ADJ-AMT
                                        * NEGATIVE-ONE.
           COMPUTE AMD-TRAN-AMT ROUNDED = ADJ-ADJ-AMT
                                        * NEGATIVE-ONE.
           COMPUTE AMD-TO-COMP-AMT ROUNDED = ADJ-ADJ-AMT
                                           * NEGATIVE-ONE.
           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE ADJ-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ADJ-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE ADJ-UNITS              TO AMD-UNITS.
           MOVE 2                      TO AMD-STATUS.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

           PERFORM 665-EDIT-REMOTE-SITE.
           MOVE "AR"                   TO EDSYWS-SYSTEM.
           PERFORM 540-EDIT-SYSTEM-70.

           IF  ((EDSYWS-AC-COMMIT-FL    = "Y")
           OR   (EDSYWS-GL-COMMIT-FL    = "Y"))
           AND (AMD-ACTIVITY        NOT = SPACES)
           AND (AMD-STATUS              = 2)
           AND ((ZR190WS-ADJ-ARR-TYPE   = "OS")
           OR   (ZR190WS-ADJ-ARR-TYPE   = "DS"))
               MOVE AMD-GL-COMPANY     TO IFUCWS-COMPANY 
               MOVE AMD-ACTIVITY       TO IFUCWS-ACTIVITY
               MOVE "AR"               TO IFUCWS-SYSTEM
               MOVE AMD-INVOICE        TO IFUCWS-INVOICE
               MOVE AMD-ORIG-CURRENCY  TO IFUCWS-CURRENCY-CODE
               MOVE AMD-ACCT-CATEGORY  TO IFUCWS-ACCT-CATEGORY
               MOVE AMD-ACCT-UNIT      TO IFUCWS-ACCT-UNIT
               MOVE AMD-ACCOUNT        TO IFUCWS-ACCOUNT
               MOVE AMD-SUB-ACCT       TO IFUCWS-SUB-ACCOUNT
               MOVE AMD-ORIG-AMT       TO IFUCWS-AMOUNT
               MOVE AMD-UNITS          TO IFUCWS-UNIT
               MOVE AMD-ORIG-ND        TO IFUCWS-TRAN-ND
               MOVE AMD-GL-DATE        TO IFUCWS-TRANS-DATE
               INITIALIZE                 IFUCWS-GLT-OBJ-ID
               INITIALIZE                 IFUCWS-ATN-OBJ-ID
               PERFORM 630-UPDATE-GLCOMMIT-80
               MOVE IFUCWS-GLT-OBJ-ID  TO AMD-GLT-OBJ-ID
               MOVE IFUCWS-ATN-OBJ-ID  TO AMD-ATN-OBJ-ID.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

           IF (ARA-CR-TYPE = "P")
               MOVE APM-COMPANY        TO DB-COMPANY
               MOVE APM-AR-CODE        TO DB-AR-CODE
           ELSE
               MOVE ARH-COMPANY        TO DB-COMPANY
               MOVE ARH-AR-CODE        TO DB-AR-CODE.

           PERFORM 840-FIND-RCDSET1.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ARA-CR-BATCH           TO AMD-BATCH-NBR.
           MOVE ARA-CR-CUSTOMER        TO AMD-CUSTOMER.
           IF (ARA-CR-TYPE = "P")
               MOVE APM-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL
               MOVE APM-ORIG-ND        TO AMD-ORIG-ND
               MOVE APM-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY
               MOVE APM-ORIG-RATE      TO AMD-ORIG-RATE.

           IF (ARA-CR-TYPE = "C")
               MOVE ARH-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL
               MOVE ARH-ORIG-ND        TO AMD-ORIG-ND
               MOVE ARH-ORIG-CURRENCY  TO AMD-ORIG-CURRENCY
               MOVE ARH-ORIG-RATE      TO AMD-ORIG-RATE.

           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-AMD-TRANS-DATE TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           MOVE ADJ-ADJ-AMT            TO AMD-TRAN-AMT.
           MOVE ADJ-ADJ-AMT            TO AMD-TO-COMP-AMT.
           MOVE ADJ-ORIG-ADJ-AMT       TO AMD-ORIG-AMT.

           MOVE ADJ-ORIG-ADJ-AMT       TO AMD-ORIG-AMT.
           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE ZR190WS-UPDATE-SUM     TO AMD-UPDATE-SUM.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       1710-END.

      *****************************************************************
       1720-CHECK-FOR-TAX-ON-DISCOUNT.
      *****************************************************************

      **** Calculate the discount percent.
           COMPUTE ZR190WS-DISCOUNT-PERCENT = 
                   (ADJ-ADJ-AMT / ARO-TRAN-AMT).

      **** Open third-party tax transaction file or use the Lawson 
      **** TXTAXTRAN file depending on A/R configuration.
           MOVE ADJ-COMPANY            TO TXOCF-COMPANY.
           MOVE "O"                    TO TXOCF-FUNCTION.
           PERFORM 2000-ACCESS-TAX-FILES-70.
           IF (ERROR-FOUND)
               INITIALIZE CRT-ERROR-NBR
                          CRT-ERROR-CAT.

      **** Locate the last matching ARDISTRIB record that corresponds
      **** to the ARADJUST record for the purpose of obtaining the
      **** last DIST-SEQ.
           MOVE ADJ-COMPANY        TO DB-COMPANY.
           MOVE ADJ-BATCH-NBR      TO DB-BATCH-NBR.
           MOVE ADJ-TRANS-TYPE     TO DB-TRANS-TYPE.
           MOVE ADJ-INVOICE        TO DB-INVOICE.                       
           MOVE ARO-CUSTOMER       TO DB-CUSTOMER.
           MOVE ZERO               TO DB-DIST-SEQ.
           PERFORM 850-FIND-NLT-AMDSET2.
           IF (ARDISTRIB-NOTFOUND)
           OR (AMD-COMPANY    NOT = DB-COMPANY)
           OR (AMD-BATCH-NBR  NOT = DB-BATCH-NBR)
           OR (AMD-TRANS-TYPE NOT = DB-TRANS-TYPE)
           OR (AMD-INVOICE    NOT = DB-INVOICE)                         
           OR (AMD-CUSTOMER   NOT = DB-CUSTOMER)
               NEXT SENTENCE
           ELSE
               INITIALIZE WS-SV-TAX-CODE
               PERFORM
                   UNTIL (ARDISTRIB-NOTFOUND)
                   OR    (AMD-COMPANY    NOT = DB-COMPANY)
                   OR    (AMD-BATCH-NBR  NOT = DB-BATCH-NBR)
                   OR    (AMD-TRANS-TYPE NOT = DB-TRANS-TYPE)
                   OR    (AMD-INVOICE    NOT = DB-INVOICE)              
                   OR    (AMD-CUSTOMER   NOT = DB-CUSTOMER) 
                   OR   ((WS-SV-TAX-CODE NOT = SPACES)
                   AND   (AMD-TAX-CODE       = WS-SV-TAX-CODE))
                       IF (WS-SV-TAX-CODE    = SPACES)
                           MOVE AMD-TAX-CODE   TO WS-SV-TAX-CODE
                       END-IF
                       MOVE AMD-DIST-SEQ TO ZR190WS-HOLD-AMD-DIST-SEQ
                       PERFORM 860-FIND-NEXT-AMDSET2
               END-PERFORM
      * IF A CREDIT SKIP PAST ADJUST RECORD TO FIND APPLIED RECORD *
               IF (ARA-INVOICE = ARA-CR-NBR)
               AND (ARA-TRANS-TYPE = "C")
                   MOVE "Y"                TO WS-SAME-LAST-CR-TRANS-NBR
                   MOVE ADJ-COMPANY        TO DB-CR-COMPANY
                                              WS-LAST-COMPANY
                   MOVE ARO-CUSTOMER       TO DB-CR-CUSTOMER
                   MOVE ADJ-TRANS-TYPE     TO DB-CR-TYPE
                                              WS-LAST-TRANS-TYPE
                   MOVE ADJ-INVOICE        TO DB-CR-NBR
                                              WS-LAST-TRANS-NBR
                   MOVE ADJ-PAYMENT-SEQ    TO DB-CR-PYMNT-SEQ
                                              WS-LAST-PAYMENT-SEQ
                   MOVE ADJ-BATCH-NBR      TO DB-CR-BATCH
                                              WS-LAST-BATCH-NBR
                   MOVE ZEROES             TO DB-CR-SUFFIX
                   MOVE ZEROES             TO DB-CR-CANCEL-SEQ
                   MOVE ADJ-APP-SEQ        TO DB-CR-APP-SEQ
                                              WS-LAST-APP-SEQ
                   PERFORM 850-FIND-NLT-ARASET3
                   PERFORM 
                      UNTIL (ARAPPLIED-NOTFOUND)
                      OR    (ARA-INVOICE  NOT = ARA-CR-NBR)
                      PERFORM 860-FIND-NEXT-ARASET3
                   END-PERFORM
               END-IF
      *   SWITCH BACK TO THE RIGHT RECORD SEQUENCE FOR ARASET4
      *   IF WE SWITCHED TO ARASET3 TO SKIP PAST CREDIT ADJ
      *   RECORD TO GET THE CORRECT VALUES FOR ARA-APPLD-AMT
      *   AND ARA-ORIG-APP-AMT
               MOVE ARA-ORIG-APP-AMT    TO ZR190WS-APP-AMT-SAVE
               MOVE ARA-APPLD-AMT       TO ZR190WS-APPLD-AMT-SAVE

               IF (ARAPPLIED-FOUND)
               AND (WS-SAME-LAST-CR-TRANS-NBR = "Y")
                   MOVE WS-LAST-COMPANY     TO DB-COMPANY
                   MOVE WS-LAST-TRANS-TYPE  TO DB-TRANS-TYPE
                   MOVE WS-LAST-TRANS-NBR   TO DB-INVOICE
                   MOVE WS-LAST-PAYMENT-SEQ TO DB-PAYMENT-SEQ
                   MOVE WS-LAST-BATCH-NBR   TO DB-BATCH-NBR
                   MOVE WS-LAST-APP-SEQ     TO DB-APP-SEQ
                   PERFORM 850-MODIFY-NLT-ARASET4
                   MOVE "N"            TO WS-SAME-LAST-CR-TRANS-NBR
               END-IF
      *        **** Find and process all existing corresponding
      *        **** ARDISTRIB records which match the ARADJUST record
               MOVE ADJ-COMPANY        TO DB-COMPANY
               MOVE ADJ-BATCH-NBR      TO DB-BATCH-NBR
               MOVE ADJ-TRANS-TYPE     TO DB-TRANS-TYPE
               MOVE ADJ-INVOICE        TO DB-INVOICE                    
               MOVE ARO-CUSTOMER       TO DB-CUSTOMER
               MOVE ZERO               TO DB-DIST-SEQ
               PERFORM 850-FIND-NLT-AMDSET2
               PERFORM 
                   UNTIL (ARDISTRIB-NOTFOUND)
                   OR    (AMD-COMPANY    NOT = DB-COMPANY)
                   OR    (AMD-BATCH-NBR  NOT = DB-BATCH-NBR)
                   OR    (AMD-TRANS-TYPE NOT = DB-TRANS-TYPE)
                   OR    (AMD-INVOICE    NOT = DB-INVOICE)              
                   OR    (AMD-CUSTOMER   NOT = DB-CUSTOMER)
                   OR    (AMD-DIST-SEQ    >   ZR190WS-HOLD-AMD-DIST-SEQ)
                       PERFORM 1730-LOOP-THRU-AMD THRU 1730-END
               END-PERFORM. 

      *--- Close third party tax transaction file if applicable.
           MOVE ADJ-COMPANY TO TXOCF-COMPANY.
           MOVE "C" TO TXOCF-FUNCTION.
           PERFORM 2000-ACCESS-TAX-FILES-70.
           IF (ERROR-FOUND)
               INITIALIZE CRT-ERROR-NBR
                          CRT-ERROR-CAT.

       1720-END.

      ******************************************************************
       1730-LOOP-THRU-AMD.
      ******************************************************************
           
           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           IF (AMD-TAX-CODE NOT = SPACES)
               NEXT SENTENCE
           ELSE
               GO TO 1730-READ-NEXT-ARDISTRIB.


      *--- Calculate the tax recovery amount in company base currency.
           COMPUTE ZR190WS-TAX-RECOVERY-AMOUNT = 
                   (ZR190WS-TRAN-AMT * ZR190WS-DISCOUNT-PERCENT).


      *--- HANDLE A PAYMENT REVERSAL CREATED BY AR180                
           IF (ARA-APP-SOURCE = "R")
               COMPUTE ZR190WS-ARA-ORIG-APP-AMT =
                       ZR190WS-APP-AMT-SAVE * NEGATIVE-ONE
               COMPUTE ZR190WS-ARA-APPLD-AMT =
                       ZR190WS-APPLD-AMT-SAVE * NEGATIVE-ONE
          ELSE
               MOVE ZR190WS-APP-AMT-SAVE   TO ZR190WS-ARA-ORIG-APP-AMT
               MOVE ZR190WS-APPLD-AMT-SAVE TO ZR190WS-ARA-APPLD-AMT
          END-IF.

           COMPUTE ZR190WS-ORIG-REVERSE-AMT ROUNDED =
               AMD-ORIG-AMT - ((ZR190WS-ARA-ORIG-APP-AMT
                              / ZR190WS-ARH-ORIG-AMT) * AMD-ORIG-AMT).

           COMPUTE ZR190WS-TRAN-REVERSE-AMT ROUNDED =
               AMD-TRAN-AMT - ((ZR190WS-ARA-APPLD-AMT
                              / ZR190WS-ARH-TRAN-AMT) * AMD-TRAN-AMT).

      *--- Call the 5000-TAXCAL-OBJECT-70 routine to obtain values for
      *--- creating a ARDISTRIB record.
           INITIALIZE TXCAL-INPUT-PARMS.
           MOVE AMD-GL-COMPANY      TO TXCAL-COMPANY.
           MOVE "I"                 TO TXCAL-FUNCTION.
           MOVE AMD-TAX-CODE        TO TXCAL-TAX-CODE.
           MOVE "AR"                TO TXCAL-SYSTEM.
           PERFORM 5000-TXCAL-OBJECT-70.

      **** Begin loading values to working storage areas to be used
      **** in creating a ARDISTRIB record.
           MOVE AMD-GL-COMPANY         TO ZR190WS-AMD-GL-COMPANY.
           MOVE AMD-GL-DATE            TO ZR190WS-AMD-GL-DATE.
           MOVE AMD-COMPANY            TO ZR190WS-AMD-COMPANY.
           MOVE AMD-BATCH-NBR          TO ZR190WS-AMD-BATCH-NBR.
           MOVE AMD-CUSTOMER           TO ZR190WS-AMD-CUSTOMER.
           MOVE AMD-PROCESS-LEVEL      TO ZR190WS-AMD-PROCESS-LEVEL.
           MOVE AMD-TRANS-TYPE         TO ZR190WS-AMD-TRANS-TYPE.
           MOVE AMD-INVOICE            TO ZR190WS-AMD-INVOICE.          
           MOVE AMD-TRANS-DATE         TO ZR190WS-AMD-TRAN-DATE.
           MOVE AMD-DST-TYPE           TO ZR190WS-AMD-DST-TYPE.
           MOVE AMD-PAYMENT-SEQ        TO ZR190WS-AMD-PAYMENT-SEQ.
           MOVE AMD-ACCUM-TYPE         TO ZR190WS-AMD-ACCUM-TYPE.

           MOVE ZR190WS-TAX-RECOVERY-AMOUNT TO ZR190WS-AMD-TRAN-AMT.    

           MOVE AMD-TO-COMP-AMT        TO ZR190WS-AMD-TO-COMP-AMT.
           MOVE AMD-UNITS              TO ZR190WS-AMD-UNITS.
           MOVE AMD-DESC               TO ZR190WS-AMD-DESC.
           MOVE AMD-ACTIVITY           TO ZR190WS-AMD-ACTIVITY.
           MOVE AMD-ACCT-CATEGORY      TO ZR190WS-AMD-ACCT-CATEGORY.
           MOVE AMD-ORIG-CURRENCY      TO ZR190WS-AMD-ORIG-CURRENCY.
           MOVE AMD-ORIG-RATE          TO ZR190WS-AMD-ORIG-RATE.
           MOVE AMD-ORIG-AMT           TO ZR190WS-AMD-ORIG-AMT.

           COMPUTE ZR190WS-HOLD-TAXABLE-AMT ROUNDED
                                       = AMD-TRAN-TAXABLE
                                       * ZR190WS-DISCOUNT-PERCENT.

           MOVE AMD-AR-CATEGORY        TO ZR190WS-AMD-AR-CATEGORY.
           MOVE AMD-TAX-CODE           TO ZR190WS-AMD-TAX-CODE.

           MOVE AMD-ORIG-TAXABLE       TO ZR190WS-AMD-ORIG-TAXABLE.
           MOVE AMD-TRAN-TAXABLE       TO ZR190WS-AMD-TRAN-TAXABLE.

           MOVE AMD-UPDATE-SUM         TO ZR190WS-AMD-UPDATE-SUM.
           MOVE AMD-ORIG-ND            TO ZR190WS-AMD-ORIG-ND.
           MOVE AMD-AUTO-REV           TO ZR190WS-AMD-AUTO-REV.
           MOVE AMD-ORIG-COMPANY       TO ZR190WS-AMD-ORIG-COMPANY.
           MOVE AMD-DOCUMENT-NBR       TO ZR190WS-AMD-DOCUMENT-NBR.
           MOVE AMD-DST-SOURCE         TO ZR190WS-AMD-DST-SOURCE.
           MOVE AMD-BASE-ACCTUNIT      TO ZR190WS-AMD-BASE-ACCTUNIT.
           MOVE AMD-JRNL-BOOK-NBR      TO ZR190WS-AMD-JRNL-BOOK-NBR.
                        
           MOVE AMD-JBK-SEQ-NBR        TO ZR190WS-AMD-JBK-SEQ-NBR.
           MOVE AMD-MX-VALUE (1)       TO ZR190WS-AMD-MX-VALUE (1).
           MOVE AMD-MX-VALUE (2)       TO ZR190WS-AMD-MX-VALUE (2).
           MOVE AMD-MX-VALUE (3)       TO ZR190WS-AMD-MX-VALUE (3).
           MOVE AMD-DRAFT-SOURCE       TO ZR190WS-AMD-DRAFT-SOURCE.

      **** Increment the ZR190WS-PROG-SEQ-NBR by one.
           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.

           MOVE ZR190WS-AMD-GL-COMPANY         TO AMD-GL-COMPANY.

           MOVE TXCAL-T-OUT-ACCT-UNIT (1)      TO AMD-ACCT-UNIT.
           MOVE TXCAL-T-OUT-ACCOUNT   (1)      TO AMD-ACCOUNT.
           MOVE TXCAL-T-OUT-SUB-ACCT  (1)      TO AMD-SUB-ACCT.

           MOVE ZR190WS-AMD-GL-DATE            TO AMD-GL-DATE.

           MOVE WS-SYSTEM-DATE-YMD             TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME               TO AMD-CREATE-TIME.

           MOVE ZR190WS-AMD-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-AMD-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE ZR190WS-AMD-CUSTOMER           TO AMD-CUSTOMER.
           MOVE ZR190WS-AMD-PROCESS-LEVEL      TO AMD-PROCESS-LEVEL.
           MOVE ZR190WS-AMD-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ZR190WS-AMD-INVOICE            TO AMD-INVOICE.          
           MOVE ZR190WS-AMD-TRAN-DATE          TO AMD-TRANS-DATE.
           MOVE ZR190WS-AMD-DST-TYPE           TO AMD-DST-TYPE.
           MOVE ZR190WS-AMD-PAYMENT-SEQ        TO AMD-PAYMENT-SEQ.
           MOVE ZR190WS-AMD-ACCUM-TYPE         TO AMD-ACCUM-TYPE.
           MOVE ZR190WS-AMD-UNITS              TO AMD-UNITS.
           MOVE ZR190WS-AMD-DESC               TO AMD-DESC.
           MOVE ZR190WS-AMD-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ZR190WS-AMD-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE 2                              TO AMD-STATUS.
           MOVE ZR190WS-AMD-ORIG-CURRENCY      TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-AMD-ORIG-RATE          TO AMD-ORIG-RATE.
           MOVE ZR190WS-AMD-AR-CATEGORY        TO AMD-AR-CATEGORY.
           MOVE ZR190WS-AMD-TAX-CODE           TO AMD-TAX-CODE.

           MOVE ZR190WS-AMD-ORIG-TAXABLE       TO AMD-ORIG-TAXABLE.
           MOVE ZR190WS-AMD-TRAN-TAXABLE       TO AMD-TRAN-TAXABLE.

           MOVE ZR190WS-AMD-UPDATE-SUM         TO AMD-UPDATE-SUM.
           MOVE ZR190WS-AMD-ORIG-ND            TO AMD-ORIG-ND.
           MOVE ZR190WS-AMD-AUTO-REV           TO AMD-AUTO-REV.
           MOVE ZR190WS-AMD-ORIG-COMPANY       TO AMD-ORIG-COMPANY.
           MOVE ZR190WS-AMD-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-AMD-DST-SOURCE         TO AMD-DST-SOURCE.
           MOVE ZR190WS-AMD-BASE-ACCTUNIT      TO AMD-BASE-ACCTUNIT.
           MOVE ZR190WS-AMD-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
                        
           MOVE ZR190WS-AMD-JBK-SEQ-NBR        TO AMD-JBK-SEQ-NBR.
           MOVE ZR190WS-AMD-MX-VALUE (1)       TO AMD-MX-VALUE (1).
           MOVE ZR190WS-AMD-MX-VALUE (2)       TO AMD-MX-VALUE (2).
           MOVE ZR190WS-AMD-MX-VALUE (3)       TO AMD-MX-VALUE (3).
           MOVE ZR190WS-AMD-DRAFT-SOURCE       TO AMD-DRAFT-SOURCE.

           MOVE ZR190WS-ORIG-REVERSE-AMT       TO AMD-ORIG-AMT.
           MOVE ZR190WS-TRAN-REVERSE-AMT       TO AMD-TRAN-AMT.
           IF (ARA-APP-SOURCE          NOT = "R")
               COMPUTE AMD-ORIG-AMT = (AMD-ORIG-AMT * NEGATIVE-ONE)
               COMPUTE AMD-TRAN-AMT = (AMD-TRAN-AMT * NEGATIVE-ONE).

      **** When posting to another company, calculate the amount
      **** to be posted to that company in its base currency.  This
      **** logic was taken from AR42 and modified for this program.
           IF (AMD-GL-COMPANY NOT = ZEROES)
           AND (AMD-GL-COMPANY NOT = AMD-COMPANY)

      *        **** Get the GL company record
               MOVE AMD-GL-COMPANY TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1

               IF (ACO-CURRENCY-CD NOT = AMD-ORIG-CURRENCY)
                   MOVE AMD-GL-COMPANY         TO IFCRWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY      TO IFCRWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD        TO IFCRWS-TO-CURR-CODE
                   PERFORM 655-EDIT-CURRENCY-RELATION-60

                   MOVE AMD-GL-COMPANY         TO IFGRWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY TO IFGRWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD        TO IFGRWS-TO-CURR-CODE
                   MOVE "AR"                   TO IFGRWS-SYSTEM
                   MOVE AMD-GL-DATE            TO IFGRWS-EFFECT-DATE
                   PERFORM 660-GET-CURRENCY-RATE-60

      *            **** The ar190ws-tax-recovery-amount below should
      *            **** reflect the orig-tax-recovery-amount
                   MOVE AMD-GL-COMPANY         TO IFCAWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY      TO IFCAWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD        TO IFCAWS-TO-CURR-CODE
                   MOVE "AR"                   TO IFCAWS-SYSTEM
                   MOVE AMD-GL-DATE            TO IFCAWS-EFFECT-DATE
                   MOVE ZR190WS-TAX-RECOVERY-AMOUNT TO
                        IFCAWS-TRAN-AMOUNT

                   INITIALIZE IFCAWS-BASE-AMOUNT
                   MOVE IFGRWS-SELL-RATE       TO IFCAWS-BASERATE
                   MOVE IFCRWS-MULT-DIV        TO IFCAWS-MULT-DIV
                   MOVE AMD-ORIG-ND            TO IFCAWS-TRAN-ND
                   MOVE ACO-BASE-ND            TO IFCAWS-BASE-ND
                   PERFORM 690-CALCULATE-AMOUNT-60
                   MOVE IFCAWS-BASE-AMOUNT     TO AMD-TO-COMP-AMT
               ELSE
                   MOVE ZR190WS-TAX-RECOVERY-AMOUNT TO AMD-TO-COMP-AMT.


           ADD 1                               TO ZR190WS-DIST-SEQ.
           MOVE ZR190WS-DIST-SEQ               TO AMD-DIST-SEQ.
           MOVE ZR190WS-PROG-SEQ-NBR           TO AMD-PROG-SEQ-NBR.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.
      *----------------------------------------------------------------

      **** Create the offsetting ARDISTRIB record.
           PERFORM 810-RECREATE-ARDISTRIB.
           MOVE ADJ-ACCT-UNIT TO AMD-ACCT-UNIT.
           MOVE ADJ-ACCOUNT TO AMD-ACCOUNT.
           MOVE ADJ-SUB-ACCT TO AMD-SUB-ACCT.
           COMPUTE AMD-ORIG-AMT = (AMD-ORIG-AMT * -1).
           COMPUTE AMD-TRAN-AMT = (AMD-TRAN-AMT * -1).
           COMPUTE AMD-TO-COMP-AMT = (AMD-TO-COMP-AMT * -1).
           ADD 1 TO ZR190WS-DIST-SEQ.
           MOVE ZR190WS-DIST-SEQ TO AMD-DIST-SEQ.
           PERFORM 820-STORE-ARDISTRIB.
      *----------------------------------------------------------------

      **** Update the Distribution Sequence Number on either the
      **** ARPAYMENT or AROIHDR file to reflect the total number of
      **** offset distributions (non AR cash payment).
           IF (AMD-TRANS-TYPE           = "P")
               MOVE ARA-BATCH-NBR       TO DB-BATCH-NBR
               MOVE ARA-PAYMENT-SEQ     TO DB-PAYMENT-SEQ
               PERFORM 840-MODIFY-APMSET1
               PERFORM 3000-SAVE-ARACPIVOT-APM
               MOVE ZR190WS-DIST-SEQ    TO APM-DIST-SEQ
               PERFORM 3000-UPDATE-ARACPIVOT-APM
               PERFORM 820-STORE-ARPAYMENT
           ELSE
               MOVE ARA-TRANS-TYPE      TO DB-TRANS-TYPE
               MOVE ARA-INVOICE         TO DB-INVOICE                   
               PERFORM 840-MODIFY-ARHSET1
               MOVE ZR190WS-DIST-SEQ    TO ARH-DIST-SEQ
               PERFORM 820-STORE-AROIHDR.

      **** Plug the appropriate working storage fields for the purpose
      **** of creating either a Lawson TXTAXTRAN record or a record
      **** pertaining to a 3rd party tax file.
           MOVE AMD-COMPANY                TO TXHST-COMPANY.
           MOVE AMD-TAX-CODE               TO TXHST-TAX-CODE.
           MOVE "AR"                       TO TXHST-SYSTEM-CD.
           MOVE AMD-CUSTOMER               TO TXHST-VEND-CUST.
           MOVE ACO-CUST-GROUP             TO DB-CUST-GROUP.
           MOVE AMD-CUSTOMER               TO DB-CUSTOMER.
           PERFORM 840-FIND-CUDSET1.
           IF (CUSTDESC-FOUND)
               MOVE CUD-TAX-ID             TO TXHST-TAX-ID-NBR
               MOVE CUD-CITY               TO TXHST-CITY
               MOVE CUD-STATE              TO TXHST-STATE
               MOVE CUD-ZIP                TO TXHST-ZIP
           ELSE
               MOVE SPACES                 TO TXHST-TAX-ID-NBR
                                              TXHST-CITY
                                              TXHST-STATE
                                              TXHST-ZIP.

           MOVE ACO-CITY                   TO TXHST-FROM-CITY.
           MOVE ACO-STATE                  TO TXHST-FROM-STATE.
           MOVE ACO-ZIP                    TO TXHST-FROM-ZIP.
           MOVE AMD-INVOICE                TO TXHST-INVOICE             
                                              TXHST-VOUCHER-NBR.

           MOVE TXCAL-T-OUT-ACCT-UNIT (1)  TO TXHST-TAX-ACCT-UNIT.
           MOVE TXCAL-T-OUT-ACCOUNT (1)    TO TXHST-TAX-ACCOUNT.
           MOVE TXCAL-T-OUT-SUB-ACCT (1)   TO TXHST-TAX-SUB-ACCT.
           MOVE TXCAL-T-TAX-RATE (1)       TO TXHST-TAX-RATE.

           MOVE CUD-NAME                   TO TXHST-NAME.
      *--- ADD VAT INFORMATION    
           MOVE AMD-COMPANY                TO DB-COMPANY.
           MOVE AMD-CUSTOMER               TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
           MOVE "O"                        TO TXHST-SOURCE.
           MOVE ACM-VAT-REG-NBR            TO TXHST-VAT-REG-NBR. 
           MOVE ACM-VAT-REG-CTRY           TO TXHST-VAT-REG-CTRY.
           IF (AMD-TRANS-TYPE              = "C")
               MOVE "C"                    TO TXHST-INV-CRD-IND
           ELSE
               MOVE "I"                    TO TXHST-INV-CRD-IND.

      *--- MOVE PAYMENT DATE 
           IF (TXCAL-T-TAX-POINT (1) = "P")
               MOVE ARA-DEPOSIT-DATE       TO TXHST-TAX-PNT-DATE
           ELSE
               MOVE AMD-GL-DATE            TO TXHST-TAX-PNT-DATE.
           MOVE ARH-TRANS-DATE             TO TXHST-INVOICE-DTE.
           MOVE AMD-GL-DATE                TO TXHST-POST-DATE.
           MOVE AMD-ORIG-CURRENCY          TO TXHST-TRAN-CURRENCY.
           MOVE AMD-ORIG-ND                TO TXHST-TRAN-ND.
           MOVE AMD-PROCESS-LEVEL          TO TXHST-PROC-LEVEL.
           INITIALIZE TXHST-ACCRUAL-FL.

           IF  (AMD-ORIG-AMT           > ZEROES)
               MOVE ZR190WS-ARH-ORIG-AMT       TO TXHST-TRAN-INV-AMT
               MOVE ZR190WS-HOLD-TAXABLE-AMT   TO TXHST-TRAN-TAXABLE
               IF (AMD-TRANS-TYPE = "C")
                   COMPUTE TXHST-TRAN-TAXABLE =
                                (TXHST-TRAN-TAXABLE * NEGATIVE-ONE)
               END-IF
           ELSE
                COMPUTE TXHST-TRAN-INV-AMT =
                   (ZR190WS-ARH-ORIG-AMT * NEGATIVE-ONE)
                COMPUTE TXHST-TRAN-TAXABLE =
                   (ZR190WS-HOLD-TAXABLE-AMT * NEGATIVE-ONE).

           COMPUTE AMD-ORIG-AMT = (AMD-ORIG-AMT * -1).
           MOVE AMD-ORIG-AMT                   TO TXHST-TRAN-TAX-AMT.

           COMPUTE TXHST-TRAN-INV-AMT = (TXHST-TRAN-INV-AMT * -1).

           MOVE "O"                            TO TXHST-TYPE.
           PERFORM 5000-CREATE-TAX-HISTORY-70.

           COMPUTE WS-TRAN-AMT =
               (WS-TRAN-AMT - ZR190WS-TAX-RECOVERY-AMOUNT).

       1730-READ-NEXT-ARDISTRIB.
           PERFORM 860-FIND-NEXT-AMDSET2.

       1730-END.

      ******************************************************************
       1800-SET-ARDISTRIB-4.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE WF5-CR-COMPANY          TO DB-COMPANY.
           MOVE WF5-PROCESS-LEVEL       TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-APVSET1.

           MOVE WF5-CR-COMPANY          TO DB-COMPANY.
           MOVE APV-AR-CODE             TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WF5-CR-COMPANY         TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT
                                          AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF5-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE WF5-COMPANY            TO AMD-COMPANY.
           MOVE WF5-CR-BATCH           TO AMD-BATCH-NBR.
           MOVE WF5-CR-CUSTOMER        TO AMD-CUSTOMER.
           MOVE WF5-PROCESS-LEVEL      TO AMD-PROCESS-LEVEL.
           MOVE WF5-CR-TYPE            TO AMD-TRANS-TYPE.
           MOVE WF5-CR-NBR             TO AMD-INVOICE.
           MOVE WF5-GL-DATE            TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           MOVE "RL"                   TO AMD-DST-TYPE.
           MOVE "S"                    TO AMD-ACCUM-TYPE.
           MOVE WF5-TRAN-AMT           TO AMD-TRAN-AMT.
           MOVE ZR190WS-MSG-6          TO ZR190WS-MSG2.
           MOVE WF5-CR-NBR             TO ZR190WS-NBR2.
           MOVE ZR190WS-MSG-NBR        TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE WF5-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF5-ORIG-CURRENCY      TO AMD-ORIG-CURRENCY.
           MOVE WF5-ORIG-RATE          TO AMD-ORIG-RATE.
           MOVE WF5-ORIG-ADJ-AMT       TO AMD-ORIG-AMT.
           IF (AMD-GL-COMPANY          = AMD-COMPANY)
               MOVE AMD-TRAN-AMT       TO AMD-TO-COMP-AMT
           ELSE
               MOVE AMD-GL-COMPANY     TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1
               IF (AMD-ORIG-CURRENCY   = ACO-CURRENCY-CD)
                   MOVE AMD-ORIG-AMT   TO AMD-TO-COMP-AMT
               ELSE
                   MOVE AMD-GL-COMPANY TO IFCRWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY TO IFCRWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD   TO IFCRWS-TO-CURR-CODE
                   PERFORM 655-EDIT-CURRENCY-RELATION-60
                   MOVE AMD-GL-COMPANY TO IFGRWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY TO IFGRWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD   TO IFGRWS-TO-CURR-CODE
                   MOVE "AR"              TO IFGRWS-SYSTEM
                   MOVE AMD-GL-DATE       TO IFGRWS-EFFECT-DATE
                   PERFORM 660-GET-CURRENCY-RATE-60
                   IF (IFCRWS-MULT-DIV    = "M")
                       COMPUTE AMD-TO-COMP-AMT ROUNDED 
                                          = AMD-ORIG-AMT
                                          * IFGRWS-SELL-RATE
                   ELSE
                       COMPUTE AMD-TO-COMP-AMT ROUNDED 
                                          = AMD-ORIG-AMT
                                          / IFGRWS-SELL-RATE.
           MOVE "02"                   TO AMD-UPDATE-SUM.
           MOVE WF5-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

           IF (AMD-GL-COMPANY          NOT = AMD-COMPANY)
               MOVE PRM-COMPANY        TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1.

       1800-END.
      ******************************************************************
       1900-SET-ARDISTRIB-5.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE WF1-COMPANY             TO DB-COMPANY.
           MOVE WF1-AR-CODE             TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT           TO ZR190WS-BASE-ACCTUNIT.

           MOVE WF1-CR-COMPANY          TO DB-COMPANY.
           MOVE WF1-OFFSET-CODE         TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           MOVE WF1-COMPANY            TO DB-COMPANY.
           MOVE WF1-BATCH-NBR          TO DB-BATCH-NBR.
           MOVE WF1-TRANS-TYPE         TO DB-TRANS-TYPE.
           MOVE WF1-INVOICE            TO DB-INVOICE.
           MOVE WF1-CUSTOMER           TO DB-CUSTOMER
                                          DBRNG-CUSTOMER.
           MOVE ZEROS                  TO DB-DIST-SEQ.
           MOVE AMDSET2-CUSTOMER       TO WS-DB-SUB-RNG.
           PERFORM 880-INIT-DBAG-AMDSET2.
           SET DBMAX-AMDSET2-DIST-SEQ  TO TRUE.
           PERFORM 880-FIND-DBAG-AMDSET2.
           IF (ARDISTRIB-FOUND)
               COMPUTE ZR190WS-DIST-SEQ = DBAG-AMDSET2-DIST-SEQ + 1
           ELSE
               MOVE 1                  TO ZR190WS-DIST-SEQ
           END-IF.
           
           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WF1-CR-COMPANY         TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF1-GL-DATE            TO AMD-GL-DATE.
           MOVE WF1-GL-DATE            TO AMD-TRANS-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE PRM-COMPANY            TO AMD-COMPANY.
           MOVE WF1-CUSTOMER           TO AMD-CUSTOMER.
           MOVE ZR190WS-DIST-SEQ       TO AMD-DIST-SEQ.
           MOVE WF1-APP-SOURCE         TO AMD-DST-TYPE.
           MOVE WF1-APPLD-AMT          TO AMD-TRAN-AMT.
           IF (WF1-CR-COMPANY          NOT = PRM-COMPANY)
               MOVE WF1-CR-APP-AMT     TO AMD-TO-COMP-AMT.
           MOVE 174                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-MSG1.
           MOVE WS-SYSTEM-DATE         TO ZR190WS-DT1.
           MOVE ZR190WS-MSG-DATE       TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE WF1-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF1-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           MOVE WF1-ORIG-APP-AMT       TO AMD-ORIG-AMT.
           MOVE WF1-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE WF1-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE WF1-INVOICE            TO AMD-INVOICE.
           MOVE SPACES                 TO ZR190WS-DOCUMENT-NBR.
           IF (ACO-DTL-APPL            = "N")
               MOVE "S"                TO AMD-ACCUM-TYPE
           ELSE
               MOVE "D"                TO AMD-ACCUM-TYPE.
           MOVE WF1-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-TO-COMP-AMT = AMD-TO-COMP-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           IF (ACO-DTL-APPL            = "N")
               GO TO 1900-CONT.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE WF1-CUSTOMER        TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE WF1-BATCH-NBR       TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE WF1-PROCESS-LEVEL   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE WF1-ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE WF1-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE WF1-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

       1900-CONT.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       1900-END.
      ******************************************************************
       2000-SET-ARDISTRIB-6.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE WF2-COMPANY             TO DB-COMPANY.
           MOVE WF2-AR-CODE             TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.

           MOVE WF2-COMPANY            TO DB-COMPANY.
           MOVE WF2-BATCH-NBR          TO DB-BATCH-NBR.
           MOVE WF2-TRANS-TYPE         TO DB-TRANS-TYPE.
           MOVE WF2-INVOICE            TO DB-INVOICE.
           MOVE WF2-CUSTOMER           TO DB-CUSTOMER.
           MOVE ZEROS                  TO DB-DIST-SEQ.
           MOVE AMDSET2-CUSTOMER       TO WS-DB-SUB-RNG.
           PERFORM 880-INIT-DBAG-AMDSET2.
           SET DBMAX-AMDSET2-DIST-SEQ  TO TRUE.
           PERFORM 880-FIND-DBAG-AMDSET2.
           IF (ARDISTRIB-FOUND)
               COMPUTE ZR190WS-DIST-SEQ = DBAG-AMDSET2-DIST-SEQ + 1
           ELSE
               MOVE 1                  TO ZR190WS-DIST-SEQ
           END-IF.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WF2-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT
                                          AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF2-GL-DATE            TO AMD-GL-DATE.
           MOVE WF2-GL-DATE            TO AMD-TRANS-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE WF2-COMPANY            TO AMD-COMPANY.
           MOVE WF2-CUSTOMER           TO AMD-CUSTOMER.
           MOVE WF2-PROCESS-LEVEL      TO AMD-PROCESS-LEVEL.
           MOVE ZR190WS-DIST-SEQ       TO AMD-DIST-SEQ.
           MOVE WF2-APP-SOURCE         TO AMD-DST-TYPE.
           COMPUTE AMD-TRAN-AMT ROUNDED = WF2-APPLD-AMT
                                        * NEGATIVE-ONE.
           MOVE 175                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-MSG1.
           MOVE WS-SYSTEM-DATE         TO ZR190WS-DT1.
           MOVE ZR190WS-MSG-DATE       TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE WF2-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF2-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           COMPUTE AMD-ORIG-AMT ROUNDED = WF2-ORIG-APP-AMT
                                        * NEGATIVE-ONE.
           MOVE "03"                   TO AMD-UPDATE-SUM.
           MOVE WF2-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE WF2-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE WF2-INVOICE            TO AMD-INVOICE.
           MOVE SPACES                 TO ZR190WS-DOCUMENT-NBR.
           IF (ACO-DTL-APPL            = "N")
               MOVE "S"                TO AMD-ACCUM-TYPE
           ELSE
               MOVE "D"                TO AMD-ACCUM-TYPE.
           MOVE WF2-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           IF (ACO-DTL-APPL            = "N")
               GO TO 2000-CONT.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE WF2-CUSTOMER       TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE WF2-BATCH-NBR      TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE WF2-PROCESS-LEVEL  TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE WF2-ARA-OPR-CODE   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE WF2-BANK-INST-CODE
                                              TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE WF2-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

       2000-CONT.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       2000-END.
      ******************************************************************
       2100-SET-ARDISTRIB-7.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE WF3-CR-COMPANY          TO DB-COMPANY.
           MOVE WF3-AR-CODE             TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT           TO ZR190WS-BASE-ACCTUNIT.

           MOVE WF3-CR-COMPANY          TO DB-COMPANY.
           MOVE WF3-OFFSET-CODE         TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WS-TRUE                TO WS-RESTART-APPL-FL.
           MOVE WF3-CR-COMPANY         TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF3-GL-DATE            TO AMD-GL-DATE.
           MOVE WF3-GL-DATE            TO AMD-TRANS-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE PRM-COMPANY            TO AMD-COMPANY.
           MOVE WF3-CUSTOMER           TO AMD-CUSTOMER.
           MOVE 1                      TO AMD-DIST-SEQ.
           MOVE WF3-APP-SOURCE         TO AMD-DST-TYPE.
           MOVE WF3-APPLD-AMT          TO AMD-TRAN-AMT.
           MOVE WF3-CR-APP-AMT         TO AMD-TO-COMP-AMT.
           MOVE 176                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-MSG1.
           MOVE WS-SYSTEM-DATE         TO ZR190WS-DT1.
           MOVE ZR190WS-MSG-DATE       TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE WF3-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF3-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           MOVE WF3-ORIG-APP-AMT       TO AMD-ORIG-AMT.
           MOVE WF3-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE WF3-INVOICE            TO AMD-INVOICE.
           MOVE SPACES                 TO ZR190WS-DOCUMENT-NBR.
           IF (ACO-DTL-APPL            = "N")
               MOVE "S"                TO AMD-ACCUM-TYPE
           ELSE
               MOVE "D"                TO AMD-ACCUM-TYPE.
           MOVE WF3-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           IF (ACO-DTL-APPL            = "N")
               GO TO 2100-CONT.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE WF3-CUSTOMER        TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE WF3-BATCH-NBR       TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE WF3-PROCESS-LEVEL   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE WF3-ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE WF3-BANK-INST-CODE
                                               TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE WF3-DEP-INST-CODE   TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

       2100-CONT.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       2100-END.
      ******************************************************************
       2200-SET-ARDISTRIB-8.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE WF4-COMPANY             TO DB-COMPANY.
           MOVE WF4-AR-CODE             TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WS-TRUE                TO WS-RESTART-APPL-FL.
           MOVE WF4-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT
                                          AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF4-GL-DATE            TO AMD-GL-DATE.
           MOVE WF4-GL-DATE            TO AMD-TRANS-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE WF4-COMPANY            TO AMD-COMPANY.
           MOVE WF4-CUSTOMER           TO AMD-CUSTOMER.
           MOVE 1                      TO AMD-DIST-SEQ.
           MOVE WF4-APP-SOURCE         TO AMD-DST-TYPE.
           COMPUTE AMD-TRAN-AMT ROUNDED = WF4-APPLD-AMT
                                        * NEGATIVE-ONE.
           MOVE 177                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-MSG1.
           MOVE WS-SYSTEM-DATE         TO ZR190WS-DT1.
           MOVE ZR190WS-MSG-DATE       TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE WF4-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF4-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           COMPUTE AMD-ORIG-AMT ROUNDED = WF4-ORIG-APP-AMT
                                        * NEGATIVE-ONE.
           MOVE "04"                   TO AMD-UPDATE-SUM.
           MOVE WF4-PROCESS-LEVEL      TO AMD-PROCESS-LEVEL.
           MOVE WF4-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE WF4-INVOICE            TO AMD-INVOICE.
           MOVE SPACES                 TO ZR190WS-DOCUMENT-NBR.
           IF (ACO-DTL-APPL            = "N")
               MOVE "S"                TO AMD-ACCUM-TYPE
           ELSE
               MOVE "D"                TO AMD-ACCUM-TYPE.
           MOVE WF4-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.

           IF (AMD-TRANS-TYPE          = "C" OR "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           IF (ACO-DTL-APPL            = "N")
               GO TO 2200-CONT.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE WF4-CUSTOMER         TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE WF4-BATCH-NBR        TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE WF4-PROCESS-LEVEL    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE WF4-ARA-OPR-CODE     TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE WF4-BANK-INST-CODE
                                                TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE WF4-DEP-INST-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

       2200-CONT.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       2200-END.
      ******************************************************************
       2300-SET-ARDISTRIB-9.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ARA-AR-CODE            TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT          TO ZR190WS-BASE-ACCTUNIT.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ADJ-COMPANY            TO AMD-GL-COMPANY.
           MOVE ADJ-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE ADJ-ACCOUNT            TO AMD-ACCOUNT.
           MOVE ADJ-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE ADJ-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-BATCH-NBR      TO AMD-BATCH-NBR.
           MOVE ZR190WS-CUSTOMER       TO AMD-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL  TO AMD-PROCESS-LEVEL.
           MOVE ADJ-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ADJ-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-TRANS-DATE     TO AMD-TRANS-DATE.
           MOVE 1                      TO AMD-DIST-SEQ.
           IF (ARA-APP-SOURCE          = "R")
               MOVE "RX"               TO AMD-DST-TYPE
           ELSE
               MOVE "RQ"               TO AMD-DST-TYPE.
           MOVE "D"                    TO AMD-ACCUM-TYPE.
           MOVE ADJ-ADJ-AMT            TO AMD-TRAN-AMT.
           MOVE ZEROES                 TO AMD-TO-COMP-AMT.

           MOVE "ARMSG"                TO CRT-ERROR-CAT.
           MOVE 212                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-CURR-GAIN-LOSS.
           MOVE "ARMSG"                TO CRT-ERROR-CAT.
           MOVE 213                    TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO ZR190WS-RVSL-GAIN-LOSS.

           IF (ADJ-DESC  = ZR190WS-CURR-GAIN-LOSS)
           OR (ADJ-DESC  = ZR190WS-RVSL-GAIN-LOSS)
               IF (ADJ-TRANS-TYPE = "C")
                   COMPUTE ZR190WS-PMT-GAIN-LOSS-AMT ROUNDED
                                        = ADJ-ADJ-AMT
                                        * NEGATIVE-ONE
               ELSE
                   MOVE ADJ-ADJ-AMT    TO ZR190WS-PMT-GAIN-LOSS-AMT
               END-IF                 
               MOVE WS-TRUE            TO ZR190WS-PMT-GAIN-LOSS-FL
           ELSE
               INITIALIZE        ZR190WS-PMT-GAIN-LOSS-AMT
               MOVE WS-FALSE               TO ZR190WS-PMT-GAIN-LOSS-FL.

           MOVE ADJ-DESC               TO AMD-DESC.
           MOVE ADJ-UNITS              TO AMD-UNITS.
           MOVE ADJ-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ADJ-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE 2                      TO AMD-STATUS.
           MOVE ACO-BASE-ND            TO AMD-ORIG-ND.
           MOVE ARA-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           MOVE ZEROS                  TO AMD-ORIG-RATE.
           MOVE ZEROS                  TO AMD-ORIG-AMT.
           MOVE "09"                   TO AMD-UPDATE-SUM.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
           MOVE "C"                    TO AMD-AUTO-REV.

           IF (AMD-TRANS-TYPE          = "P")
               COMPUTE AMD-ORIG-AMT    = AMD-ORIG-AMT
                                       * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT    = AMD-TRAN-AMT
                                       * NEGATIVE-ONE.

           PERFORM
               VARYING I2 FROM 1 BY 1 
               UNTIL  (I2                         > 3)
               OR     (IFSCATWS-FIELD-NAME (I2)   = SPACES)
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-CUSTOMER-TXT) 
                      MOVE ZR190WS-CUSTOMER    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) = ZR190WS-BATCH-TXT)  
                      MOVE ZR190WS-BATCH-NBR   TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-PROCESS-LVL-TXT)
                      MOVE ZR190WS-PROCESS-LEVEL TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-OPR-CODE-TXT)
                      MOVE ARA-OPR-CODE    TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-BANK-INST-TXT)
                      MOVE ZR190WS-BANK-INST-CODE
                                           TO AMD-MX-VALUE (I2)
                  END-IF
                  IF (IFSCATWS-FIELD-NAME (I2) 
                                           = ZR190WS-DEP-INST-TXT)
                      MOVE ACO-DEP-INST-CODE  TO AMD-MX-VALUE (I2)
                  END-IF
           END-PERFORM.

           PERFORM 665-EDIT-REMOTE-SITE.
           MOVE "AR"                   TO EDSYWS-SYSTEM.
           PERFORM 540-EDIT-SYSTEM-70.

           IF  ((EDSYWS-AC-COMMIT-FL    = "Y")
           OR   (EDSYWS-GL-COMMIT-FL    = "Y"))
           AND (AMD-ACTIVITY        NOT = SPACES)
               MOVE AMD-GL-COMPANY     TO IFUCWS-COMPANY 
               MOVE AMD-ACTIVITY       TO IFUCWS-ACTIVITY
               MOVE "AR"               TO IFUCWS-SYSTEM
               MOVE AMD-INVOICE        TO IFUCWS-INVOICE
               MOVE AMD-ORIG-CURRENCY  TO IFUCWS-CURRENCY-CODE
               MOVE AMD-ACCT-CATEGORY  TO IFUCWS-ACCT-CATEGORY
               MOVE AMD-ACCT-UNIT      TO IFUCWS-ACCT-UNIT
               MOVE AMD-ACCOUNT        TO IFUCWS-ACCOUNT
               MOVE AMD-SUB-ACCT       TO IFUCWS-SUB-ACCOUNT
               MOVE AMD-ORIG-AMT       TO IFUCWS-AMOUNT
               MOVE AMD-UNITS          TO IFUCWS-UNIT
               MOVE AMD-ORIG-ND        TO IFUCWS-TRAN-ND
               INITIALIZE                 IFUCWS-GLT-OBJ-ID
               INITIALIZE                 IFUCWS-ATN-OBJ-ID
               PERFORM 630-UPDATE-GLCOMMIT-80
               MOVE IFUCWS-GLT-OBJ-ID  TO AMD-GLT-OBJ-ID
               MOVE IFUCWS-ATN-OBJ-ID  TO AMD-ATN-OBJ-ID.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

       2300-END.
      ******************************************************************
       2400-CREATE-AROITEM.
      ******************************************************************

           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ZR190WS-CUSTOMER       TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
           PERFORM 800-CREATE-AROITEMS.
           PERFORM 3000-INIT-ARACPIVOT-ARO.
           MOVE ADJ-COMPANY            TO ARO-COMPANY
                                          DB-COMPANY.
           IF (ADJ-ORIG-ADJ-AMT < ZERO)
               MOVE "C"                TO ARO-TRANS-TYPE
                                          ARO-ALT-TYPE
           ELSE
               MOVE "D"                TO ARO-TRANS-TYPE
                                          ARO-ALT-TYPE.
           PERFORM 840-MODIFY-ACOSET1.

           IF (ARO-TRANS-TYPE = "C")
               ADD 1                   TO ACO-CREDIT-CB-NBR
               MOVE ACO-CREDIT-CB-NBR  TO ZR190WS-CREDIT-NBR
               MOVE ACO-CREDIT-CB-PRFX TO ZR190WS-CREDIT-PRFX
               MOVE ZR190WS-CREDIT-CB  TO ARO-INVOICE
           ELSE
               ADD 1                   TO ACO-CHRG-BACK-NBR
               MOVE ACO-CHRG-BACK-NBR  TO ZR190WS-NBR
               MOVE "CB-"              TO ZR190WS-PREFIX
               MOVE ZR190WS-CB-NBR     TO ARO-INVOICE
               IF (ACO-SUMM-BTCH-NBR = 999999)
                   ADD 2               TO ACO-SUMM-BTCH-NBR
               ELSE
                   ADD 1               TO ACO-SUMM-BTCH-NBR.

           MOVE 1                      TO ARO-PAYMENT-SEQ.
           MOVE ZR190WS-CUSTOMER       TO ARO-CUSTOMER.
           MOVE 1                      TO ARO-STATUS.
           MOVE ZR190WS-TRANS-DATE     TO ARO-TRANS-DATE.
           MOVE ZR190WS-DUE-DATE       TO ARO-DUE-DATE.
           MOVE ZR190WS-ACTIVITY       TO ARO-ACTIVITY.
           MOVE ZR190WS-ACCT-CATEGORY  TO ARO-ACCT-CATEGORY.
           MOVE ZR190WS-ACTIVITY-GRP   TO ARO-ACTIVITY-GRP.
           MOVE ZR190WS-CONTRACT       TO ARO-CONTRACT.

           IF (ARO-TRANS-TYPE = "C")
               COMPUTE ARO-ORIG-AMT     = ADJ-ORIG-ADJ-AMT
                                        * -1
           ELSE
               MOVE ADJ-ORIG-ADJ-AMT   TO ARO-ORIG-AMT.

           MOVE ZR190WS-PROCESS-LEVEL  TO ARO-PROCESS-LEVEL.
           MOVE ZR190WS-CUST-PO-NBR    TO ARO-CUST-PO-NBR.
           MOVE ZR190WS-TRANS-USER1    TO ARO-TRANS-USER1.
           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ZR190WS-CUSTOMER       TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
           MOVE ACM-BANK-INST-CODE     TO CBEBWS-BANK-INST-CODE.
           PERFORM 550-EDIT-BANK-INST-CODE-70.
           MOVE ACM-BANK-INST-CODE     TO ARO-BANK-INST-CODE.
           MOVE CBEBWS-BANK-INST-TYPE  TO ARO-BANK-INST-TYPE.
           MOVE ZR190WS-SORT-1         TO ARO-SORT-1.
           MOVE ZR190WS-SORT-2         TO ARO-SORT-2.
           MOVE ZR190WS-SORT-3         TO ARO-SORT-3.
           MOVE ZR190WS-SORT-4         TO ARO-SORT-4.

           MOVE ARO-COMPANY            TO IFCAWS-COMPANY.
           MOVE ZR190WS-ORIG-CURRENCY  TO IFCAWS-FR-CURR-CODE.
           MOVE ACO-CURRENCY-CD        TO IFCAWS-TO-CURR-CODE.
           MOVE "AR"                   TO IFCAWS-SYSTEM.
           MOVE ZR190WS-TRANS-DATE     TO IFCAWS-EFFECT-DATE.

           MOVE ARO-ORIG-AMT           TO IFCAWS-TRAN-AMOUNT.
           INITIALIZE IFCAWS-BASE-AMOUNT.
           MOVE ZR190WS-ORIG-RATE      TO IFCAWS-BASERATE.
           MOVE ZR190WS-CURR-MUDV      TO IFCAWS-MULT-DIV.
           MOVE ZR190WS-ORIG-ND        TO IFCAWS-TRAN-ND.
           MOVE ACO-BASE-ND            TO IFCAWS-BASE-ND.
           PERFORM 690-CALCULATE-AMOUNT-60.
           MOVE IFCAWS-BASE-AMOUNT     TO ARO-TRAN-AMT
                                          ARO-SORT-AMOUNT.

           IF (ACM-CB-DTL-DATE = "I")
               MOVE ZR190WS-TRANS-DATE TO ARO-TRANS-DATE
               MOVE ZR190WS-DUE-DATE   TO ARO-DUE-DATE
           ELSE
               MOVE ARA-CR-COMPANY     TO DB-COMPANY
               MOVE ARA-CR-BATCH       TO DB-BATCH-NBR
               PERFORM 840-FIND-APHSET1
               MOVE APH-DEPOSIT-DATE   TO ARO-TRANS-DATE
               INITIALIZE TETEWS-OVR-DISC-DATE
                          TETEWS-OVR-DUE-DATE
                          TETEWS-OVR-DISC-RATE
                          TETEWS-OVR-DISC-AMT
                          TETEWS-ND
                          TETEWS-ALLOWED-AMT
               MOVE ACM-MEMO-TERM      TO TETEWS-TERMS-CD
               MOVE APH-DEPOSIT-DATE   TO TETEWS-TRANS-DATE
               MOVE ADJ-ORIG-ADJ-AMT   TO TETEWS-TRANS-AMT
               MOVE ZR190WS-ORIG-ND    TO TETEWS-ND
               MOVE ZR190WS-ORIG-RATE  TO TETEWS-ORIG-RATE
               MOVE ZR190WS-CURR-MUDV  TO TETEWS-CURR-MUDV
               MOVE ACO-BASE-ND        TO TETEWS-BASE-ND
               PERFORM 700-EDIT-TERMS-60
               IF (ERROR-FOUND)
                   MOVE ZR190WS-DUE-DATE    TO ARO-DUE-DATE
               ELSE
                   MOVE TETEWS-DUE-DATE (1) TO ARO-DUE-DATE.

           PERFORM 800-CREATE-AROIHDR.
           MOVE ADJ-COMPANY            TO ARH-COMPANY.
           MOVE ARO-TRANS-TYPE         TO ARH-TRANS-TYPE
                                          ARH-ALT-TYPE.
           MOVE ARO-INVOICE            TO ARH-INVOICE.
           MOVE 1                      TO ARH-STATUS.
           MOVE ZR190WS-CUSTOMER       TO ARH-CUSTOMER.
           MOVE ZR190WS-BATCH-NBR      TO ARH-BATCH-NBR.
           MOVE ZR190WS-PROCESS-LEVEL  TO ARH-PROCESS-LEVEL.
           MOVE ARO-TRANS-DATE         TO ARH-TRANS-DATE.
           MOVE ARA-GL-DATE            TO ARH-GL-DATE.
           MOVE ZR190WS-ORIG-CURRENCY  TO ARH-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-ND        TO ARH-ORIG-ND.
           MOVE PRM-JRNL-BOOK-NBR      TO ARH-JRNL-BOOK-NBR.
           MOVE ARO-ORIG-AMT           TO ARH-ORIG-AMT.
           MOVE ARO-TRAN-AMT           TO ARH-TRAN-AMT.
           MOVE ADJ-REASON-CODE        TO ARH-CB-REASON.
           MOVE ADJ-APP-SEQ            TO ARH-CB-SEQ-NBR.
           MOVE ZR190WS-CUST-PO-NBR    TO ARH-CUST-PO-NBR.
           MOVE ADJ-TRANS-TYPE         TO ARH-XREF-TYPE.
           MOVE ADJ-INVOICE            TO ARH-XREF-NBR.
           MOVE ADJ-PAYMENT-SEQ        TO ARH-XREF-PYMT-SEQ.
           MOVE "N"                    TO ARH-SUM-LINE.
           IF (ADJ-DESC                NOT = SPACES)
               MOVE ADJ-DESC           TO ARH-DESC
           ELSE
               MOVE SPACES             TO ZR190WS-ARO-XTYPE
               MOVE SPACES             TO ZR190WS-ARO-XNBR
               MOVE ZR190WS-XREF-TYPE  TO ZR190WS-ARO-XTYPE
               MOVE ZR190WS-XREF-NBR   TO ZR190WS-ARO-XNBR
               MOVE ZR190WS-ARO-DESC   TO ARH-DESC.
           MOVE ZR190WS-TRANS-USER1    TO ARH-TRANS-USER1.
           MOVE ZR190WS-TRANS-USER2    TO ARH-TRANS-USER2.
           MOVE ZR190WS-TRANS-USER3    TO ARH-TRANS-USER3.
           MOVE ZR190WS-TRANS-USER4    TO ARH-TRANS-USER4.
           MOVE ZR190WS-TRANS-USER5    TO ARH-TRANS-USER5.
           MOVE ARA-AR-CODE            TO ARH-AR-CODE.
           MOVE ZR190WS-SALESMAN       TO ARH-SALESMAN.
           MOVE ZR190WS-ORIG-RATE      TO ARH-ORIG-RATE.
           MOVE ZR190WS-CURR-MUDV      TO ARH-CURR-MUDV.
           MOVE ZR190WS-GROUP-RATE     TO ARH-GROUP-RATE.
           MOVE ZR190WS-GROUP-MUDV     TO ARH-GROUP-MUDV.
           MOVE ARO-TRAN-AMT           TO ARH-BASE-DETAIL.
           MOVE 1                      TO ARH-PAYMENT-SEQ.
           MOVE "E"                    TO ARH-ORIG-CODE.
           MOVE ACM-TERMS-CD           TO ARH-TERMS-CD.
           MOVE 1                      TO ARH-DIST-SEQ.
           MOVE "E"                    TO ARH-ORIG-CODE.
           IF (ZR190WS-ORIG-CURRENCY   = ACO-CURRENCY-CD)
               MOVE "N"                TO ARH-REVALUE-FL
           ELSE
               MOVE "Y"                TO ARH-REVALUE-FL.
           MOVE ADJ-COMPANY            TO DB-COMPANY.
           MOVE ZR190WS-CUSTOMER       TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
           MOVE ACM-BANK-INST-CODE     TO CBEBWS-BANK-INST-CODE.
           PERFORM 550-EDIT-BANK-INST-CODE-70.
           MOVE ACM-BANK-INST-CODE     TO ARH-BANK-INST-CODE.
           MOVE CBEBWS-BANK-INST-TYPE  TO ARH-BANK-INST-TYPE.
174212     MOVE "AR"                   TO ARH-SYSTEM.

      ** New ARO fields for 8.1 - values defaulted from ARH
           MOVE ARH-GL-DATE            TO ARO-GL-DATE.
           MOVE ARH-ORIG-ND            TO ARO-ORIG-ND.
           MOVE ARH-BATCH-NBR          TO ARO-BATCH-NBR.
           MOVE ARH-XREF-NBR           TO ARO-XREF-NBR.
           MOVE ARH-SALESMAN           TO ARO-SALESMAN.
           MOVE ARH-ORIG-RATE          TO ARO-ORIG-RATE.
           MOVE ARH-SUM-LINE           TO ARO-SUM-LINE.
           MOVE ARH-GROUP-RATE         TO ARO-GROUP-RATE.
           MOVE ARH-ORIG-CODE          TO ARO-ORIG-CODE.
           MOVE ARH-AR-CODE            TO ARO-AR-CODE.
           MOVE ARH-ORIG-CURRENCY      TO ARO-ORIG-CURRENCY.
           MOVE ARH-XREF-COMPANY       TO ARO-XREF-COMPANY.
           MOVE ARH-GROUP-MUDV         TO ARO-GROUP-MUDV.
           MOVE ARH-CURR-MUDV          TO ARO-CURR-MUDV.
           MOVE ARH-CANCEL-FLAG        TO ARO-CANCEL-FLAG.
           MOVE ARH-REVALUE-FL         TO ARO-REVALUE-FL.
           MOVE ARH-XREF-TYPE          TO ARO-XREF-TYPE.
           MOVE ARH-DESC               TO ARO-DESC.
           MOVE ARH-TERMS-CD           TO ARO-TERMS-CD.
           MOVE ARH-AC-CUSTOMER-ID     TO ARO-AC-CUSTOMER-ID.

           MOVE ARH-LATE-CH-FL         TO ARO-LATE-CH-FL.
           MOVE ARH-LST-DUNLTR-STM     TO ARO-LST-DUNLTR-STM.
           MOVE ARH-LAST-LTR-DATE      TO ARO-LAST-LTR-DATE.
           MOVE ARH-LST-LTRTEXT-CD     TO ARO-LST-LTRTEXT-CD.
           MOVE ARH-SENT-FOR-COLL      TO ARO-SENT-FOR-COLL.
           MOVE ARH-DUN-LTR-IND        TO ARO-DUN-LTR-IND.
           MOVE ARH-ASSESS-DUN-FEE     TO ARO-ASSESS-DUN-FEE.

           IF (ARR-CB-DISPUTE-CD       NOT = SPACES)
               PERFORM 2950-CREATE-CB-DISPUTE
               THRU    2950-END.

           PERFORM 3000-UPDATE-ARACPIVOT-ARO.
           PERFORM 820-STORE-AROITEMS.

           PERFORM 820-STORE-AROIHDR.

           MOVE "N"                    TO ARPVT-AROIHDR.
           MOVE ARH-CUST-PO-NBR        TO ARPVT-CUST-PO-NBR.
           MOVE ARH-PROCESS-LEVEL      TO ARPVT-PROCESS-LEVEL.
           MOVE ARH-TRANS-USER1        TO ARPVT-TRANS-USER1.
           MOVE ARH-XREF-TYPE          TO ARPVT-XREF-TYPE.
           MOVE ARH-XREF-NBR           TO ARPVT-XREF-NBR.
           MOVE ARH-ORIG-CURRENCY      TO ARPVT-ORIG-CURRENCY.
           MOVE ARH-ORIG-ND            TO ARPVT-ORIG-ND.
           MOVE ARH-ORIG-RATE          TO ARPVT-ORIG-RATE.
           MOVE ARH-CURR-MUDV          TO ARPVT-CURR-MUDV.
           MOVE ARH-SUM-LINE           TO ARPVT-SUM-LINE.
           MOVE "A"                    TO ARPVT-FC.
           PERFORM 2000-ARPVT-PROCESS-TRAN.
           INITIALIZE CRT-ERROR-NBR
                      CRT-ERROR-CAT.

           PERFORM 820-STORE-ARCOMP.

       2400-END.
      ******************************************************************
       2500-CREATE-AROITEM.
      ******************************************************************

           PERFORM 800-CREATE-AROIHDR.
           MOVE WF5-CR-COMPANY         TO ARH-COMPANY.

           IF (WF5-ORIG-ADJ-AMT < ZERO)
               MOVE "C"                TO ARH-TRANS-TYPE
                                          ARH-ALT-TYPE
           ELSE
               MOVE "D"                TO ARH-TRANS-TYPE
                                          ARH-ALT-TYPE.

           MOVE WF5-CR-COMPANY         TO DB-COMPANY.
           PERFORM 840-MODIFY-ACOSET1.

           IF (ARH-TRANS-TYPE = "C")
               ADD 1                   TO ACO-CREDIT-CB-NBR
               MOVE ACO-CREDIT-CB-NBR  TO ZR190WS-CREDIT-NBR
               MOVE ACO-CREDIT-CB-PRFX TO ZR190WS-CREDIT-PRFX
               MOVE ZR190WS-CREDIT-CB  TO ARH-INVOICE
           ELSE
               ADD 1                   TO ACO-CHRG-BACK-NBR
               MOVE ACO-CHRG-BACK-NBR  TO ZR190WS-NBR
               MOVE "CB-"              TO ZR190WS-PREFIX
               MOVE ZR190WS-CB-NBR     TO ARH-INVOICE
               IF (ACO-SUMM-BTCH-NBR = 999999)
                   ADD 2               TO ACO-SUMM-BTCH-NBR
               ELSE
                   ADD 1               TO ACO-SUMM-BTCH-NBR.

           MOVE 1                      TO ARH-PAYMENT-SEQ.
           MOVE WF5-CR-CUSTOMER        TO ARH-CUSTOMER.
           MOVE 1                      TO ARH-STATUS.
           MOVE WF5-CR-BATCH           TO ARH-BATCH-NBR.
           MOVE WF5-PROCESS-LEVEL      TO ARH-PROCESS-LEVEL.
           MOVE WF5-GL-DATE            TO ARH-TRANS-DATE.
           MOVE WF5-GL-DATE            TO ARH-GL-DATE.
           IF (ARH-TRANS-TYPE = "C")
               COMPUTE ARH-ORIG-AMT     = WF5-ORIG-ADJ-AMT
                                        * -1
           ELSE
               MOVE WF5-ORIG-ADJ-AMT   TO ARH-ORIG-AMT.

           IF (WF5-CURR-MUDV           = "M")
               COMPUTE ARH-TRAN-AMT ROUNDED = ARH-ORIG-AMT    
                                            * WF5-ORIG-RATE
           ELSE
               COMPUTE ARH-TRAN-AMT ROUNDED = ARH-ORIG-AMT
                                            / WF5-ORIG-RATE.
           MOVE 1                      TO ARH-DIST-SEQ.
           MOVE WF5-CR-TYPE            TO ARH-XREF-TYPE.
           MOVE WF5-CR-NBR             TO ARH-XREF-NBR.
           MOVE "E"                    TO ARH-ORIG-CODE.
           MOVE ZR190WS-MSG-7          TO ZR190WS-MSG3.
           MOVE WF5-CR-NBR             TO ZR190WS-NBR3.
           MOVE WF5-CR-TYPE            TO ZR190WS-TYPE3.
           MOVE WF5-CR-COMPANY         TO ZR190WS-COMP3.
           MOVE ZR190WS-MSG-COMP       TO ARH-DESC.
           MOVE APV-AR-CODE            TO ARH-AR-CODE.
           MOVE WF5-CR-COMPANY         TO DB-COMPANY.
           MOVE WF5-CR-CUSTOMER        TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
           MOVE ACM-SALESMAN           TO ARH-SALESMAN.
           MOVE ACM-TERMS-CD           TO ARH-TERMS-CD.
           MOVE WF5-ORIG-CURRENCY      TO ARH-ORIG-CURRENCY.
           MOVE PRM-COMPANY            TO ARH-CB-ORIG-COMP.
           MOVE WF5-ORIG-RATE          TO ARH-ORIG-RATE.
           MOVE WF5-CURR-MUDV          TO ARH-CURR-MUDV.
           MOVE WF5-GROUP-RATE         TO ARH-GROUP-RATE.
           MOVE WF5-GROUP-MUDV         TO ARH-GROUP-MUDV.
           MOVE ARH-TRAN-AMT           TO ARH-BASE-DETAIL.
           MOVE WF5-ORIG-ND            TO ARH-ORIG-ND.
           MOVE "N"                    TO ARH-SUM-LINE.
           IF (WF5-ORIG-CURRENCY       = ACO-CURRENCY-CD)
               MOVE "N"                TO ARH-REVALUE-FL
           ELSE
               MOVE "Y"                TO ARH-REVALUE-FL.
           MOVE ACM-BANK-INST-CODE     TO CBEBWS-BANK-INST-CODE.
           PERFORM 550-EDIT-BANK-INST-CODE-70.
           MOVE ACM-BANK-INST-CODE     TO ARH-BANK-INST-CODE.
           MOVE CBEBWS-BANK-INST-TYPE  TO ARH-BANK-INST-TYPE.
           MOVE PRM-JRNL-BOOK-NBR      TO ARH-JRNL-BOOK-NBR.
174212     MOVE "AR"                   TO ARH-SYSTEM.
           PERFORM 820-STORE-AROIHDR.

           PERFORM 800-CREATE-AROITEMS.
           PERFORM 3000-INIT-ARACPIVOT-ARO.
           MOVE WF5-CR-COMPANY         TO ARO-COMPANY.
           MOVE ARH-TRANS-TYPE         TO ARO-TRANS-TYPE
                                          ARO-ALT-TYPE.
           MOVE ARH-INVOICE            TO ARO-INVOICE.
           MOVE 1                      TO ARO-PAYMENT-SEQ.
           MOVE WF5-CR-CUSTOMER        TO ARO-CUSTOMER.
           MOVE 1                      TO ARO-STATUS.
           MOVE WF5-GL-DATE            TO ARO-TRANS-DATE.
           MOVE ARH-ORIG-AMT           TO ARO-ORIG-AMT.
           IF (WF5-CURR-MUDV           = "M")
               COMPUTE ARO-TRAN-AMT ROUNDED = ARO-ORIG-AMT        
                                            * WF5-ORIG-RATE
           ELSE
               COMPUTE ARO-TRAN-AMT ROUNDED = ARO-ORIG-AMT       
                                            / WF5-ORIG-RATE.
           MOVE ARO-TRAN-AMT           TO ARO-SORT-AMOUNT.
           MOVE WF5-GL-DATE            TO ARO-DUE-DATE.
           IF (WF5-ACTIVITY-FL         NOT = "N")
               MOVE WF5-ACTIVITY       TO ARO-ACTIVITY
               MOVE WF5-ACCT-CATEGORY  TO ARO-ACCT-CATEGORY
               MOVE WF5-ACTIVITY-GRP   TO ARO-ACTIVITY-GRP
               MOVE WF5-CONTRACT       TO ARO-CONTRACT.
           MOVE WF5-SORT-1             TO ARO-SORT-1.
           MOVE WF5-SORT-2             TO ARO-SORT-2.
           MOVE WF5-SORT-3             TO ARO-SORT-3.
           MOVE WF5-SORT-4             TO ARO-SORT-4.
           MOVE WF5-PROCESS-LEVEL      TO ARO-PROCESS-LEVEL.
           MOVE WF5-CR-COMPANY         TO DB-COMPANY.
           MOVE WF5-CR-CUSTOMER        TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
           MOVE ACM-BANK-INST-CODE     TO CBEBWS-BANK-INST-CODE.
           PERFORM 550-EDIT-BANK-INST-CODE-70.
           MOVE ACM-BANK-INST-CODE     TO ARO-BANK-INST-CODE.
           MOVE CBEBWS-BANK-INST-TYPE  TO ARO-BANK-INST-TYPE.

      ** New ARO fields for 8.1 - values defaulted from ARH
           MOVE ARH-GL-DATE            TO ARO-GL-DATE.
           MOVE ARH-ORIG-ND            TO ARO-ORIG-ND.
           MOVE ARH-BATCH-NBR          TO ARO-BATCH-NBR.
           MOVE ARH-XREF-NBR           TO ARO-XREF-NBR.
           MOVE ARH-SALESMAN           TO ARO-SALESMAN.
           MOVE ARH-ORIG-RATE          TO ARO-ORIG-RATE.
           MOVE ARH-SUM-LINE           TO ARO-SUM-LINE.
           MOVE ARH-GROUP-RATE         TO ARO-GROUP-RATE.
           MOVE ARH-ORIG-CODE          TO ARO-ORIG-CODE.
           MOVE ARH-AR-CODE            TO ARO-AR-CODE.
           MOVE ARH-ORIG-CURRENCY      TO ARO-ORIG-CURRENCY.
           MOVE ARH-XREF-COMPANY       TO ARO-XREF-COMPANY.
           MOVE ARH-GROUP-MUDV         TO ARO-GROUP-MUDV.
           MOVE ARH-CURR-MUDV          TO ARO-CURR-MUDV.
           MOVE ARH-CANCEL-FLAG        TO ARO-CANCEL-FLAG.
           MOVE ARH-REVALUE-FL         TO ARO-REVALUE-FL.
           MOVE ARH-XREF-TYPE          TO ARO-XREF-TYPE.
           MOVE ARH-DESC               TO ARO-DESC.
           MOVE ARH-TERMS-CD           TO ARO-TERMS-CD.
           MOVE ARH-AC-CUSTOMER-ID     TO ARO-AC-CUSTOMER-ID.

           MOVE ARH-LATE-CH-FL         TO ARO-LATE-CH-FL.
           MOVE ARH-LST-DUNLTR-STM     TO ARO-LST-DUNLTR-STM.
           MOVE ARH-LAST-LTR-DATE      TO ARO-LAST-LTR-DATE.
           MOVE ARH-LST-LTRTEXT-CD     TO ARO-LST-LTRTEXT-CD.
           MOVE ARH-SENT-FOR-COLL      TO ARO-SENT-FOR-COLL.
           MOVE ARH-DUN-LTR-IND        TO ARO-DUN-LTR-IND.
           MOVE ARH-ASSESS-DUN-FEE     TO ARO-ASSESS-DUN-FEE.

           IF (WF5-CB-DISPUTE-CD   NOT = SPACES)
               PERFORM 2955-SUMMARY-CB-DISPUTE
               THRU    2955-END.

           PERFORM 3000-UPDATE-ARACPIVOT-ARO.
           PERFORM 820-STORE-AROITEMS.

           MOVE "N"                    TO ARPVT-AROIHDR.
           MOVE ARH-CUST-PO-NBR        TO ARPVT-CUST-PO-NBR.
           MOVE ARH-PROCESS-LEVEL      TO ARPVT-PROCESS-LEVEL.
           MOVE ARH-TRANS-USER1        TO ARPVT-TRANS-USER1.
           MOVE ARH-XREF-TYPE          TO ARPVT-XREF-TYPE.
           MOVE ARH-XREF-NBR           TO ARPVT-XREF-NBR.
           MOVE ARH-ORIG-CURRENCY      TO ARPVT-ORIG-CURRENCY.
           MOVE ARH-ORIG-ND            TO ARPVT-ORIG-ND.
           MOVE ARH-ORIG-RATE          TO ARPVT-ORIG-RATE.
           MOVE ARH-CURR-MUDV          TO ARPVT-CURR-MUDV.
           MOVE ARH-SUM-LINE           TO ARPVT-SUM-LINE.
           MOVE "A"                    TO ARPVT-FC.
           PERFORM 2000-ARPVT-PROCESS-TRAN.
           INITIALIZE CRT-ERROR-NBR
                      CRT-ERROR-CAT.

           PERFORM 820-STORE-ARCOMP.

       2500-END.
      ******************************************************************
       2600-CREATE-ARDISPUTE.
      ******************************************************************

           PERFORM 800-CREATE-ARDISPUTE.
           MOVE ZR190WS-D-COMPANY      TO ADP-COMPANY.
           MOVE ZR190WS-D-CUSTOMER     TO ADP-CUSTOMER.
           MOVE ZR190WS-D-TYPE         TO ADP-TRANS-TYPE.
           MOVE ZR190WS-D-NBR          TO ADP-INVOICE.
           MOVE ZR190WS-D-PAYMENT-SEQ  TO ADP-PAYMENT-SEQ.
           ADD 1                       TO ZR190WS-DISPUTE-SEQ.
           MOVE ZR190WS-DISPUTE-SEQ    TO ADP-SEQ.
           MOVE ZR190WS-MISC-IAMT      TO ADP-DISPUTE-AMT.
           MOVE ZR190WS-D-DISPUTE-CD   TO ADP-DISPUTE-CD.
           MOVE ZR190WS-D-TRAN-AMT     TO ADP-TRAN-AMT.
           COMPUTE ADP-ORIG-DISP = ZR190WS-ORIG-AMT
                                 - (ZR190WS-ARO-ORIG-APP-AMT
                                  + ZR190WS-ARO-ORIG-ADJ-AMT).
      *     MOVE ZR190WS-MISC-OAMT      TO ADP-ORIG-DISP.
           MOVE ZR190WS-D-ORIG-AMT     TO ADP-ORIG-AMT.
           MOVE ZR190WS-D-CURR         TO ADP-ORIG-CURRENCY.
           MOVE ZR190WS-D-DISPUTE-DATE TO ADP-DISPUTE-DATE.
           MOVE ZR190WS-MSG-8          TO ZR190WS-MSG4.
           MOVE ZR190WS-D-TYPE         TO ZR190WS-TYPE4.
           MOVE ZR190WS-D-NBR          TO ZR190WS-NBR4.
           MOVE ZR190WS-TYPE           TO ADP-DESC.
           PERFORM 820-STORE-ARDISPUTE.

       2600-END.
      ******************************************************************
       2800-UPDT-PERIOD-BUCKET.
      ******************************************************************

      *******UPDATE PERIOD WRITE OFF BUCKET

           MOVE ZR190WS-COMPANY        TO ARWS-COMPANY.
           MOVE ZR190WS-CUSTOMER       TO ARWS-CUSTOMER.
           MOVE "W"                    TO ARWS-RESULT-FL.
           MOVE ARA-GL-DATE            TO ARWS-GL-DATE.
           IF (ADJ-TRANS-TYPE          = "P" OR "C")
              COMPUTE ARWS-TRAN-AMT   = ADJ-ADJ-AMT
                                      * NEGATIVE-ONE
           ELSE
               MOVE ADJ-ADJ-AMT        TO ARWS-TRAN-AMT.
           MOVE ZEROS                  TO ARWS-DAY.
           MOVE ZEROS                  TO ARWS-DAY2.

           MOVE "Y"                    TO ARWS-SKIP-MX-UPDATE.
           PERFORM 700-UPDATE-TOTALS.

       2800-END.

      ******************************************************************
       2900-SET-ARDISTRIB-10.
      ******************************************************************
   
       2900-FIRST-RECORD.
   
           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.
           MOVE WF8-COMPANY             TO DB-COMPANY.
           MOVE WF8-ROUNDING-CODE       TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
           MOVE RCD-ACCT-UNIT           TO ZR190WS-BASE-ACCTUNIT.
   
           PERFORM 6000-PROG-SEQ
           THRU    6000-END.
   
           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WF8-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF8-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE WF8-COMPANY            TO AMD-COMPANY.
           MOVE WF8-PAYMENT-SEQ        TO AMD-PAYMENT-SEQ.
           MOVE WF8-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE WF8-CUSTOMER           TO AMD-CUSTOMER.
           MOVE WF8-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE WF8-INVOICE            TO AMD-INVOICE.
           MOVE WF8-APP-SEQ            TO AMD-DIST-SEQ.
           MOVE WF8-APP-SOURCE         TO AMD-DST-TYPE.
           IF (ACO-DTL-APPL            = "N")
               MOVE "S"                TO AMD-ACCUM-TYPE
           ELSE
               MOVE "D"                TO AMD-ACCUM-TYPE.
           IF (WF8-TRANS-TYPE          = "C")
              COMPUTE AMD-TRAN-AMT     = WF8-TRAN-AMT
                                       * NEGATIVE-ONE
           ELSE
              MOVE WF8-TRAN-AMT        TO AMD-TRAN-AMT.
           MOVE 60                     TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE WF8-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF8-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
   
GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.
   
       2900-SECOND-RECORD.
   
           MOVE WF8-COMPANY             TO DB-COMPANY.
           MOVE WF8-OFFSET-CODE         TO DB-AR-CODE.
           PERFORM 840-FIND-RCDSET1.
   
           PERFORM 6000-PROG-SEQ
           THRU    6000-END.
   
           PERFORM 800-CREATE-ARDISTRIB.
           MOVE WF8-COMPANY            TO AMD-GL-COMPANY.
           MOVE RCD-ACCT-UNIT          TO AMD-ACCT-UNIT.
           MOVE RCD-ACCOUNT            TO AMD-ACCOUNT.
           MOVE RCD-SUB-ACCT           TO AMD-SUB-ACCT.
           MOVE WF8-GL-DATE            TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD     TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME       TO AMD-CREATE-TIME.
           MOVE ZR190WS-PROG-SEQ-NBR   TO AMD-PROG-SEQ-NBR.
           MOVE WF8-COMPANY            TO AMD-COMPANY.
           MOVE WF8-PAYMENT-SEQ        TO AMD-PAYMENT-SEQ.
           MOVE WF8-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE WF8-CUSTOMER           TO AMD-CUSTOMER.
           MOVE WF8-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE WF8-INVOICE            TO AMD-INVOICE.
           MOVE WF8-APP-SEQ            TO AMD-DIST-SEQ.
           MOVE WF8-APP-SOURCE         TO AMD-DST-TYPE.
           IF (ACO-DTL-APPL            = "N")
               MOVE "S"                TO AMD-ACCUM-TYPE
           ELSE
               MOVE "D"                TO AMD-ACCUM-TYPE.
           MOVE WF8-TRAN-AMT           TO AMD-TRAN-AMT.
           IF (WF8-TRANS-TYPE          = "C")
              MOVE WF8-TRAN-AMT        TO AMD-TRAN-AMT
           ELSE
              COMPUTE AMD-TRAN-AMT     = WF8-TRAN-AMT
                                       * NEGATIVE-ONE.
           MOVE 60                     TO CRT-MSG-NBR.
           PERFORM 790-GET-MSG.
           MOVE CRT-MESSAGE            TO AMD-DESC.
           MOVE 2                      TO AMD-STATUS.
           MOVE "01"                   TO AMD-UPDATE-SUM.
           MOVE WF8-ORIG-ND            TO AMD-ORIG-ND.
           MOVE WF8-APP-CURR-CD        TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-BASE-ACCTUNIT  TO AMD-BASE-ACCTUNIT.
           MOVE PRM-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
   
GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.
   
       2900-END.

      ******************************************************************
       2950-CREATE-CB-DISPUTE.
      ******************************************************************

           PERFORM 800-CREATE-ARDISPUTE.
           
           MOVE ARO-COMPANY            TO ADP-COMPANY.
           MOVE ARO-TRANS-TYPE         TO ADP-TRANS-TYPE.
           MOVE ARO-INVOICE            TO ADP-INVOICE.
           MOVE ARO-PAYMENT-SEQ        TO ADP-PAYMENT-SEQ.
           MOVE ARO-CUSTOMER           TO ADP-CUSTOMER.
           ADD 1                       TO ARO-DISPUTE-SEQ.
           MOVE ARO-DISPUTE-SEQ        TO ADP-SEQ.
           MOVE ARR-CB-DISPUTE-CD      TO ADP-DISPUTE-CD.
           MOVE ARO-TRAN-AMT           TO ADP-TRAN-AMT.
           MOVE ARO-ORIG-AMT           TO ADP-ORIG-AMT.
           MOVE ARO-ORIG-CURRENCY      TO ADP-ORIG-CURRENCY.
           MOVE ARO-TRAN-AMT           TO ADP-DISPUTE-AMT.
           MOVE ARO-ORIG-AMT           TO ADP-ORIG-DISP.
           MOVE ARA-DEPOSIT-DATE       TO ADP-DISPUTE-DATE.
           MOVE ARR-DESCRIPTION        TO ADP-DESC.

           PERFORM 820-STORE-ARDISPUTE.

           MOVE ARO-CUSTOMER           TO DB-CUSTOMER.
           PERFORM 840-MODIFY-ACMSET1.

           IF (ARO-TRANS-TYPE           = "C")
               SUBTRACT ADP-DISPUTE-AMT FROM ACM-DISP-AMT
           ELSE
               ADD ADP-DISPUTE-AMT      TO ACM-DISP-AMT.

           ADD 1                       TO ACM-DISP-NBR.
           PERFORM 820-STORE-ARCUSTOMER.

       2950-END.
      ******************************************************************
       2955-SUMMARY-CB-DISPUTE.
      ******************************************************************

           PERFORM 800-CREATE-ARDISPUTE.
           
           MOVE ARO-COMPANY            TO ADP-COMPANY.
           MOVE ARO-TRANS-TYPE         TO ADP-TRANS-TYPE.
           MOVE ARO-INVOICE            TO ADP-INVOICE.
           MOVE ARO-PAYMENT-SEQ        TO ADP-PAYMENT-SEQ.
           MOVE ARO-CUSTOMER           TO ADP-CUSTOMER.
           ADD 1                       TO ARO-DISPUTE-SEQ.
           MOVE ARO-DISPUTE-SEQ        TO ADP-SEQ.
           MOVE WF5-CB-DISPUTE-CD      TO ADP-DISPUTE-CD.
           MOVE ARO-TRAN-AMT           TO ADP-TRAN-AMT.
           MOVE ARO-ORIG-AMT           TO ADP-ORIG-AMT.
           MOVE ARO-ORIG-CURRENCY      TO ADP-ORIG-CURRENCY.
           MOVE ARO-TRAN-AMT           TO ADP-DISPUTE-AMT.
           MOVE ARO-ORIG-AMT           TO ADP-ORIG-DISP.
           MOVE WF5-DEPOSIT-DATE       TO ADP-DISPUTE-DATE.

           MOVE ARO-COMPANY            TO DB-COMPANY.
           MOVE WF5-CB-DISPUTE-CD      TO DB-DISPUTE-CD.
           PERFORM 840-FIND-DCDSET1.
           MOVE DCD-DESC               TO ADP-DESC.

           PERFORM 820-STORE-ARDISPUTE.

           MOVE ARO-CUSTOMER           TO DB-CUSTOMER.
           PERFORM 840-MODIFY-ACMSET1.

           IF (ARO-TRANS-TYPE           = "C")
               SUBTRACT ADP-DISPUTE-AMT FROM ACM-DISP-AMT
           ELSE
               ADD ADP-DISPUTE-AMT      TO ACM-DISP-AMT.

           ADD 1                       TO ACM-DISP-NBR.
           PERFORM 820-STORE-ARCUSTOMER.

       2955-END.
      ******************************************************************
       2960-CREATE-DISPUTE.
      ******************************************************************

           MOVE ARA-COMPANY            TO DB-COMPANY.
           MOVE ARA-TRANS-TYPE         TO DB-TRANS-TYPE.
           MOVE ARA-INVOICE            TO DB-INVOICE.
           MOVE ARA-PAYMENT-SEQ        TO DB-PAYMENT-SEQ.
           PERFORM 840-MODIFY-AROSET1.
           PERFORM 3000-SAVE-ARACPIVOT-ARO.

           IF (ARO-STATUS              NOT = 1)
               GO TO 2960-END.

           INITIALIZE  FILTER-STRING.
           MOVE 1      TO I8.
           STRING "(ADP-RESOLV-DATE = '00000000')"
                   DELIMITED           BY SIZE
                   INTO                FILTER-STRING
                                       POINTER I8.
           PERFORM 890-CREATE-FILTER.

           MOVE ARO-COMPANY            TO DB-COMPANY.
           MOVE ARO-CUSTOMER           TO DB-CUSTOMER.
           MOVE ARO-TRANS-TYPE         TO DB-TRANS-TYPE.
           MOVE ARO-INVOICE            TO DB-INVOICE.
           MOVE ARO-PAYMENT-SEQ        TO DB-PAYMENT-SEQ.
           MOVE ADPSET1-PAYMENT-SEQ    TO WS-DB-BEG-RNG.
           PERFORM 850-FILTER-BEGRNG-ADPSET1.
           IF (ARDISPUTE-FOUND)
               GO TO 2960-END.

           PERFORM 800-CREATE-ARDISPUTE.
           
           MOVE ARO-COMPANY            TO ADP-COMPANY.
           MOVE ARO-TRANS-TYPE         TO ADP-TRANS-TYPE.
           MOVE ARO-INVOICE            TO ADP-INVOICE.
           MOVE ARO-PAYMENT-SEQ        TO ADP-PAYMENT-SEQ.
           MOVE ARO-CUSTOMER           TO ADP-CUSTOMER.
           ADD 1                       TO ARO-DISPUTE-SEQ.
           MOVE ARO-DISPUTE-SEQ        TO ADP-SEQ.
           MOVE ARR-DISPUTE-CD         TO ADP-DISPUTE-CD.
           MOVE ARO-TRAN-AMT           TO ADP-TRAN-AMT.
           MOVE ARO-ORIG-AMT           TO ADP-ORIG-AMT.
           MOVE ARO-ORIG-CURRENCY      TO ADP-ORIG-CURRENCY.
           COMPUTE ADP-DISPUTE-AMT ROUNDED =  ARO-TRAN-AMT
                                           - (ARO-APPLD-AMT
                                           +  ARO-ADJ-AMT).
           COMPUTE ADP-ORIG-DISP ROUNDED   =  ARO-ORIG-AMT
                                           - (ARO-ORIG-APP-AMT
                                           +  ARO-ORIG-ADJ-AMT).
           MOVE ARR-DESCRIPTION        TO ADP-DESC.

           IF (ARA-DEPOSIT-DATE        < ARO-TRANS-DATE)
               MOVE ARO-TRANS-DATE     TO ADP-DISPUTE-DATE
           ELSE
               MOVE ARA-DEPOSIT-DATE   TO ADP-DISPUTE-DATE.

           PERFORM 820-STORE-ARDISPUTE.
           PERFORM 3000-UPDATE-ARACPIVOT-ARO.
           PERFORM 820-STORE-AROITEMS.

           MOVE ARO-CUSTOMER           TO DB-CUSTOMER.
           PERFORM 840-MODIFY-ACMSET1.

           IF (ARO-TRANS-TYPE           = "C")
               SUBTRACT ADP-DISPUTE-AMT FROM ACM-DISP-AMT
           ELSE
               ADD ADP-DISPUTE-AMT      TO ACM-DISP-AMT.

           ADD 1                       TO ACM-DISP-NBR.
           PERFORM 820-STORE-ARCUSTOMER.

       2960-END.
      ******************************************************************
       3200-BUILD-WORK-1.
      ******************************************************************

           MOVE ZEROS                  TO ZR190WS-APP2
                                          ZR190WS-ADJUST-AMT.
           MOVE "N"                    TO ZR190WS-CURR-FL.

           IF  (ARA-ADJ-SEQ            > ZERO)
      *     AND (ZR190WS-ACO-CURR       NOT = ARA-APP-CURR-CD)
               MOVE ARA-COMPANY        TO DB-COMPANY
               MOVE ARA-TRANS-TYPE     TO DB-TRANS-TYPE
               MOVE ARA-INVOICE        TO DB-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO DB-PAYMENT-SEQ
               MOVE ARA-BATCH-NBR      TO DB-BATCH-NBR
               MOVE ARA-APP-SEQ        TO DB-APP-SEQ
               MOVE ZEROS              TO DB-ADJ-SEQ
               MOVE ADJSET1-APP-SEQ    TO WS-DB-BEG-RNG
               PERFORM 850-FIND-BEGRNG-ADJSET1
               PERFORM 3250-ARADJUST
               THRU    3250-END
                   UNTIL (ARADJUST-NOTFOUND).

           MOVE ARA-CR-COMPANY         TO DB-COMPANY.
           MOVE ARA-CR-BATCH           TO DB-BATCH-NBR.
           MOVE ARA-CR-PYMNT-SEQ       TO DB-PAYMENT-SEQ.
           PERFORM 840-FIND-APMSET1.
           MOVE APM-ORIG-ND            TO ZR190WS-APM-ORIG-ND.

           MOVE ARA-CR-APP-AMT         TO ZR190WS-ADJ-AMT.

           IF (ACO-DTL-APPL            = "N")
               MOVE ARA-COMPANY        TO WF1-COMPANY
               MOVE ARA-CR-COMPANY     TO WF1-CR-COMPANY
               MOVE ARA-OFFSET-CODE    TO WF1-OFFSET-CODE
               MOVE ARA-GL-DATE        TO WF1-GL-DATE
               MOVE ARA-APP-CURR-CD    TO WF1-APP-CURR-CD
               MOVE ARA-TRANS-TYPE     TO WF1-TRANS-TYPE
               IF (ARA-APP-SOURCE      = "R")
                   MOVE "RY"           TO WF1-APP-SOURCE
               ELSE                   
                   MOVE "RL"           TO WF1-APP-SOURCE
               END-IF
               PERFORM 8400-READ-WZR190A
               IF (WZR190A-FOUND)
                   ADD ARA-CR-ORIG-AP-AMT TO WF1-ORIG-APP-AMT
                   ADD ZR190WS-ADJ-AMT    TO WF1-CR-APP-AMT
                   GO TO 3200-CONT.

           PERFORM 8000-CREATE-WZR190A.
           MOVE ARA-COMPANY            TO WF1-COMPANY.
           MOVE ARA-CR-COMPANY         TO WF1-CR-COMPANY.
           MOVE ARA-OFFSET-CODE        TO WF1-OFFSET-CODE.
           MOVE ARA-GL-DATE            TO WF1-GL-DATE.
           MOVE ZR190WS-APM-ORIG-ND    TO WF1-ORIG-ND.
           MOVE ARA-APP-CURR-CD        TO WF1-APP-CURR-CD.
           MOVE ARA-CR-ORIG-AP-AMT     TO WF1-ORIG-APP-AMT.
           MOVE ARA-AR-CODE            TO WF1-AR-CODE.
           MOVE ARA-TRANS-TYPE         TO WF1-TRANS-TYPE.
           MOVE ZR190WS-ADJ-AMT        TO WF1-CR-APP-AMT.
           MOVE SPACES                 TO ZR190WS-DOCUMENT-NBR.
           MOVE "7-"                   TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER    TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR   TO WF1-DOCUMENT-NBR.
           MOVE ARA-OPR-CODE           TO WF1-ARA-OPR-CODE.
           MOVE ZR190WS-PROCESS-LEVEL  TO WF1-PROCESS-LEVEL.
           MOVE ZR190WS-BANK-INST-CODE TO WF1-BANK-INST-CODE.
           MOVE ZR190WS-DEP-INST-CODE  TO WF1-DEP-INST-CODE.
           IF (ARA-APP-SOURCE           = "R")
               MOVE "RY"                TO WF1-APP-SOURCE
           ELSE                   
               MOVE "RL"                TO WF1-APP-SOURCE.

           IF (ACO-DTL-APPL            = "Y")
               MOVE ARA-BATCH-NBR      TO WF1-BATCH-NBR
               MOVE ARH-CUSTOMER       TO WF1-CUSTOMER
               MOVE ARA-INVOICE        TO WF1-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO WF1-PAYMENT-SEQ
               MOVE ARA-APP-SEQ        TO WF1-APP-SEQ.
          
       3200-CONT.

           IF (ZR190WS-CURR-FL         = "N")
               ADD ARA-APPLD-AMT       TO WF1-APPLD-AMT
           ELSE
               ADD ZR190WS-ADJUST-AMT  TO WF1-APPLD-AMT.

           PERFORM 8200-STORE-WZR190A.

           IF (ACO-DTL-APPL                = "N")
               MOVE ARA-COMPANY            TO WF2-COMPANY
               MOVE ZR190WS-PROCESS-LEVEL  TO WF2-PROCESS-LEVEL
               MOVE ARA-AR-CODE            TO WF2-AR-CODE
               MOVE ARA-GL-DATE            TO WF2-GL-DATE
               MOVE ARA-APP-CURR-CD        TO WF2-APP-CURR-CD
               MOVE ARA-TRANS-TYPE         TO WF2-TRANS-TYPE
               IF (ARA-APP-SOURCE          = "R")
                   MOVE "RY"               TO WF2-APP-SOURCE
               ELSE                   
                   MOVE "RL"               TO WF2-APP-SOURCE
               END-IF
               PERFORM 8400-READ-WZR190B
               IF (WZR190B-FOUND)
                   ADD ARA-CR-ORIG-AP-AMT  TO WF2-ORIG-APP-AMT
                   ADD ARA-APPLD-AMT       TO WF2-APPLD-AMT
                   GO TO 3200-STORE.

           PERFORM 8000-CREATE-WZR190B.
           MOVE ARA-COMPANY                TO WF2-COMPANY.
           MOVE ZR190WS-PROCESS-LEVEL      TO WF2-PROCESS-LEVEL.
           MOVE ARA-AR-CODE                TO WF2-AR-CODE.
           MOVE ARA-GL-DATE                TO WF2-GL-DATE.
           MOVE ARA-APP-CURR-CD            TO WF2-APP-CURR-CD.
           MOVE ARA-CR-ORIG-AP-AMT         TO WF2-ORIG-APP-AMT.
           MOVE ZR190WS-APM-ORIG-ND        TO WF2-ORIG-ND.
           MOVE ARA-APPLD-AMT              TO WF2-APPLD-AMT.
           MOVE ARA-TRANS-TYPE             TO WF2-TRANS-TYPE.
           MOVE SPACES                     TO ZR190WS-DOCUMENT-NBR.
           MOVE "7-"                       TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER        TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR       TO WF2-DOCUMENT-NBR.
           MOVE ARA-OPR-CODE               TO WF2-ARA-OPR-CODE.
           MOVE ZR190WS-BANK-INST-CODE     TO WF2-BANK-INST-CODE.
           MOVE ZR190WS-DEP-INST-CODE      TO WF2-DEP-INST-CODE.
           IF (ARA-APP-SOURCE              = "R")
               MOVE "RY"                   TO WF2-APP-SOURCE
           ELSE                   
               MOVE "RL"                   TO WF2-APP-SOURCE.

           IF (ACO-DTL-APPL            = "Y")
               MOVE ARA-BATCH-NBR      TO WF2-BATCH-NBR
               MOVE ARH-CUSTOMER       TO WF2-CUSTOMER
               MOVE ARA-INVOICE        TO WF2-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO WF2-PAYMENT-SEQ
               MOVE ARA-APP-SEQ        TO WF2-APP-SEQ.
          
       3200-STORE.

           PERFORM 8200-STORE-WZR190B.

       3200-END.
      ******************************************************************
       3250-ARADJUST.
      ******************************************************************

           IF  (ADJ-REASON-CODE           = "CURR")
           AND (ADJ-TRANS-TYPE            = "D" OR "I")
               COMPUTE ZR190WS-APP2  ROUNDED = ARA-APPLD-AMT
                                             - ADJ-ADJ-AMT
               ADD ZR190WS-APP2          TO ZR190WS-ADJUST-AMT
               MOVE "Y"                  TO ZR190WS-CURR-FL.

           IF  (ADJ-REASON-CODE           = "CURR")
           AND (ADJ-TRANS-TYPE            = "C")
               COMPUTE ZR190WS-APP2  ROUNDED = ARA-APPLD-AMT
                                             - (ADJ-ADJ-AMT
                                             *  NEGATIVE-ONE)
               ADD ZR190WS-APP2          TO ZR190WS-ADJUST-AMT
               MOVE "Y"                  TO ZR190WS-CURR-FL.

           PERFORM 860-FIND-NXTRNG-ADJSET1.

       3250-END.
      ******************************************************************
       3300-BUILD-WORK-2.
      ******************************************************************

           MOVE ZEROS                  TO ZR190WS-APP3
                                          ZR190WS-ADJUST-AMT.
           MOVE "N"                    TO ZR190WS-CURR-FL.

           IF  (ARA-ADJ-SEQ            > ZERO)
               MOVE ARA-COMPANY        TO DB-COMPANY
               MOVE ARA-TRANS-TYPE     TO DB-TRANS-TYPE
               MOVE ARA-INVOICE        TO DB-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO DB-PAYMENT-SEQ
               MOVE ARA-BATCH-NBR      TO DB-BATCH-NBR
               MOVE ARA-APP-SEQ        TO DB-APP-SEQ
               MOVE ZEROS              TO DB-ADJ-SEQ
               MOVE ADJSET1-APP-SEQ    TO WS-DB-BEG-RNG
               PERFORM 850-FIND-BEGRNG-ADJSET1
               PERFORM 3250-ARADJUST
               THRU    3250-END
                   UNTIL (ARADJUST-NOTFOUND).

           MOVE ARA-CR-APP-AMT      TO ZR190WS-ADJ-AMT.

           IF (ACO-DTL-APPL             = "N")
               MOVE ARA-COMPANY         TO WF3-COMPANY
               MOVE ARA-CR-COMPANY      TO WF3-CR-COMPANY
               MOVE ARA-OFFSET-CODE     TO WF3-OFFSET-CODE
               MOVE ARA-GL-DATE         TO WF3-GL-DATE
               MOVE ARA-APP-CURR-CD     TO WF3-APP-CURR-CD
               IF (ARA-APP-SOURCE  = "R")
                   MOVE "RY"            TO WF3-APP-SOURCE
               ELSE                   
                   MOVE "RL"            TO WF3-APP-SOURCE
               END-IF
               PERFORM 8400-READ-WZR190C
               IF (WZR190C-FOUND)
                   ADD ARA-CR-ORIG-AP-AMT TO WF3-ORIG-APP-AMT
                   ADD ZR190WS-ADJ-AMT  TO WF3-CR-APP-AMT
                   GO TO 3300-CONT.

           PERFORM 8000-CREATE-WZR190C.
           MOVE ARA-COMPANY             TO WF3-COMPANY.
           MOVE ZR190WS-CUSTOMER        TO WF3-CUSTOMER.
           MOVE ARA-CR-COMPANY          TO WF3-CR-COMPANY.
           MOVE ARA-OFFSET-CODE         TO WF3-OFFSET-CODE.
           MOVE ARA-GL-DATE             TO WF3-GL-DATE.
           MOVE ZR190WS-ORIG-ND         TO WF3-ORIG-ND.
           MOVE ARA-APP-CURR-CD         TO WF3-APP-CURR-CD.
           MOVE ARA-CR-ORIG-AP-AMT      TO WF3-ORIG-APP-AMT.
           MOVE ARA-AR-CODE             TO WF3-AR-CODE.
           MOVE ZR190WS-ADJ-AMT         TO WF3-CR-APP-AMT.
           MOVE SPACES                  TO ZR190WS-DOCUMENT-NBR.
           MOVE "7-"                    TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER     TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR    TO WF3-DOCUMENT-NBR.
           MOVE ARA-CR-CUSTOMER         TO WF3-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL   TO WF3-PROCESS-LEVEL.
           MOVE ARA-BATCH-NBR           TO WF3-BATCH-NBR.
           MOVE ZR190WS-BANK-INST-CODE  TO WF3-BANK-INST-CODE.
           MOVE ARA-OPR-CODE            TO WF3-ARA-OPR-CODE.
           MOVE ZR190WS-DEP-INST-CODE   TO WF3-DEP-INST-CODE.
           IF (ARA-APP-SOURCE              = "R")
               MOVE "RY"                 TO WF3-APP-SOURCE
           ELSE                   
               MOVE "RL"                 TO WF3-APP-SOURCE.

           IF (ACO-DTL-APPL            = "Y")
               MOVE ARA-TRANS-TYPE     TO WF3-TRANS-TYPE
               MOVE ARA-INVOICE        TO WF3-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO WF3-PAYMENT-SEQ
               MOVE ARA-APP-SEQ        TO WF3-APP-SEQ.
          

       3300-CONT.

           IF (ZR190WS-CURR-FL          = "N")
               ADD ARA-APPLD-AMT        TO WF3-APPLD-AMT
           ELSE
               ADD ZR190WS-ADJUST-AMT   TO WF3-APPLD-AMT.

           PERFORM 8200-STORE-WZR190C.

           IF (ACO-DTL-APPL             = "N")
               MOVE ARA-COMPANY         TO WF4-COMPANY
               MOVE ZR190WS-PROCESS-LEVEL   TO WF4-PROCESS-LEVEL
               MOVE ARA-AR-CODE         TO WF4-AR-CODE
               MOVE ARA-GL-DATE         TO WF4-GL-DATE
               MOVE ARA-APP-CURR-CD     TO WF4-APP-CURR-CD
               IF (ARA-APP-SOURCE       = "R")
                   MOVE "RY"            TO WF4-APP-SOURCE
               ELSE                   
                   MOVE "RL"            TO WF4-APP-SOURCE
               END-IF
               PERFORM 8400-READ-WZR190D
               IF (WZR190D-FOUND)
                  ADD ARA-CR-ORIG-AP-AMT  TO WF4-ORIG-APP-AMT
                  ADD ARA-APPLD-AMT     TO WF4-APPLD-AMT
                  GO TO 3300-STORE.

           PERFORM 8000-CREATE-WZR190D.
           MOVE ARA-COMPANY             TO WF4-COMPANY.
           MOVE ZR190WS-CUSTOMER        TO WF4-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL   TO WF4-PROCESS-LEVEL.
           MOVE ARA-AR-CODE             TO WF4-AR-CODE.
           MOVE ARA-GL-DATE             TO WF4-GL-DATE.
           MOVE ARA-APP-CURR-CD         TO WF4-APP-CURR-CD.
           MOVE ARA-CR-ORIG-AP-AMT      TO WF4-ORIG-APP-AMT.
           MOVE ZR190WS-ORIG-ND         TO WF4-ORIG-ND.
           MOVE ARA-APPLD-AMT           TO WF4-APPLD-AMT.
           MOVE SPACES                  TO ZR190WS-DOCUMENT-NBR.
           MOVE "7-"                    TO ZR190WS-DOC-PRE.
           MOVE ZR190WS-DOC-COUNTER     TO ZR190WS-DOC-NBR.
           MOVE ZR190WS-DOCUMENT-NBR    TO WF4-DOCUMENT-NBR.
           MOVE ARA-CR-CUSTOMER         TO WF4-CUSTOMER.
           MOVE ZR190WS-PROCESS-LEVEL   TO WF4-PROCESS-LEVEL.
           MOVE ARA-BATCH-NBR           TO WF4-BATCH-NBR.
           MOVE ZR190WS-BANK-INST-CODE  TO WF4-BANK-INST-CODE.
           MOVE ARA-OPR-CODE            TO WF4-ARA-OPR-CODE.
           MOVE ZR190WS-DEP-INST-CODE   TO WF4-DEP-INST-CODE.
           IF (ARA-APP-SOURCE              = "R")
               MOVE "RY"                 TO WF4-APP-SOURCE
           ELSE                   
               MOVE "RL"                 TO WF4-APP-SOURCE.

           IF (ACO-DTL-APPL            = "Y")
               MOVE ARA-TRANS-TYPE     TO WF4-TRANS-TYPE
               MOVE ARA-INVOICE        TO WF4-INVOICE
               MOVE ARA-PAYMENT-SEQ    TO WF4-PAYMENT-SEQ
               MOVE ARA-APP-SEQ        TO WF4-APP-SEQ.

       3300-STORE.

           PERFORM 8200-STORE-WZR190D.

       3300-END.
      ******************************************************************
       3400-BUILD-WORK-5.
      ******************************************************************

           MOVE ARA-COMPANY            TO WF5-COMPANY.
           MOVE ARA-CR-COMPANY         TO WF5-CR-COMPANY.
           MOVE ARA-CR-BATCH           TO WF5-CR-BATCH.
           MOVE ARA-CR-TYPE            TO WF5-CR-TYPE.
           MOVE ARA-CR-NBR             TO WF5-CR-NBR.
           MOVE ARA-CR-CUSTOMER        TO WF5-CR-CUSTOMER.
           MOVE ARA-GL-DATE            TO WF5-GL-DATE.
           PERFORM 8400-READ-WZR190E.

           MOVE ADJ-CR-ORIG-AJ-AMT     TO ZR190WS-ADJ-AMT.

           IF (WZR190E-FOUND)
               ADD ZR190WS-ADJ-AMT     TO WF5-ORIG-ADJ-AMT
               IF (WF5-CB-DISPUTE-FL   = SPACES)
                   IF (ARR-CB-DISPUTE-CD   NOT = WF5-CB-DISPUTE-CD)
                       MOVE "N"        TO WF5-CB-DISPUTE-FL
                       MOVE SPACES     TO WF5-CB-DISPUTE-CD
                   ELSE
                       MOVE ARR-CB-DISPUTE-CD
                                       TO WF5-CB-DISPUTE-CD
                   END-IF
               END-IF
               IF (WF5-ACTIVITY-FL     = SPACES)
                   IF (ARO-ACTIVITY     NOT = WF5-ACTIVITY)
                   OR (ARO-ACTIVITY-GRP NOT = WF5-ACTIVITY-GRP)
                   OR (ARO-CONTRACT     NOT = WF5-CONTRACT)
                       MOVE "N"         TO WF5-ACTIVITY-FL
                       MOVE SPACES      TO WF5-ACTIVITY
                                           WF5-ACTIVITY-GRP
                                           WF5-CONTRACT
                   ELSE
                       MOVE ARO-ACTIVITY       TO WF5-ACTIVITY
                       MOVE ARO-ACTIVITY-GRP   TO WF5-ACTIVITY-GRP
                       MOVE ARO-CONTRACT       TO WF5-CONTRACT.

           IF (WZR190E-NOTFOUND)
               PERFORM 8000-CREATE-WZR190E
               MOVE ARA-COMPANY        TO WF5-COMPANY
               MOVE ARA-CR-COMPANY     TO WF5-CR-COMPANY
               MOVE ARA-CR-BATCH       TO WF5-CR-BATCH
               MOVE ARA-CR-TYPE        TO WF5-CR-TYPE
               MOVE ARA-CR-NBR         TO WF5-CR-NBR
               MOVE ARA-CR-CUSTOMER    TO WF5-CR-CUSTOMER
               MOVE ARA-GL-DATE        TO WF5-GL-DATE
               MOVE ARA-DEPOSIT-DATE   TO WF5-DEPOSIT-DATE
               MOVE ARR-CB-DISPUTE-CD  TO WF5-CB-DISPUTE-CD
               MOVE ZR190WS-ADJ-AMT    TO WF5-ORIG-ADJ-AMT
               MOVE ZR190WS-ORIG-ND    TO WF5-ORIG-ND
               MOVE SPACES             TO ZR190WS-DOCUMENT-NBR
               ADD  1                  TO ZR190WS-CBS-COUNTER
               MOVE "7-"               TO ZR190WS-DOC-PRE
               MOVE ZR190WS-CBS-COUNTER  TO ZR190WS-DOC-NBR
               MOVE ZR190WS-DOCUMENT-NBR TO WF5-DOCUMENT-NBR
               MOVE ARO-ACTIVITY       TO WF5-ACTIVITY
               MOVE ARO-ACTIVITY-GRP   TO WF5-ACTIVITY-GRP
               MOVE ARO-CONTRACT       TO WF5-CONTRACT
               MOVE ARO-SORT-1         TO WF5-SORT-1
               MOVE ARO-SORT-2         TO WF5-SORT-2
               MOVE ARO-SORT-3         TO WF5-SORT-3
               MOVE ARO-SORT-4         TO WF5-SORT-4
               
               IF (ARA-CR-TYPE         = "P")
                   MOVE ARA-CR-COMPANY   TO DB-COMPANY
                   MOVE ARA-CR-BATCH     TO DB-BATCH-NBR
                   PERFORM 840-FIND-APHSET1
                   MOVE APH-PROCESS-LEVEL TO WF5-PROCESS-LEVEL
                   MOVE APH-CURRENCY-CD   TO WF5-ORIG-CURRENCY
                   MOVE APH-ORIG-RATE     TO WF5-ORIG-RATE
                   MOVE APH-GROUP-MUDV    TO WF5-GROUP-MUDV
                   MOVE APH-GROUP-RATE    TO WF5-GROUP-RATE
                   MOVE APH-CURR-MUDV     TO WF5-CURR-MUDV
               ELSE
                   MOVE ARA-CR-COMPANY    TO DB-COMPANY
                   MOVE ARA-CR-TYPE       TO DB-TRANS-TYPE
                   MOVE ARA-CR-NBR        TO DB-INVOICE
                   MOVE ARA-CR-PYMNT-SEQ  TO DB-PAYMENT-SEQ
                   PERFORM 840-FIND-AROSET1
                   MOVE ARO-ALT-TYPE      TO DB-TRANS-TYPE
                   PERFORM 840-FIND-ARHSET1
                   MOVE ARH-PROCESS-LEVEL TO WF5-PROCESS-LEVEL
                   MOVE ARH-ORIG-CURRENCY TO WF5-ORIG-CURRENCY
                   MOVE ARH-ORIG-RATE     TO WF5-ORIG-RATE
                   MOVE ARH-GROUP-MUDV    TO WF5-GROUP-MUDV
                   MOVE ARH-GROUP-RATE    TO WF5-GROUP-RATE
                   MOVE ARH-CURR-MUDV     TO WF5-CURR-MUDV
                   MOVE ARA-COMPANY       TO DB-COMPANY
                   MOVE ARA-TRANS-TYPE    TO DB-TRANS-TYPE
                   MOVE ARA-INVOICE       TO DB-INVOICE
                   MOVE ARA-PAYMENT-SEQ   TO DB-PAYMENT-SEQ
                   PERFORM 840-FIND-AROSET1
                   MOVE ARO-ALT-TYPE      TO DB-TRANS-TYPE
                   PERFORM 840-FIND-ARHSET1.

           MOVE WF5-COMPANY            TO IFCAWS-COMPANY.
           MOVE WF5-ORIG-CURRENCY      TO IFCAWS-FR-CURR-CODE.
           MOVE ACO-CURRENCY-CD        TO IFCAWS-TO-CURR-CODE.
           MOVE "AR"                   TO IFCAWS-SYSTEM.
           MOVE WF5-GL-DATE            TO IFCAWS-EFFECT-DATE.
           MOVE ZR190WS-ADJ-AMT           TO IFCAWS-TRAN-AMOUNT.
           INITIALIZE IFCAWS-BASE-AMOUNT.
           MOVE WF5-ORIG-RATE             TO IFCAWS-BASERATE.
           MOVE WF5-CURR-MUDV             TO IFCAWS-MULT-DIV.
           MOVE WF5-ORIG-ND               TO IFCAWS-TRAN-ND.
           MOVE ACO-BASE-ND               TO IFCAWS-BASE-ND.
           PERFORM 690-CALCULATE-AMOUNT-60.
           ADD  IFCAWS-BASE-AMOUNT        TO WF5-TRAN-AMT.

           PERFORM 8200-STORE-WZR190E.

       3400-END.
      ******************************************************************
       3500-BUILD-WORK-6.
      ******************************************************************

           PERFORM 8000-CREATE-WZR190F.
           MOVE ARO-COMPANY            TO WF6-COMPANY.
           MOVE ARO-TRANS-TYPE         TO WF6-TRANS-TYPE.
           MOVE ARO-INVOICE            TO WF6-INVOICE.
           MOVE ARO-TRAN-AMT           TO WF6-TRAN-AMT.
           MOVE ARO-ORIG-AMT           TO WF6-ORIG-AMT.
           MOVE ARO-ACTIVITY           TO WF6-ACTIVITY.
           MOVE ARO-ACCT-CATEGORY      TO WF6-ACCT-CATEGORY.
           MOVE ARR-CB-TYPE            TO WF6-CB-TYPE.
           MOVE ADJ-REASON-CODE        TO WF6-REASON-CODE.
           MOVE ADJ-DESC               TO WF6-DESC.
           IF (ARR-CB-TYPE             = "D")
               MOVE ADJ-TRANS-TYPE     TO WF6-XREF-TYPE
               MOVE ADJ-INVOICE        TO WF6-XREF-NBR
           ELSE
               MOVE ARH-XREF-TYPE      TO WF6-XREF-TYPE
               MOVE ARH-XREF-NBR       TO WF6-XREF-NBR.

           MOVE ARA-CR-TYPE            TO WF6-CR-TYPE.
           MOVE ARA-CR-NBR             TO WF6-CR-NBR.
           MOVE ARH-ORIG-CURRENCY      TO WF6-ORIG-CURRENCY.
           MOVE ARH-ORIG-ND            TO WF6-ORIG-ND.

           MOVE ARO-CUSTOMER           TO WF6-CUSTOMER.

           PERFORM 8200-STORE-WZR190F.

       3500-END.
      ******************************************************************
       3600-BUILD-WORK-7.
      ******************************************************************

           PERFORM 8000-CREATE-WZR190G.
           ADD 1                       TO ZR190WS-SEQ-NBR.
           MOVE ZR190WS-SEQ-NBR        TO WF7-SEQ-NBR.
           MOVE WF5-COMPANY            TO WF7-COMPANY.
           MOVE WF5-CR-COMPANY         TO WF7-CR-COMPANY.
           MOVE WF5-CR-BATCH           TO WF7-CR-BATCH.
           MOVE WF5-CR-TYPE            TO WF7-CR-TYPE.
           MOVE WF5-CR-NBR             TO WF7-CR-NBR.
           MOVE WF5-CR-CUSTOMER        TO WF7-CR-CUSTOMER.
           MOVE WF5-GL-DATE            TO WF7-GL-DATE.
           MOVE ADJ-REASON-CODE        TO WF7-REASON-CODE.
           MOVE ADJ-DESC               TO WF7-DESC.
           MOVE ADJ-TRANS-TYPE         TO WF7-XREF-TYPE.
           MOVE ADJ-INVOICE            TO WF7-XREF-NBR.
           MOVE ZR190WS-ORIG-CURRENCY  TO WF7-ORIG-CURRENCY.
           MOVE ZR190WS-ORIG-ND        TO WF7-ORIG-ND.

           PERFORM 8200-STORE-WZR190G.

       3600-END.

      ******************************************************************
       3700-BUILD-WORK-8.
      ******************************************************************
   
           PERFORM 8000-CREATE-WZR190H.
           MOVE PRM-COMPANY            TO WF8-COMPANY.
           MOVE PRM-COMPANY            TO WF8-CR-COMPANY
                                          DB-COMPANY.
           MOVE ARA-OFFSET-CODE        TO WF8-OFFSET-CODE.
           MOVE ARA-GL-DATE            TO WF8-GL-DATE.
           MOVE ARA-APP-CURR-CD        TO WF8-APP-CURR-CD.
           MOVE ARA-TRANS-TYPE         TO WF8-TRANS-TYPE
                                          DB-TRANS-TYPE.
           MOVE ARA-INVOICE            TO WF8-INVOICE
                                          DB-INVOICE.
           MOVE ARA-PAYMENT-SEQ        TO WF8-PAYMENT-SEQ
                                          DB-PAYMENT-SEQ.
           MOVE ARA-BATCH-NBR          TO WF8-BATCH-NBR.
           MOVE ARA-APP-SEQ            TO WF8-APP-SEQ.
           MOVE ZR190WS-RND-AMT        TO WF8-TRAN-AMT.
           MOVE ACO-BASE-ND            TO WF8-ORIG-ND.
           MOVE ARA-AR-CODE            TO WF8-AR-CODE.
           MOVE ARH-CUSTOMER           TO WF8-CUSTOMER.
           IF (ARA-APP-SOURCE              = "R")
               MOVE "RY"               TO WF8-APP-SOURCE
           ELSE                   
               MOVE "RL"               TO WF8-APP-SOURCE.
     
           PERFORM 840-FIND-AROSET1.
           MOVE ARO-PROCESS-LEVEL      TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-APVSET1.
           MOVE APV-ROUNDING-CODE      TO WF8-ROUNDING-CODE.
     
           PERFORM 8200-STORE-WZR190H.
   
       3700-END.

      ******************************************************************
       3900-CHECK-ARDISPUTE.
      ******************************************************************

           IF (ADP-RESOLV-DATE         = ZEROS)
               MOVE WS-TRUE            TO ZR190WS-REC-FOUND
               GO TO 3900-END.

           PERFORM 860-MODIFY-NXTRNG-ADPSET1.

       3900-END.
      ******************************************************************
       4000-DO-REPORT.
      ******************************************************************

           MOVE ZEROES                 TO RPT-PAGE-COUNT (ZR190-R1).

           MOVE WS-FALSE               TO ZR190WS-REPORT-FL.
           MOVE WS-TRUE                TO ZR190WS-CB-CURR.
           MOVE WS-TRUE                TO ZR190WS-CB-MEMO-CURR.
           MOVE WS-TRUE                TO ZR190WS-CB-DETL-CURR.
           MOVE WS-TRUE                TO ZR190WS-CB-SUMM-CURR.
           MOVE PRM-COMPANY            TO WF6-COMPANY.
           MOVE SPACES                 TO WF6-TRANS-TYPE.
           MOVE SPACES                 TO WF6-INVOICE.

           PERFORM 8500-READ-NLT-WZR190F.
           IF  (WZR190F-FOUND)
           AND (WF6-COMPANY                = PRM-COMPANY)
               MOVE WF6-COMPANY            TO G1-COMPANY
               MOVE PRM-COMPANY            TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1
               MOVE ACO-COMPANY            TO G1-COMPANY
               MOVE ACO-NAME               TO G1-ACO-NAME
               MOVE ACO-CURRENCY-CD        TO G1-ACO-CURRENCY-CD
               MOVE WS-TRUE                TO ZR190WS-REPORT-FL
               MOVE GN1-COMPANY            TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
               PERFORM 4200-CHARGE-BACK
               THRU    4200-END
                   UNTIL (WZR190F-NOTFOUND)
                   OR    (WF6-COMPANY NOT = PRM-COMPANY).

           IF (PROGRAM-RESTARTING           = WS-FALSE)
               MOVE PRM-COMPANY             TO WF5-COMPANY
               MOVE ZEROS                   TO WF5-CR-COMPANY
               MOVE ZEROS                   TO WF5-CR-BATCH
               MOVE SPACES                  TO WF5-CR-TYPE
               MOVE SPACES                  TO WF5-CR-NBR
               MOVE SPACES                  TO WF5-CR-CUSTOMER
               MOVE ZEROS                   TO WF5-GL-DATE
               PERFORM 8500-READ-NLT-WZR190E
           ELSE
               MOVE WS-FALSE                TO PROGRAM-RESTARTING
               MOVE WS-RESTART-COMP         TO WF5-COMPANY
               MOVE WS-RESTART-CR-COMP      TO WF5-CR-COMPANY
               MOVE WS-RESTART-BATCH        TO WF5-CR-BATCH
               MOVE WS-RESTART-TYPE         TO WF5-CR-TYPE
               MOVE WS-RESTART-NBR          TO WF5-CR-NBR
               MOVE WS-RESTART-CR-CUST      TO WF5-CR-CUSTOMER
               MOVE WS-RESTART-DATE         TO WF5-GL-DATE
               PERFORM 8400-READ-WZR190E
               IF (WZR190E-FOUND)
                    PERFORM
                        UNTIL (WZR190E-NOTFOUND)
                        OR    (WF5-COMPANY    NOT = WS-RESTART-COMP)
                        OR    (WF5-CR-COMPANY NOT = WS-RESTART-CR-COMP)
                        OR    (WF5-CR-BATCH   NOT = WS-RESTART-BATCH)
                        OR    (WF5-CR-TYPE    NOT = WS-RESTART-TYPE)
                        OR    (WF5-CR-NBR     NOT = WS-RESTART-NBR)
                        OR    (WF5-CR-CUSTOMER NOT = WS-RESTART-CR-CUST)
                        OR    (WF5-GL-DATE    NOT = WS-RESTART-DATE)

                    PERFORM 8600-READ-NEXT-WZR190E
                    END-PERFORM.

           IF (WZR190E-FOUND)
               PERFORM 840-MODIFY-CKPSET1
               MOVE 7                      TO WS-RESTART-PHASE
               MOVE ZR190WS-PROG-SEQ-NBR   TO WS-RESTART-PGM
               MOVE WS-RESTART-INFO        TO CKP-RESTART-INFO
               PERFORM 820-STORE-CKPOINT
               PERFORM 920-AUDIT-END
               PERFORM 910-AUDIT-BEGIN
               IF (ZR190WS-REPORT-FL       = WS-FALSE)
                   MOVE PRM-COMPANY        TO DB-COMPANY
                   PERFORM 840-FIND-ACOSET1
                   MOVE ACO-COMPANY        TO G1-COMPANY
                   MOVE ACO-NAME           TO G1-ACO-NAME
                   MOVE ACO-CURRENCY-CD    TO G1-ACO-CURRENCY-CD
                   MOVE WS-TRUE            TO ZR190WS-REPORT-FL
                   MOVE GN1-COMPANY        TO RPT-GROUP-REQUEST
                   PERFORM 700-PRINT-RPT-GRP
               END-IF
               PERFORM 4100-DO-WORK-3
               THRU    4100-END
                   UNTIL (WZR190E-NOTFOUND)
                   OR    (WF5-COMPANY   NOT = PRM-COMPANY).
       

           IF (ZR190WS-REPORT-FL        = WS-TRUE)
               IF  (ZR190WS-DETL-CURR-SAME)
               AND (ZR190WS-DET-CB-CURRENCY NOT = ACO-CURRENCY-CD)
                   MOVE ZR190WS-DET-CB-CURRENCY TO T0-DETAIL-CURRENCY
                   MOVE ZR190WS-DET-ND      TO T0-ORIG-DETAIL-AMOUNT-ND
                   MOVE ZR190WS-DET-ORIG-AMT    TO T0-ORIG-DETAIL-AMOUNT
               ELSE
                   MOVE SPACES                  TO T0-DETAIL-CURRENCY
                   MOVE ZEROES                  TO T0-ORIG-DETAIL-AMOUNT
               END-IF
               IF  (ZR190WS-MEMO-CURR-SAME)
               AND (ZR190WS-MEM-CB-CURRENCY NOT = ACO-CURRENCY-CD)
                   MOVE ZR190WS-MEM-CB-CURRENCY TO T0-MEMO-CURRENCY
                   MOVE ZR190WS-MEM-ND      TO T0-ORIG-MEMO-AMOUNT-ND
                   MOVE ZR190WS-MEM-ORIG-AMT    TO T0-ORIG-MEMO-AMOUNT
               ELSE
                   MOVE SPACES                  TO T0-MEMO-CURRENCY
                   MOVE ZEROES                  TO T0-ORIG-MEMO-AMOUNT
               END-IF
               IF  (ZR190WS-SUMM-CURR-SAME)
               AND (ZR190WS-SUM-CB-CURRENCY NOT = ACO-CURRENCY-CD)
                   MOVE ZR190WS-SUM-CB-CURRENCY TO T0-SUMMARY-CURRENCY
                   MOVE ZR190WS-SUM-ND      TO T0-ORIG-SUMMARY-AMOUNT-ND
                   MOVE ZR190WS-SUM-ORIG-AMT   TO T0-ORIG-SUMMARY-AMOUNT
               ELSE
                   MOVE SPACES                  TO T0-SUMMARY-CURRENCY
                   MOVE ZEROES                 TO T0-ORIG-SUMMARY-AMOUNT
               END-IF
               IF  (ZR190WS-CB-CURR-SAME)
               AND (ZR190WS-CB-CURRENCY NOT = ACO-CURRENCY-CD)
                   MOVE ZR190WS-MEMO-DASH       TO T0-MEMO-DASH-LINE
                   MOVE ZR190WS-CB-CURRENCY     TO T0-ALL-CURRENCY
                   MOVE ZR190WS-CB-ND         TO T0-ORIG-TOTAL-AMOUNT-ND
                   COMPUTE ZR190WS-TOTALS ROUNDED = ZR190WS-DET-ORIG-AMT
                                                  + ZR190WS-SUM-ORIG-AMT
                                                  + ZR190WS-MEM-ORIG-AMT
                   MOVE ZR190WS-TOTALS          TO T0-ORIG-TOTAL-AMOUNT
               ELSE
                   MOVE SPACES                  TO T0-ALL-CURRENCY
                                                   T0-MEMO-DASH-LINE
                   MOVE ZEROES                  TO T0-ORIG-TOTAL-AMOUNT
               END-IF
               MOVE ACO-BASE-ND         TO T0-DETAIL-AMOUNT-ND
               MOVE ZR190WS-T0DTL       TO T0-DETAIL-AMOUNT
               MOVE ACO-BASE-ND         TO T0-MEMO-AMOUNT-ND
               MOVE ZR190WS-T0MEMO      TO T0-MEMO-AMOUNT
               MOVE ACO-BASE-ND         TO T0-SUMMARY-AMOUNT-ND
               MOVE ZR190WS-T0SUM       TO T0-SUMMARY-AMOUNT
               COMPUTE ZR190WS-TOTALS ROUNDED = ZR190WS-T0DTL
                                              + ZR190WS-T0MEMO
                                              + ZR190WS-T0SUM
               MOVE ACO-BASE-ND         TO T0-TOTAL-AMOUNT-ND
               MOVE ZR190WS-TOTALS         TO T0-TOTAL-AMOUNT
               MOVE TN0-TOTALS             TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP.

       4000-END.
      ******************************************************************
       4100-DO-WORK-3.
      ******************************************************************

           PERFORM 1800-SET-ARDISTRIB-4
           THRU    1800-END.
           PERFORM 2500-CREATE-AROITEM
           THRU    2500-END.

           MOVE ARO-COMPANY             TO DB-COMPANY.
           PERFORM 840-FIND-ACOSET1.
           MOVE ARO-CUSTOMER            TO DB-CUSTOMER.
           IF (ARO-TRANS-TYPE = "C")
               COMPUTE ARWS-TRAN-AMT     = ARO-TRAN-AMT
                                         * -1
           ELSE
               MOVE ARO-TRAN-AMT        TO ARWS-TRAN-AMT.
           MOVE ARH-GROUP-RATE          TO ARWS-GROUP-RATE.
           MOVE ARH-GROUP-MUDV          TO ARWS-GROUP-MUDV.
           MOVE "C"                     TO ARWS-TRANS-TYPE.
           MOVE WF5-GL-DATE             TO ARWS-GL-DATE.
           MOVE "Y"                     TO ARWS-SKIP-MX-UPDATE.
           PERFORM 700-UPDATE-ARCUSTOMER.

           PERFORM 4300-PRTAUD2
           THRU    4300-END.

           PERFORM 8600-READ-NEXT-WZR190E.

       4100-END.
      ******************************************************************
       4200-CHARGE-BACK.
      ******************************************************************

           IF  (WF6-CB-TYPE             = "D")
           AND (ZR190WS-DET-CB-CURRENCY = SPACES)
               MOVE WF6-ORIG-CURRENCY  TO ZR190WS-DET-CB-CURRENCY
               MOVE WF6-ORIG-ND        TO ZR190WS-DET-ND.

           IF  (WF6-CB-TYPE             = "M")
           AND (ZR190WS-MEM-CB-CURRENCY = SPACES)
               MOVE WF6-ORIG-CURRENCY  TO ZR190WS-MEM-CB-CURRENCY.
               MOVE WF6-ORIG-ND        TO ZR190WS-MEM-ND.

           IF (ZR190WS-CB-CURRENCY = SPACES)
               MOVE WF6-ORIG-ND        TO ZR190WS-CB-ND
               MOVE WF6-ORIG-CURRENCY  TO ZR190WS-CB-CURRENCY.

           INITIALIZE                     ZR190WS-CHECK-LENGTH.

           MOVE WF6-XREF-NBR           TO ZR190WS-CHECK-LENGTH.

           IF (ZR190WS-11-22 = SPACES)
               MOVE WF6-TRANS-TYPE     TO G1-TRANS-TYPE
               MOVE WF6-INVOICE        TO G1-INVOICE
               MOVE ACO-BASE-ND        TO G1-TRAN-AMT-ND
               IF (G1-TRANS-TYPE = "C")
                   COMPUTE G1-TRAN-AMT  = WF6-TRAN-AMT
                                        * -1
               ELSE
                   MOVE WF6-TRAN-AMT   TO G1-TRAN-AMT
               END-IF
               IF (WF6-CB-TYPE = "D")
                   MOVE 180            TO CRT-MSG-NBR
                   MOVE "ZR190"        TO CRT-ERROR-CAT
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE    TO G1-CB-TYPE
               ELSE
                   MOVE 181            TO CRT-MSG-NBR
                   MOVE "ZR190"        TO CRT-ERROR-CAT
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE    TO G1-CB-TYPE
               END-IF
               MOVE WF6-REASON-CODE    TO G1-REASON-CODE
               MOVE WF6-DESC           TO G1-DESC
               MOVE WF6-XREF-TYPE      TO G1-XREF-TYPE
               MOVE WF6-XREF-NBR       TO G1-XREF-NBR
               MOVE WF6-CR-TYPE        TO G1-CR-TYPE
               MOVE WF6-CR-NBR         TO G1-CR-NBR
               MOVE GN1-DETAIL         TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
           ELSE
               MOVE WF6-TRANS-TYPE     TO G12-TRANS-TYPE
               MOVE WF6-INVOICE        TO G12-INVOICE
               MOVE ACO-BASE-ND        TO G12-TRAN-AMT-ND
               IF (G12-TRANS-TYPE = "C")
                   COMPUTE G12-TRAN-AMT = WF6-TRAN-AMT
                                        * -1
               ELSE
                   MOVE WF6-TRAN-AMT   TO G12-TRAN-AMT
               END-IF
               IF (WF6-CB-TYPE = "D")
                   MOVE 180            TO CRT-MSG-NBR
                   MOVE "ZR190"        TO CRT-ERROR-CAT
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE    TO G12-CB-TYPE
               ELSE
                   MOVE 181            TO CRT-MSG-NBR
                   MOVE "ZR190"        TO CRT-ERROR-CAT
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE    TO G12-CB-TYPE
               END-IF
               MOVE WF6-REASON-CODE    TO G12-REASON-CODE
               MOVE WF6-DESC           TO G12-DESC
               MOVE WF6-XREF-TYPE      TO G12-XREF-TYPE
               MOVE WF6-XREF-NBR       TO G12-XREF-NBR
               MOVE WF6-CR-TYPE        TO G12-CR-TYPE
               MOVE WF6-CR-NBR         TO G12-CR-NBR
               MOVE GN12-DETAIL        TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
           END-IF.

           IF (WF6-ORIG-CURRENCY       NOT = ACO-CURRENCY-CD)
               MOVE WF6-ORIG-ND        TO G2-ORIG-AMT-ND
               MOVE WF6-ORIG-AMT       TO G2-ORIG-AMT
               MOVE WF6-ORIG-CURRENCY  TO G2-ORIG-CURRENCY
           ELSE
               MOVE ZEROES             TO G2-ORIG-AMT
               MOVE SPACES             TO G2-ORIG-CURRENCY.

           MOVE WF6-CUSTOMER           TO G2-CB-CUSTOMER.
           MOVE WF6-CUSTOMER           TO DB-CUSTOMER.
           PERFORM 840-FIND-CUDSET1.
           IF (CUSTDESC-FOUND)
               MOVE CUD-NAME           TO G2-NAME
           ELSE
               MOVE SPACES             TO G2-NAME.

           MOVE GN2-CUSTOMER           TO RPT-GROUP-REQUEST.
           PERFORM 700-PRINT-RPT-GRP.

           IF (WF6-CB-TYPE             = "D")
               IF (WF6-TRANS-TYPE = "C")
                   COMPUTE ZR190WS-CREDIT-AMT = WF6-TRAN-AMT
                                              * -1
                   ADD ZR190WS-CREDIT-AMT  TO ZR190WS-T0DTL
                   COMPUTE ZR190WS-CREDIT-AMT = WF6-ORIG-AMT
                                              * -1
                   ADD ZR190WS-CREDIT-AMT  TO ZR190WS-DET-ORIG-AMT
               ELSE
                   ADD WF6-TRAN-AMT        TO ZR190WS-T0DTL
                   ADD WF6-ORIG-AMT        TO ZR190WS-DET-ORIG-AMT
               END-IF
           ELSE
               IF (WF6-TRANS-TYPE = "C")
                   COMPUTE ZR190WS-CREDIT-AMT = WF6-TRAN-AMT 
                                              * -1
                   ADD ZR190WS-CREDIT-AMT  TO ZR190WS-T0MEMO
                   COMPUTE ZR190WS-CREDIT-AMT = WF6-ORIG-AMT
                                              * -1
                   ADD ZR190WS-CREDIT-AMT  TO ZR190WS-MEM-ORIG-AMT
               ELSE
                   ADD WF6-TRAN-AMT        TO ZR190WS-T0MEMO
                   ADD WF6-ORIG-AMT        TO ZR190WS-MEM-ORIG-AMT
               END-IF.

           IF  (WF6-CB-TYPE            = "D")
           AND (ZR190WS-DETL-CURR-SAME)
               IF (WF6-ORIG-CURRENCY NOT = ZR190WS-DET-CB-CURRENCY)
                   MOVE WS-FALSE       TO ZR190WS-CB-DETL-CURR.

           IF (WF6-CB-TYPE             = "M")
           AND (ZR190WS-MEMO-CURR-SAME)
               IF (WF6-ORIG-CURRENCY NOT = ZR190WS-MEM-CB-CURRENCY)
                   MOVE WS-FALSE       TO ZR190WS-CB-MEMO-CURR.

           IF (ZR190WS-CB-CURR-SAME)
               IF (WF6-ORIG-CURRENCY NOT = ZR190WS-CB-CURRENCY)
                   MOVE WS-FALSE       TO ZR190WS-CB-CURR.

           PERFORM 8600-READ-NEXT-WZR190F.

       4200-END.
      ******************************************************************
       4300-PRTAUD2.
      ******************************************************************

           MOVE WF5-COMPANY            TO WF7-COMPANY.
           MOVE WF5-CR-COMPANY         TO WF7-CR-COMPANY.
           MOVE WF5-CR-BATCH           TO WF7-CR-BATCH.
           MOVE WF5-CR-TYPE            TO WF7-CR-TYPE.
           MOVE WF5-CR-NBR             TO WF7-CR-NBR.
           MOVE WF5-CR-CUSTOMER        TO WF7-CR-CUSTOMER.
           MOVE WF5-GL-DATE            TO WF7-GL-DATE.
           MOVE ZEROS                  TO WF7-SEQ-NBR.
           PERFORM 8500-READ-NLT-WZR190G.

           IF (ZR190WS-SUM-CB-CURRENCY = SPACES)
               MOVE WF5-ORIG-CURRENCY  TO ZR190WS-SUM-CB-CURRENCY
               MOVE WF5-ORIG-ND        TO ZR190WS-SUM-ND.

           IF (ZR190WS-CB-CURRENCY = SPACES)
               MOVE WF5-ORIG-ND        TO ZR190WS-CB-ND
               MOVE WF5-ORIG-CURRENCY  TO ZR190WS-CB-CURRENCY.

           INITIALIZE                     ZR190WS-CHECK-LENGTH.

           MOVE WF7-XREF-NBR           TO ZR190WS-CHECK-LENGTH.

           IF (ZR190WS-11-22 = SPACES)
               MOVE ARO-TRANS-TYPE     TO G1-TRANS-TYPE
               MOVE ARO-INVOICE        TO G1-INVOICE
               MOVE ACO-BASE-ND        TO G1-TRAN-AMT-ND
               MOVE WF5-TRAN-AMT       TO G1-TRAN-AMT
               MOVE 182                TO CRT-MSG-NBR
               MOVE "ZR190"            TO CRT-ERROR-CAT
               PERFORM 790-GET-MSG
               MOVE CRT-MESSAGE        TO G1-CB-TYPE
               MOVE WF7-REASON-CODE    TO G1-REASON-CODE
               MOVE WF7-DESC           TO G1-DESC
               MOVE WF7-XREF-TYPE      TO G1-XREF-TYPE
               MOVE WF7-XREF-NBR       TO G1-XREF-NBR
               MOVE WF7-CR-TYPE        TO G1-CR-TYPE
               MOVE WF7-CR-NBR         TO G1-CR-NBR
               MOVE GN1-DETAIL         TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
           ELSE
               MOVE ARO-TRANS-TYPE     TO G12-TRANS-TYPE
               MOVE ARO-INVOICE        TO G12-INVOICE
               MOVE ACO-BASE-ND        TO G12-TRAN-AMT-ND
               MOVE WF5-TRAN-AMT       TO G12-TRAN-AMT
               MOVE 182                TO CRT-MSG-NBR
               MOVE "ZR190"            TO CRT-ERROR-CAT
               PERFORM 790-GET-MSG
               MOVE CRT-MESSAGE        TO G12-CB-TYPE
               MOVE WF7-REASON-CODE    TO G12-REASON-CODE
               MOVE WF7-DESC           TO G12-DESC
               MOVE WF7-XREF-TYPE      TO G12-XREF-TYPE
               MOVE WF7-XREF-NBR       TO G12-XREF-NBR
               MOVE WF7-CR-TYPE        TO G12-CR-TYPE
               MOVE WF7-CR-NBR         TO G12-CR-NBR
               MOVE GN12-DETAIL        TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
           END-IF.

           IF (WF5-ORIG-CURRENCY       NOT = ACO-CURRENCY-CD)
               MOVE WF5-ORIG-ND        TO G2-ORIG-AMT-ND
               MOVE WF5-ORIG-ADJ-AMT   TO G2-ORIG-AMT
               MOVE WF5-ORIG-CURRENCY  TO G2-ORIG-CURRENCY
           ELSE
               MOVE ZEROES             TO G2-ORIG-AMT
               MOVE SPACES             TO G2-ORIG-CURRENCY.

           MOVE WF5-CR-CUSTOMER        TO G2-CB-CUSTOMER.
           MOVE WF5-CR-CUSTOMER        TO DB-CUSTOMER.
           PERFORM 840-FIND-CUDSET1.
           IF (CUSTDESC-FOUND)
               MOVE CUD-NAME           TO G2-NAME
           ELSE
               MOVE SPACES             TO G2-NAME.

           MOVE GN2-CUSTOMER           TO RPT-GROUP-REQUEST.
           PERFORM 700-PRINT-RPT-GRP.

           ADD WF5-TRAN-AMT            TO ZR190WS-T0SUM.
           ADD WF5-ORIG-ADJ-AMT        TO ZR190WS-SUM-ORIG-AMT.

           IF (ZR190WS-SUMM-CURR-SAME)
               IF (WF5-ORIG-CURRENCY NOT = ZR190WS-SUM-CB-CURRENCY)
                   MOVE WS-FALSE       TO ZR190WS-CB-SUMM-CURR.

           IF (ZR190WS-CB-CURR-SAME)
               IF (WF7-ORIG-CURRENCY NOT = ZR190WS-CB-CURRENCY)
                   MOVE WS-FALSE       TO ZR190WS-CB-CURR.

           PERFORM 8600-READ-NEXT-WZR190G.

           PERFORM 4350-WZR190G
           THRU    4350-END
               UNTIL (WZR190G-NOTFOUND)
               OR    (WF7-COMPANY      NOT = WF5-COMPANY)
               OR    (WF7-CR-COMPANY   NOT = WF5-CR-COMPANY)
               OR    (WF7-CR-BATCH     NOT = WF5-CR-BATCH)
               OR    (WF7-CR-TYPE      NOT = WF5-CR-TYPE)
               OR    (WF7-CR-NBR       NOT = WF5-CR-NBR)
               OR    (WF7-CR-CUSTOMER  NOT = WF5-CR-CUSTOMER)
               OR    (WF7-GL-DATE      NOT = WF5-GL-DATE).

       4300-END.
      ******************************************************************
       4350-WZR190G.
      ******************************************************************

           MOVE WF7-REASON-CODE        TO G3-REASON-CODE.
           MOVE WF7-DESC               TO G3-DESC.
           MOVE WF7-XREF-TYPE          TO G3-XREF-TYPE.
           MOVE WF7-XREF-NBR           TO G3-XREF-NBR.

           MOVE GN3-XREF               TO RPT-GROUP-REQUEST.
           PERFORM 700-PRINT-RPT-GRP.

           PERFORM 8600-READ-NEXT-WZR190G.

       4350-END.
      ******************************************************************
       5000-TAX-POINT.
      ******************************************************************

           MOVE WS-TRUE                 TO WS-RESTART-APPL-FL.

           INITIALIZE     ZR190WS-ADJ-ORIG-REV
                          ZR190WS-ADJ-TRAN-REV
                          ZR190WS-ORIG-REVERSE-AMT
                          ZR190WS-TRAN-REVERSE-AMT.

           IF (AMD-TRANS-TYPE                  NOT = "C")
               IF (ARA-ADJ-SEQ                 > ZERO)
                   MOVE ARA-COMPANY             TO DB-COMPANY
                   MOVE ARA-TRANS-TYPE          TO DB-TRANS-TYPE
                   MOVE ARA-INVOICE             TO DB-INVOICE
                   MOVE ARA-PAYMENT-SEQ         TO DB-PAYMENT-SEQ
                   MOVE ARA-BATCH-NBR           TO DB-BATCH-NBR
                   MOVE ARA-APP-SEQ             TO DB-APP-SEQ
                   MOVE ADJSET1-APP-SEQ         TO WS-DB-BEG-RNG
                   PERFORM 850-FIND-BEGRNG-ADJSET1
                   PERFORM
                       UNTIL (ARADJUST-NOTFOUND)
                       IF (ADJ-REASON-CODE  NOT = "CURR")
                           ADD ADJ-ORIG-ADJ-AMT TO ZR190WS-ADJ-ORIG-REV
                           ADD ADJ-ADJ-AMT      TO ZR190WS-ADJ-TRAN-REV
                       ELSE
                           ADD ADJ-ORIG-ADJ-AMT TO ZR190WS-ADJ-ORIG-REV
                                                   ZR190WS-ADJ-TRAN-REV
                       END-IF
                       PERFORM 860-FIND-NXTRNG-ADJSET1
                   END-PERFORM
                   COMPUTE ZR190WS-ORIG-REVERSE-AMT ROUNDED
                                               = ((ARA-ORIG-APP-AMT
                                               +   ZR190WS-ADJ-ORIG-REV)
                                               /   ZR190WS-ARH-ORIG-AMT)
                                               *   AMD-ORIG-AMT
                   COMPUTE ZR190WS-TRAN-REVERSE-AMT ROUNDED
                                               = ((ARA-APPLD-AMT
                                               + ZR190WS-ADJ-TRAN-REV)
                                               / ZR190WS-ARH-TRAN-AMT)
                                               * AMD-TRAN-AMT
               ELSE
                   COMPUTE ZR190WS-ORIG-REVERSE-AMT ROUNDED
                                               = (ARA-ORIG-APP-AMT
                                               / ZR190WS-ARH-ORIG-AMT)
                                               * AMD-ORIG-AMT
                   COMPUTE ZR190WS-TRAN-REVERSE-AMT ROUNDED
                                               = (ARA-APPLD-AMT
                                               / ZR190WS-ARH-TRAN-AMT)
                                               * AMD-TRAN-AMT
               END-IF
           ELSE
               IF (ARA-ADJ-SEQ                 > ZERO)
                   MOVE ARA-COMPANY             TO DB-COMPANY
                   MOVE ARA-TRANS-TYPE          TO DB-TRANS-TYPE
                   MOVE ARA-INVOICE             TO DB-INVOICE  
                   MOVE ARA-PAYMENT-SEQ         TO DB-PAYMENT-SEQ
                   MOVE ARA-BATCH-NBR           TO DB-BATCH-NBR
                   MOVE ARA-APP-SEQ             TO DB-APP-SEQ
                   MOVE ADJSET1-APP-SEQ         TO WS-DB-BEG-RNG
                   PERFORM 850-FIND-BEGRNG-ADJSET1
                   PERFORM
                       UNTIL (ARADJUST-NOTFOUND)
                       IF (ADJ-REASON-CODE  NOT = "CURR")
                           ADD ADJ-ORIG-ADJ-AMT TO ZR190WS-ADJ-ORIG-REV
                           ADD ADJ-ADJ-AMT      TO ZR190WS-ADJ-TRAN-REV
                       ELSE
                           ADD ADJ-ORIG-ADJ-AMT TO ZR190WS-ADJ-ORIG-REV
                                                   ZR190WS-ADJ-TRAN-REV
                       END-IF
                       PERFORM 860-FIND-NXTRNG-ADJSET1
                   END-PERFORM
                   COMPUTE ZR190WS-ORIG-REVERSE-AMT ROUNDED
                                               = ((ARA-ORIG-APP-AMT
                                               +   ZR190WS-ADJ-ORIG-REV)
                                               /   ARH-ORIG-AMT)
                                               *   AMD-ORIG-AMT
                   COMPUTE ZR190WS-TRAN-REVERSE-AMT ROUNDED
                                               = ((ARA-APPLD-AMT
                                               +   ZR190WS-ADJ-TRAN-REV)
                                               /   ARH-TRAN-AMT)
                                               *   AMD-TRAN-AMT
               ELSE
                   COMPUTE ZR190WS-ORIG-REVERSE-AMT ROUNDED
                                                = (ARA-ORIG-APP-AMT
                                                   / ARH-ORIG-AMT)
                                                   * AMD-ORIG-AMT
                   COMPUTE ZR190WS-TRAN-REVERSE-AMT ROUNDED
                                                = (ARA-APPLD-AMT
                                                   / ARH-TRAN-AMT)
                                                   * AMD-TRAN-AMT
               END-IF
           END-IF.

           INITIALIZE TXCAL-INPUT-PARMS.
           MOVE AMD-GL-COMPANY      TO TXCAL-COMPANY.
           MOVE "I"                 TO TXCAL-FUNCTION.
           MOVE AMD-TAX-CODE        TO TXCAL-TAX-CODE.
           MOVE "AR"                TO TXCAL-SYSTEM.
           PERFORM 5000-TXCAL-OBJECT-70.

           MOVE AMD-GL-COMPANY         TO ZR190WS-AMD-GL-COMPANY.
           MOVE AMD-GL-DATE            TO ZR190WS-AMD-GL-DATE.
           MOVE AMD-COMPANY            TO ZR190WS-AMD-COMPANY.
           MOVE AMD-BATCH-NBR          TO ZR190WS-AMD-BATCH-NBR.
           MOVE AMD-CUSTOMER           TO ZR190WS-AMD-CUSTOMER.
           MOVE AMD-PROCESS-LEVEL      TO ZR190WS-AMD-PROCESS-LEVEL.
           MOVE AMD-TRANS-TYPE         TO ZR190WS-AMD-TRANS-TYPE.
           MOVE AMD-INVOICE            TO ZR190WS-AMD-INVOICE.
           MOVE AMD-TRANS-DATE         TO ZR190WS-AMD-TRAN-DATE.
           MOVE ARA-APP-SOURCE         TO ZR190WS-AMD-DST-TYPE.
           MOVE AMD-PAYMENT-SEQ        TO ZR190WS-AMD-PAYMENT-SEQ.
           MOVE AMD-ACCUM-TYPE         TO ZR190WS-AMD-ACCUM-TYPE.
           MOVE AMD-TRAN-AMT           TO ZR190WS-AMD-TRAN-AMT.
           MOVE AMD-TO-COMP-AMT        TO ZR190WS-AMD-TO-COMP-AMT.
           MOVE AMD-UNITS              TO ZR190WS-AMD-UNITS.
           MOVE AMD-DESC               TO ZR190WS-AMD-DESC.
           MOVE AMD-ACTIVITY           TO ZR190WS-AMD-ACTIVITY.
           MOVE AMD-ACCT-CATEGORY      TO ZR190WS-AMD-ACCT-CATEGORY.
           MOVE AMD-ORIG-CURRENCY      TO ZR190WS-AMD-ORIG-CURRENCY.
           MOVE AMD-ORIG-RATE          TO ZR190WS-AMD-ORIG-RATE.
           MOVE AMD-ORIG-AMT           TO ZR190WS-AMD-ORIG-AMT.
           MOVE AMD-AR-CATEGORY        TO ZR190WS-AMD-AR-CATEGORY.
           MOVE AMD-TAX-CODE           TO ZR190WS-AMD-TAX-CODE.

      *--- IF ARA-APP-SOURCE = R, (AR80 REVERSE), THE SIGNS WILL DIFFER 
      *--- THIS CHECK SHOULD CATCH SIGN DIFFERENCES
           IF  (ZR190WS-ORIG-REVERSE-AMT > ZEROES)
           AND (AMD-ORIG-TAXABLE         < ZEROES)
                COMPUTE ZR190WS-AMD-ORIG-TAXABLE = AMD-ORIG-TAXABLE
                                                 * NEGATIVE-ONE
                COMPUTE ZR190WS-AMD-TRAN-TAXABLE = AMD-TRAN-TAXABLE
                                                 * NEGATIVE-ONE
           ELSE
               MOVE AMD-ORIG-TAXABLE   TO ZR190WS-AMD-ORIG-TAXABLE
               MOVE AMD-TRAN-TAXABLE   TO ZR190WS-AMD-TRAN-TAXABLE.

           MOVE AMD-UPDATE-SUM         TO ZR190WS-AMD-UPDATE-SUM.
           MOVE AMD-ORIG-ND            TO ZR190WS-AMD-ORIG-ND.
           MOVE AMD-AUTO-REV           TO ZR190WS-AMD-AUTO-REV.
           MOVE AMD-ORIG-COMPANY       TO ZR190WS-AMD-ORIG-COMPANY.
           MOVE AMD-DOCUMENT-NBR       TO ZR190WS-AMD-DOCUMENT-NBR.
           MOVE AMD-DST-SOURCE         TO ZR190WS-AMD-DST-SOURCE.
           MOVE AMD-BASE-ACCTUNIT      TO ZR190WS-AMD-BASE-ACCTUNIT.
           MOVE AMD-JRNL-BOOK-NBR      TO ZR190WS-AMD-JRNL-BOOK-NBR.
           MOVE AMD-MX-VALUE (1)       TO ZR190WS-AMD-MX-VALUE (1).
           MOVE AMD-MX-VALUE (2)       TO ZR190WS-AMD-MX-VALUE (2).
           MOVE AMD-MX-VALUE (3)       TO ZR190WS-AMD-MX-VALUE (3).
           MOVE AMD-DRAFT-SOURCE       TO ZR190WS-AMD-DRAFT-SOURCE.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ZR190WS-AMD-GL-COMPANY         TO AMD-GL-COMPANY.
           MOVE TXCAL-T-OUTDU-ACT-UNIT (1)     TO AMD-ACCT-UNIT.
           MOVE TXCAL-T-OUTDU-ACCOUNT  (1)     TO AMD-ACCOUNT.
           MOVE TXCAL-T-OUTDU-SUB-ACCT (1)     TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE                    TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD             TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME               TO AMD-CREATE-TIME.
           MOVE ZR190WS-AMD-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-AMD-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE ZR190WS-AMD-CUSTOMER           TO AMD-CUSTOMER.
           MOVE ZR190WS-AMD-PROCESS-LEVEL      TO AMD-PROCESS-LEVEL.
           MOVE ZR190WS-AMD-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ZR190WS-AMD-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-AMD-TRAN-DATE          TO AMD-TRANS-DATE.
           MOVE ZR190WS-AMD-DST-TYPE           TO AMD-DST-TYPE.
           MOVE ZR190WS-AMD-PAYMENT-SEQ        TO AMD-PAYMENT-SEQ.
           MOVE ZR190WS-AMD-ACCUM-TYPE         TO AMD-ACCUM-TYPE.
           MOVE ZR190WS-AMD-UNITS              TO AMD-UNITS.
           MOVE ZR190WS-AMD-DESC               TO AMD-DESC.
           MOVE ZR190WS-AMD-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ZR190WS-AMD-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE 2                              TO AMD-STATUS.
           MOVE ZR190WS-AMD-ORIG-CURRENCY      TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-AMD-ORIG-RATE          TO AMD-ORIG-RATE.
           MOVE ZR190WS-AMD-AR-CATEGORY        TO AMD-AR-CATEGORY.
           MOVE ZR190WS-AMD-TAX-CODE           TO AMD-TAX-CODE.
           MOVE ZR190WS-AMD-UPDATE-SUM         TO AMD-UPDATE-SUM.
           MOVE ZR190WS-AMD-ORIG-ND            TO AMD-ORIG-ND.
           MOVE ZR190WS-AMD-AUTO-REV           TO AMD-AUTO-REV.
           MOVE ZR190WS-AMD-ORIG-COMPANY       TO AMD-ORIG-COMPANY.
           MOVE ZR190WS-AMD-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-AMD-DST-SOURCE         TO AMD-DST-SOURCE.
           MOVE ZR190WS-AMD-BASE-ACCTUNIT      TO AMD-BASE-ACCTUNIT.
           MOVE ZR190WS-AMD-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
           MOVE AMD-JBK-SEQ-NBR        TO ZR190WS-AMD-JBK-SEQ-NBR.
           MOVE ZR190WS-AMD-MX-VALUE (1)       TO AMD-MX-VALUE (1).
           MOVE ZR190WS-AMD-MX-VALUE (2)       TO AMD-MX-VALUE (2).
           MOVE ZR190WS-AMD-MX-VALUE (3)       TO AMD-MX-VALUE (3).
           MOVE ZR190WS-AMD-DRAFT-SOURCE       TO AMD-DRAFT-SOURCE.
           MOVE ZR190WS-AMD-ORIG-TAXABLE       TO AMD-ORIG-TAXABLE.
           MOVE ZR190WS-AMD-TRAN-TAXABLE       TO AMD-TRAN-TAXABLE.
           MOVE ZR190WS-ORIG-REVERSE-AMT       TO AMD-ORIG-AMT.
           MOVE ZR190WS-TRAN-REVERSE-AMT       TO AMD-TRAN-AMT.
           MOVE ZR190WS-TRAN-REVERSE-AMT       TO AMD-TO-COMP-AMT.

           IF (ZR190WS-CREDIT-FL          = WS-TRUE)
               COMPUTE AMD-ORIG-TAXABLE   = ZR190WS-AMD-ORIG-TAXABLE
                                          * NEGATIVE-ONE
               COMPUTE AMD-TRAN-TAXABLE   = ZR190WS-AMD-TRAN-TAXABLE
                                          * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT       = ZR190WS-TRAN-REVERSE-AMT
                                          * NEGATIVE-ONE
               COMPUTE AMD-ORIG-AMT       = ZR190WS-ORIG-REVERSE-AMT
                                          * NEGATIVE-ONE.

           IF  (ZR190WS-CREDIT-FL           = WS-FALSE)
           AND (ARA-TRANS-TYPE              NOT = "C")
               COMPUTE AMD-ORIG-AMT ROUNDED = ZR190WS-ORIG-REVERSE-AMT
                                            * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT ROUNDED = ZR190WS-TRAN-REVERSE-AMT
                                            * NEGATIVE-ONE
               COMPUTE AMD-ORIG-TAXABLE     = ZR190WS-AMD-ORIG-TAXABLE  
                                            * NEGATIVE-ONE
               COMPUTE AMD-TRAN-TAXABLE     =  ZR190WS-AMD-TRAN-TAXABLE 
                                            * NEGATIVE-ONE
               COMPUTE AMD-TO-COMP-AMT      =  ZR190WS-TRAN-REVERSE-AMT
                                            * NEGATIVE-ONE.

           ADD 1                               TO ZR190WS-DIST-SEQ.
           MOVE ZR190WS-DIST-SEQ               TO AMD-DIST-SEQ.
           MOVE ZR190WS-PROG-SEQ-NBR           TO AMD-PROG-SEQ-NBR.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

           PERFORM 6000-PROG-SEQ
           THRU    6000-END.

           PERFORM 800-CREATE-ARDISTRIB.
           MOVE ZR190WS-AMD-GL-COMPANY         TO AMD-GL-COMPANY.
           MOVE TXCAL-T-OUT-ACCT-UNIT (1)      TO AMD-ACCT-UNIT.
           MOVE TXCAL-T-OUT-ACCOUNT   (1)      TO AMD-ACCOUNT.
           MOVE TXCAL-T-OUT-SUB-ACCT  (1)      TO AMD-SUB-ACCT.
           MOVE ARA-GL-DATE                    TO AMD-GL-DATE.
           MOVE WS-SYSTEM-DATE-YMD             TO AMD-CREATE-DATE.
           MOVE ZR190WS-RUN-TIME               TO AMD-CREATE-TIME.
           MOVE ZR190WS-AMD-COMPANY            TO AMD-COMPANY.
           MOVE ZR190WS-AMD-BATCH-NBR          TO AMD-BATCH-NBR.
           MOVE ZR190WS-AMD-CUSTOMER           TO AMD-CUSTOMER.
           MOVE ZR190WS-AMD-PROCESS-LEVEL      TO AMD-PROCESS-LEVEL.
           MOVE ZR190WS-AMD-TRANS-TYPE         TO AMD-TRANS-TYPE.
           MOVE ZR190WS-AMD-INVOICE            TO AMD-INVOICE.
           MOVE ZR190WS-AMD-TRAN-DATE          TO AMD-TRANS-DATE.
           MOVE ZR190WS-AMD-DST-TYPE           TO AMD-DST-TYPE.
           MOVE ZR190WS-AMD-PAYMENT-SEQ        TO AMD-PAYMENT-SEQ.
           MOVE ZR190WS-AMD-ACCUM-TYPE         TO AMD-ACCUM-TYPE.
           MOVE ZR190WS-AMD-UNITS              TO AMD-UNITS.
           MOVE ZR190WS-AMD-DESC               TO AMD-DESC.
           MOVE ZR190WS-AMD-ACTIVITY           TO AMD-ACTIVITY.
           MOVE ZR190WS-AMD-ACCT-CATEGORY      TO AMD-ACCT-CATEGORY.
           MOVE 2                              TO AMD-STATUS.
           MOVE ZR190WS-AMD-ORIG-CURRENCY      TO AMD-ORIG-CURRENCY.
           MOVE ZR190WS-AMD-ORIG-RATE          TO AMD-ORIG-RATE.
           MOVE ZR190WS-AMD-AR-CATEGORY        TO AMD-AR-CATEGORY.
           MOVE ZR190WS-AMD-TAX-CODE           TO AMD-TAX-CODE.
           MOVE ZR190WS-AMD-UPDATE-SUM         TO AMD-UPDATE-SUM.
           MOVE ZR190WS-AMD-ORIG-ND            TO AMD-ORIG-ND.
           MOVE ZR190WS-AMD-AUTO-REV           TO AMD-AUTO-REV.
           MOVE ZR190WS-AMD-ORIG-COMPANY       TO AMD-ORIG-COMPANY.
           MOVE ZR190WS-AMD-DOCUMENT-NBR       TO AMD-DOCUMENT-NBR.
           MOVE ZR190WS-AMD-DST-SOURCE         TO AMD-DST-SOURCE.
           MOVE ZR190WS-AMD-BASE-ACCTUNIT      TO AMD-BASE-ACCTUNIT.
           MOVE ZR190WS-AMD-JRNL-BOOK-NBR      TO AMD-JRNL-BOOK-NBR.
           MOVE ZR190WS-AMD-JBK-SEQ-NBR        TO AMD-JBK-SEQ-NBR.
           MOVE ZR190WS-AMD-MX-VALUE (1)       TO AMD-MX-VALUE (1).
           MOVE ZR190WS-AMD-MX-VALUE (2)       TO AMD-MX-VALUE (2).
           MOVE ZR190WS-AMD-MX-VALUE (3)       TO AMD-MX-VALUE (3).
           MOVE ZR190WS-AMD-DRAFT-SOURCE       TO AMD-DRAFT-SOURCE.
           MOVE ZR190WS-AMD-ORIG-TAXABLE       TO AMD-ORIG-TAXABLE.
           MOVE ZR190WS-AMD-TRAN-TAXABLE       TO AMD-TRAN-TAXABLE.
           MOVE ZR190WS-TRAN-REVERSE-AMT       TO AMD-TRAN-AMT.
           MOVE ZR190WS-ORIG-REVERSE-AMT       TO AMD-ORIG-AMT.

           IF  (ZR190WS-CREDIT-FL         = WS-FALSE)
           AND (ARA-TRANS-TYPE            = "C")
               COMPUTE AMD-ORIG-TAXABLE   = ZR190WS-AMD-ORIG-TAXABLE
                                          * NEGATIVE-ONE
               COMPUTE AMD-TRAN-TAXABLE   = ZR190WS-AMD-TRAN-TAXABLE
                                          * NEGATIVE-ONE
               COMPUTE AMD-TRAN-AMT       = ZR190WS-TRAN-REVERSE-AMT
                                          * NEGATIVE-ONE
               COMPUTE AMD-ORIG-AMT       = ZR190WS-ORIG-REVERSE-AMT
                                          * NEGATIVE-ONE.

           IF (AMD-GL-COMPANY                  NOT = AMD-COMPANY)
               MOVE AMD-GL-COMPANY             TO DB-COMPANY
               PERFORM 840-FIND-ACOSET1
               IF (AMD-ORIG-CURRENCY           = ACO-CURRENCY-CD)
                   MOVE ZR190WS-TRAN-REVERSE-AMT
                                               TO AMD-TO-COMP-AMT
               ELSE
                   MOVE AMD-GL-COMPANY         TO IFCRWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY      TO IFCRWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD        TO IFCRWS-TO-CURR-CODE
                   PERFORM 655-EDIT-CURRENCY-RELATION-60
                   MOVE AMD-GL-COMPANY         TO IFGRWS-COMPANY
                   MOVE AMD-ORIG-CURRENCY      TO IFGRWS-FR-CURR-CODE
                   MOVE ACO-CURRENCY-CD        TO IFGRWS-TO-CURR-CODE
                   MOVE "AR"                   TO IFGRWS-SYSTEM
                   MOVE AMD-GL-DATE            TO IFGRWS-EFFECT-DATE
                   PERFORM 660-GET-CURRENCY-RATE-60
                   IF (IFCRWS-MULT-DIV         = "M")
                       COMPUTE AMD-TO-COMP-AMT ROUNDED
                                             = (ZR190WS-TRAN-REVERSE-AMT
                                                * IFGRWS-SELL-RATE)
                   ELSE
                       COMPUTE AMD-TO-COMP-AMT ROUNDED
                                             = (ZR190WS-TRAN-REVERSE-AMT
                                                / IFGRWS-SELL-RATE).

           ADD 1                               TO ZR190WS-DIST-SEQ.
           MOVE ZR190WS-DIST-SEQ               TO AMD-DIST-SEQ.
           MOVE ZR190WS-PROG-SEQ-NBR           TO AMD-PROG-SEQ-NBR.

GW0106     PERFORM 7000-ACCOUNT-DATA
GW0106     THRU    7000-END.

           PERFORM 820-STORE-ARDISTRIB.

           MOVE AMD-COMPANY                TO TXHST-COMPANY.
           MOVE AMD-TAX-CODE               TO TXHST-TAX-CODE.
           MOVE "AR"                       TO TXHST-SYSTEM-CD.
           MOVE AMD-CUSTOMER               TO TXHST-VEND-CUST.
           MOVE ACO-CUST-GROUP             TO DB-CUST-GROUP.
           MOVE AMD-CUSTOMER               TO DB-CUSTOMER.
           PERFORM 840-FIND-CUDSET1.
           IF (CUSTDESC-FOUND)
               MOVE CUD-TAX-ID             TO TXHST-TAX-ID-NBR
               MOVE CUD-CITY               TO TXHST-CITY
               MOVE CUD-STATE              TO TXHST-STATE
               MOVE CUD-ZIP                TO TXHST-ZIP
           ELSE
               MOVE SPACES                 TO TXHST-TAX-ID-NBR
                                              TXHST-CITY
                                              TXHST-STATE
                                              TXHST-ZIP.

           MOVE ACO-CITY                   TO TXHST-FROM-CITY.
           MOVE ACO-STATE                  TO TXHST-FROM-STATE.
           MOVE ACO-ZIP                    TO TXHST-FROM-ZIP.
           MOVE AMD-INVOICE                TO TXHST-INVOICE
                                              TXHST-VOUCHER-NBR.
           MOVE AMD-ACCT-UNIT              TO TXHST-TAX-ACCT-UNIT.
           MOVE AMD-ACCOUNT                TO TXHST-TAX-ACCOUNT.
           MOVE AMD-SUB-ACCT               TO TXHST-TAX-SUB-ACCT.
           MOVE CUD-NAME                   TO TXHST-NAME.
           MOVE ARA-GL-DATE                TO TXHST-TAX-PNT-DATE.
           MOVE ARH-TRANS-DATE             TO TXHST-INVOICE-DTE.
           MOVE AMD-GL-DATE                TO TXHST-POST-DATE.
           MOVE AMD-ORIG-CURRENCY          TO TXHST-TRAN-CURRENCY.
           MOVE AMD-ORIG-ND                TO TXHST-TRAN-ND.
           MOVE AMD-PROCESS-LEVEL          TO TXHST-PROC-LEVEL.

           IF (TXCAL-TAX-TYPE NOT = "M")
               MOVE TXCAL-T-TAX-RATE   (1) TO TXHST-TAX-RATE
               MOVE TXCAL-T-ACCRUAL-FL (1) TO TXHST-ACCRUAL-FL
           ELSE
               IF (TXTXC-ACCT-BY-CODE = "Y")
                   INITIALIZE TXTAC70WS
                   MOVE "I"                TO TXTAC-FC
                   MOVE TXTXC-COMPANY      TO TXTAC-COMPANY
                   MOVE AMD-TAX-CODE       TO TXTAC-TAX-CODE
                   MOVE "EDIT"             TO TXTAC-FUNCTION-LABEL
                   PERFORM 2000-TXTAC-OBJECT-70
                   MOVE TXTAC-ACCRUAL-FL   TO TXHST-ACCRUAL-FL
               ELSE
                   MOVE TXTXC-ACCRUAL-FL   TO TXHST-ACCRUAL-FL
               END-IF
               COMPUTE TXHST-TAX-RATE ROUNDED = AMD-ORIG-AMT
                                              / AMD-ORIG-TAXABLE
           END-IF.

           MOVE AMD-COMPANY            TO DB-COMPANY.
           MOVE AMD-CUSTOMER           TO DB-CUSTOMER.
           PERFORM 840-FIND-ACMSET1.
       
           MOVE "O"                        TO TXHST-SOURCE.
           MOVE ACM-VAT-REG-NBR            TO TXHST-VAT-REG-NBR. 
           MOVE ACM-VAT-REG-CTRY           TO TXHST-VAT-REG-CTRY.
           IF (AMD-TRANS-TYPE              = "C")
               MOVE "C"                    TO TXHST-INV-CRD-IND
           ELSE
               MOVE "I"                    TO TXHST-INV-CRD-IND.

           MOVE AMD-ORIG-AMT               TO TXHST-TRAN-TAX-AMT.

      *--- IF A TAX CODE WITH A TAX RATE OF 0% IS USED, THE AMD-ORIG-AMT
      *--- WILL BE ZERO.  THEREFORE THE AMD-ORIG-TAXABLE MUST BE USED
           IF  (AMD-ORIG-AMT            = ZEROES)
                MOVE ZR190WS-AMD-ORIG-TAXABLE TO ZR190WS-CHK-AMT-SIGN
           ELSE
                MOVE AMD-ORIG-AMT             TO ZR190WS-CHK-AMT-SIGN
           END-IF.

           IF (AMD-TRANS-TYPE                     NOT = "C")
               IF (ZR190WS-CHK-AMT-SIGN           > ZEROES)
                   MOVE ZR190WS-ARH-ORIG-AMT      TO TXHST-TRAN-INV-AMT
                   MOVE ZR190WS-AMD-ORIG-TAXABLE  TO TXHST-TRAN-TAXABLE
               ELSE
                   COMPUTE TXHST-TRAN-INV-AMT     = ZR190WS-ARH-ORIG-AMT
                                                    * NEGATIVE-ONE
                   MOVE ZR190WS-AMD-ORIG-TAXABLE  TO TXHST-TRAN-TAXABLE
               END-IF
           ELSE
               IF (ZR190WS-CHK-AMT-SIGN           > ZEROES)
                   MOVE ARH-ORIG-AMT              TO TXHST-TRAN-INV-AMT
                   MOVE ZR190WS-AMD-ORIG-TAXABLE  TO TXHST-TRAN-TAXABLE
               ELSE
                   COMPUTE TXHST-TRAN-INV-AMT     = ARH-ORIG-AMT
                                                    * NEGATIVE-ONE
                   COMPUTE TXHST-TRAN-TAXABLE     =
                                                ZR190WS-AMD-ORIG-TAXABLE
                                                    * NEGATIVE-ONE
               END-IF
           END-IF.

           MOVE "O"                            TO TXHST-TYPE.
           PERFORM 5000-CREATE-TAX-HISTORY-70.

           PERFORM 860-FIND-NEXT-AMDSET6.

       5000-END.
      ******************************************************************
       6000-PROG-SEQ.
      ******************************************************************

           IF (ZR190WS-PROG-SEQ-NBR  = 9999999)
               MOVE 1                      TO ZR190WS-PROG-SEQ-NBR
           ELSE
               ADD 1                       TO ZR190WS-PROG-SEQ-NBR.


       6000-END.
GW0106******************************************************************
GW0106 7000-ACCOUNT-DATA.
GW0106******************************************************************
GW0106
GW0106     IF  (AMD-ACCT-UNIT = "1010")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101901"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF  (AMD-ACCT-UNIT = "1010")
GW0106     AND (AMD-ACCOUNT = 50035)
GW0106        MOVE "101901"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "2010")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101902"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "3010")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101903"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "4010")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101904"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "4040")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101907"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "4050")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101908"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "4060")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101909"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "5010")
GW0106     AND (AMD-ACCOUNT = 50010)
GW0106        MOVE "101905"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
FP5751     IF (AMD-ACCT-UNIT = "6010")
FP5751     AND (AMD-ACCOUNT = 50301)
FP5751        MOVE "101906"                TO AMD-ACCT-UNIT
FP5751        MOVE 2000                    TO AMD-GL-COMPANY
FP5751     ELSE
GW0106     IF (AMD-ACCT-UNIT = "9999")
GW0106     AND (AMD-ACCOUNT = 13021 OR 13053 OR 20301 OR 10030
GW0106           OR 13050)
GW0106        MOVE "999999"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "1001" OR "2001" OR "3001" OR "6001")
GW0106     AND (AMD-ACCOUNT = 20045)
GW0106        MOVE "101001"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "1010" OR "2010" OR "3010" OR "6010")
GW0106     AND (AMD-ACCOUNT = 60160)
GW0106        MOVE "101010"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "1001" OR "2001" OR "3001" OR "6001")
GW0106     AND (AMD-ACCOUNT = 20154)
GW0106        MOVE "101001"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0106     ELSE
GW0106     IF (AMD-ACCT-UNIT = "1001" OR "2001" OR "3001" OR "6001")
GW0106     AND (AMD-ACCOUNT = 20164)
GW0106        MOVE "101001"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
GW0100     ELSE
GW7/06     IF (AMD-ACCT-UNIT = "2010")
GW0106     AND (AMD-ACCOUNT = 50035)
GW0106        MOVE "101902"                TO AMD-ACCT-UNIT
GW0106        MOVE 2000                    TO AMD-GL-COMPANY
           ELSE
           IF (AMD-ACCT-UNIT = "98001")
SB0612     AND (AMD-ACCOUNT = 20018)
SB0612        MOVE "101001"                TO AMD-ACCT-UNIT
SB0612        MOVE 2000                    TO AMD-GL-COMPANY
           ELSE
           IF (AMD-ACCT-UNIT = "98001")
SB0512     AND (AMD-ACCOUNT = 20019)
SB0512        MOVE "101001"                TO AMD-ACCT-UNIT
SB0512        MOVE 2000                    TO AMD-GL-COMPANY
           END-IF.
GW0106
GW0106 7000-END.
      ******************************************************************
       1000-END.
      ******************************************************************
      ******************************************************************
       8000-CREATE-WZR190A              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF1-COMPANY
                                          WF1-CR-COMPANY
                                          WF1-GL-DATE
                                          WF1-APP-SEQ
                                          WF1-APPLD-AMT
                                          WF1-PAYMENT-SEQ
                                          WF1-ORIG-APP-AMT
                                          WF1-ORIG-ND     
                                          WF1-BATCH-NBR
                                          WF1-CR-APP-AMT.

           MOVE SPACES                 TO WF1-OFFSET-CODE
                                          WF1-CUSTOMER
                                          WF1-TRANS-TYPE
                                          WF1-INVOICE
                                          WF1-DOCUMENT-NBR
                                          WF1-APP-CURR-CD.

           MOVE WS-TRUE                TO ARWS-WZR190A-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190A           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190A-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190A               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190A-CREATED)
               WRITE WZR190A-REC        INVALID KEY
                   MOVE WF1-COMPANY         TO ZR190WS-WF1-COMPANY
                   MOVE WF1-CR-COMPANY      TO ZR190WS-WF1-CR-COMPANY
                   MOVE WF1-OFFSET-CODE     TO ZR190WS-WF1-OFFSET-CODE
                   MOVE WF1-GL-DATE         TO ZR190WS-WF1-GL-DATE
                   MOVE WF1-APP-CURR-CD     TO ZR190WS-WF1-APP-CURR-CD
                   MOVE ZR190WS-WF1-REC-KEY TO CRT-ERR-VAR1
                   MOVE 404                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190A-CREATED)
               REWRITE WZR190A-REC      INVALID KEY
                   MOVE WF1-COMPANY         TO ZR190WS-WF1-COMPANY
                   MOVE WF1-CR-COMPANY      TO ZR190WS-WF1-CR-COMPANY
                   MOVE WF1-OFFSET-CODE     TO ZR190WS-WF1-OFFSET-CODE
                   MOVE WF1-GL-DATE         TO ZR190WS-WF1-GL-DATE
                   MOVE WF1-APP-CURR-CD     TO ZR190WS-WF1-APP-CURR-CD
                   MOVE ZR190WS-WF1-REC-KEY TO CRT-ERR-VAR1
                   MOVE 404                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190A-CREATED-SW.

      ******************************************************************
       8400-READ-WZR190A               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190A-SW.

           READ WZR190A-FILE            KEY WF1-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190A-SW.

      ******************************************************************
       8500-READ-NLT-WZR190A           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190A-SW.

           START WZR190A-FILE           KEY NOT < WF1-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190A-SW.

           IF (WZR190A-FOUND)
               PERFORM 8600-READ-NEXT-WZR190A.

      ******************************************************************
       8600-READ-NEXT-WZR190A          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190A-SW.

           READ WZR190A-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190A-SW.


      ******************************************************************
       8000-CREATE-WZR190B              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF2-COMPANY
                                          WF2-GL-DATE
                                          WF2-APPLD-AMT
                                          WF2-ORIG-ND     
                                          WF2-PAYMENT-SEQ
                                          WF2-APP-SEQ
                                          WF2-BATCH-NBR
                                          WF2-ORIG-APP-AMT.

           MOVE SPACES                 TO WF2-PROCESS-LEVEL
                                          WF2-AR-CODE
                                          WF2-CUSTOMER
                                          WF2-TRANS-TYPE
                                          WF2-INVOICE
                                          WF2-DOCUMENT-NBR
                                          WF2-APP-CURR-CD.

           MOVE WS-TRUE                TO ARWS-WZR190B-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190B           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190B-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190B               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190B-CREATED)
               WRITE WZR190B-REC        INVALID KEY
                   MOVE WF2-COMPANY         TO ZR190WS-WF2-COMPANY
                   MOVE WF2-PROCESS-LEVEL   TO ZR190WS-WF2-PROCESS-LEVEL
                   MOVE WF2-AR-CODE         TO ZR190WS-WF2-AR-CODE
                   MOVE WF2-GL-DATE         TO ZR190WS-WF2-GL-DATE
                   MOVE WF2-APP-CURR-CD     TO ZR190WS-WF2-APP-CURR-CD
                   MOVE ZR190WS-WF2-REC-KEY TO CRT-ERR-VAR1
                   MOVE 405                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190B-CREATED)
               REWRITE WZR190B-REC      INVALID KEY
                   MOVE WF2-COMPANY         TO ZR190WS-WF2-COMPANY
                   MOVE WF2-PROCESS-LEVEL   TO ZR190WS-WF2-PROCESS-LEVEL
                   MOVE WF2-AR-CODE         TO ZR190WS-WF2-AR-CODE
                   MOVE WF2-GL-DATE         TO ZR190WS-WF2-GL-DATE
                   MOVE WF2-APP-CURR-CD     TO ZR190WS-WF2-APP-CURR-CD
                   MOVE ZR190WS-WF2-REC-KEY TO CRT-ERR-VAR1
                   MOVE 405                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190B-CREATED-SW.

      ******************************************************************
       8400-READ-WZR190B               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190B-SW.

           READ WZR190B-FILE            KEY WF2-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190B-SW.

      ******************************************************************
       8500-READ-NLT-WZR190B           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190B-SW.

           START WZR190B-FILE           KEY NOT < WF2-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190B-SW.

           IF (WZR190B-FOUND)
               PERFORM 8600-READ-NEXT-WZR190B.

      ******************************************************************
       8600-READ-NEXT-WZR190B          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190B-SW.

           READ WZR190B-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190B-SW.


      ******************************************************************
       8000-CREATE-WZR190C              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF3-COMPANY
                                          WF3-CR-COMPANY
                                          WF3-GL-DATE
                                          WF3-APPLD-AMT
                                          WF3-ORIG-APP-AMT
                                          WF3-ORIG-ND     
                                          WF3-APP-SEQ
                                          WF3-PAYMENT-SEQ
                                          WF3-CR-APP-AMT.

           MOVE SPACES                 TO WF3-OFFSET-CODE
                                          WF3-TRANS-TYPE
                                          WF3-INVOICE
                                          WF3-DOCUMENT-NBR
                                          WF3-APP-CURR-CD.

           MOVE WS-TRUE                TO ARWS-WZR190C-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190C           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190C-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190C               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190C-CREATED)
               WRITE WZR190C-REC        INVALID KEY
                   MOVE WF3-COMPANY         TO ZR190WS-WF3-COMPANY
                   MOVE WF3-CR-COMPANY      TO ZR190WS-WF3-CR-COMPANY
                   MOVE WF3-OFFSET-CODE     TO ZR190WS-WF3-OFFSET-CODE
                   MOVE WF3-GL-DATE         TO ZR190WS-WF3-GL-DATE
                   MOVE WF3-APP-CURR-CD     TO ZR190WS-WF3-APP-CURR-CD
                   MOVE ZR190WS-WF3-REC-KEY TO CRT-ERR-VAR1
                   MOVE 406                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190C-CREATED)
               REWRITE WZR190C-REC      INVALID KEY
                   MOVE WF3-COMPANY         TO ZR190WS-WF3-COMPANY
                   MOVE WF3-CR-COMPANY      TO ZR190WS-WF3-CR-COMPANY
                   MOVE WF3-OFFSET-CODE     TO ZR190WS-WF3-OFFSET-CODE
                   MOVE WF3-GL-DATE         TO ZR190WS-WF3-GL-DATE
                   MOVE WF3-APP-CURR-CD     TO ZR190WS-WF3-APP-CURR-CD
                   MOVE ZR190WS-WF3-REC-KEY TO CRT-ERR-VAR1
                   MOVE 406                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190C-CREATED-SW.

      ******************************************************************
       8400-READ-WZR190C               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190C-SW.

           READ WZR190C-FILE            KEY WF3-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190C-SW.

      ******************************************************************
       8500-READ-NLT-WZR190C           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190C-SW.

           START WZR190C-FILE           KEY NOT < WF3-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190C-SW.

           IF (WZR190C-FOUND)
               PERFORM 8600-READ-NEXT-WZR190C.

      ******************************************************************
       8600-READ-NEXT-WZR190C          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190C-SW.

           READ WZR190C-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190C-SW.


      ******************************************************************
       8000-CREATE-WZR190D              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF4-COMPANY
                                          WF4-GL-DATE
                                          WF4-APPLD-AMT
                                          WF4-ORIG-ND     
                                          WF4-PAYMENT-SEQ
                                          WF4-APP-SEQ
                                          WF4-ORIG-APP-AMT.

           MOVE SPACES                 TO WF4-PROCESS-LEVEL
                                          WF4-TRANS-TYPE
                                          WF4-INVOICE
                                          WF4-AR-CODE
                                          WF4-DOCUMENT-NBR
                                          WF4-APP-CURR-CD.

           MOVE WS-TRUE                TO ARWS-WZR190D-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190D           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190D-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190D               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190D-CREATED)
               WRITE WZR190D-REC        INVALID KEY
                   MOVE WF4-COMPANY         TO ZR190WS-WF4-COMPANY
                   MOVE WF4-PROCESS-LEVEL   TO ZR190WS-WF4-PROCESS-LEVEL
                   MOVE WF4-AR-CODE         TO ZR190WS-WF4-AR-CODE
                   MOVE WF4-GL-DATE         TO ZR190WS-WF4-GL-DATE
                   MOVE WF4-APP-CURR-CD     TO ZR190WS-WF4-APP-CURR-CD
                   MOVE ZR190WS-WF4-REC-KEY TO CRT-ERR-VAR1
                   MOVE 407                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190D-CREATED)
               REWRITE WZR190D-REC      INVALID KEY
                   MOVE WF4-COMPANY         TO ZR190WS-WF4-COMPANY
                   MOVE WF4-PROCESS-LEVEL   TO ZR190WS-WF4-PROCESS-LEVEL
                   MOVE WF4-AR-CODE         TO ZR190WS-WF4-AR-CODE
                   MOVE WF4-GL-DATE         TO ZR190WS-WF4-GL-DATE
                   MOVE WF4-APP-CURR-CD     TO ZR190WS-WF4-APP-CURR-CD
                   MOVE ZR190WS-WF4-REC-KEY TO CRT-ERR-VAR1
                   MOVE 407                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190D-CREATED-SW.

      ******************************************************************
       8400-READ-WZR190D               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190D-SW.

           READ WZR190D-FILE            KEY WF4-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190D-SW.

      ******************************************************************
       8500-READ-NLT-WZR190D           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190D-SW.

           START WZR190D-FILE           KEY NOT < WF4-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190D-SW.

           IF (WZR190D-FOUND)
               PERFORM 8600-READ-NEXT-WZR190D.

      ******************************************************************
       8600-READ-NEXT-WZR190D          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190D-SW.

           READ WZR190D-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190D-SW.


      ******************************************************************
       8000-CREATE-WZR190E              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF5-COMPANY
                                          WF5-CR-COMPANY
                                          WF5-CR-BATCH
                                          WF5-GL-DATE
                                          WF5-ORIG-RATE
                                          WF5-ORIG-ADJ-AMT
                                          WF5-TRAN-AMT
                                          WF5-ORIG-ND
                                          WF5-GROUP-RATE.

           MOVE SPACES                 TO WF5-CR-TYPE
                                          WF5-CR-NBR
                                          WF5-CR-CUSTOMER
                                          WF5-PROCESS-LEVEL
                                          WF5-ORIG-CURRENCY
                                          WF5-CURR-MUDV    
                                          WF5-DOCUMENT-NBR
                                          WF5-GROUP-MUDV
                                          WF5-ACTIVITY
                                          WF5-ACCT-CATEGORY.
           MOVE WS-TRUE                TO ARWS-WZR190E-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190E           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190E-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190E               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190E-CREATED)
               WRITE WZR190E-REC        INVALID KEY
                   MOVE WF5-COMPANY         TO ZR190WS-WF5-COMPANY
                   MOVE WF5-CR-COMPANY      TO ZR190WS-WF5-CR-COMPANY
                   MOVE WF5-CR-BATCH        TO ZR190WS-WF5-CR-BATCH
                   MOVE WF5-CR-TYPE         TO ZR190WS-WF5-CR-TYPE
                   MOVE WF5-CR-NBR          TO ZR190WS-WF5-CR-NBR
                   MOVE WF5-CR-CUSTOMER     TO ZR190WS-WF5-CR-CUSTOMER
                   MOVE WF5-GL-DATE         TO ZR190WS-WF5-GL-DATE
                   MOVE ZR190WS-WF5-REC-KEY TO CRT-ERR-VAR1
                   MOVE 408                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190E-CREATED)
               REWRITE WZR190E-REC      INVALID KEY
                   MOVE WF5-COMPANY         TO ZR190WS-WF5-COMPANY
                   MOVE WF5-CR-COMPANY      TO ZR190WS-WF5-CR-COMPANY
                   MOVE WF5-CR-BATCH        TO ZR190WS-WF5-CR-BATCH
                   MOVE WF5-CR-TYPE         TO ZR190WS-WF5-CR-TYPE
                   MOVE WF5-CR-NBR          TO ZR190WS-WF5-CR-NBR
                   MOVE WF5-CR-CUSTOMER     TO ZR190WS-WF5-CR-CUSTOMER
                   MOVE WF5-GL-DATE         TO ZR190WS-WF5-GL-DATE
                   MOVE ZR190WS-WF5-REC-KEY TO CRT-ERR-VAR1
                   MOVE 408                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190E-CREATED-SW.

      ******************************************************************
       8400-READ-WZR190E               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190E-SW.

           READ WZR190E-FILE            KEY WF5-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190E-SW.

      ******************************************************************
       8500-READ-NLT-WZR190E           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190E-SW.

           START WZR190E-FILE           KEY NOT < WF5-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190E-SW.

           IF (WZR190E-FOUND)
               PERFORM 8600-READ-NEXT-WZR190E.

      ******************************************************************
       8600-READ-NEXT-WZR190E          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190E-SW.

           READ WZR190E-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190E-SW.


      ******************************************************************
       8000-CREATE-WZR190F              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF6-COMPANY
                                          WF6-ORIG-AMT
                                          WF6-TRAN-AMT
                                          WF6-ORIG-ND.

           MOVE SPACES                 TO WF6-TRANS-TYPE
                                          WF6-INVOICE
                                          WF6-CB-TYPE
                                          WF6-REASON-CODE
                                          WF6-DESC
                                          WF6-XREF-TYPE    
                                          WF6-XREF-NBR  
                                          WF6-CR-TYPE
                                          WF6-CR-NBR  
                                          WF6-CUSTOMER
                                          WF6-ORIG-CURRENCY
                                          WF6-ACTIVITY
                                          WF6-ACCT-CATEGORY.
           MOVE WS-TRUE                TO ARWS-WZR190F-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190F           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190F-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190F               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190F-CREATED)
               WRITE WZR190F-REC        INVALID KEY
                   MOVE WF6-COMPANY         TO ZR190WS-WF6-COMPANY
                   MOVE WF6-TRANS-TYPE      TO ZR190WS-WF6-TRANS-TYPE
                   MOVE WF6-INVOICE         TO ZR190WS-WF6-INVOICE
                   MOVE ZR190WS-WF6-REC-KEY TO CRT-ERR-VAR1
                   MOVE 409                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190F-CREATED)
               REWRITE WZR190F-REC      INVALID KEY
                   MOVE WF6-COMPANY         TO ZR190WS-WF6-COMPANY
                   MOVE WF6-TRANS-TYPE      TO ZR190WS-WF6-TRANS-TYPE
                   MOVE WF6-INVOICE         TO ZR190WS-WF6-INVOICE
                   MOVE ZR190WS-WF6-REC-KEY TO CRT-ERR-VAR1
                   MOVE 409                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190F-CREATED-SW.

      ******************************************************************
       8400-READ-WZR190F               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190F-SW.

           READ WZR190F-FILE            KEY WF6-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190F-SW.

      ******************************************************************
       8500-READ-NLT-WZR190F           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190F-SW.

           START WZR190F-FILE           KEY NOT < WF6-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190F-SW.

           IF (WZR190F-FOUND)
               PERFORM 8600-READ-NEXT-WZR190F.

      ******************************************************************
       8600-READ-NEXT-WZR190F          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190F-SW.

           READ WZR190F-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190F-SW.


      ******************************************************************
       8000-CREATE-WZR190G              SECTION.
      ******************************************************************
       8000-START.

           MOVE ZEROS                  TO WF7-COMPANY
                                          WF7-CR-COMPANY
                                          WF7-CR-BATCH
                                          WF7-SEQ-NBR
                                          WF7-GL-DATE
                                          WF7-ORIG-ND.

           MOVE SPACES                 TO WF7-CR-TYPE
                                          WF7-CR-NBR
                                          WF7-CR-CUSTOMER
                                          WF7-REASON-CODE
                                          WF7-DESC
                                          WF7-XREF-TYPE    
                                          WF7-XREF-NBR  
                                          WF7-ORIG-CURRENCY.

           MOVE WS-TRUE                TO ARWS-WZR190G-CREATED-SW.

      ******************************************************************
       8100-RECREATE-WZR190G           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190G-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190G               SECTION.
      ******************************************************************
       8200-START.

           IF (WZR190G-CREATED)
               WRITE WZR190G-REC        INVALID KEY
                   MOVE WF7-COMPANY         TO ZR190WS-WF7-COMPANY
                   MOVE WF7-CR-COMPANY      TO ZR190WS-WF7-CR-COMPANY
                   MOVE WF7-CR-BATCH        TO ZR190WS-WF7-CR-BATCH
                   MOVE WF7-CR-TYPE         TO ZR190WS-WF7-CR-TYPE
                   MOVE WF7-CR-NBR          TO ZR190WS-WF7-CR-NBR
                   MOVE WF7-CR-CUSTOMER     TO ZR190WS-WF7-CR-CUSTOMER
                   MOVE WF7-GL-DATE         TO ZR190WS-WF7-GL-DATE
                   MOVE WF7-SEQ-NBR         TO ZR190WS-WF7-SEQ-NBR
                   MOVE ZR190WS-WF7-REC-KEY TO CRT-ERR-VAR1
                   MOVE 410                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           IF (NOT WZR190G-CREATED)
               REWRITE WZR190G-REC      INVALID KEY
                   MOVE WF7-COMPANY         TO ZR190WS-WF7-COMPANY
                   MOVE WF7-CR-COMPANY      TO ZR190WS-WF7-CR-COMPANY
                   MOVE WF7-CR-BATCH        TO ZR190WS-WF7-CR-BATCH
                   MOVE WF7-CR-TYPE         TO ZR190WS-WF7-CR-TYPE
                   MOVE WF7-CR-NBR          TO ZR190WS-WF7-CR-NBR
                   MOVE WF7-CR-CUSTOMER     TO ZR190WS-WF7-CR-CUSTOMER
                   MOVE WF7-GL-DATE         TO ZR190WS-WF7-GL-DATE
                   MOVE WF7-SEQ-NBR         TO ZR190WS-WF7-SEQ-NBR
                   MOVE ZR190WS-WF7-REC-KEY TO CRT-ERR-VAR1
                   MOVE 410                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.

           MOVE WS-FALSE               TO ARWS-WZR190G-CREATED-SW.


      ******************************************************************
       8400-READ-WZR190G               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190G-SW.

           READ WZR190G-FILE            KEY WF7-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190G-SW.

      ******************************************************************
       8500-READ-NLT-WZR190G           SECTION.
      ******************************************************************
       8500-START.

           MOVE WS-FALSE               TO ARWS-WZR190G-SW.

           START WZR190G-FILE           KEY NOT < WF7-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190G-SW.

           IF (WZR190G-FOUND)
               PERFORM 8600-READ-NEXT-WZR190G.

      ******************************************************************
       8600-READ-NEXT-WZR190G          SECTION.
      ******************************************************************
       8600-START.

           MOVE WS-FALSE               TO ARWS-WZR190G-SW.

           READ WZR190G-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190G-SW.

      ******************************************************************
       8000-CREATE-WZR190H              SECTION.
      ******************************************************************
       8000-START.
   
           MOVE ZEROS                  TO WF8-COMPANY
                                          WF8-CR-COMPANY
                                          WF8-GL-DATE
                                          WF8-PAYMENT-SEQ
                                          WF8-APP-SEQ
                                          WF8-TRAN-AMT
                                          WF8-ORIG-ND
                                          WF8-BATCH-NBR.
   
           MOVE SPACES                 TO WF8-OFFSET-CODE
                                          WF8-APP-CURR-CD
                                          WF8-TRANS-TYPE
                                          WF8-INVOICE
                                          WF8-AR-CODE
                                          WF8-CUSTOMER.
   
           MOVE WS-TRUE                TO ARWS-WZR190H-CREATED-SW.
   
      ******************************************************************
       8100-RECREATE-WZR190H           SECTION.
      ******************************************************************
       8100-START.

           MOVE WS-TRUE                TO ARWS-WZR190H-CREATED-SW.

      ******************************************************************
       8200-STORE-WZR190H               SECTION.
      ******************************************************************
       8200-START.
   
           IF (WZR190H-CREATED)
               WRITE WZR190H-REC        INVALID KEY
                   MOVE WF8-COMPANY         TO ZR190WS-WF8-COMPANY
                   MOVE WF8-CR-COMPANY      TO ZR190WS-WF8-CR-COMPANY
                   MOVE WF8-OFFSET-CODE     TO ZR190WS-WF8-OFFSET-CODE
                   MOVE WF8-GL-DATE         TO ZR190WS-WF8-GL-DATE
                   MOVE WF8-APP-CURR-CD     TO ZR190WS-WF8-APP-CURR-CD
                   MOVE WF8-TRANS-TYPE      TO ZR190WS-WF8-TRANS-TYPE
                   MOVE WF8-INVOICE         TO ZR190WS-WF8-INVOICE
                   MOVE WF8-PAYMENT-SEQ     TO ZR190WS-WF8-PAYMENT-SEQ
                   MOVE WF8-APP-SEQ         TO ZR190WS-WF8-APP-SEQ
                   MOVE ZR190WS-WF8-REC-KEY TO CRT-ERR-VAR1
                   MOVE 411                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.
   
           IF (NOT WZR190H-CREATED)
               REWRITE WZR190H-REC      INVALID KEY
                   MOVE WF8-COMPANY         TO ZR190WS-WF8-COMPANY
                   MOVE WF8-CR-COMPANY      TO ZR190WS-WF8-CR-COMPANY
                   MOVE WF8-OFFSET-CODE     TO ZR190WS-WF8-OFFSET-CODE
                   MOVE WF8-GL-DATE         TO ZR190WS-WF8-GL-DATE
                   MOVE WF8-APP-CURR-CD     TO ZR190WS-WF8-APP-CURR-CD
                   MOVE WF8-TRANS-TYPE      TO ZR190WS-WF8-TRANS-TYPE
                   MOVE WF8-INVOICE         TO ZR190WS-WF8-INVOICE
                   MOVE WF8-PAYMENT-SEQ     TO ZR190WS-WF8-PAYMENT-SEQ
                   MOVE WF8-APP-SEQ         TO ZR190WS-WF8-APP-SEQ
                   MOVE ZR190WS-WF8-REC-KEY TO CRT-ERR-VAR1
                   MOVE 411                 TO CRT-ERROR-NBR
                   PERFORM 780-DISPLAY-MSG.
   
           MOVE WS-FALSE               TO ARWS-WZR190H-CREATED-SW.
   
   
      ******************************************************************
       8400-READ-WZR190H               SECTION.
      ******************************************************************
       8400-START.

           MOVE WS-FALSE               TO ARWS-WZR190H-SW.

           READ WZR190H-FILE            KEY WF8-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190H-SW.

      ******************************************************************
       8500-READ-NLT-WZR190H           SECTION.
      ******************************************************************
       8500-START.
   
           MOVE WS-FALSE               TO ARWS-WZR190H-SW.
   
           START WZR190H-FILE           KEY NOT < WF8-REC-KEY
               INVALID KEY
                   MOVE WS-TRUE        TO ARWS-WZR190H-SW.
   
           IF (WZR190H-FOUND)
               PERFORM 8600-READ-NEXT-WZR190H.
   
      ******************************************************************
       8600-READ-NEXT-WZR190H          SECTION.
      ******************************************************************
       8600-START.
   
           MOVE WS-FALSE               TO ARWS-WZR190H-SW.
   
           READ WZR190H-FILE NEXT RECORD
               AT END
                   MOVE WS-TRUE        TO ARWS-WZR190H-SW.

      ******************************************************************
       9000-SUBSTRING-FILE-NAME         SECTION.
      ******************************************************************
       9000-START.

           MOVE WS-TMP-FILE            TO ZR190WS-TEMP-FILE-NAME.

           PERFORM 
               VARYING ZR190WS-I9 FROM 100 BY NEGATIVE-ONE
               UNTIL  (ZR190WS-I9                     < 1) 
               OR     (ZR190WS-FILE-CHAR (ZR190WS-I9) = "/")
                   CONTINUE
           END-PERFORM.

           MOVE WS-TMP-FILE (01:ZR190WS-I9) TO ZR190WS-PATH-NAME.
           ADD  1                           TO ZR190WS-I9.
           MOVE WS-TMP-FILE (ZR190WS-I9:99) TO ZR190WS-FILE-NAME.

      ******************************************************************
       9000-STRING-FILE-NAME            SECTION.
      ******************************************************************
       9000-START.

           STRING ZR190WS-PATH-NAME DELIMITED BY " "
                  ZR190WS-FILE-NAME DELIMITED BY " "
                                            INTO ZR190WS-TEMP-FILE-NAME.

      ******************************************************************
       1010-END.
      ******************************************************************
      ******************************************************************
      *
      *   600-BEGIN-BROADCAST
      *   605-END-BROADCAST
      *   610-BEG-ELEMENT-TAG
      *   615-END-ELEMENT-TAG
      *
      *   These routines are used for Channels.  Service must be defined
      *   in WF07.1 before running program.
      *
      *   Input:
      *           ZR190WS-DO-RPT1-BROADCAST    (Y/N)
      *           ZR190WS-PRINT-FILE-1  (Base)
      *           ZR190WS-ELEMENT-VALUE (Element Value)
      *           ZR190WS-ELEMENT-TYPE  (Element)
      *
      *   Output: none
      *
      ******************************************************************
       600-BEGIN-BROADCAST         SECTION 72.
      ******************************************************************
       600-START.
      *** THE FOLLOWING LINES OF CODE MUST BE PERFORMED ONCE PER 
      *** EXECUTION OF THE PROGRAM PRIOR TO ANY WRITING OF THE PRINTFILE
      *** BEING PUBLISHED.

           INITIALIZE WFAPI-INPUT.
           INITIALIZE WFAPI-OUTPUT.
           MOVE WFCHWS-SERVICE-NAME    TO WFAPI-I-SERVICE.
           MOVE CRT-PROGRAM-CODE       TO WFAPI-I-CRITERION-1.
           MOVE CRT-JOB-USER           TO WFAPI-I-CRITERION-2.
           MOVE CRT-JOB-NAME           TO WFAPI-I-CRITERION-3.
           PERFORM 1000-WF-SERVICE.
           IF (WFAPI-O-RETURN-CODE = ZEROS)
              INITIALIZE WFAPI-INPUT
              MOVE WFAPI-O-SERVICE     TO WFAPI-I-SERVICE
              MOVE WFAPI-O-AGENT       TO WFAPI-I-AGENT
              MOVE WFAPI-O-PROCEDURE   TO WFAPI-I-PROCEDURE
              STRING CRT-PROGRAM-CODE "-"
                     CRT-JOB-USER     "-"
                     CRT-JOB-NAME     DELIMITED BY SIZE
                                      INTO WFAPI-I-WORK-TITLE
              INITIALIZE WFAPI-OUTPUT
              PERFORM 1000-WF-CREATE-SETUP.

       600-SECTION-END.
      ****************************************************************
       605-END-BROADCAST             SECTION 72.
      ****************************************************************
       605-START.
      
      *** THE FOLLOWING LINES OF CODE MUST BE PERFORMED ONCE FOR EACH
      *** PRINTFILE TO BE PUBLISHED.

           IF  (WFAPI-O-RETURN-CODE   NOT = ZEROS)
               GO TO 605-SECTION-END.

           IF (ZR190WS-DO-RPT1-BROADCAST  = "Y")
              INITIALIZE WFAPI-INPUT
              MOVE WFAPI-O-WORKUNIT        TO WFAPI-I-WORKUNIT
              MOVE ZR190WS-PRINT-FILE-1    TO WFAPI-I-FILE-NAME
              MOVE 500                     TO CRT-MSG-NBR
              MOVE "GLCHN"                 TO CRT-ERROR-CAT
              PERFORM 790-GET-MSG
              MOVE CRT-MESSAGE             TO WFAPI-I-DESCRIPTION
              MOVE "REPORT"                TO WFAPI-I-DOCUMENT-ID
              INITIALIZE WFAPI-OUTPUT
              PERFORM 1000-WF-ADD-FOLDER-SETUP
           END-IF.

      *** THE FOLLOWING LINES OF CODE MUST BE PERFORMED ONCE PER 
      *** EXECUTION OF THE PROGRAM AFTER ALL WRITING OF THE PRINTFILES.
      *** THIS WILL WILL RELEASE THE REPORT(S) TO BE PUBLISHED.

           INITIALIZE WFAPI-INPUT.
           MOVE WFAPI-O-WORKUNIT           TO WFAPI-I-WORKUNIT.
           INITIALIZE WFAPI-OUTPUT.
           PERFORM 1000-WF-RELEASE-SETUP.

       605-SECTION-END.
      
      ****************************************************************
       610-BEG-ELEMENT-TAG          SECTION 72.
      ****************************************************************
       610-START.
      
      *** END TAG
      *** THE FOLLOWING CODE SHOULD BE INSERTED FOR EACH LEVEL BREAK BEIN
      *** USED TO BURST THE REPORT IN BROADCAST (THREE LEVEL MAXIMUM)
      *** PROVIDE THE ELEMENT NAME AND VALUE. 
      
           IF (WFAPI-O-RETURN-CODE    NOT = ZEROS)
               GO TO 610-SECTION-END.
      
           MOVE ZR190WS-ELEMENT-TYPE   TO CRT-MSG-NBR.
           MOVE "GLCHN"                TO CRT-ERROR-CAT.
           PERFORM 790-GET-MSG.
      
           MOVE CRT-MESSAGE            TO WFCHWS-ELEMENT.
           MOVE ZR190WS-ELEMENT-VALUE  TO WFCHWS-VALUE.
           MOVE WFCHWS-BEG-TAG         TO WFCHWS-TAG-NAME.
           MOVE WFCHWS-TAG-STRING      TO CHN1-TAG-LINE.
           
           IF (ZR190WS-DO-RPT1-BROADCAST  = "Y")
               MOVE BROADCAST-TAG-LINE-R1   TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP.
      
       610-SECTION-END.
      
      ****************************************************************
       615-END-ELEMENT-TAG           SECTION 72.
      ****************************************************************
       615-START.
      *** END TAG
      *** THE FOLLOWING CODE SHOULD BE INSERTED FOR EACH LEVEL BREAK BEIN
      *** USED TO BURST THE REPORT IN BROADCAST (THREE LEVEL MAXIMUM)
      *** PROVIDE THE ELEMENT NAME AND VALUE. 
      
           IF (WFAPI-O-RETURN-CODE    NOT = ZEROS)
               GO TO 615-SECTION-END.
      
           MOVE ZR190WS-ELEMENT-TYPE   TO CRT-MSG-NBR.
           MOVE "GLCHN"                TO CRT-ERROR-CAT.
           PERFORM 790-GET-MSG.
      
           MOVE CRT-MESSAGE            TO WFCHWS-ELEMENT.
           MOVE ZR190WS-ELEMENT-VALUE  TO WFCHWS-VALUE.
           MOVE WFCHWS-END-TAG         TO WFCHWS-TAG-NAME.
           MOVE WFCHWS-TAG-STRING      TO CHN1-TAG-LINE.
           
           IF (ZR190WS-DO-RPT1-BROADCAST  = "Y")
               MOVE BROADCAST-TAG-LINE-R1   TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP.
      
       615-SECTION-END.
      
