******* PA102PD 53 <3255981393>
      ******************************************************************
      *                            PA102PD                             *
      ******************************************************************
      *                                                                *
      *  JT#      TAG      DESCRIPTION                                 *
      *  ------   ------   ------------------------------------------  *
      *  263836 | J63836 | ENHANCEMENT TO ADD NEW EMPLIST REPORT FOR   *
      *         |        | EMPLOYEES ASSIGNED TO POSITION CODE THAT    *
      *         |        | WAS CHANGED BUT IS NOT UPDATED DUE TO END   *
      *         |        | DATE ON PA13.                               *
      *  ------   ------   ------------------------------------------  *
      *  333276 | J33276 | PA102 CREATION OF BN35 RECORDS              *
      *  ------   ------   ------------------------------------------  *
      *  431587 | J31587 | ADDED VALIDATION NOT TO INCLUDE RECORDS ON  *
      *         |        | REPORT WHEN PEP-END-DATE IS LESS THAN EFF   *
      *         |        | DATE                                        *
      *  ------   ------   ------------------------------------------  *
      *  436155 | J36155 | RETURNED COMMENTED CODE MADE FOR JT263836   *
      *  ------   ------   ------------------------------------------  *
      *  517585 | J17585 | ADDED CODE TO ENABLE LBI BURST REPORTING    *
      *  ------   ------   ------------------------------------------  *
      *  582034 | J82034 | CHECKED ON PERSACTYPE FOR UPDATE BENEFITS   *
      *         |        | DEFAULTING                                  *
      *  ------   ------   ------------------------------------------  *
      *  585363 | J85363 | PA102 NOT END DATING LEVEL 2 POSITION ON    *
      *         |        | EMPLOYEE                                    *
      *  ------   ------   ------------------------------------------  *
      * 1118754 | 118754 | Modify condition that prints the error      *
      *         |        | report that will separate the condition     *
      *         |        | added by JT-263836 and treat it as mandatory*
      *  ------   ------   ------------------------------------------  *
      * 1101470 | 101470 | PERSONNEL ACTION HISTORY SHOWS INCORRECT    *
      *         |        | REASON CODE AND "UPDATED USER" FOR A PA02   *
      *         |        | CHANGE THAT WAS CAPTURED BY PA100           *
      *  ------ | ------ | ------------------------------------------- *
      * 1111167 | 111167 | ADDED A CONDITION FOR ANNUAL HOURS CHANGES  *
      *         |        | FOR DECIMAL VALUES.                         *
      *  ------   ------   ------------------------------------------  *
      * 1189056 | 189056 | UPDATED PA102WS-NOUPDATES FLAG WHEN CHANGE  *
      *         |        | WAS DONE IN PERSACTION TABLE.               *
      *  ------   ------   ------------------------------------------  *
000010******************************************************************
000020*                                                                *
000030*The program is divided into 2 phases                            *
000040*                                                                *
000050*PHASE 1 : EDIT OF PARAMETERS                                    *
000060*                                                                *
000070*PHASE 2 : IF UPDATE OPTION IS SELECTED, PROGRAM WILL            *
000080*          UPDATE EMPLOYEES - EMPLOYEE AND PAEMPPOS              *
000090*          UPDATE REQUISITIONS - PAJOBREQ                        *
000100*          UPDATE PERSONNEL ACTIONS - PERSACTION                 *
000110*          UPDATE REQUISITIONS - PAJOBREQ                        *
000120*                                                                *
000130*          FOR UPDATE AND REPORT ONLY OPTION, REPORT WILL        *
000140*          BE CREATED                                            *
000150*                                                                *
000160******************************************************************
000170******************************************************************
000180 050-EDIT-PARAMETERS             SECTION 10.
000190******************************************************************
000200 050-START.
000210
           MOVE "Y"                         TO HREMP-BATCH-PROGRAM.

000220     MOVE PRM-COMPANY                 TO DB-COMPANY.
000230     MOVE SPACES                      TO DB-PROCESS-LEVEL.
000240     PERFORM 840-FIND-PRSSET1.
000250
000260     IF (PRSYSTEM-NOTFOUND)
000270         MOVE PRM-COMPANY             TO CRT-ERR-VAR1      
000280         MOVE WS-TRUE                 TO WS-PARAMETER-ERROR
000290         MOVE 100                     TO CRT-ERROR-NBR     
000300         PERFORM 780-PRINT-ERROR-MSG
000310         MOVE ZEROES                  TO CRT-ERROR-NBR
000320         GO TO 050-EDIT-PARAMETERS-END
000330     ELSE
000340         MOVE PRS-NAME                TO PA102WS-PRS-NAME
000350         IF (PRM-ACTION = SPACES)
000360             MOVE PRS-ACTION-CODE     TO PA102WS-ACTION
000370         ELSE
000380             MOVE PRM-ACTION          TO PA102WS-ACTION  
101470         END-IF
101470         IF (PRM-REASON1 = SPACES)
101470             MOVE PRS-REASON          TO PA102WS-SV-PRS-REASON
101470         END-IF
101470     END-IF.
000390       
000400     IF  (PRM-CURRENT       = "Y")
000410     AND (PRM-EFFECT-DATE   NOT = ZEROES)
000420         MOVE WS-TRUE                 TO WS-PARAMETER-ERROR
000430         MOVE 102                     TO CRT-ERROR-NBR
000440         PERFORM 780-PRINT-ERROR-MSG
000450         MOVE ZEROES                  TO CRT-ERROR-NBR
000460         GO TO 050-EDIT-PARAMETERS-END.
000470
000480     IF  (PRM-CURRENT        = "N")
000490     AND (PRM-EFFECT-DATE    = ZEROES)
000500         MOVE WS-TRUE                 TO WS-PARAMETER-ERROR
000510         MOVE 108                     TO CRT-ERROR-NBR
000520         PERFORM 780-PRINT-ERROR-MSG
000530         MOVE ZEROES                  TO CRT-ERROR-NBR
000540         GO TO 050-EDIT-PARAMETERS-END.
000550
000560     IF (PRM-CURRENT = "Y")
000570         MOVE WS-SYSTEM-DATE-YMD      TO PA102WS-PRM-EFFECT-DATE
000580     ELSE
000590         MOVE PRM-EFFECT-DATE         TO PA102WS-PRM-EFFECT-DATE.
000600
000610     IF (PRM-POSITION            NOT = SPACES)
000620         MOVE PRM-COMPANY             TO DB-COMPANY
000630         MOVE PRM-POSITION            TO DB-POSITION
P58562         MOVE POSSET2-POSITION        TO WS-DB-BEG-RNG
000640         MOVE PA102WS-PRM-EFFECT-DATE TO DB-EFFECT-DATE
P58562         MOVE ZEROES                  TO DBRNG-EFFECT-DATE
P58562         MOVE POSSET2-EFFECT-DATE     TO WS-DB-SUB-RNG
P58562         PERFORM 850-FIND-SUBRNG-POSSET2
000660         IF (PAPOSITION-NOTFOUND)
000690             MOVE PRM-POSITION TO CRT-ERR-VAR1
000700             MOVE 103                 TO CRT-ERROR-NBR
000710             MOVE WS-TRUE             TO WS-PARAMETER-ERROR
000720             PERFORM 780-PRINT-ERROR-MSG
000730             MOVE ZEROES              TO CRT-ERROR-NBR
000740             GO TO 050-EDIT-PARAMETERS-END
000750         ELSE
000760             MOVE POS-DESCRIPTION     TO PA102WS-POS-DESCRIPTION.
000770
000780     IF  (PRM-ACTION      = SPACES)
000790     AND (PRS-ACTION-CODE = SPACES)
000800         MOVE PRM-ACTION              TO CRT-ERR-VAR1
000810         MOVE 101                     TO CRT-ERROR-NBR
000820         MOVE WS-TRUE                 TO WS-PARAMETER-ERROR
000830         PERFORM 780-PRINT-ERROR-MSG
000840         MOVE ZEROES                  TO CRT-ERROR-NBR
000850         GO TO 050-EDIT-PARAMETERS-END.
000860
000870     IF (PRM-ACTION NOT = SPACES)
000880         MOVE PRM-ACTION              TO DB-ACTION-CODE
000890         PERFORM 840-FIND-PATSET1
000900         IF (PERSACTYPE-NOTFOUND)
000910             MOVE PRM-ACTION          TO CRT-ERR-VAR1
000920             MOVE 104                 TO CRT-ERROR-NBR
000930             MOVE WS-TRUE             TO WS-PARAMETER-ERROR
000940             PERFORM 780-PRINT-ERROR-MSG
000950             MOVE ZEROES              TO CRT-ERROR-NBR
000960             GO TO 050-EDIT-PARAMETERS-END.
000970
           IF (PRM-ACTION NOT = SPACES)
               IF (PAT-REQUIRE-REASON = 2)
                   IF (PRM-REASON1  = SPACES)
                   OR (PRM-REASON2  = SPACES)
                       MOVE 137                        TO CRT-ERROR-NBR
                       MOVE PAT-REQUIRE-REASON         TO CRT-ERR-VAR1
001060                 PERFORM 780-PRINT-ERROR-MSG
001080                 GO TO 050-EDIT-PARAMETERS-END
                   END-IF
               END-IF
               IF (PAT-REQUIRE-REASON = 1)
                   IF  (PRM-REASON1  = SPACES)
                   AND (PRM-REASON2  = SPACES)
                       MOVE 137                     TO CRT-ERROR-NBR
001060                 PERFORM 780-PRINT-ERROR-MSG
001080                 GO TO 050-EDIT-PARAMETERS-END
                   END-IF
               END-IF.

           SET PA102WS-NO-ACTION-REASON TO TRUE.

           MOVE PRM-COMPANY     TO DB-COMPANY.

           IF (PRM-ACTION NOT = SPACES)
               MOVE PRM-ACTION             TO DB-ACTION-CODE
049700         MOVE CRESET4-ACTION-CODE    TO WS-DB-BEG-RNG
               PERFORM 850-KFIND-BEGRNG-CRESET4
               IF (PAACTREAS-KFOUND)
                   SET PA102WS-ACTION-REASON TO TRUE.

           IF (PRM-ACTION NOT = SPACES)
050200         IF (PRM-REASON1 NOT = SPACES)
                   IF (PA102WS-ACTION-REASON)
                       MOVE PRM-ACTION      TO DB-ACTION-CODE
P64324                 MOVE PRM-REASON1     TO DB-ACT-REASON-CD
P64324                 PERFORM 840-FIND-CRESET4
P64324                 IF (PAACTREAS-NOTFOUND)
001030                    MOVE WS-TRUE            TO WS-PARAMETER-ERROR
001040                    MOVE 138                 TO CRT-ERROR-NBR
001050                    MOVE PRM-REASON1         TO CRT-ERR-VAR1
001060                    PERFORM 780-PRINT-ERROR-MSG
001070                    MOVE ZEROES              TO CRT-ERROR-NBR
001080                    GO TO 050-EDIT-PARAMETERS-END
001090                 END-IF
                   ELSE
                       MOVE PRM-REASON1          TO DB-ACT-REASON-CD
                       MOVE SPACES               TO DB-ACTION-CODE
                       PERFORM 840-FIND-CRESET3
050400                 IF (PAACTREAS-NOTFOUND)
                           MOVE 105                 TO CRT-ERROR-NBR
001060                     PERFORM 780-PRINT-ERROR-MSG
001070                     MOVE ZEROES              TO CRT-ERROR-NBR
001080                     GO TO 050-EDIT-PARAMETERS-END
                       END-IF
050800             END-IF
P64324             IF (CRE-ACTIVE-FLAG NOT = "1")
001110                 MOVE WS-TRUE           TO WS-PARAMETER-ERROR
001120                 MOVE 106               TO CRT-ERROR-NBR
001130                 MOVE PRM-REASON1       TO CRT-ERR-VAR1 
001140                 PERFORM 780-PRINT-ERROR-MSG
001150                 MOVE ZEROES            TO CRT-ERROR-NBR
001160                 GO TO 050-EDIT-PARAMETERS-END.
001170
           IF (PRM-ACTION NOT = SPACES)
050200         IF (PRM-REASON2 NOT = SPACES)
                   IF (PA102WS-ACTION-REASON)
                       MOVE PRM-ACTION      TO DB-ACTION-CODE
P64324                 MOVE PRM-REASON2     TO DB-ACT-REASON-CD
P64324                 PERFORM 840-FIND-CRESET4
P64324                 IF (PAACTREAS-NOTFOUND)
001030                    MOVE WS-TRUE            TO WS-PARAMETER-ERROR
001040                    MOVE 138                 TO CRT-ERROR-NBR
001050                    MOVE PRM-REASON2         TO CRT-ERR-VAR1
001060                    PERFORM 780-PRINT-ERROR-MSG
001070                    MOVE ZEROES              TO CRT-ERROR-NBR
001080                    GO TO 050-EDIT-PARAMETERS-END
001090                 END-IF
                   ELSE
                       MOVE PRM-REASON2          TO DB-ACT-REASON-CD
                       MOVE SPACES               TO DB-ACTION-CODE
                       PERFORM 840-FIND-CRESET3
050400                 IF (PAACTREAS-NOTFOUND)
                           MOVE 105                 TO CRT-ERROR-NBR
001060                     PERFORM 780-PRINT-ERROR-MSG
001070                     MOVE ZEROES              TO CRT-ERROR-NBR
001080                     GO TO 050-EDIT-PARAMETERS-END
                       END-IF
050800             END-IF
P64324             IF (CRE-ACTIVE-FLAG NOT = "1")
001110                 MOVE WS-TRUE           TO WS-PARAMETER-ERROR
001120                 MOVE 106               TO CRT-ERROR-NBR
001130                 MOVE PRM-REASON2       TO CRT-ERR-VAR1 
001140                 PERFORM 780-PRINT-ERROR-MSG
001150                 MOVE ZEROES            TO CRT-ERROR-NBR
001160                 GO TO 050-EDIT-PARAMETERS-END.
001170
J02157     IF  (PRM-PROCESS-LEVEL NOT = SPACES)
J02157     AND (PRM-PROC-GROUP    NOT = SPACES)
J02157         MOVE 142                    TO CRT-ERROR-NBR
J02157         PERFORM 780-PRINT-ERROR-MSG
J02157         GO TO 050-EDIT-PARAMETERS-END.
J02157     
J02157     IF   (PRM-POSITION      NOT = SPACES)
J02157     AND ((PRM-PROCESS-LEVEL NOT = SPACES)
J02157     OR   (PRM-PROC-GROUP    NOT = SPACES))
J02157         MOVE 143                    TO CRT-ERROR-NBR
J02157         PERFORM 780-PRINT-ERROR-MSG
J02157         GO TO 050-EDIT-PARAMETERS-END.
J02157     
J02157     IF  (PRM-PROCESS-LEVEL NOT = SPACES)
J02157         MOVE PRM-PROCESS-LEVEL          TO DB-PROCESS-LEVEL
J02157         PERFORM 840-FIND-PRSSET1
J02157         IF (PRSYSTEM-NOTFOUND)
J02157             MOVE 141                    TO CRT-ERROR-NBR
J02157             MOVE PRM-PROCESS-LEVEL      TO CRT-ERR-VAR1
J02157             PERFORM 780-PRINT-ERROR-MSG
J02157             GO TO 050-EDIT-PARAMETERS-END
J02157         ELSE
J02157             MOVE PRS-NAME               TO PRM-PRS1-NAME
J02157         END-IF
J02157     END-IF.
J02157 
J02157     IF  (PRM-PROC-GROUP NOT = SPACES)
J02157         MOVE PRM-COMPANY                TO DB-COMPANY
J02157         MOVE PRM-PROC-GROUP             TO DB-PROC-GROUP
J02157         MOVE PRPSET1-PROC-GROUP         TO WS-DB-BEG-RNG
J02157         PERFORM 850-FIND-BEGRNG-PRPSET1
J02157         IF (PRPROCGRP-NOTFOUND)
J02157             MOVE 140                    TO CRT-ERROR-NBR
J02157             MOVE PRM-PROC-GROUP         TO CRT-ERR-VAR1
J02157             PERFORM 780-PRINT-ERROR-MSG
J02157             GO TO 050-EDIT-PARAMETERS-END
J02157         ELSE
J02157             MOVE PRM-COMPANY            TO LPPL-IN-COMPANY
J02157             MOVE PRM-PROC-GROUP         TO LPPL-IN-PROC-GROUP
J02157             SET LPPL-BY-PROC-GROUP      TO TRUE
J02157             PERFORM 6000-BUILD-PL-WORKFILE
J02157             SET LPPLSECWRK-NOTFOUND     TO TRUE
J02157             MOVE SPACES                 TO LP1-REC-KEY.
 
001370******************************************************************
001380 050-EDIT-PARAMETERS-END.
001390******************************************************************
001400
001410******************************************************************
001420 100-PROGRAM-CONTROL             SECTION 25.
001430******************************************************************
001440 100-START.
001450
P78926     SET PA102-OBJ-ID-OPTIMIZE   TO TRUE.
001460     MOVE 051                         TO CRT-MSG-NBR.
001470     PERFORM 780-DISPLAY-MSG.
001480
001490     OPEN OUTPUT ERRORS-FILE.
           OPEN OUTPUT WARNING-FILE.
J63836     OPEN OUTPUT EMPLIST-FILE.
P58562     PERFORM 900-BUILD-TMP-FILE-NAME.
P58562     MOVE WS-TMP-FILE                TO WS-ACTIONS-FILE-NAME.
P58562     PERFORM 9800-OPEN-OUTPUT-ACTIONS.
P58562     PERFORM 9900-CLOSE-ACTIONS.
P58562     PERFORM 9810-OPEN-IO-ACTIONS.
001500
001510     IF (PRM-UPDATE = "Y")
001520         PERFORM 840-FIND-CKPSET1
001530         IF (CKPOINT-FOUND)
001540             MOVE CKP-RESTART-INFO    TO WS-REST-DATA
001550             IF (WS-REST-PHASE = "U")
001560                 MOVE WS-TRUE             TO PROGRAM-RESTARTING.
001570
001580     IF  (PRM-UPDATE = "Y")
001590     AND (WS-NOTRESTARTING)
001600         MOVE PRM-COMPANY             TO DB-COMPANY
001610         MOVE PRM-POSITION            TO DB-POSITION
001620         INITIALIZE                      DB-EMPLOYEE
001630                                         DB-REQUISITION
001640                                         DB-EFFECT-DATE
001650                                         DB-UPDATE-TYPE
001660         PERFORM 850-FIND-NLT-PPESET2
001670         IF  (PAPOSERR-FOUND)
001680         AND (PPE-COMPANY  = DB-COMPANY)
001690             IF (PRM-POSITION = SPACES)
001700                 PERFORM 910-AUDIT-BEGIN
001710                 PERFORM 500-CLEAN-UP
001720                     UNTIL (PAPOSERR-NOTFOUND)
001730                     OR    (PPE-COMPANY NOT = DB-COMPANY)
001740                 PERFORM 840-MODIFY-CKPSET1
001750                 INITIALIZE               WS-REST-DATA
001760                 MOVE "U"              TO WS-REST-PHASE
001770                 MOVE WS-REST-DATA     TO CKP-RESTART-INFO
001780                 PERFORM 820-STORE-CKPOINT
001790                 PERFORM 925-AUDIT-END
001800             ELSE
001810             IF  (PRM-POSITION   NOT = SPACES)
001820             AND (PPE-POSITION   = PRM-POSITION)
001830                 PERFORM 910-AUDIT-BEGIN
001840                 PERFORM 500-CLEAN-UP
001850                     UNTIL (PAPOSERR-NOTFOUND)
001860                     OR    (PPE-COMPANY  NOT = DB-COMPANY)
001870                     OR    (PPE-POSITION NOT = DB-POSITION)
001880                 PERFORM 840-MODIFY-CKPSET1
001890                 INITIALIZE               WS-REST-DATA
001900                 MOVE "U"              TO WS-REST-PHASE
001910                 MOVE WS-REST-DATA     TO CKP-RESTART-INFO
001920                 PERFORM 820-STORE-CKPOINT
001930                 PERFORM 925-AUDIT-END.
001940     
J17585     PERFORM 1000-OPEN-WORKFLOW-DB.
J17585     PERFORM 600-BEGIN-BROADCAST.
J17585     MOVE "Y"                    TO PRBRD-DO-BASE-BROADCAST.
J17585     MOVE PRM-PRINT-FILE         TO PRBRD-PRINT-FILE.
J17585
001950     PERFORM 1000-PROCESS-DATA.
J17585
J17585     IF (PRBRD-BROADCAST-ENABLED)
J17585         MOVE PRM-PRINT-FILE     TO PRBRD-PRINT-FILE
J17585         PERFORM 605-END-BROADCAST
J17585         PERFORM 620-RELEASE-BROADCAST
J17585     END-IF.
001960
           CLOSE ERRORS-FILE.
           CLOSE WARNING-FILE.
J63836     CLOSE EMPLIST-FILE.

001970 100-END.
001980      
001990******************************************************************
002000 500-CLEAN-UP                    SECTION 30.
002010******************************************************************
002020 500-START.
002030
002040     MOVE PPE-POSITION            TO WS-SAVE-POSITION.
002050     MOVE PPE-EFFECT-DATE         TO WS-SAVE-EFFECT-DATE.
002060
002070     SET PA102WS-DELETE           TO TRUE.
002080
002090     PERFORM 520-CLEAN-UP-PAPOSERR   
002100     THRU    520-END
002110         UNTIL (PAPOSERR-NOTFOUND)
002120         OR    (PPE-POSITION    NOT = WS-SAVE-POSITION)
002130         OR    (PPE-EFFECT-DATE NOT = WS-SAVE-EFFECT-DATE).
002140
002150*** REMOVE ALL MATCHING DATA TYPE PAPOSCHG IF NO PAPOSERR OR ONLY
002160*** END DATE (UPDATE TYPE 2) FOUND.  DATA TYPE PAPOSCHG HAVE A
002170*** FIELD NUMBER NOT = ZEROES
002180
002190     IF (PA102WS-DELETE)
002210         MOVE WS-SAVE-POSITION    TO DB-POSITION
002220         MOVE WS-SAVE-EFFECT-DATE TO DB-EFFECT-DATE
002230         MOVE 1                   TO DB-FLD-NBR
002240         PERFORM 850-MODIFY-NLT-PPCSET1
002250         PERFORM
002260             UNTIL (PAPOSCHG-NOTFOUND)
002270             OR    (PPC-COMPANY     NOT = DB-COMPANY)
002280             OR    (PPC-POSITION    NOT = DB-POSITION)
002290             OR    (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE) 
002300                 PERFORM 830-DELETE-PAPOSCHG
002310                 PERFORM 860-MODIFY-NEXT-PPCSET1
002320         END-PERFORM.
002330
002340     GO TO 500-END.
002350
002360******************************************************************
002370 520-CLEAN-UP-PAPOSERR.                                      
002380******************************************************************
002390
002400*** THESE ARE END-DATE TYPES AND ONLY CHECKING FOR DATA TYPES
002410
002420     IF (PPE-UPDATE-TYPE = "2  ")
002430         GO TO 520-FIND-NEXT-PAPOSERR.
002440
002450*** IF PPE-EMPLOYEE IS ZEROES, THIS IS A REQUISITION
002460
002470     IF (PPE-EMPLOYEE    = ZEROES)
002480         SET PA102WS-SKIP-DELETE      TO TRUE
002490         GO TO 520-FIND-NEXT-PAPOSERR.
002500
J02157     IF  (PRM-PROCESS-LEVEL NOT = SPACES)
J02157     OR  (PRM-PROC-GROUP    NOT = SPACES)
J02157         MOVE PPE-COMPANY        TO DB-COMPANY
J02157         MOVE PPE-POSITION       TO DB-POSITION
J02157         MOVE PPE-EFFECT-DATE    TO DB-EFFECT-DATE
J02157         PERFORM 840-FIND-POSSET1
J02157         IF  (PAPOSITION-NOTFOUND)
J02157             SET PA102WS-SKIP-DELETE     TO TRUE
J02157             PERFORM 860-FIND-NEXT-PPESET2
J02157               UNTIL (PAPOSERR-NOTFOUND)
J02157               OR    (PPE-COMPANY     NOT = DB-COMPANY)
J02157               OR    (PPE-POSITION    NOT = DB-POSITION)
J02157               OR    (PPE-EFFECT-DATE NOT = DB-EFFECT-DATE)
J02157             GO TO 520-END
J02157         ELSE
J02157         IF  (PRM-PROCESS-LEVEL NOT = SPACES)
J02157         AND (POS-PROCESS-LEVEL NOT = PRM-PROCESS-LEVEL)
J02157             SET PA102WS-SKIP-DELETE     TO TRUE
J02157             PERFORM 860-FIND-NEXT-PPESET2
J02157                UNTIL (PAPOSERR-NOTFOUND)
J02157                OR    (PPE-COMPANY     NOT = DB-COMPANY)
J02157                OR    (PPE-POSITION    NOT = DB-POSITION)
J02157                OR    (PPE-EFFECT-DATE NOT = DB-EFFECT-DATE)
J02157             GO TO 520-END
J02157         ELSE
J02157         IF  (PRM-PROC-GROUP NOT = SPACES)
J02157             MOVE POS-PROCESS-LEVEL      TO LP1-PROCESS-LEVEL
J02157             PERFORM 8400-FIND-LPPLSECWRK
J02157             IF  (LPPLSECWRK-NOTFOUND)
J02157                 SET PA102WS-SKIP-DELETE TO TRUE
J02157                 PERFORM 860-FIND-NEXT-PPESET2
J02157                    UNTIL (PAPOSERR-NOTFOUND)
J02157                    OR    (PPE-COMPANY     NOT = DB-COMPANY)
J02157                    OR    (PPE-POSITION    NOT = DB-POSITION)
J02157                    OR    (PPE-EFFECT-DATE NOT = DB-EFFECT-DATE)
J02157                 GO TO 520-END
J02157             END-IF
J02157         END-IF
J02157     END-IF.

002510     MOVE PPE-EMPLOYEE            TO DB-EMPLOYEE.
002520     MOVE "E"                     TO DB-ACTION-TYPE.
002530     MOVE PCTSET2-EMPLOYEE        TO WS-DB-BEG-RNG.
002540     PERFORM 850-FIND-BEGRNG-PCTSET2.
002550
002560     PERFORM 860-FIND-NXTRNG-PCTSET2
002570         UNTIL  (PERSACTION-NOTFOUND)
002580         OR    ((PCT-POSITION   = PPE-POSITION)
002590         AND    (PCT-POS-EFF-DT <= PPE-EFFECT-DATE)).
002600          
002610     IF (PERSACTION-FOUND)
002620         SET PA102WS-SKIP-DELETE      TO TRUE
002630         GO TO 520-FIND-NEXT-PAPOSERR.
002640
002650     MOVE "L"                         TO DB-ACTION-TYPE.
002660     MOVE PCTSET2-EMPLOYEE            TO WS-DB-BEG-RNG.
002670     PERFORM 850-FIND-BEGRNG-PCTSET2.
002680
002690     PERFORM 860-FIND-NXTRNG-PCTSET2
002700         UNTIL  (PERSACTION-NOTFOUND)
002710         OR    ((PCT-POSITION   = PPE-POSITION)
002720         AND    (PCT-POS-EFF-DT <= PPE-EFFECT-DATE)).
002730          
002740     IF (PERSACTION-FOUND)
002750         SET PA102WS-SKIP-DELETE      TO TRUE
002760         GO TO 520-FIND-NEXT-PAPOSERR.
002770
002780     MOVE PEPSET2-EMPLOYEE            TO WS-DB-BEG-RNG.
002790     PERFORM 850-FIND-BEGRNG-PEPSET2.
002800     IF (PAEMPPOS-FOUND)
002810         PERFORM 860-FIND-NXTRNG-PEPSET2
002820             UNTIL  (PAEMPPOS-NOTFOUND)
002830             OR    ((PEP-POSITION   = PPE-POSITION)
002840             AND    (PEP-POS-EFF-DT <= PPE-EFFECT-DATE)).
002850
002860     IF (PAEMPPOS-FOUND)
002870         SET PA102WS-SKIP-DELETE      TO TRUE
002880         GO TO 520-FIND-NEXT-PAPOSERR.
002890
002900     MOVE PPE-COMPANY                  TO DB-COMPANY.
002910     MOVE PPE-EMPLOYEE                 TO DB-EMPLOYEE.
002920     INITIALIZE                           DB-REQUISITION.
002930     MOVE PPE-POSITION                 TO DB-POSITION.
002940     MOVE PPE-EFFECT-DATE              TO DB-EFFECT-DATE.
002950     MOVE PPE-UPDATE-TYPE              TO DB-UPDATE-TYPE.
002960     PERFORM 840-MODIFY-PPESET1.
002970     IF (PAPOSERR-FOUND)
002980         PERFORM 830-DELETE-PAPOSERR.
002990
003000 520-FIND-NEXT-PAPOSERR.
003010     PERFORM 860-FIND-NEXT-PPESET2.
003020
003030 520-END.
003040      
003050******************************************************************
003060 500-END.
003070******************************************************************
003080******************************************************************
003090 1000-PROCESS-DATA               SECTION 35.
003100******************************************************************
003110 1000-START.
003120
003130     MOVE WS-FALSE                   TO WS-DATA-TO-PRINT-SW
003140                                        WS-ERR-DATA-TO-PRINT-SW
003140                                        WS-WARN-DATA-TO-PRINT-SW
J63836                                     WS-EMPLIST-DATA-TO-PRINT-SW.
003150
           SET PA102WS-NOEMPS              TO TRUE.
           SET PA102WS-NOREQS              TO TRUE.
           SET PA102WS-NOHIRES             TO TRUE.
           SET PA102WS-NOACTIONS           TO TRUE.
           SET PA102WS-NOSPECIAL           TO TRUE.
            
P58562     MOVE 117                        TO CRT-MSG-NBR.
P58562     PERFORM 790-GET-MSG.
P58562     MOVE CRT-MESSAGE                TO WS-PA102-MSG-117.
P58562     MOVE 118                        TO CRT-MSG-NBR.
P58562     PERFORM 790-GET-MSG.
P58562     MOVE CRT-MESSAGE                TO WS-PA102-MSG-118.
P58562     MOVE 119                        TO CRT-MSG-NBR.
P58562     PERFORM 790-GET-MSG.
P58562     MOVE CRT-MESSAGE                TO WS-PA102-MSG-119.
P58562     MOVE 121                        TO CRT-MSG-NBR.
P58562     PERFORM 790-GET-MSG.
P58562     MOVE CRT-MESSAGE                TO WS-PA102-MSG-121.
P58562     MOVE 128                        TO CRT-MSG-NBR.
P58562     PERFORM 790-GET-MSG.
P58562     MOVE CRT-MESSAGE                TO WS-PA102-MSG-128.
P58562     MOVE SPACES                     TO CRT-MESSAGE.
P58562     MOVE ZEROES                     TO CRT-MSG-NBR.
P58562
P58562     MOVE WS-FALSE                   TO WS-ACTIONS-STORED-SW.
P58562     MOVE "A"                        TO DB-ACTION-TYPE.
P58562     MOVE PCTSET1-ACTION-TYPE        TO WS-DB-BEG-RNG.
P58562     PERFORM 850-FIND-BEGRNG-PCTSET1.
P58562     IF (PERSACTION-FOUND)
P58562         PERFORM 2750-SAVE-ACTIONS
P58562         THRU    2750-END
P58562             UNTIL (PERSACTION-NOTFOUND).
P58562
P58562     MOVE "E"                        TO DB-ACTION-TYPE.
P58562     MOVE PCTSET1-ACTION-TYPE        TO WS-DB-BEG-RNG.
P58562     PERFORM 850-FIND-BEGRNG-PCTSET1.
P58562     IF (PERSACTION-FOUND)
P58562         PERFORM 2750-SAVE-ACTIONS
P58562         THRU    2750-END
P58562             UNTIL (PERSACTION-NOTFOUND).
P58562
P58562     MOVE "L"                        TO DB-ACTION-TYPE.
P58562     MOVE PCTSET1-ACTION-TYPE        TO WS-DB-BEG-RNG.
P58562     PERFORM 850-FIND-BEGRNG-PCTSET1.
P58562     IF (PERSACTION-FOUND)
P58562         PERFORM 2750-SAVE-ACTIONS
P58562         THRU    2750-END
P58562             UNTIL (PERSACTION-NOTFOUND).
P58562
P58562     PERFORM 9900-CLOSE-ACTIONS.
P58562     PERFORM 9820-OPEN-INPUT-ACTIONS.
P58562
003160     MOVE PRM-COMPANY                TO DB-COMPANY.
003170     MOVE "PO"                       TO DB-TOPIC.
           INITIALIZE                         DB-COUNTRY-CD-REQ.
003180     MOVE PASSET2-COUNTRY-CD-REQ     TO WS-DB-BEG-RNG.
003190     PERFORM 850-FIND-BEGRNG-PASSET2.
003200     INITIALIZE                         WS-ACTION-TABLE.
003210     PERFORM
003220         VARYING I1 FROM 1 BY 1
003230         UNTIL  (PASCRTY-NOTFOUND)
003240         OR     (I1 > PA102WS-COUNTER)
003250             MOVE PAS-FLD-NBR         TO WS-FIELD-NBR (I1)
003260             MOVE PAS-DEFAULT-FLG     TO WS-DEFAULT-FLG (I1)
003270             PERFORM 860-FIND-NXTRNG-PASSET2.
003280
003290     PERFORM 1200-PROCESS-PAPOSCHG 
003300     THRU    1200-END.
003310
003320     IF  (NO-DATA-TO-PRINT)
           AND (NO-ERR-DATA-TO-PRINT)
           AND (NO-WARN-DATA-TO-PRINT)
J63836     AND (NO-EMPLIST-DATA-TO-PRINT)
003330         MOVE 107                     TO CRT-MSG-NBR
003340         PERFORM 780-PRINT-MSG
003350     ELSE
003360     IF  (PA102WS-NOEMPS)
003370     AND (PA102WS-NOREQS)
003380     AND (PA102WS-NOHIRES)
003390     AND (PA102WS-NOACTIONS) 
           AND (PA102WS-NOSPECIAL)
003400         MOVE 126                     TO CRT-MSG-NBR
003410         PERFORM 780-PRINT-MSG.
003420
           IF (NO-ERR-DATA-TO-PRINT)
003410         MOVE WS-ERROR-RPT-NAME       TO WS-TMP-FILE
003410         PERFORM 901-REMOVE-TMP-FILE.        

           IF (NO-WARN-DATA-TO-PRINT)
003410         MOVE WS-WARNING-RPT-NAME     TO WS-TMP-FILE
003410         PERFORM 901-REMOVE-TMP-FILE.        
J63836
J63836     IF (NO-EMPLIST-DATA-TO-PRINT)
J63836         MOVE WS-EMPLIST-RPT-NAME     TO WS-TMP-FILE
J63836         PERFORM 901-REMOVE-TMP-FILE
J63836     END-IF.
J63836
003430     GO TO 1000-END.
003440   
003450******************************************************************
003460 1200-PROCESS-PAPOSCHG.                               
003470******************************************************************
003480
003490     MOVE PRM-COMPANY                 TO DB-COMPANY.
003500     INITIALIZE                          DB-POSITION
003510                                         DB-EFFECT-DATE
003520                                         DB-FLD-NBR.
003530
003540     IF (WS-RESTARTING)
003550         MOVE WS-REST-COMPANY     TO DB-COMPANY
003560         MOVE WS-REST-POSITION    TO DB-POSITION
003570         MOVE WS-REST-EFFECT-DATE TO DB-EFFECT-DATE
003580         PERFORM 850-FIND-NLT-PPCSET1
003590         PERFORM 860-FIND-NEXT-PPCSET1
003600             UNTIL (PPC-COMPANY     NOT = DB-COMPANY)
003610             AND   (PPC-POSITION    NOT = DB-POSITION)
003620             AND   (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE)
003630     ELSE
003640         IF (PRM-POSITION NOT = SPACES)
003650             MOVE PRM-POSITION            TO DB-POSITION
003660         END-IF
003670         PERFORM 850-FIND-NLT-PPCSET1.
003680
003690     IF (PAPOSCHG-NOTFOUND)
003700     OR (PPC-COMPANY NOT = DB-COMPANY)
003710         GO TO 1200-END
003720     ELSE
003730     IF  (PRM-POSITION    NOT = SPACES)
003740     AND (PPC-POSITION    NOT = PRM-POSITION)
003750         GO TO 1200-END.
003760
003770     MOVE PPC-COMPANY                 TO PA102WS-COMPANY.
003780     MOVE PPC-POSITION                TO PA102WS-POSITION.
003790     MOVE PPC-EFFECT-DATE             TO PA102WS-EFFECT-DATE.
003800
003810     MOVE PPC-COMPANY                 TO G1-PPC-COMPANY
J63836                                         G2-PPC-COMPANY.
003820     MOVE PA102WS-PRS-NAME            TO G1-PRS-NAME
J63836                                         G2-PRS-NAME.
J17585
J17585     IF (PRBRD-BROADCAST-ENABLED)
J17585         MOVE 500                    TO PRBRD-ELEMENT-TYPE
J17585         MOVE PRM-COMPANY            TO PRBRD-ELEMENT-VALUE
J17585         PERFORM 610-BEG-ELEMENT-TAG
J17585         MOVE WFCHWS-TAG-STRING      TO BTL1-TAG-LINE
J17585         MOVE BROADCAST-TAG-LINE-1   TO RPT-GROUP-REQUEST
J17585         PERFORM 700-PRINT-RPT-GRP
J17585     END-IF.
J17585
003830     MOVE GN1-PPC-COMPANY             TO RPT-GROUP-REQUEST.
003840     PERFORM 700-PRINT-RPT-GRP.
J63836     MOVE GN2-PPC-COMPANY             TO RPT-GROUP-REQUEST.
J63836     PERFORM 700-PRINT-RPT-GRP.
003850     MOVE PPC-COMPANY                 TO G8-ERR-COMPANY
                                               W1-ERR-COMPANY.
003860     MOVE PA102WS-PRS-NAME            TO G8-PRS-NAME
                                               W1-PRS-NAME.
003870     MOVE GN8-ERR-COMPANY             TO RPT-GROUP-REQUEST.
003880     PERFORM 700-PRINT-RPT-GRP.
003870     MOVE WN1-ERR-COMPANY             TO RPT-GROUP-REQUEST.
003880     PERFORM 700-PRINT-RPT-GRP.
003890
003900     IF (PRM-POSITION = SPACES)
003910         PERFORM 1300-PROCESS-PAPOSCHG-DATA
003920         THRU    1300-END
003930             UNTIL (PAPOSCHG-NOTFOUND)
003940             OR    (PPC-COMPANY     NOT = PRM-COMPANY)
003950     ELSE
003960         PERFORM 1300-PROCESS-PAPOSCHG-DATA
003970         THRU    1300-END
003980             UNTIL (PAPOSCHG-NOTFOUND)
003990             OR    (PPC-COMPANY     NOT = PRM-COMPANY)
004000             OR    (PPC-POSITION    NOT = PA102WS-POSITION).
004010
004020     IF (PRM-UPDATE = "Y")
004030         PERFORM 910-AUDIT-BEGIN
004040         PERFORM 840-MODIFY-CKPSET1
004050         INITIALIZE                     WS-REST-DATA
004060         MOVE WS-REST-DATA           TO CKP-RESTART-INFO
004070         PERFORM 820-STORE-CKPOINT
004080         PERFORM 925-AUDIT-END.
J17585
J17585     IF (PRBRD-BROADCAST-ENABLED)
J17585         MOVE 500                    TO PRBRD-ELEMENT-TYPE
J17585         MOVE PRM-COMPANY            TO PRBRD-ELEMENT-VALUE
J17585         PERFORM 615-END-ELEMENT-TAG
J17585         MOVE WFCHWS-TAG-STRING      TO BTL1-TAG-LINE
J17585         MOVE BROADCAST-TAG-LINE-1   TO RPT-GROUP-REQUEST
J17585         PERFORM 700-PRINT-RPT-GRP
J17585     END-IF.
004090 
004100 1200-END.            
004110
004120******************************************************************
004130 1300-PROCESS-PAPOSCHG-DATA.           
004140******************************************************************
004150
101470     MOVE SPACES                     TO PA102WS-SV-CREATE-USER
101470                                        PA102WS-SV-CHG-REASON. 
004160     MOVE PPC-COMPANY                TO PA102WS-COMPANY.
004170     MOVE PPC-POSITION               TO PA102WS-POSITION.
004180     MOVE PPC-EFFECT-DATE            TO PA102WS-EFFECT-DATE.
004190
004200     IF (PPC-EFFECT-DATE > PA102WS-PRM-EFFECT-DATE)
004210         PERFORM 860-FIND-NEXT-PPCSET1
004220             UNTIL (PAPOSCHG-NOTFOUND)
004230             OR    (PPC-COMPANY  NOT = PA102WS-COMPANY)
004240             OR    (PPC-POSITION NOT = PA102WS-POSITION)
004250         GO TO 1300-END.        
004260
004270     IF (PAPOSCHG-NOTFOUND)
004280         GO TO 1300-END.
004320
004330     MOVE PPC-COMPANY                 TO DB-COMPANY.
004340     MOVE PPC-POSITION                TO DB-POSITION 
004350                                         G1H-PPC-POSITION
J63836                                         G2H-PPC-POSITION.
004360     MOVE PPC-EFFECT-DATE             TO DB-EFFECT-DATE 
004370                                         G1H-PPC-EFFECT-DATE
J63836                                         G2H-PPC-EFFECT-DATE.
004380
004390     MOVE PRM-COMPANY                 TO DB-COMPANY.
004400     MOVE PPC-POSITION                TO DB-POSITION.
004410     MOVE PPC-EFFECT-DATE             TO DB-EFFECT-DATE.
J05121     PERFORM 840-FIND-POSSET2.
P58562*    MOVE POSSET2-POSITION            TO WS-DB-BEG-RNG.
P58562*    MOVE ZEROES                      TO DBRNG-EFFECT-DATE.
P58562*    MOVE POSSET2-EFFECT-DATE         TO WS-DB-SUB-RNG.
P58562*    PERFORM 850-FIND-SUBRNG-POSSET2.
004430     IF  (PAPOSITION-NOTFOUND)
004460         MOVE PPC-POSITION           TO G9A-PPC-POSITION
004470         MOVE PPC-EFFECT-DATE        TO G9A-PPC-EFFECT-DATE
004480         INITIALIZE                     G9A-POS-DESCRIPTION
004490                                        G9A-EMP-REQ
                                              G9A-POS-LEVEL
004500                                        G9A-DESCRIPTION
004510         MOVE 103 TO CRT-MSG-NBR
004520         PERFORM 790-GET-MSG
004530         MOVE CRT-MESSAGE            TO  G9A-COMMENTS 
004540         INITIALIZE                      POS-END-DATE
004550                                         POS-DESCRIPTION
004560                                         PA102WS-POS-EFFECT-DATE
004570                                         G1H-PPC-END-DATE
004580                                         G1H-PPC-DESCRIPTION
004590                                         PA102WS-POS-DESCRIPTION
004600          MOVE GN9A-ERROR-DETAIL      TO RPT-GROUP-REQUEST
004610          PERFORM 700-PRINT-RPT-GRP
                IF (NO-ERR-DATA-TO-PRINT)
                    SET ERR-DATA-TO-PRINT   TO TRUE
                END-IF
004620          PERFORM 860-FIND-NEXT-PPCSET1
004630              UNTIL (PAPOSCHG-NOTFOUND)
004640              OR    (PPC-COMPANY     NOT = DB-COMPANY)
004650              OR    (PPC-POSITION    NOT = DB-POSITION)
004660              OR    (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE)
004670          GO TO 1300-END
004680     ELSE
J02157         IF  (PRM-PROCESS-LEVEL NOT = SPACES)
J02157         AND (POS-PROCESS-LEVEL NOT = PRM-PROCESS-LEVEL)
J02157             PERFORM 860-FIND-NEXT-PPCSET1
J02157                UNTIL (PAPOSCHG-NOTFOUND)
J02157                OR    (PPC-COMPANY     NOT = DB-COMPANY)
J02157                OR    (PPC-POSITION    NOT = DB-POSITION)
J02157                OR    (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE)
J02157             GO TO 1300-END
J02157         END-IF
J02157         IF  (PRM-PROC-GROUP NOT = SPACES)
J02157             MOVE POS-PROCESS-LEVEL      TO LP1-PROCESS-LEVEL
J02157             PERFORM 8400-FIND-LPPLSECWRK
J02157             IF  (LPPLSECWRK-NOTFOUND)
J02157                 PERFORM 860-FIND-NEXT-PPCSET1
J02157                    UNTIL (PAPOSCHG-NOTFOUND)
J02157                    OR    (PPC-COMPANY     NOT = DB-COMPANY)
J02157                    OR    (PPC-POSITION    NOT = DB-POSITION)
J02157                    OR    (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE)
J02157                 GO TO 1300-END
J02157             END-IF
J02157         END-IF
004690         MOVE POS-EFFECT-DATE         TO PA102WS-POS-EFFECT-DATE
004700         MOVE POS-END-DATE            TO G1H-PPC-END-DATE
J63836         MOVE POS-END-DATE            TO G2H-PPC-END-DATE
004710         MOVE POS-DESCRIPTION         TO G1H-PPC-DESCRIPTION
J63836         MOVE POS-DESCRIPTION         TO G2H-PPC-DESCRIPTION
004720                                         PA102WS-POS-DESCRIPTION
101470         MOVE POS-CREATE-USER         TO PA102WS-SV-CREATE-USER
101470         MOVE POS-CHG-REASON          TO PA102WS-SV-CHG-REASON
101470     END-IF.
004730
           IF (PPC-UPDATE-TYPE = "2  ")
P70438         MOVE PRM-COMPANY                TO DB-COMPANY
P70438         MOVE TEMSET1-COMPANY            TO WS-DB-BEG-RNG
P70438         MOVE SPACES                     TO FILTER-STRING
P70438         STRING
P70438         "(TEM-POSITION  = ?) AND "
P70438         "(TEM-MSTR-END = ?)"
P70438             DELIMITED BY SIZE
P70438             INTO FILTER-STRING
P70438         PERFORM 890-CREATE-FILTER
P70438         MOVE PA102WS-POSITION           TO ALPHANUM-FILTER-VALUE
P70438         PERFORM 890-SET-ALPHANUM-FILTER-VALUE
P70438         MOVE ZEROES                     TO DATETIME-FILTER-VALUE
P70438         PERFORM 890-SET-DATETIME-FILTER-VALUE
P70438         PERFORM 850-FILTER-BEGRNG-TEMSET1
               IF (TAEEMASTER-FOUND)
                   MOVE PPC-POSITION           TO G9A-PPC-POSITION
                   MOVE PPC-EFFECT-DATE        TO G9A-PPC-EFFECT-DATE
                   MOVE POS-DESCRIPTION        TO G9A-POS-DESCRIPTION
                   INITIALIZE                     G9A-EMP-REQ
                                                  G9A-POS-LEVEL
                                                  G9A-DESCRIPTION
                   MOVE 135 TO CRT-MSG-NBR
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE            TO  G9A-COMMENTS 
                   MOVE GN9A-ERROR-DETAIL      TO RPT-GROUP-REQUEST
                   PERFORM 700-PRINT-RPT-GRP
                   IF (NO-ERR-DATA-TO-PRINT)
                       SET ERR-DATA-TO-PRINT   TO TRUE
                   END-IF
                   PERFORM 860-FIND-NEXT-PPCSET1
                       UNTIL (PAPOSCHG-NOTFOUND)
                       OR    (PPC-COMPANY     NOT = DB-COMPANY)
                       OR    (PPC-POSITION    NOT = DB-POSITION)
                       OR    (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE)
                   GO TO 1300-END.
           
           IF (PPC-UPDATE-TYPE = "2  ")
               MOVE TENSET1-COMPANY            TO WS-DB-BEG-RNG
               MOVE SPACES                     TO FILTER-STRING
P70438         STRING
P70438         "(TEN-POSITION     = ?) AND "
P70438         "(TEN-ENRL-STOP-DT = ?)"
P70438             DELIMITED BY SIZE
P70438             INTO FILTER-STRING
               PERFORM 890-CREATE-FILTER
               MOVE PA102WS-POSITION           TO ALPHANUM-FILTER-VALUE
               PERFORM 890-SET-ALPHANUM-FILTER-VALUE
P70438         MOVE ZEROES                     TO DATETIME-FILTER-VALUE
P70438         PERFORM 890-SET-DATETIME-FILTER-VALUE
               PERFORM 850-FILTER-BEGRNG-TENSET1
               IF (TAENROLL-FOUND)
                   MOVE PPC-POSITION           TO G9A-PPC-POSITION
                   MOVE PPC-EFFECT-DATE        TO G9A-PPC-EFFECT-DATE
                   MOVE POS-DESCRIPTION        TO G9A-POS-DESCRIPTION
                   INITIALIZE                     G9A-EMP-REQ
                                                  G9A-POS-LEVEL
                                                  G9A-DESCRIPTION
                   MOVE 135 TO CRT-MSG-NBR
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE            TO  G9A-COMMENTS 
                   MOVE GN9A-ERROR-DETAIL      TO RPT-GROUP-REQUEST
                   PERFORM 700-PRINT-RPT-GRP
                   IF (NO-ERR-DATA-TO-PRINT)
                       SET ERR-DATA-TO-PRINT   TO TRUE
                   END-IF
                   PERFORM 860-FIND-NEXT-PPCSET1
                       UNTIL (PAPOSCHG-NOTFOUND)
                       OR    (PPC-COMPANY     NOT = DB-COMPANY)
                       OR    (PPC-POSITION    NOT = DB-POSITION)
                       OR    (PPC-EFFECT-DATE NOT = DB-EFFECT-DATE)
                   GO TO 1300-END.
                     
J17585     IF (PRBRD-BROADCAST-ENABLED)
J17585         MOVE 511                    TO PRBRD-ELEMENT-TYPE
J17585         MOVE PA102WS-POSITION       TO PRBRD-ELEMENT-VALUE
J17585         PERFORM 610-BEG-ELEMENT-TAG
J17585         MOVE WFCHWS-TAG-STRING      TO BTL1-TAG-LINE
J17585         MOVE BROADCAST-TAG-LINE-1   TO RPT-GROUP-REQUEST
J17585         PERFORM 700-PRINT-RPT-GRP
J17585     END-IF.
J17585
004740     MOVE GN1H-POSITION-HEADER        TO RPT-GROUP-REQUEST.
004750     PERFORM 700-PRINT-RPT-GRP.
J63836     MOVE GN2H-POSITION-HEADER        TO RPT-GROUP-REQUEST.
J63836     PERFORM 700-PRINT-RPT-GRP.
004760
004300     IF (PRM-UPDATE = "Y")
004310         PERFORM 910-AUDIT-BEGIN.

004770     INITIALIZE                          PA102WS-UPDATE-FIELDS 
004780                                         PA102WS-DEFAULTS.
004790     MOVE 1 TO I1.
004800     PERFORM 1400-LOAD-POSITION-DATA
004810     THRU    1400-END
004820         UNTIL (PAPOSCHG-NOTFOUND)
004830         OR    (PPC-COMPANY     NOT = PA102WS-COMPANY)
004840         OR    (PPC-POSITION    NOT = PA102WS-POSITION)
004850         OR    (PPC-EFFECT-DATE NOT = PA102WS-EFFECT-DATE).
004860
004870*** NO PAPOSCHG RECORDS TO PROCESS ***
004880
004890     IF  (PA102WS-FIELD-NBR (1) = ZEROES)
004900     AND (PA102WS-END-DATE      = ZEROES)
004910         IF (PRM-UPDATE = "Y")
004920             PERFORM 1350-END-UPDATING
004930             THRU    1350-END
004940         END-IF
004950         GO TO 1300-END.
004960
005020     MOVE PA102WS-COMPANY             TO DB-COMPANY.
005030     MOVE PA102WS-POSITION            TO DB-POSITION.
005040     MOVE PEPSET4-POSITION            TO WS-DB-BEG-RNG.
005050     PERFORM 850-FIND-BEGRNG-PEPSET4.
J63836*    IF (PAEMPPOS-FOUND)
J63836*        PERFORM 860-FIND-NXTRNG-PEPSET4
J63836*            UNTIL  (PAEMPPOS-NOTFOUND)
J63836*            OR    ((PEP-POS-EFF-DT <= PA102WS-EFFECT-DATE)
J63836*            AND    (PEP-END-DATE   = ZEROES)).
005110
005120     IF (PAEMPPOS-FOUND)
005130         SET PA102WS-NONAME-PRINT TO TRUE
005140         MOVE GN2HE-EMP-HEADER    TO RPT-GROUP-REQUEST
005150         PERFORM 700-PRINT-RPT-GRP
J63836         MOVE GN3HE-EMP-HEADER    TO RPT-GROUP-REQUEST
J63836         PERFORM 700-PRINT-RPT-GRP
005160         PERFORM 1600-PROCESS-PAEMPPOS
005170         THRU    1600-END
005180             UNTIL (PAEMPPOS-NOTFOUND).
005190            
005200     MOVE PJRSET2-POSITION            TO WS-DB-BEG-RNG.
005210     PERFORM 850-FIND-BEGRNG-PJRSET2.
005220     IF (PAJOBREQ-FOUND)
005230         PERFORM 860-FIND-NXTRNG-PJRSET2
005240             UNTIL  (PAJOBREQ-NOTFOUND)
005250             OR    ((PJR-CLOSED-DATE = ZEROES)
005260             AND    (PJR-POS-EFFECT-DAT  <= PA102WS-EFFECT-DATE)).
005270
005280     IF (PAJOBREQ-FOUND)
005290         SET PA102WS-NONAME-PRINT     TO TRUE
005300         MOVE GN2HR-REQ-HEADER        TO RPT-GROUP-REQUEST
005310         PERFORM 700-PRINT-RPT-GRP
005320         PERFORM 2200-PROCESS-PAJOBREQ
005330         THRU    2200-END
005340             UNTIL (PAJOBREQ-NOTFOUND).
005350
P58562     MOVE PRM-COMPANY                TO AC-COMPANY.
P58562     MOVE PA102WS-POSITION           TO AC-POSITION.
P58562     MOVE PA102WS-EFFECT-DATE        TO AC-POS-EFF-DT.
P58562     MOVE "A"                        TO AC-ACTION-TYPE.
P58562     PERFORM 8500-FIND-NLT-ACTIONS.
P58562     IF  (ACTIONS-FOUND)
P58562     AND (AC-COMPANY     = PRM-COMPANY)
P58562     AND (AC-POSITION    = PA102WS-POSITION)
P58562     AND (AC-ACTION-TYPE = "A")
005580         MOVE GN2HA-ACTION-HEADER        TO RPT-GROUP-REQUEST
005590         PERFORM 700-PRINT-RPT-GRP
005600         PERFORM 2400-PROCESS-NEW-HIRES 
005610         THRU    2400-END
P58562             UNTIL (ACTIONS-NOTFOUND)
P58562             OR    (AC-COMPANY     NOT = PRM-COMPANY)
P58562             OR    (AC-POSITION    NOT = PA102WS-POSITION)
P58562             OR    (AC-ACTION-TYPE NOT = "A").
P58562
P58562     MOVE PRM-COMPANY                TO AC-COMPANY.
P58562     MOVE PA102WS-POSITION           TO AC-POSITION.
P58562     MOVE PA102WS-EFFECT-DATE        TO AC-POS-EFF-DT.
P58562     MOVE "E"                        TO AC-ACTION-TYPE.
P58562     PERFORM 8500-FIND-NLT-ACTIONS.
P58562     IF  (ACTIONS-FOUND)
P58562     AND (AC-COMPANY  = PRM-COMPANY)
P58562     AND (AC-POSITION = PA102WS-POSITION)
005580         MOVE GN2TA-ACTION-HEADER        TO RPT-GROUP-REQUEST
005590         PERFORM 700-PRINT-RPT-GRP
005600         PERFORM 2800-PROCESS-TRANSFERS
005610         THRU    2800-END
P58562             UNTIL (ACTIONS-NOTFOUND)
P58562             OR    (AC-COMPANY     NOT = PRM-COMPANY)
P58562             OR    (AC-POSITION    NOT = PA102WS-POSITION).
005870
005880     IF (PRM-UPDATE = "Y")
               MOVE PRM-COMPANY                 TO DB-COMPANY
               MOVE PA102WS-POSITION            TO DB-POSITION
               MOVE PA102WS-EFFECT-DATE         TO DB-EFFECT-DATE
               PERFORM 840-MODIFY-POSSET1
               IF (PAPOSITION-FOUND)
                   INITIALIZE                      POS-UPDATE-FLAG
J48486*             MOVE CRT-USER-NAME           TO POS-USER-ID
J48486*             MOVE WS-SYSTEM-DATE-YMD      TO POS-DATE-STAMP
J48486*             MOVE HHMMSS                  TO POS-TIME-STAMP
                   PERFORM 820-STORE-PAPOSITION
               END-IF             
006000         PERFORM 1350-END-UPDATING
006010         THRU    1350-END
J48486     END-IF.
J17585
J17585     IF (PRBRD-BROADCAST-ENABLED)
J17585         MOVE 511                    TO PRBRD-ELEMENT-TYPE
J17585         MOVE PA102WS-POSITION       TO PRBRD-ELEMENT-VALUE
J17585         PERFORM 615-END-ELEMENT-TAG
J17585         MOVE WFCHWS-TAG-STRING      TO BTL1-TAG-LINE
J17585         MOVE BROADCAST-TAG-LINE-1   TO RPT-GROUP-REQUEST
J17585         PERFORM 700-PRINT-RPT-GRP
J17585     END-IF.
006020
006030 1300-END.
006040
006050******************************************************************
006060 1350-END-UPDATING.
006070******************************************************************
006080
006090     MOVE PA102WS-COMPANY             TO DB-COMPANY.
006100     MOVE PA102WS-POSITION            TO DB-POSITION.
006110     MOVE PA102WS-EFFECT-DATE         TO DB-EFFECT-DATE.
006120     MOVE PPESET2-EFFECT-DATE         TO WS-DB-BEG-RNG.
006130     PERFORM 850-FIND-BEGRNG-PPESET2.
006140     IF (PAPOSERR-NOTFOUND)
006150         MOVE PPCSET1-EFFECT-DATE     TO WS-DB-BEG-RNG
006160         PERFORM 830-DELETERNG-PPCSET1.
006170
006180     PERFORM 840-MODIFY-CKPSET1.
006190     MOVE PA102WS-COMPANY             TO WS-REST-COMPANY.
006200     MOVE PA102WS-POSITION            TO WS-REST-POSITION.
006210     MOVE PA102WS-EFFECT-DATE         TO WS-REST-EFFECT-DATE.
006220     MOVE WS-REST-DATA                TO CKP-RESTART-INFO.
006230     PERFORM 820-STORE-CKPOINT.
006240     PERFORM 900-SAVE-PRINT-FILES.
006250     PERFORM 925-AUDIT-END.
006260
006270     MOVE PA102WS-COMPANY             TO DB-COMPANY.
006280     MOVE PA102WS-POSITION            TO DB-POSITION.
006290     MOVE PA102WS-EFFECT-DATE         TO DB-EFFECT-DATE.
006300     PERFORM 850-FIND-NLT-PPCSET1.
006310     IF  (PAPOSCHG-FOUND)
006320     AND (PPC-COMPANY     = PA102WS-COMPANY)
006330     AND (PPC-POSITION    = PA102WS-POSITION)
006340     AND (PPC-EFFECT-DATE = PA102WS-EFFECT-DATE)
006350         PERFORM 860-FIND-NEXT-PPCSET1
006360            UNTIL (PAPOSCHG-NOTFOUND)
006370            OR    (PPC-COMPANY     NOT = PA102WS-COMPANY)
006380            OR    (PPC-POSITION    NOT = PA102WS-POSITION)
006390            OR    (PPC-EFFECT-DATE NOT = PA102WS-EFFECT-DATE).
006400
006410 1350-END.
006420
006430******************************************************************
006440 1400-LOAD-POSITION-DATA.
006450******************************************************************
006460
           MOVE PPC-FLD-NBR                TO PA102WS-FLD-NBR.

           IF (PPC-FLD-NBR = PAPOS-REASON-DN)
           OR (PPC-FLD-NBR = PAPOS-SUPERVISOR-LNK-DN)
           OR (PPC-FLD-NBR = PAPOS-POSIT-STATUS-DN)
           OR (PPC-FLD-NBR = PAPOS-POS-DESCRIPTION-DN)
               SET PA102WS-SPECIAL         TO TRUE.

006470     IF  (PPC-UPDATE-TYPE = "2  ")
006480     AND (PPC-END-DATE    > PA102WS-PRM-EFFECT-DATE)
006490         GO TO 1400-FIND-NEXT-PAPOSCHG.
006500
006510     IF (NO-DATA-TO-PRINT)
006520         MOVE WS-TRUE TO WS-DATA-TO-PRINT-SW.
006530 
           SET PA102WS-USE-COMPANY             TO TRUE.
           IF (PPC-POSITION NOT = SPACES)
               MOVE PPC-COMPANY                TO DB-COMPANY
               MOVE PPC-POSITION               TO DB-POSITION
P58562*        MOVE POSSET2-POSITION           TO WS-DB-BEG-RNG
               MOVE PA102WS-POS-EFFECT-DATE    TO DB-EFFECT-DATE
P58562*        MOVE ZEROES                     TO DBRNG-EFFECT-DATE
P58562*        MOVE POSSET2-EFFECT-DATE        TO WS-DB-SUB-RNG
P58562*        PERFORM 850-FIND-SUBRNG-POSSET2.
J05121         PERFORM 840-FIND-POSSET2
               IF  (PAPOSITION-FOUND)
               AND (POS-PROCESS-LEVEL NOT = SPACES)
                   MOVE "PO"                   TO DB-TOPIC
                   MOVE SPACES                 TO DB-COUNTRY-CD-REQ
                   MOVE POS-PROCESS-LEVEL      TO DB-PROCESS-LEVEL
                   MOVE PASSET2-PROCESS-LEVEL  TO WS-DB-BEG-RNG
                   PERFORM 850-FIND-BEGRNG-PASSET2
                   IF (PASCRTY-FOUND)
                       SET PA102WS-USE-PROCESS-LEVEL
                                               TO TRUE.

006540     IF (PPC-UPDATE-TYPE = "2  ")
006550         MOVE PPC-COMPANY                TO DB-COMPANY
006560         MOVE PPC-POSITION               TO DB-POSITION
006570         MOVE PA102WS-POS-EFFECT-DATE    TO DB-EFFECT-DATE
006580         PERFORM 850-FIND-NLT-POSSET1
006590         IF  (PAPOSITION-FOUND)
006600         AND (POS-COMPANY     = DB-COMPANY)
006610         AND (POS-POSITION    = DB-POSITION)
006620         AND (POS-EFFECT-DATE = DB-EFFECT-DATE)
006630           IF (POS-END-DATE = ZEROES)
006640             IF (PRM-UPDATE = "Y")
006650                 MOVE PPC-COMPANY         TO DB-COMPANY
006660                 MOVE PPC-POSITION        TO DB-POSITION
006670                 MOVE PPC-EFFECT-DATE     TO DB-EFFECT-DATE
006680                 INITIALIZE                  DB-FLD-NBR
006690                 PERFORM 840-MODIFY-PPCSET1
006700                 IF (PAPOSCHG-FOUND)
006710                     PERFORM 830-DELETE-PAPOSCHG   
006720                     INITIALIZE                  DB-EMPLOYEE
006730                                                 DB-REQUISITION
006740                     PERFORM 850-MODIFY-NLT-PPESET2
006750                     PERFORM
006760                       UNTIL  (PAPOSERR-NOTFOUND)
006770                       OR    ((PPE-COMPANY     NOT = DB-COMPANY)
006780                       OR     (PPE-POSITION    NOT =
006790                                            PA102WS-POSITION)
006800                       OR     (PPE-EFFECT-DATE NOT =
006810                                            PA102WS-EFFECT-DATE))
006820                         IF (PPE-UPDATE-TYPE = "2  ")
006830                             PERFORM 830-DELETE-PAPOSERR
006840                         END-IF
006850                     END-PERFORM 
006860                 END-IF
006870             END-IF
006880             GO TO 1400-FIND-NEXT-PAPOSCHG
006890           ELSE
006900             IF (POS-END-DATE NOT = PPC-END-DATE)
006910                 MOVE POS-END-DATE TO PPC-END-DATE
006920             END-IF
006930             PERFORM 860-FIND-NEXT-POSSET1
006940             IF  (PAPOSITION-FOUND)
006950             AND (POS-COMPANY     = DB-COMPANY)
006960             AND (POS-POSITION    = DB-POSITION)
006970             AND (POS-EFFECT-DATE = DB-EFFECT-DATE)
006980             AND (POS-POSITION    = PPC-POSITION)
006990               MOVE POS-EFFECT-DATE     TO WSDR-FR-DATE
007000               PERFORM 900-DATE-TO-JULIAN
007010               SUBTRACT 1 FROM WSDR-JULIAN-DAYS
007020               PERFORM 900-JULIAN-TO-DATE
007030               IF (WSDR-FR-DATE = PPC-END-DATE)
007040                 IF (PRM-UPDATE = "Y")
007050                     MOVE PPC-COMPANY         TO DB-COMPANY
007060                     MOVE PPC-POSITION        TO DB-POSITION
007070                     MOVE PPC-EFFECT-DATE     TO DB-EFFECT-DATE
007080                     INITIALIZE                  DB-FLD-NBR
007090                     PERFORM 840-MODIFY-PPCSET1
007100                     IF (PAPOSCHG-FOUND)
007110                         PERFORM 830-DELETE-PAPOSCHG   
007120                         INITIALIZE              DB-EMPLOYEE
007130                                                 DB-REQUISITION
007140                         PERFORM 850-MODIFY-NLT-PPESET2
007150                         PERFORM
007160                           UNTIL  (PAPOSERR-NOTFOUND)
007170                           OR    ((PPE-COMPANY     NOT =
007180                                                   DB-COMPANY)
007190                           OR     (PPE-POSITION    NOT =
007200                                            PA102WS-POSITION)
007210                           OR     (PPE-EFFECT-DATE NOT =
007220                                            PA102WS-EFFECT-DATE))
007230                             IF (PPE-UPDATE-TYPE = "2  ")
007240                               PERFORM 830-DELETE-PAPOSERR
007250                             END-IF
007260                         END-PERFORM 
007270                     END-IF
007280                 END-IF
007290                 GO TO 1400-FIND-NEXT-PAPOSCHG.
007300
007310     INITIALIZE                          PA102WS-FLD-COUNT.
007320     PERFORM 1500-LOAD-PAPOSCHG    
007330     THRU    1500-END.
007340
007350 1400-FIND-NEXT-PAPOSCHG.
           MOVE PA102WS-COMPANY        TO DB-COMPANY.
           MOVE PA102WS-POSITION       TO DB-POSITION.
           MOVE PA102WS-EFFECT-DATE    TO DB-EFFECT-DATE.
           MOVE PA102WS-FLD-NBR        TO DB-FLD-NBR.
           PERFORM 850-FIND-NLT-PPCSET1.
           IF  (PAPOSCHG-FOUND)
           AND (PPC-COMPANY            = DB-COMPANY)
           AND (PPC-POSITION           = DB-POSITION)
           AND (PPC-EFFECT-DATE        = DB-EFFECT-DATE)
           AND (PPC-FLD-NBR            = DB-FLD-NBR)
007360         PERFORM 860-FIND-NEXT-PPCSET1.
007370      
007380 1400-END.
007390  
007400******************************************************************
007410 1500-LOAD-PAPOSCHG.                         
007420******************************************************************
007430
007440     MOVE 1                   TO I2.
007450     IF (PPC-FLD-NBR = ZEROES)
007460         PERFORM
007470            UNTIL  (I2 > 27)
007480            OR     (PAPOSEMP-POS-FLD (I2) = HRPEP-END-DATE-DN)
007490               ADD 1              TO I2
007500         END-PERFORM
007510     ELSE    
007520         PERFORM
007530            UNTIL  (I2 > 27)
007540            OR     (PAPOSEMP-POS-FLD (I2) = PPC-FLD-NBR)
007550                ADD 1              TO I2
007560         END-PERFORM.
007570
007580     IF (PPC-FLD-NBR = ZEROES)
007590         IF  (I2 NOT > 27)
007600         AND (PAPOSEMP-POS-FLD (I2) = HRPEP-END-DATE-DN)
007610            MOVE PAPOSEMP-EMP-FLD (I2) TO PA102WS-FIELD-NBR2 (I1)
007620         END-IF
007630     ELSE
007640     IF (PPC-FLD-NBR NOT = ZEROES)
007650         IF  (I2 NOT > 27)
007660         AND (PAPOSEMP-POS-FLD (I2) = PPC-FLD-NBR)
007670            MOVE PAPOSEMP-EMP-FLD (I2) TO PA102WS-FIELD-NBR2 (I1).
007680
007690     IF (PPC-UPDATE-TYPE = "1  ")
007700         MOVE PPC-FLD-NBR             TO PA102WS-FIELD-NBR (I1)
007710         INITIALIZE                      PA102WS-DEFAULT-FLG (I1)
               IF (PA102WS-USE-PROCESS-LEVEL)
                   MOVE "PO"                   TO DB-TOPIC
                   MOVE SPACES                 TO DB-COUNTRY-CD-REQ
                   MOVE POS-PROCESS-LEVEL      TO DB-PROCESS-LEVEL
                   MOVE PASSET2-PROCESS-LEVEL  TO WS-DB-BEG-RNG
                   PERFORM 850-FIND-BEGRNG-PASSET2
007720             PERFORM
007740                 UNTIL  (PASCRTY-NOTFOUND)
007750                 OR     (PA102WS-DEFAULT-FLG (I1) NOT = ZEROES)
007760                 IF (PAS-FLD-NBR  = PPC-FLD-NBR)
007770                     IF (PAS-DEFAULT-FLG = 1)
007780                         IF (PRM-UPDATE = "Y")
007790                             MOVE PPC-COMPANY    TO DB-COMPANY
007800                             MOVE PPC-POSITION   TO DB-POSITION
007810                             MOVE PPC-EFFECT-DATE
007810                                                 TO DB-EFFECT-DATE
007820                             MOVE PPC-FLD-NBR    TO DB-FLD-NBR
007830                             PERFORM 840-MODIFY-PPCSET1
007840                             IF (PAPOSCHG-FOUND)
007850                                  PERFORM 830-DELETE-PAPOSCHG
007860                             END-IF
007870                         ELSE
007880                             MOVE PAS-DEFAULT-FLG
007890                                      TO PA102WS-DEFAULT-FLG (I1)
007900                         END-IF
007910                     ELSE
007920                         MOVE PAS-DEFAULT-FLG
007930                                      TO PA102WS-DEFAULT-FLG (I1)
007940                     END-IF
007950                 END-IF
                       PERFORM 860-FIND-NXTRNG-PASSET2
007960             END-PERFORM
007970         ELSE
007720             PERFORM
007730                 VARYING I2 FROM 1 BY 1
007740                 UNTIL  (I2                > PA102WS-COUNTER)
007750                 OR     (PA102WS-DEFAULT-FLG (I1) NOT = ZEROES)
007760                 IF (WS-FIELD-NBR (I2)   = PPC-FLD-NBR)
007770                     IF (WS-DEFAULT-FLG (I2) = 1)
007780                         IF (PRM-UPDATE = "Y")
007790                             MOVE PPC-COMPANY    TO DB-COMPANY
007800                             MOVE PPC-POSITION   TO DB-POSITION
007810                             MOVE PPC-EFFECT-DATE
007810                                                 TO DB-EFFECT-DATE
007820                             MOVE PPC-FLD-NBR    TO DB-FLD-NBR
007830                             PERFORM 840-MODIFY-PPCSET1
007840                             IF (PAPOSCHG-FOUND)
007850                                  PERFORM 830-DELETE-PAPOSCHG
007860                             END-IF
007870                         ELSE
007880                             MOVE WS-DEFAULT-FLG (I2)
007890                                      TO PA102WS-DEFAULT-FLG (I1)
007900                         END-IF
007910                     ELSE
007920                         MOVE WS-DEFAULT-FLG (I2)
007930                                      TO PA102WS-DEFAULT-FLG (I1)
007940                     END-IF
007950                 END-IF
007960             END-PERFORM.
007970
007980     IF  (PPC-UPDATE-TYPE          = "1  ")
007990     AND (PA102WS-DEFAULT-FLG (I1) = ZEROES)
008000         MOVE 1                       TO PA102WS-DEFAULT-FLG (I1).
008010
008020     IF (PPC-FLD-NBR = ZEROES)
008030         MOVE HRPEP-END-DATE-DN       TO DB-FLD-NBR
008040     ELSE
008050         MOVE PPC-FLD-NBR             TO DB-FLD-NBR.
008060     PERFORM 840-FIND-PADSET1.
008070     IF (PADICT-FOUND)
               MOVE PAD-ITEM-NAME           TO CRT-PHRASE
               MOVE WS-PHRASE-SIZE          TO CRT-PHRASE-SIZE
               MOVE "N"                     TO CRT-PUT-DOTS
               PERFORM 900-GET-PHRASE-XLT
               MOVE CRT-PHRASE-XLT          TO PA102WS-ITEM-NAME (I1).
008090
008100     IF (PPC-UPDATE-TYPE = "2  ")
008110         MOVE PPC-END-DATE            TO PA102WS-VALUE (I1)
008120                                         PA102WS-END-DATE 
008130         MOVE PPC-END-DATE            TO WS-END-DATE-FORMAT
008140         MOVE WS-MONTH                TO WS-MM
008150         MOVE WS-DAY                  TO WS-DD
008160         MOVE WS-YEAR3-4              TO WS-YY
008170         MOVE WS-RPT-DATE             TO G1D-PPC-VALUE
J63836                                         G2D-PPC-VALUE
008180         INITIALIZE                      PA102WS-VALUE-PRIOR (I1)
008190                                         G1D-PPC-VALUE-PRIOR
J63836                                         G2D-PPC-VALUE-PRIOR
008200         MOVE PA102WS-ITEM-NAME (I1)
008210                                      TO G1D-PAD-ITEM-NAME
J63836                                         G2D-PAD-ITEM-NAME
008220         MOVE G1D-POSITION-DETAIL     TO RPT-GROUP-REQUEST
008230         PERFORM 700-PRINT-RPT-GRP
J63836         MOVE G2D-POSITION-DETAIL     TO RPT-GROUP-REQUEST
J63836         PERFORM 700-PRINT-RPT-GRP
008240         ADD 1 TO I1
008250         GO TO 1500-END. 
008260
           IF (PPC-A-VALUE-PRIOR NOT = SPACES)
           OR (PPC-A-VALUE       NOT = SPACES)
               IF (PPC-FLD-NBR             = PAPOS-PROCESS-LEVEL-DN)
                   MOVE PPC-COMPANY         TO DB-COMPANY
                   MOVE PPC-A-VALUE-PRIOR   TO DB-PROCESS-LEVEL
                   PERFORM 840-FIND-PRSSET1
                   IF (PRSYSTEM-FOUND)
                       MOVE PRS-CURRENCY-CODE
                                            TO PA102WS-BEFORE-CURRENCY
                       MOVE PRS-WORK-COUNTRY
                                            TO WS-BEF-WORK-COUNTRY
                   END-IF
                   MOVE PPC-A-VALUE         TO DB-PROCESS-LEVEL
                   PERFORM 840-FIND-PRSSET1
                   IF (PRSYSTEM-FOUND)
                       MOVE PRS-CURRENCY-CODE
                                            TO PA102WS-AFTER-CURRENCY
                       MOVE PRS-WORK-COUNTRY
                                            TO WS-AFT-WORK-COUNTRY
                   END-IF.

           IF (PPC-N-VALUE-PRIOR NOT = ZEROES)
           OR (PPC-N-VALUE       NOT = ZEROES)
               IF  (PPC-FLD-NBR             = PAPOS-PAY-RATE-DN)
               AND (PA102WS-BEFORE-CURRENCY = SPACES)
                   MOVE PPC-COMPANY         TO DB-COMPANY
                   MOVE PPC-A-VALUE-PRIOR   TO DB-PROCESS-LEVEL
                   PERFORM 840-FIND-PRSSET1
                   IF (PRSYSTEM-FOUND)
                       MOVE PRS-CURRENCY-CODE
                                            TO PA102WS-BEFORE-CURRENCY
                   END-IF
                   MOVE PPC-A-VALUE         TO DB-PROCESS-LEVEL
                   PERFORM 840-FIND-PRSSET1
                   IF (PRSYSTEM-FOUND)
                       MOVE PRS-CURRENCY-CODE
                                            TO PA102WS-AFTER-CURRENCY
                   END-IF
               END-IF
008290         IF (PPC-FLD-NBR = PAPOS-PAY-RATE-DN)
111167         OR (PPC-FLD-NBR = PAPOS-ANNUAL-HOURS-DN)
008300             MOVE PPC-N-VALUE         TO HRWS-DEC-FIELD
008310             MOVE 0                   TO HRWS-SIZE
008320             MOVE 4                   TO HRWS-NBR-DECIMALS
008330             PERFORM 770-HR-FORMAT-DEC-FIELD
008340             MOVE HRWS-VALUE          TO PA102WS-VALUE (I1)
008350                                         G1D-PPC-VALUE
J63836                                         G2D-PPC-VALUE
008360             MOVE PPC-N-VALUE-PRIOR
008370                                      TO HRWS-DEC-FIELD
008380             MOVE 0                   TO HRWS-SIZE
008390             MOVE 4                   TO HRWS-NBR-DECIMALS
008400             PERFORM 770-HR-FORMAT-DEC-FIELD
008410             MOVE HRWS-VALUE          TO PA102WS-VALUE-PRIOR (I1)
008420                                         G1D-PPC-VALUE-PRIOR
J63836                                         G2D-PPC-VALUE-PRIOR
008430         ELSE
008440             MOVE PPC-N-VALUE         TO HRWS-DEC-FIELD
008450             MOVE 0                   TO HRWS-SIZE
008460             MOVE 0                   TO HRWS-NBR-DECIMALS
008470             PERFORM 770-HR-FORMAT-DEC-FIELD
008480             MOVE HRWS-VALUE          TO PA102WS-VALUE (I1)
008490                                         G1D-PPC-VALUE
J63836                                         G2D-PPC-VALUE
008500             MOVE PPC-N-VALUE-PRIOR   TO HRWS-DEC-FIELD
008510             MOVE 0                   TO HRWS-SIZE
008520             MOVE 0                   TO HRWS-NBR-DECIMALS
008530             PERFORM 770-HR-FORMAT-DEC-FIELD
008540             MOVE HRWS-VALUE          TO PA102WS-VALUE-PRIOR (I1)
008550                                         G1D-PPC-VALUE-PRIOR
J63836                                         G2D-PPC-VALUE-PRIOR.
008560
008570     IF (PPC-A-VALUE-PRIOR NOT = SPACES)
008580     OR (PPC-A-VALUE       NOT = SPACES)
008590         MOVE PPC-A-VALUE             TO PA102WS-VALUE (I1)
008600                                         G1D-PPC-VALUE
J63836                                         G2D-PPC-VALUE
008610         MOVE PPC-A-VALUE-PRIOR       TO PA102WS-VALUE-PRIOR (I1)
008620                                         G1D-PPC-VALUE-PRIOR
J63836                                         G2D-PPC-VALUE-PRIOR.
008630
008640     MOVE PA102WS-DEFAULT-FLG (I1)    TO G1D-DEFAULT
J63836                                         G2D-DEFAULT.
008650     MOVE PA102WS-ITEM-NAME (I1)      TO G1D-PAD-ITEM-NAME
J63836                                         G2D-PAD-ITEM-NAME.
008660
008670     ADD 1 TO I1.
008680     MOVE G1D-POSITION-DETAIL        TO RPT-GROUP-REQUEST.
008690     PERFORM 700-PRINT-RPT-GRP.
J63836     MOVE G2D-POSITION-DETAIL        TO RPT-GROUP-REQUEST.
J63836     PERFORM 700-PRINT-RPT-GRP.
008700
008710     IF (PPC-FLD-NBR = PAPOS-EXP-COMPANY-DN)
008720         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-EXP-COMPANY.
008730     IF (PPC-FLD-NBR = PAPOS-EXP-ACCOUNT-DN)
008740         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-EXP-ACCOUNT.
008750     IF (PPC-FLD-NBR = PAPOS-EXP-SUB-ACCT-DN)
008760         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-EXP-SUB-ACCT.
008770     IF (PPC-FLD-NBR = PAPOS-PAY-RATE-DN)
008780         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-PAY-RATE.
008790     IF (PPC-FLD-NBR = PAPOS-PAY-FREQUENCY-DN)
008800         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-PAY-FREQUENCY.
008810     IF (PPC-FLD-NBR = PAPOS-PAY-STEP-DN)
008820         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-PAY-STEP.
008830     IF (PPC-FLD-NBR = PAPOS-SHIFT-DN)
008840         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-SHIFT.
008850     IF (PPC-FLD-NBR = PAPOS-SEC-LVL-DN)
008860         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-SEC-LVL.
008870     IF (PPC-FLD-NBR = PAPOS-ANNUAL-HOURS-DN)
008880         MOVE PPC-N-VALUE-PRIOR       TO PA102WS-ANNUAL-HOURS.
008890
008900 1500-END.
008910
008920******************************************************************
008930 1600-PROCESS-PAEMPPOS.                                       .
008940******************************************************************
008950   
J63836     MOVE 0                           TO WS-EMPLIST-SW.
J63836     IF ((PEP-END-DATE   NOT = ZEROES)
J63836     AND (PEP-END-DATE      >= PA102WS-EFFECT-DATE)) 
J63836         MOVE 1                       TO WS-EMPLIST-SW
J63836         IF (NO-EMPLIST-DATA-TO-PRINT)
J63836             SET EMPLIST-DATA-TO-PRINT       TO TRUE
J63836         END-IF
J63836     END-IF.
J31587   
J31587     IF ((PEP-END-DATE   NOT = ZEROES)
J31587     AND (PEP-END-DATE       < PA102WS-EFFECT-DATE))
J31587         GO TO 1600-FIND-NEXT-PAEMPPOS
J31587     END-IF.
008990
009000     IF  (PRM-UPDATE = "Y")
J63836     AND (EMPLIST-NOTFOUND)
009010         MOVE PEP-EMPLOYEE            TO PA102WS-LAST-EMPLOYEE
009020         MOVE PEP-POS-LEVEL           TO PA102WS-LAST-POS-LEVEL.
009030
009040     MOVE PEP-COMPANY                 TO DB-COMPANY.
009050     MOVE PEP-EMPLOYEE                TO DB-EMPLOYEE
009060                                         PA102WS-PEP-EMPLOYEE. 
009070     MOVE PEP-POS-LEVEL               TO PA102WS-PEP-POS-LEVEL.
009080     MOVE PEP-EFFECT-DATE             TO PA102WS-PEP-EFFECT-DATE.
009090     PERFORM 840-FIND-EMPSET1.
009100     PERFORM 840-FIND-PEMSET1.
009110     IF (EMPLOYEE-NOTFOUND)
009120         GO TO 1600-FIND-NEXT-PAEMPPOS
009130     ELSE
009140         MOVE EMP-LAST-NAME           TO HRWS-LAST-NAME
009150         MOVE EMP-FIRST-NAME          TO HRWS-FIRST-NAME
009160         MOVE EMP-MIDDLE-INIT         TO HRWS-MIDDLE-INIT
               MOVE EMP-LAST-NAME-PRE       TO HRWS-LAST-NAME-PRE
               MOVE EMP-NAME-SUFFIX         TO HRWS-NAME-SUFFIX
009170         PERFORM 750-HR-FORMAT-NAME.
009180
009190     SET PA102WS-NOUPDATES            TO TRUE.
           MOVE "PA102"                     TO CRT-ERROR-CAT.
009200
P34870     MOVE HREMP-FC                    TO CRT-PROC-LEV-SECURED.
P34870     MOVE EMP-COMPANY                 TO CRT-COMPANY.
P34870     MOVE EMP-PROCESS-LEVEL           TO CRT-PROCESS-LEVEL.
P34870     PERFORM 700-HR-EMP-SECURITY.
P34870     IF  (HRWS-EMP-SECURED)
J63836     AND (EMPLIST-NOTFOUND)
P34870         MOVE PEP-POSITION            TO G9A-PPC-POSITION
P34870         MOVE PA102WS-POS-DESCRIPTION TO G9A-POS-DESCRIPTION
P34870         MOVE PEP-EFFECT-DATE         TO G9A-PPC-EFFECT-DATE
P34870         MOVE PEP-EMPLOYEE            TO G9A-EMP-REQ
P34870         MOVE PEP-POS-LEVEL           TO G9A-POS-LEVEL
P34870         MOVE HRWS-FORMAT-NAME        TO PA102WS-NAME
P34870         MOVE PA102WS-EMP-NAME        TO G9A-DESCRIPTION
P34870         MOVE 136                     TO CRT-MSG-NBR
P34870         PERFORM 790-GET-MSG
P34870         MOVE CRT-MESSAGE             TO G9A-COMMENTS
P34870         MOVE GN9A-ERROR-DETAIL       TO RPT-GROUP-REQUEST
P34870         PERFORM 700-PRINT-RPT-GRP
P34870         IF (NO-ERR-DATA-TO-PRINT)
P34870             SET ERR-DATA-TO-PRINT    TO TRUE
P34870         END-IF
P34870         GO TO 1600-FIND-NEXT-PAEMPPOS
P34870     END-IF.
P34870
118754     IF  (((PEP-POS-LEVEL    = 1)
009220     AND  (PA102WS-END-DATE NOT = ZEROES)
118754     AND  (PEP-POSITION     NOT = PA102WS-SV-POSITION))
009230     OR  ((PEP-POS-LEVEL    > 1)
009240     AND  (PA102WS-END-DATE NOT = ZEROES)
118754     AND  (PEP-EFFECT-DATE  >= PA102WS-END-DATE)))
J63836     AND (EMPLIST-NOTFOUND)
009260         MOVE PEP-POSITION            TO G9A-PPC-POSITION
118754                                         PA102WS-SV-POSITION
009270         MOVE PA102WS-POS-DESCRIPTION TO G9A-POS-DESCRIPTION
009280         MOVE PEP-EFFECT-DATE         TO G9A-PPC-EFFECT-DATE
009290         MOVE HRWS-FORMAT-NAME        TO PA102WS-NAME
009300         MOVE PA102WS-EMP-NAME        TO G9A-DESCRIPTION
009310         MOVE PEP-EMPLOYEE            TO G9A-EMP-REQ
               MOVE PEP-POS-LEVEL           TO G9A-POS-LEVEL
009320         IF (PEP-POS-LEVEL > 1)
009330             MOVE 116                 TO CRT-MSG-NBR
009340         ELSE
009350             MOVE 115                 TO CRT-MSG-NBR
009360         END-IF
009370         PERFORM 790-GET-MSG
009380         MOVE CRT-MESSAGE             TO G9A-COMMENTS
009390         MOVE GN9A-ERROR-DETAIL       TO RPT-GROUP-REQUEST
009400         PERFORM 700-PRINT-RPT-GRP
               IF (NO-ERR-DATA-TO-PRINT)
                   SET ERR-DATA-TO-PRINT      TO TRUE
               END-IF
009410         MOVE PRM-COMPANY               TO DB-COMPANY
009420         MOVE PEP-EMPLOYEE              TO DB-EMPLOYEE
009430         INITIALIZE                        DB-REQUISITION
009440         MOVE PA102WS-POSITION          TO DB-POSITION
009450         MOVE PA102WS-EFFECT-DATE       TO DB-EFFECT-DATE
009460         MOVE "2  "                     TO DB-UPDATE-TYPE
009470         PERFORM 840-FIND-PPESET1
009480         IF (PRM-UPDATE = "Y")
J63836         AND (EMPLIST-NOTFOUND)
009490             IF (PAPOSERR-NOTFOUND)
009500               PERFORM 800-CREATE-PAPOSERR
009510               MOVE PRM-COMPANY           TO PPE-COMPANY
009520               MOVE PEP-EMPLOYEE          TO PPE-EMPLOYEE
009530               INITIALIZE                    PPE-REQUISITION
009540               MOVE PA102WS-POSITION      TO PPE-POSITION
009550               MOVE PA102WS-EFFECT-DATE   TO PPE-EFFECT-DATE
009560               MOVE "2  "                 TO PPE-UPDATE-TYPE
009570               MOVE PEP-POS-LEVEL         TO PPE-POS-LEVEL (1)
009580               PERFORM 820-STORE-PAPOSERR
009590           ELSE
                     PERFORM
                         VARYING I3 FROM 1 BY 1
                         UNTIL  (I3 > 98)
                         OR     (PPE-POS-LEVEL (I3) = PEP-POS-LEVEL)
                             CONTINUE
                     END-PERFORM
                     IF (I3 > 98)
009650                  PERFORM 840-MODIFY-PPESET1
009660                  PERFORM
009670                     VARYING I3 FROM 1 BY 1
009680                     UNTIL  (I3 > 98)
009690                     OR     (PPE-POS-LEVEL (I3) = ZEROES)
009700                         MOVE PEP-POS-LEVEL TO PPE-POS-LEVEL (I3) 
009710                  END-PERFORM
009720                  PERFORM 820-STORE-PAPOSERR.
009730
009740     MOVE WS-FALSE                    TO WS-ACTION-FOUND-SW.
009750
009760     INITIALIZE WS-ACTION-TABLE
009770                WS-ACT-END-DATE
009780                WS-ACT-POS-LEVEL.
009790
009800     MOVE 1                           TO I4.
           MOVE PEP-COMPANY                 TO DB-COMPANY.
009810     MOVE "E"                         TO DB-ACTION-TYPE.
009820     MOVE PEP-EMPLOYEE                TO DB-EMPLOYEE.
           MOVE ZEROES                      TO DB-EFFECT-DATE
                                               DB-ACTION-NBR. 
           MOVE SPACES                      TO DB-ACTION-CODE.
           PERFORM 850-FIND-NLT-PCTSET2.
009850     IF (PERSACTION-FOUND)
009860         MOVE WS-TRUE                 TO WS-ACTION-FOUND-SW
               MOVE PCT-COMPANY             TO PA102WS-PCT-COMPANY
               MOVE PCT-ACTION-TYPE         TO PA102WS-PCT-ACTION-TYPE
               MOVE PCT-EMPLOYEE            TO PA102WS-PCT-EMPLOYEE
009870         PERFORM 1650-CHECK-ACTION
009880         THRU    1650-END
009890             UNTIL (PERSACTION-NOTFOUND)
                   OR    (PCT-COMPANY     NOT = DB-COMPANY)
                   OR    (PCT-EMPLOYEE    NOT = DB-EMPLOYEE)
                   OR    (PCT-ACTION-TYPE NOT = DB-ACTION-TYPE).
009900
           MOVE PEP-COMPANY                 TO DB-COMPANY.
009910     MOVE "L"                         TO DB-ACTION-TYPE.
009920     MOVE PEP-EMPLOYEE                TO DB-EMPLOYEE.
           MOVE ZEROES                      TO DB-EFFECT-DATE
                                               DB-ACTION-NBR. 
           MOVE SPACES                      TO DB-ACTION-CODE.
           PERFORM 850-FIND-NLT-PCTSET2.
009950     IF (PERSACTION-FOUND)
009960         MOVE WS-TRUE                 TO WS-ACTION-FOUND-SW
               MOVE PCT-COMPANY             TO PA102WS-PCT-COMPANY
               MOVE PCT-ACTION-TYPE         TO PA102WS-PCT-ACTION-TYPE
               MOVE PCT-EMPLOYEE            TO PA102WS-PCT-EMPLOYEE
009970         PERFORM 1650-CHECK-ACTION
009980         THRU    1650-END
009990             UNTIL (PERSACTION-NOTFOUND)
                   OR    (PCT-COMPANY     NOT = DB-COMPANY)
                   OR    (PCT-EMPLOYEE    NOT = DB-EMPLOYEE)
                   OR    (PCT-ACTION-TYPE NOT = DB-ACTION-TYPE).
010000
010010     MOVE WS-FALSE                     TO WS-ACTIONS-DONE-SW.
010020
010030     IF (WS-ACTIONS)
010040         PERFORM 1700-SORT-ACTIONS
010050         THRU    1700-END
010060         MOVE WS-FALSE                TO WS-SKIP-EMPLOYEE-SW
010070         PERFORM 2000-PROCESS-ACTIONS
010080         THRU    2000-END
010090             VARYING I1 FROM 1 BY 1
010100             UNTIL  (I1 > 50)
010110             OR     (WS-ACTION-CODE (I1) = SPACES)
010120             OR     (WS-SKIP-EMPLOYEE)
010130         IF (WS-SKIP-EMPLOYEE)
010140             GO TO 1600-FIND-NEXT-PAEMPPOS.
010150
010160     IF  (PA102WS-NOUPDATES)
010170     AND (PEP-POS-LEVEL    > 1)
010180     AND (PA102WS-END-DATE NOT = ZEROES)
010190     AND (PEP-EFFECT-DATE  < PA102WS-END-DATE)
010200         SET PA102WS-UPDATES TO TRUE.
010210
010220     IF (PEP-POS-LEVEL = 1)
010230         INITIALIZE HREMP-SCR-FIELDS
010240                    HRPEM-SCR-FIELDS
010250         PERFORM 7000-HREMP-DEFAULT
010260         PERFORM 7000-HRPEM-DEFAULT
010270     ELSE
010280         INITIALIZE PAPEP-SCR-FIELDS
010290         PERFORM 7000-PAPEP-DEFAULT.
010300
010310     INITIALIZE G2AWS.
010320     IF  (PA102WS-END-DATE NOT = ZEROES)
010330     AND (PEP-POS-LEVEL    > 1)
010340     AND (PEP-EFFECT-DATE  < PA102WS-END-DATE)
010350         MOVE 1                      TO G2-IND
010360         INITIALIZE                 G2AWS-PPC-VALUE-PRIOR (G2-IND)
010370         MOVE PEP-EMPLOYEE           TO G2AWS-EMP-REQ (G2-IND)
010380         MOVE HRWS-FORMAT-NAME       TO
010390                                   G2AWS-NAME-DESCRIPTION (G2-IND)
010400         MOVE PEP-EFFECT-DATE        TO
010410                                    G2AWS-PPC-EFFECT-DATE (G2-IND)
J63836         MOVE PEP-END-DATE           TO  
J63836                                    G2AWS-PPC-END-DATE (G2-IND) 
010420         MOVE PEP-POS-LEVEL          TO G2AWS-PPC-LVL (G2-IND)
010430         INITIALIZE                     G2AWS-PPC-VALUE (G2-IND)
010440         MOVE HRPEP-END-DATE-DN      TO G2AWS-FLD-NBR (G2-IND)
010450                                        DB-FLD-NBR
010460         PERFORM 840-FIND-PADSET1
010470         IF (PADICT-FOUND)
                  MOVE PAD-ITEM-NAME       TO CRT-PHRASE
                  MOVE WS-PHRASE-SIZE      TO CRT-PHRASE-SIZE
                  MOVE "N"                 TO CRT-PUT-DOTS
                  PERFORM 900-GET-PHRASE-XLT
                  MOVE CRT-PHRASE-XLT      TO
010490                                     G2AWS-PAD-ITEM-NAME (G2-IND)
010500         END-IF
P58562         MOVE WS-PA102-MSG-121       TO G2AWS-COMMENTS (G2-IND)
010540         ADD 1                       TO G2-IND
010550     ELSE
010560         MOVE 1                      TO G2-IND.
010570
           SET PA102WS-NO-PAY-RATE-UPD     TO TRUE.
           SET PA102WS-NOEMPLOYEE-ERR      TO TRUE.
010580     PERFORM
010590       VARYING I1 FROM 1 BY 1
010600       UNTIL  (I1 > PA102WS-COUNTER)
010610       OR     (PA102WS-FIELD-NBR (I1) = ZEROES)
010620         INITIALIZE             G2AWS-PPC-VALUE-PRIOR (G2-IND)
010630         MOVE WS-FALSE           TO WS-DEFAULT-INFO-SW
010640         IF (PA102WS-DEFAULT-FLG (I1) = 3)
010650             PERFORM 2150-MOVE-VALUE
010660             THRU    2150-END
010670         END-IF
010680         IF (PA102WS-DEFAULT-FLG (I1) = 2)
                   SET PA102WS-NOCURR-ERROR     TO TRUE
010690             PERFORM 2100-CHECK-VALUE
010700             THRU    2100-END
                   IF (PA102WS-CURR-ERROR)
                       GO TO 1600-FIND-NEXT-PAEMPPOS
                   END-IF
010710         END-IF
010720         IF  (PA102WS-DEFAULT-FLG (I1) = 2 OR 3)
010730         AND (G2AWS-FIELD-CHANGED (G2-IND) NOT = "N")
010740           IF   (PA102WS-END-DATE = ZEROES)
010750           OR  ((PEP-POS-LEVEL            > 1)
010760           OR   (PA102WS-END-DATE         NOT = ZEROES)
010770           AND  (PEP-EFFECT-DATE          < PA102WS-END-DATE))
010780               MOVE PEP-EMPLOYEE          TO
010790                                           G2AWS-EMP-REQ (G2-IND)
010800               MOVE HRWS-FORMAT-NAME      TO
010810                                  G2AWS-NAME-DESCRIPTION (G2-IND)
010820               MOVE PEP-POS-LEVEL          TO
010830                                           G2AWS-PPC-LVL (G2-IND)
010840               MOVE PA102WS-FIELD-NBR2 (I1)
010850                                 TO G2AWS-FLD-NBR (G2-IND)
010860               MOVE PA102WS-VALUE (I1)     TO
010870                                          G2AWS-PPC-VALUE (G2-IND)
010880               MOVE PA102WS-ITEM-NAME (I1) TO
010890                                      G2AWS-PAD-ITEM-NAME (G2-IND)
010900               IF (G2AWS-FIELD-CHANGED (G2-IND) = SPACES)
010910                 MOVE PEP-EFFECT-DATE     TO
010920                                    G2AWS-PPC-EFFECT-DATE (G2-IND)
J63836                 MOVE PEP-END-DATE        TO
J63836                                    G2AWS-PPC-END-DATE (G2-IND)
P58562                 MOVE WS-PA102-MSG-117    TO
P58562                                          G2AWS-COMMENTS (G2-IND)
J63836*                MOVE 0                   TO WS-EMPLIST-SW
010970               ELSE
                       IF (PEP-EFFECT-DATE > PA102WS-EFFECT-DATE)
J63836                 OR (EMPLIST-FOUND)
                           MOVE PEP-EFFECT-DATE TO
                                          G2AWS-PPC-EFFECT-DATE (G2-IND)
J63836                     MOVE PEP-END-DATE    TO
J63836                                    G2AWS-PPC-END-DATE (G2-IND)
                       ELSE
010980                     MOVE PA102WS-EFFECT-DATE TO
010990                                    G2AWS-PPC-EFFECT-DATE (G2-IND)
J63836*                    MOVE PA102WS-END-DATE       TO
J63836*                                   G2AWS-PPC-END-DATE (G2-IND)
                       END-IF
P58562                 MOVE WS-PA102-MSG-119    TO
P58562                                           G2AWS-COMMENTS (G2-IND)
011040               END-IF
011050               ADD 1 TO G2-IND
011060           END-IF
011070         END-IF
011080     END-PERFORM.
011090
011100     IF  (PA102WS-FIELD-NBR (1) = ZEROES)
011110     AND (PA102WS-FIELD-NBR (2) = ZEROES)
011120     AND (PA102WS-END-DATE      NOT = ZEROES)
011130         IF   (PEP-POS-LEVEL         = 1)
011140         OR  ((PEP-POS-LEVEL         > 1)
011150         AND  (PEP-EFFECT-DATE       >= PA102WS-END-DATE))
011160             IF  (PRM-UPDATE = "Y")
J63836             AND (EMPLIST-NOTFOUND)
011170                 MOVE PEP-COMPANY            TO DB-COMPANY
011180                 MOVE PEP-EMPLOYEE           TO DB-EMPLOYEE
011190                 MOVE PEP-POS-LEVEL          TO DB-POS-LEVEL
011200                 MOVE PEP-EFFECT-DATE        TO DB-EFFECT-DATE
011210                 PERFORM 840-MODIFY-PEPSET1
011220                 MOVE PA102WS-EFFECT-DATE    TO PEP-POS-EFF-DT
011230                 MOVE WS-SYSTEM-DATE-YMD     TO PEP-DATE-STAMP
011240                 MOVE HHMMSS                 TO PEP-TIME-STAMP
011250                 MOVE CRT-USER-NAME          TO PEP-USER-ID
011260                 PERFORM 820-STORE-PAEMPPOS
011270                 GO TO 1600-FIND-NEXT-PAEMPPOS
011280             ELSE
011290                 GO TO 1600-FIND-NEXT-PAEMPPOS.
011300
011310     IF (PA102WS-NOUPDATES)
011320         MOVE PEP-POSITION            TO G9A-PPC-POSITION
011330         MOVE PA102WS-POS-DESCRIPTION TO G9A-POS-DESCRIPTION
011340         MOVE PEP-EFFECT-DATE         TO G9A-PPC-EFFECT-DATE
011350         MOVE PEP-EMPLOYEE            TO G9A-EMP-REQ
               MOVE PEP-POS-LEVEL           TO G9A-POS-LEVEL
011360         MOVE HRWS-FORMAT-NAME        TO PA102WS-NAME
011370         MOVE PA102WS-EMP-NAME        TO G9A-DESCRIPTION
P58562         MOVE WS-PA102-MSG-118        TO G9A-COMMENTS
011410         MOVE GN9A-ERROR-DETAIL       TO RPT-GROUP-REQUEST
011420         PERFORM 700-PRINT-RPT-GRP
               IF (NO-ERR-DATA-TO-PRINT)
                   SET ERR-DATA-TO-PRINT      TO TRUE
               END-IF
011430         IF (PRM-UPDATE = "Y")
J63836         AND (EMPLIST-NOTFOUND)
011440             MOVE PEP-COMPANY            TO DB-COMPANY
011450             MOVE PEP-EMPLOYEE           TO DB-EMPLOYEE
011460             MOVE PEP-POS-LEVEL          TO DB-POS-LEVEL
011470             MOVE PEP-EFFECT-DATE        TO DB-EFFECT-DATE
011480             PERFORM 840-MODIFY-PEPSET1
011490             MOVE PA102WS-EFFECT-DATE    TO PEP-POS-EFF-DT
011500             MOVE WS-SYSTEM-DATE-YMD     TO PEP-DATE-STAMP
011510             MOVE HHMMSS                 TO PEP-TIME-STAMP
011520             MOVE CRT-USER-NAME          TO PEP-USER-ID
011530             PERFORM 820-STORE-PAEMPPOS
                   MOVE PRM-COMPANY             TO DB-COMPANY
                   MOVE PA102WS-LAST-EMPLOYEE   TO DB-EMPLOYEE
                   INITIALIZE                      DB-REQUISITION
                   MOVE PA102WS-POSITION        TO DB-POSITION
                   MOVE PA102WS-EFFECT-DATE     TO DB-EFFECT-DATE
                   MOVE "3  "                   TO DB-UPDATE-TYPE
                   PERFORM 840-MODIFY-PPESET1
                   IF (PAPOSERR-FOUND)
                       PERFORM 830-DELETE-PAPOSERR
                   END-IF
                   MOVE "1  "                   TO DB-UPDATE-TYPE
                   PERFORM 840-MODIFY-PPESET1
                   IF (PAPOSERR-FOUND)
                       PERFORM 830-DELETE-PAPOSERR
                   END-IF
011540             GO TO 1600-FIND-NEXT-PAEMPPOS
011550         ELSE
011560             GO TO 1600-FIND-NEXT-PAEMPPOS.
011570
011580     IF (PA102WS-NOEMPS)
011590         SET PA102WS-EMPS             TO TRUE.
011600
011610     MOVE 1 TO G2-IND.
011620     PERFORM
011630         UNTIL  (G2-IND > 30)
011640         OR     (G2AWS-FIELD-CHANGED (G2-IND) = WS-STAR)
011650             ADD 1 TO G2-IND.
011660     IF (G2-IND > 30)
011670         SET PA102WS-NOHISTORY TO TRUE
011680     ELSE
011690         SET PA102WS-HISTORY TO TRUE.
011700
011710     MOVE EMP-COMPANY                 TO DB-COMPANY.
011720     MOVE EMP-EMP-STATUS              TO DB-EMP-STATUS.
011730     PERFORM 840-FIND-EMSSET1.
011740     INITIALIZE                          HREMP-I2.
           MOVE PEP-EMPLOYEE                TO PA102WS-SAVE-EMPLOYEE.
           MOVE PEP-POS-LEVEL               TO PA102WS-SAVE-POS-LEVEL.
           MOVE PEP-EFFECT-DATE             TO PA102WS-SAVE-EFFECT-DATE.
011750     IF (PEP-POS-LEVEL = 1)
J36155     AND (EMPLIST-NOTFOUND)
011760         MOVE WS-TRUE                 TO HREMP-PAUSER-FLAG-SW
011770         IF (EMSTATUS-FOUND)
011780             MOVE EMS-COUNT           TO HREMP-COUNT
011790                                         HREMP-BCOUNT
011800         END-IF
011810         MOVE 1                       TO HREMP-POS-LEVEL
               PERFORM 1750-LOAD-HREMP-EFFECT-DATE
               THRU    1750-END
               IF (PAEMPPOS-NOTFOUND)
                   GO TO 1600-END
               END-IF
011910         MOVE PA102WS-END-DATE        TO HREMP-PAPOS-END-DATE
J82034
J82034         MOVE PA102WS-ACTION          TO DB-ACTION-CODE
J82034         PERFORM 840-FIND-PATSET1
J82034         IF (PERSACTYPE-FOUND)
J82034             MOVE PAT-DFT-UPD-BN      TO HREMP-UPDATE-BENEFIT
J82034         ELSE
J82034             MOVE "N"                 TO HREMP-UPDATE-BENEFIT
J82034         END-IF
J82034         
J82034*        MOVE "Y"                     TO HREMP-UPDATE-BENEFIT
J33276         MOVE "Y"                     TO HREMP-ACTION
011950         MOVE PEP-COMPANY             TO HREMP-COMPANY
011960         MOVE 1                       TO HREMP-COMPANY-FN
011970         MOVE PEP-EMPLOYEE            TO HREMP-EMPLOYEE
011980         MOVE 1                       TO HREMP-EMPLOYEE-FN
011990         MOVE WS-TRUE                 TO HREMP-FROM-ACTION-SW
012000                                         HREMP-POS-CHG-SW
               MOVE PA102WS-ACTION          TO HREMP-ACTION-CODE
012010         IF (PA102WS-NOHISTORY)
012020             SET HREMP-POS-CHG        TO TRUE
012030         ELSE
012040             SET HREMP-NO-POS-CHG     TO TRUE
012050         END-IF
               SET FROM-PA102               TO TRUE
012060         PERFORM 2000-HREMP-EDIT-TRAN
               MOVE "PA102"                 TO CRT-ERROR-CAT
               IF  (POS-CURRENCY-CODE NOT = HREMP-CURRENCY-CODE)
               AND (PA102WS-PAY-RATE-UPD)                        
                   MOVE 134                 TO CRT-MSG-NBR
                   MOVE POS-CURRENCY-CODE   TO CRT-ERR-VAR1
                   MOVE HREMP-CURRENCY-CODE TO CRT-ERR-VAR2
                   PERFORM 790-GET-MSG
                   PERFORM 2610-WRITE-PAY-PAPOSERR
                   THRU    2610-END
                   SET ERR-DATA-TO-PRINT     TO TRUE
                   SET PA102WS-EMPLOYEE-ERR  TO TRUE
               END-IF      
               IF  (POS-CURRENCY-CODE = HREMP-CURRENCY-CODE)
               AND (EMP-CURRENCY-CODE NOT = HREMP-CURRENCY-CODE)
                   MOVE 131                 TO CRT-MSG-NBR
                   MOVE POS-CURRENCY-CODE   TO CRT-ERR-VAR1
                   PERFORM 790-GET-MSG
                   IF (ERR-DATA-TO-PRINT)
                       PERFORM 2610-WRITE-PAY-PAPOSERR
                       THRU    2610-END
                       SET ERR-DATA-TO-PRINT     TO TRUE
                       SET PA102WS-EMPLOYEE-ERR  TO TRUE
                   ELSE
                       SET PA102-EMP       TO TRUE
                       PERFORM 3200-WRITE-ERR-MSG
                       SET WARN-DATA-TO-PRINT       TO TRUE
                   END-IF
               END-IF
012080     ELSE
J36155         IF (EMPLIST-NOTFOUND)
012090             IF (PEP-EFFECT-DATE < PA102WS-END-DATE)
012100                 MOVE PA102WS-END-DATE    TO PAPEP-END-DATE
012110             END-IF
012150             IF (EMSTATUS-FOUND)
012160                 MOVE EMS-COUNT           TO PAPEP-COUNT
012170                                             PAPEP-BCOUNT
012180             END-IF
                   PERFORM 1725-LOAD-PAPEP-EFFECT-DATE
                   THRU    1725-END
012270             MOVE PA102WS-END-DATE        TO PAPEP-PAPOS-END-DATE
012280             MOVE WS-TRUE                 TO PAPEP-FROM-ACTION-SW
012290                                             PAPEP-POS-CHG-SW
J82034
J82034             MOVE PA102WS-ACTION          TO DB-ACTION-CODE
J82034             PERFORM 840-FIND-PATSET1
J82034             IF (PERSACTYPE-FOUND)
J82034                 MOVE PAT-DFT-UPD-BN      TO HREMP-UPDATE-BENEFIT
J82034             ELSE
J82034                 MOVE "N"                 TO HREMP-UPDATE-BENEFIT
J82034             END-IF
J82034
012350             MOVE "Y"                     TO HREMP-BATCH-PROGRAM
J82034*                                            HREMP-UPDATE-BENEFIT
012370                                             PAPEP-ACTION
012380             MOVE PA102WS-ACTION          TO PAPEP-ACTION-CODE
012390             IF (PA102WS-NOHISTORY)
012400                 SET PAPEP-POS-CHG        TO TRUE
012410*                MOVE "C"                 TO PAPEP-FC
012420*                MOVE PEP-EFFECT-DATE     TO PAPEP-EFFECT-DATE
012430             ELSE
012440                 SET PAPEP-NO-POS-CHG     TO TRUE
012450             END-IF
012460             PERFORM 2000-PAPEP-EDIT-TRAN
                   MOVE "PA102"                  TO CRT-ERROR-CAT
                   IF  (POS-CURRENCY-CODE NOT = PAPEP-CURRENCY-CODE)
                   AND (PA102WS-PAY-RATE-UPD)                        
                       MOVE 134                 TO CRT-MSG-NBR
                       MOVE POS-CURRENCY-CODE   TO CRT-ERR-VAR1
                       MOVE PAPEP-CURRENCY-CODE TO CRT-ERR-VAR2
                       PERFORM 790-GET-MSG
                       PERFORM 2610-WRITE-PAY-PAPOSERR
                       THRU    2610-END
                       SET PA102WS-EMPLOYEE-ERR   TO TRUE
                       SET ERR-DATA-TO-PRINT      TO TRUE
                   END-IF
                   MOVE PRM-COMPANY                 TO DB-COMPANY
                   MOVE PA102WS-PEP-EMPLOYEE        TO DB-EMPLOYEE
                   MOVE PA102WS-PEP-POS-LEVEL       TO DB-POS-LEVEL
                   MOVE PA102WS-PEP-EFFECT-DATE     TO DB-EFFECT-DATE
                   PERFORM 840-FIND-PEPSET1
                   IF  (POS-CURRENCY-CODE = PAPEP-CURRENCY-CODE)
                   AND (PEP-CURRENCY-CODE NOT = PAPEP-CURRENCY-CODE)
                       MOVE 131                 TO CRT-MSG-NBR
                       MOVE POS-CURRENCY-CODE   TO CRT-ERR-VAR1
                       PERFORM 790-GET-MSG
                       IF (ERR-DATA-TO-PRINT)
                           PERFORM 2610-WRITE-PAY-PAPOSERR
                           THRU    2610-END
                           SET PA102WS-EMPLOYEE-ERR  TO TRUE
                       ELSE
                           SET PA102-EMP       TO TRUE
                           PERFORM 3200-WRITE-ERR-MSG
                           SET WARN-DATA-TO-PRINT       TO TRUE
                       END-IF
                   END-IF 
J36155         END-IF
J36155     END-IF.
012480
           IF (HREMP-I2 NOT = ZEROES)
               MOVE "HREMP"                      TO CRT-ERROR-CAT
               IF (HREMP-ERROR-FOUND)
                   IF (NO-ERR-DATA-TO-PRINT)
                       SET ERR-DATA-TO-PRINT      TO TRUE
                   END-IF
012500             PERFORM 2600-WRITE-EMP-PAPOSERR
012510             THRU    2600-END
012520             MOVE "PA102"                     TO CRT-ERROR-CAT
012530             GO TO 1600-FIND-NEXT-PAEMPPOS
               ELSE
               IF (HREMP-WARNING-FOUND)
                   IF (NO-WARN-DATA-TO-PRINT)
                       SET WARN-DATA-TO-PRINT       TO TRUE
                   END-IF
012500             PERFORM 2625-WRITE-EMPMSG-PAPOSERR
012510             THRU    2625-END
012520             MOVE "PA102"                     TO CRT-ERROR-CAT
012540         ELSE
012550             MOVE "PA102"                     TO CRT-ERROR-CAT.
012560
           IF (HREMP-ERROR-FOUND)
           OR (PA102WS-EMPLOYEE-ERR)
               GO TO 1600-FIND-NEXT-PAEMPPOS.

012570     IF  (PRM-UPDATE = "Y")
012580     AND (PA102WS-HISTORY)
J63836     AND (EMPLIST-NOTFOUND)
P78926         PERFORM 7500-GET-OBJECT-ID
012610         MOVE IFOBIWS-OBJ-ID              TO PA102WS-OBJ-ID.
012620
CRP001     
CRP001*--- Initiate a work unit for CRP Benefits recalculation
           IF (PA102WS-PEP-EMPLOYEE = 78323)
              GO TO 1600-TEST.
CRP001     IF (PRM-UPDATE NOT = "Y")
J63836     OR (EMPLIST-FOUND)
CRP001     OR (PA102WS-PEP-POS-LEVEL NOT = 1)
CRP001         GO TO 1600-SKIP-CRP-RECALC.
       1600-TEST.
CRP001     MOVE PA102WS-ACTION         TO HRCRP-ACTION-CODE.
CRP001     PERFORM 9000-CHECK-ACTION-CODE.
CRP001     IF (HRCRP-RECALC-ACTION = "N")
CRP001         GO TO 1600-SKIP-CRP-RECALC.
CRP001     MOVE PRM-COMPANY             TO HRCRP-COMPANY.
CRP001     MOVE PA102WS-PEP-EMPLOYEE    TO HRCRP-EMPLOYEE.
CRP001     MOVE HREMP-EFFECT-DATE         TO HRCRP-EFFECT-DATE.
CRP001     PERFORM 1000-SETUP-CRP-TRIGGER-WS.
CRP001*--- Reset fields for PA102 specific values
CRP001     MOVE PA102WS-ACTION         TO HRCRP-ACTION-CODE.
CRP001     PERFORM 8433-CALC-OLD-SALARY.
CRP001     MOVE HRCRP-OLD-SALARY-N     TO HRCRPWS-NUM-15.
CRP001     MOVE HRCRPWS-ALPHA-15       TO HRCRP-OLD-SALARY.
CRP001     MOVE HREMP-ANNUAL-HOURS     TO HRCRP-ANNUAL-HOURS.
CRP001     MOVE HREMP-SCHEDULE         TO HRCRP-SCHEDULE.          
CRP001     PERFORM 8436-CALC-NEW-SALARY.
CRP001     MOVE HRCRP-NEW-SALARY-N     TO HRCRPWS-NUM-15.
CRP001     MOVE HRCRPWS-ALPHA-15       TO HRCRP-NEW-SALARY.
CRP001     PERFORM 2000-CREATE-CRP-TRIGGER.
      *--- Pause so as to avoid overloading IPA Work unit creation
      *--- ***Pause may not be needed****
           PERFORM 902-SLEEP 5 TIMES.
CRP001 1600-SKIP-CRP-RECALC.
CRP001 
012630     IF  (PRM-UPDATE = "Y")
J63836     AND (EMPLIST-NOTFOUND)
012640         MOVE PRM-COMPANY                 TO DB-COMPANY
012650         MOVE PA102WS-PEP-EMPLOYEE        TO DB-EMPLOYEE
012660         MOVE PA102WS-PEP-POS-LEVEL       TO DB-POS-LEVEL
012670         MOVE PA102WS-PEP-EFFECT-DATE     TO DB-EFFECT-DATE
012680         PERFORM 840-FIND-PEPSET1
012690         IF (PEP-POS-LEVEL = 1)
012700             PERFORM
012710                 VARYING I1 FROM 1 BY 1
012720                 UNTIL  (I1 > 1999)
012730                     MOVE "X"             TO HREMP-LOG-FLAG (I1)
012740             END-PERFORM
012810             MOVE PA102WS-OBJ-ID          TO HREMP-ACT-OBJ-ID
012820             SET HREMP-POS-CHG            TO TRUE
012830             PERFORM 3000-HREMP-PROCESS-TRAN
012840         ELSE
012910             MOVE PA102WS-OBJ-ID          TO HREMP-ACT-OBJ-ID
012920             PERFORM 3000-PAPEP-PROCESS-TRAN
012930         END-IF
               MOVE "PA102"                     TO CRT-ERROR-CAT
               IF (HRWS-GROUP-SIZE-ERROR)
                   MOVE 133                     TO CRT-MSG-NBR
                   PERFORM 790-GET-MSG
                   IF (ERR-DATA-TO-PRINT)
                       PERFORM 2610-WRITE-PAY-PAPOSERR
                       THRU    2610-END
                       SET PA102WS-EMPLOYEE-ERR TO TRUE
                   ELSE
                       SET PA102-EMP            TO TRUE
                       PERFORM 3200-WRITE-ERR-MSG
                   END-IF
               END-IF
012940         IF (PA102WS-HISTORY)
012950             MOVE PRM-COMPANY             TO PAACT-COMPANY
012960             MOVE "E"                     TO PAACT-ACTION-TYPE
012970             MOVE PA102WS-PEP-EMPLOYEE    TO PAACT-EMPLOYEE
012980             MOVE PA102WS-ACTION          TO PAACT-ACTION-CODE
                   IF (PA102WS-PEP-POS-LEVEL = 1)
                       MOVE HREMP-EFFECT-DATE   TO PAACT-EFFECT-DATE
                   ELSE
                       MOVE PAPEP-EFFECT-DATE   TO PAACT-EFFECT-DATE
                   END-IF
013000             MOVE "Y"                     TO PAACT-HISTORY
013010             PERFORM 2300-PAACT-ACTION-NBR 
013020             MOVE PAACT-ACTION-NBR        TO PA102WS-ACTION-NBR
013030             MOVE "L"                     TO PAACT-ACTION-TYPE
013040             PERFORM 2300-PAACT-ACTION-NBR
013050             IF (PAACT-ACTION-NBR > PA102WS-ACTION-NBR)
013060                 MOVE PAACT-ACTION-NBR    TO PA102WS-ACTION-NBR
013070                                             PA102WS-ACTION-NBR
013080             END-IF
013090             PERFORM 800-CREATE-PERSACTHST
013100             MOVE PRM-COMPANY             TO PAH-COMPANY
013110             MOVE "E"                     TO PAH-ACTION-TYPE
013120             MOVE PA102WS-ACTION          TO PAH-ACTION-CODE
013130             MOVE PA102WS-ACTION-NBR      TO PAH-ACTION-NBR
                   IF (PA102WS-PEP-POS-LEVEL = 1)
                       MOVE HREMP-EFFECT-DATE   TO PAH-EFFECT-DATE
                   ELSE
                       MOVE PAPEP-EFFECT-DATE   TO PAH-EFFECT-DATE
                   END-IF
013150             MOVE PA102WS-PEP-EMPLOYEE    TO PAH-EMPLOYEE
013160             INITIALIZE                      PAH-ANT-END-DATE
101470*            MOVE PRM-REASON1             TO PAH-REASON (1)
101470             IF  (PRM-REASON1 = SPACES)
101470                  IF (PA102WS-SV-CHG-REASON NOT = SPACES)
101470                      MOVE PA102WS-SV-CHG-REASON
101470                                          TO PAH-REASON (1)
101470                  ELSE
101470                      MOVE PA102WS-SV-PRS-REASON
101470                                          TO PAH-REASON (1)
101470                  END-IF                  
101470             ELSE
101470                  MOVE PRM-REASON1        TO PAH-REASON (1)
101470             END-IF
013180             MOVE PRM-REASON2             TO PAH-REASON (2)
013190             MOVE CRT-USER-NAME           TO PAH-USER-ID
013200             MOVE WS-SYSTEM-DATE-YMD      TO PAH-DATE-STAMP
P80029             MOVE HHMMSS                  TO PAH-TIME-STAMP
P80029             MOVE WS-SYSTEM-DATE-YMD      TO PAH-CREATE-DATE
P80029             MOVE HHMMSS                  TO PAH-CREATE-TIME
101470*            MOVE CRT-USER-NAME           TO PAH-CREATE-USER
101470             MOVE PA102WS-SV-CREATE-USER  TO PAH-CREATE-USER 
013210             MOVE PA102WS-OBJ-ID          TO PAH-OBJ-ID
                   MOVE PA102WS-PEP-POS-LEVEL   TO PAH-POS-LEVEL
101470         END-IF
101470     END-IF.
013220
013230     SET PA102WS-NONAME-PRINT             TO TRUE.
013240
013250***   THESE FIELDS ARE PRINTED AND CHANGED ONLY FOR LEVEL 1
013260
013270     PERFORM
013280         VARYING G2-IND FROM 1 BY 1
013290         UNTIL  (G2-IND > 30)
013300         OR     (G2AWS-EMP-REQ (G2-IND) = ZEROES)
013370           IF (G2AWS-FLD-NBR (G2-IND) = HREMP-SEC-LVL-DN)
013380           OR (G2AWS-FLD-NBR (G2-IND) = HREMP-SEC-LOCATION-DN)
013390           OR (G2AWS-FLD-NBR (G2-IND) = HREMP-PAY-FREQUENCY-DN)
013400           OR (G2AWS-FLD-NBR (G2-IND) = HREMP-SALARY-CLASS-DN)
013410           OR (G2AWS-FLD-NBR (G2-IND) = HREMP-EXEMPT-EMP-DN)
013420           OR (G2AWS-FLD-NBR (G2-IND) = HREMP-OT-PLAN-CODE-DN)
013440             IF  (PA102WS-PEP-POS-LEVEL = 1)
J63836             AND (EMPLIST-NOTFOUND)
013450                 PERFORM 1625-MOVE-FOR-PRINT
013460                 THRU    1625-END
J63836             ELSE
J63836                 PERFORM 1626-MOVE-FOR-PRINT
J63836                 THRU    1626-END
J63836                 SET EMPLIST-DATA-TO-PRINT       TO TRUE
013470             END-IF
013480           ELSE
J63836             IF (EMPLIST-NOTFOUND)
013490                 PERFORM 1625-MOVE-FOR-PRINT
013500                 THRU    1625-END
J63836             ELSE
J63836                 PERFORM 1626-MOVE-FOR-PRINT
J63836                 THRU    1626-END
J63836                 SET EMPLIST-DATA-TO-PRINT       TO TRUE
J63836             END-IF
013510           END-IF
013520     END-PERFORM.
013530          
013540     IF  (PRM-UPDATE = "Y")
013550     AND (PA102WS-HISTORY)
J63836     AND (EMPLIST-NOTFOUND)
J82034         MOVE HREMP-UPDATE-BENEFIT TO PAH-UPDATE-BENEFIT
J82034         MOVE SPACES               TO PAH-UPDATE-REQ-DED
P64324                                      PAH-UPD-ABS-MGMT
P64324                                      PAH-HIST-CORR-FLAG
P64324         MOVE ZEROES               TO PAH-EDM-EFFECT-DT
P64324                                      PAH-EDM-END-DATE
P64324         MOVE "4"                  TO PAH-ACTION-UPD
013560         PERFORM 820-STORE-PERSACTHST.
013570
013580     IF (PRM-UPDATE = "Y")
J63836     AND (EMPLIST-NOTFOUND)
013590         MOVE PRM-COMPANY             TO DB-COMPANY
013600         MOVE PA102WS-LAST-EMPLOYEE   TO DB-EMPLOYEE
013610         INITIALIZE                      DB-REQUISITION
013620         MOVE PA102WS-POSITION        TO DB-POSITION
013630         MOVE PA102WS-EFFECT-DATE     TO DB-EFFECT-DATE
013640         MOVE "3  "                   TO DB-UPDATE-TYPE
013650         PERFORM 840-MODIFY-PPESET1
013660         IF (PAPOSERR-FOUND)
013670             PERFORM 830-DELETE-PAPOSERR
               END-IF
013640         MOVE "1  "                   TO DB-UPDATE-TYPE
013650         PERFORM 840-MODIFY-PPESET1
013660         IF (PAPOSERR-FOUND)
013670             PERFORM 830-DELETE-PAPOSERR.
013680
J85363     IF  (PA102WS-FIELD-NBR (1) = ZEROES)
J85363     AND (PA102WS-FIELD-NBR (2) = ZEROES)
J85363     AND (PEP-END-DATE      NOT = POS-END-DATE)
J85363         IF  (PEP-POS-LEVEL         > 1)
J85363         AND (PEP-EFFECT-DATE       < PA102WS-END-DATE)
J85363             IF  (PRM-UPDATE = "Y")
J85363             AND (EMPLIST-NOTFOUND)
J85363                 MOVE PEP-COMPANY            TO DB-COMPANY
J85363                 MOVE PEP-EMPLOYEE           TO DB-EMPLOYEE
J85363                 MOVE PEP-POS-LEVEL          TO DB-POS-LEVEL
J85363                 MOVE PEP-EFFECT-DATE        TO DB-EFFECT-DATE
J85363                 PERFORM 840-MODIFY-PEPSET1
J85363                 MOVE PA102WS-EFFECT-DATE    TO PEP-POS-EFF-DT
J85363                 MOVE PA102WS-END-DATE       TO PEP-END-DATE
J85363                 MOVE WS-SYSTEM-DATE-YMD     TO PEP-DATE-STAMP
J85363                 MOVE HHMMSS                 TO PEP-TIME-STAMP
J85363                 MOVE CRT-USER-NAME          TO PEP-USER-ID
J85363                 PERFORM 820-STORE-PAEMPPOS
J85363                 GO TO 1600-FIND-NEXT-PAEMPPOS
J85363             ELSE
J85363                 GO TO 1600-FIND-NEXT-PAEMPPOS
J85363             END-IF
J85363         END-IF
J85363     END-IF.
J85363
013690 1600-FIND-NEXT-PAEMPPOS.
013700
013710     PERFORM 860-FIND-NXTRNG-PEPSET4.
013720
013730     IF (PRM-UPDATE = "Y")
J63836     AND (EMPLIST-NOTFOUND)
013740         IF  (PAEMPPOS-FOUND)
013750         AND (PEP-COMPANY    = PRM-COMPANY)
013760         AND (PEP-EMPLOYEE   = PA102WS-LAST-EMPLOYEE)
013770         AND (PEP-POS-LEVEL  = PA102WS-LAST-POS-LEVEL)
013780             PERFORM 860-FIND-NXTRNG-PEPSET4.
013790
013800 1600-END.
013810
013820******************************************************************
013830 1625-MOVE-FOR-PRINT.
013840******************************************************************
013850
013860     IF (PA102WS-NONAME-PRINT)
013870         MOVE G2AWS-EMP-REQ (G2-IND)      TO G2EA-EMP-REQ
013880         MOVE G2AWS-NAME-DESCRIPTION (G2-IND) TO
013890                                          G2EA-NAME-DESCRIPTION
013900         SET PA102WS-NAME-PRINT           TO TRUE
013910     ELSE
013920         INITIALIZE                       G2EA-EMP-REQ
013930                                          G2EA-NAME-DESCRIPTION.
013940
013950     MOVE G2AWS-PAD-ITEM-NAME (G2-IND)    TO G2EA-PAD-ITEM-NAME.
013960     MOVE G2AWS-PPC-VALUE-PRIOR (G2-IND)  TO G2EA-PPC-VALUE-PRIOR.
013970     MOVE G2AWS-PPC-LVL (G2-IND)          TO G2EA-PPC-LVL.
013980     MOVE G2AWS-PPC-EFFECT-DATE (G2-IND)  TO G2EA-PPC-EFFECT-DATE.
013990     MOVE G2AWS-COMMENTS (G2-IND)         TO G2EA-COMMENTS.
014080     MOVE GN2EA-FIELD-NBR                 TO RPT-GROUP-REQUEST.
014090     PERFORM 700-PRINT-RPT-GRP.
014100
014110 1625-END.
014120
J63836******************************************************************
J63836 1626-MOVE-FOR-PRINT.
J63836******************************************************************
J63836
J63836     IF (PA102WS-NONAME-PRINT)
J63836         MOVE G2AWS-EMP-REQ (G2-IND)      TO G3EA-EMP-REQ
J63836         MOVE G2AWS-NAME-DESCRIPTION (G2-IND) TO
J63836                                          G3EA-NAME-DESCRIPTION
J63836         SET PA102WS-NAME-PRINT           TO TRUE
J63836     ELSE
J63836         INITIALIZE                       G3EA-EMP-REQ
J63836                                          G3EA-NAME-DESCRIPTION.
J63836
J63836     MOVE G2AWS-PAD-ITEM-NAME (G2-IND)    TO G3EA-PAD-ITEM-NAME.
J63836     MOVE G2AWS-PPC-VALUE-PRIOR (G2-IND)  TO G3EA-PPC-VALUE-PRIOR.
J63836     MOVE G2AWS-PPC-LVL (G2-IND)          TO G3EA-PPC-LVL.
J63836     MOVE G2AWS-PPC-EFFECT-DATE (G2-IND)  TO G3EA-PPC-EFFECT-DATE.
J63836     MOVE G2AWS-PPC-END-DATE (G2-IND)     TO G3EA-PPC-END-DATE.
J63836     MOVE GN3EA-FIELD-NBR                 TO RPT-GROUP-REQUEST.
J63836     PERFORM 700-PRINT-RPT-GRP.
J63836
J63836 1626-END.
J63836
014130******************************************************************
014140 1650-CHECK-ACTION.
014150******************************************************************
014160
           MOVE PCT-ACTION-CODE        TO PA102WS-PCT-ACTION-CODE.
           MOVE PCT-EFFECT-DATE        TO PA102WS-PCT-EFFECT-DATE.
           MOVE PCT-ACTION-NBR         TO PA102WS-PCT-ACTION-NBR.

014170     MOVE 1 TO I3. 
      * Are you ending the pos level on the action?
014180     PERFORM
014190         UNTIL  (I3 > 36)
014200         OR     ((PCT-POS-LEVEL      = 1)
014210         AND     (PCT-FLD-NBR (I3)   = HREMP-TERM-DATE-DN))
014220         OR     ((PCT-POS-LEVEL      > 1)
014230         AND     (PCT-POS-LEVEL      = PEP-POS-LEVEL) 
014240         AND     (PCT-FLD-NBR (I3)   = HRPEP-END-DATE-DN))
014250             ADD 1 TO I3                        
014260     END-PERFORM.
014270
014280     INITIALIZE                          WS-ACTION-TABLE.
014290     IF (I3 NOT > 36)
      * The pos level is being ended, the end date is changing, or the
      * end date is being removed on the action and the pos level is 
      * the primary position and the employee is not termed, add to the
      * table and go to another action.
014300         IF  (PCT-POS-LEVEL      = 1)
014310         AND (PCT-NEW-VALUE (I3) NOT = SPACES)
               AND (PCT-NEW-VALUE (I3) NOT = "*BLANK")
014320         AND (EMP-TERM-DATE      = ZEROES)
014330             MOVE PCT-NEW-VALUE (I3)  TO PAPCTIO-NEW-VALUE
                   MOVE "D"                 TO PAPCTIO-DATA-TYPE
014340             PERFORM 9100-FORMAT-PAPCT-TO-STORAGE
014350             MOVE PAPCTIO-NEW-DATE    TO WS-END-DATE (I4)
014360             MOVE PCT-EFFECT-DATE     TO WS-EFFECT-DATE (I4) 
014370             MOVE PCT-ACTION-CODE     TO WS-ACTION-CODE (I4) 
014380             MOVE PCT-ACTION-NBR      TO WS-ACTION-NBR (I4) 
014390             MOVE PCT-ACTION-TYPE     TO WS-ACTION-TYPE (I4) 
014400             MOVE PCT-POSITION        TO WS-POSITION (I4) 
014410             MOVE PCT-POS-EFF-DT      TO WS-POS-EFF-DT (I4) 
014420             MOVE 1                   TO WS-END-POS-LEVEL (I4)
014430             MOVE "Y"                 TO WS-END-DATE-FLG (I4)
014440             ADD 1                    TO I4
014450             GO TO 1650-FIND-NEXT-PERSACTION
014460         ELSE
      * The pos level is being ended, the end date is changing, or the
      * end date is being removed on the action and the pos level is 
      * not the primary position and the pep record has not ended, add 
      * to the table and go to another action.
014470         IF  (PCT-POS-LEVEL      > 1)
014480         AND (PCT-NEW-VALUE (I3) NOT = SPACES)
               AND (PCT-NEW-VALUE (I3) NOT = "*BLANK")
014490         AND (PEP-END-DATE       = ZEROES)
014500             MOVE PCT-NEW-VALUE (I3)  TO PAPCTIO-NEW-VALUE
                   MOVE "D"                 TO PAPCTIO-DATA-TYPE
014510             PERFORM 9100-FORMAT-PAPCT-TO-STORAGE
014520             MOVE PAPCTIO-NEW-DATE    TO WS-END-DATE (I4)
014530             MOVE PCT-EFFECT-DATE     TO WS-EFFECT-DATE (I4) 
014540             MOVE PCT-ACTION-CODE     TO WS-ACTION-CODE (I4) 
014550             MOVE PCT-ACTION-NBR      TO WS-ACTION-NBR (I4) 
014560             MOVE PCT-ACTION-TYPE     TO WS-ACTION-TYPE (I4) 
014570             MOVE PCT-POSITION        TO WS-POSITION (I4) 
014580             MOVE PCT-POS-EFF-DT      TO WS-POS-EFF-DT (I4) 
014590             MOVE PCT-POS-LEVEL       TO WS-END-POS-LEVEL (I4)
014600             MOVE "Y"                 TO WS-END-DATE-FLG (I4)
014610             ADD 1                    TO I4
014620             GO TO 1650-FIND-NEXT-PERSACTION.
014630
      * Skip if action is for another pos level
014640     IF (PCT-POS-LEVEL NOT = PEP-POS-LEVEL)
014650         GO TO 1650-FIND-NEXT-PERSACTION.
014660
      * Skip if there is no position on the action
014670     IF (PCT-POSITION = SPACES)
014680         GO TO 1650-FIND-NEXT-PERSACTION.
014690
014700     MOVE WS-TRUE                  TO WS-ACTIONS-DONE-SW.
014710
      * Is a field being changed on the action a field being changed
      * on the position (on PAPOSCHG)? If so, sets the flag to "Y"
014720     PERFORM 1675-CHECK-FIELDS
014730     THRU    1675-END
014740         VARYING I3 FROM 1 BY 1
014750         UNTIL  (I3 > 36)
014760         OR     (WS-POSFLDCHG (I4) = "Y").
014770
      * If there is no field being changed on the action that is a field
      * being changed on the position (on PAPOSCHG), update the
      * pos-eff-dt on the action.
014780     IF (WS-POSFLDCHG (I4)     = SPACES)
014790         IF (PRM-UPDATE         = "Y")
014800             MOVE PRM-COMPANY             TO DB-COMPANY
014810             MOVE PCT-ACTION-TYPE         TO DB-ACTION-TYPE
014820             MOVE PCT-EMPLOYEE            TO DB-EMPLOYEE
014830             MOVE PCT-ACTION-CODE         TO DB-ACTION-CODE
014840             MOVE PCT-EFFECT-DATE         TO DB-EFFECT-DATE
014850             MOVE PCT-ACTION-NBR          TO DB-ACTION-NBR
014860             PERFORM 840-MODIFY-PCTSET2
014870             IF (PERSACTION-FOUND)
014880                 MOVE PA102WS-EFFECT-DATE TO PCT-POS-EFF-DT
                       PERFORM 8200-BEFORE-STORE-PERSACTION
014890                 PERFORM 820-STORE-PERSACTION
014900             END-IF
014910         END-IF
014920         GO TO 1650-FIND-NEXT-PERSACTION.
014930
      * If there is a field being changed on the action that is a field
      * being changed on the position (on PAPOSCHG), add action info to
      * the table.
014940     MOVE PCT-EFFECT-DATE                 TO WS-EFFECT-DATE (I4).
014950     MOVE PCT-ACTION-CODE                 TO WS-ACTION-CODE (I4).
014960     MOVE PCT-ACTION-NBR                  TO WS-ACTION-NBR (I4).
014970     MOVE PCT-ACTION-TYPE                 TO WS-ACTION-TYPE (I4).
014980     MOVE PCT-POSITION                    TO WS-POSITION (I4).
014990     MOVE PCT-POS-EFF-DT                  TO WS-POS-EFF-DT (I4).
015000     ADD 1                                TO I4.
015010
015020 1650-FIND-NEXT-PERSACTION.
015030
           MOVE PA102WS-PCT-COMPANY        TO DB-COMPANY.
           MOVE PA102WS-PCT-ACTION-TYPE    TO DB-ACTION-TYPE.
           MOVE PA102WS-PCT-EMPLOYEE       TO DB-EMPLOYEE.
           MOVE PA102WS-PCT-ACTION-CODE    TO DB-ACTION-CODE.
           MOVE PA102WS-PCT-EFFECT-DATE    TO DB-EFFECT-DATE.
           MOVE PA102WS-PCT-ACTION-NBR     TO DB-ACTION-NBR.
           PERFORM 850-FIND-NLT-PCTSET2.
015040     PERFORM 860-FIND-NEXT-PCTSET2.
015050
015060 1650-END.
015070
015080******************************************************************
015090 1675-CHECK-FIELDS.   
015100******************************************************************
015110
015120      IF  (PCT-FLD-NBR (I3)   NOT = ZEROES)
015130      AND (PCT-NEW-VALUE (I3) NOT = SPACES)
015140          MOVE 1 TO I5
015150          PERFORM
015160              UNTIL  (I5 > PA102WS-COUNTER)
015170              OR     (PCT-FLD-NBR (I3) = PA102WS-FIELD-NBR2 (I5))
015180                 ADD 1 TO I5
015190          END-PERFORM
015200          IF  (I5 NOT > PA102WS-COUNTER)
015210          AND (PA102WS-DEFAULT-FLG (I5) = 2 OR 3)
015220              MOVE "Y"        TO WS-POSFLDCHG (I4).
015230
015240 1675-END.
015250
015260******************************************************************
015270 1700-SORT-ACTIONS.
015280******************************************************************
015290
015300     PERFORM
015310         VARYING I2 FROM 1 BY 1
015320         UNTIL  (I2 > 49)
015330
015340         PERFORM
015350           VARYING I3 FROM I2 BY 1
015360           UNTIL  (I3 > 50)
015370           OR     (WS-ACTION-TYPE (I3) NOT = WS-ACTION-TYPE (I2))
015380             IF  (WS-ACTION-TYPE (I3) = WS-ACTION-TYPE (I2))
015390             AND (WS-EFFECT-DATE (I3) < WS-EFFECT-DATE (I2))
015400                 PERFORM 1800-SWAP-ED-TABLE-DATA
015410                 THRU    1800-END
015420             END-IF
015430         END-PERFORM
015440     END-PERFORM.
015450
015460 1700-END.
015470
039900******************************************************************
040000 1725-LOAD-PAPEP-EFFECT-DATE.
040100******************************************************************

           MOVE PA102WS-EFFECT-DATE       TO PAPEP-PAPOS-EFFECT-DATE.

           MOVE PA102WS-SAVE-EMPLOYEE     TO DB-EMPLOYEE.
           MOVE PA102WS-SAVE-POS-LEVEL    TO DB-POS-LEVEL.
           MOVE PEPSET3-POS-LEVEL         TO WS-DB-BEG-RNG. 
           PERFORM 850-FIND-BEGRNG-PEPSET3.
           IF (PEP-EFFECT-DATE > PA102WS-EFFECT-DATE)
               PERFORM
                   UNTIL (PAEMPPOS-NOTFOUND)
                   OR    (PEP-POSITION    NOT = PA102WS-POSITION)
                   OR    (PEP-EFFECT-DATE <= PA102WS-EFFECT-DATE)
                       MOVE PEP-EFFECT-DATE TO PA102WS-SAVE-EFFECT
                       PERFORM 860-FIND-NXTRNG-PEPSET3
               END-PERFORM
               IF  (PAEMPPOS-FOUND)
               AND (PEP-POSITION = PA102WS-POSITION)
                   IF (PEP-EFFECT-DATE <= PA102WS-EFFECT-DATE)
                       MOVE PA102WS-EFFECT-DATE  TO PAPEP-EFFECT-DATE
                       MOVE PA102WS-SAVE-EFFECT-DATE
                                                 TO PAPEP-UPDPEP-DATE
                       SET PAPEP-USEUPDATE-DT    TO TRUE
                   END-IF
               ELSE
                   IF (PAEMPPOS-FOUND)
                       MOVE PA102WS-SAVE-EFFECT-DATE
                                                 TO PAPEP-UPDPEP-DATE
                   END-IF
                   MOVE PA102WS-SAVE-EFFECT      TO PAPEP-EFFECT-DATE
               END-IF
               MOVE PA102WS-SAVE-EFFECT-DATE     TO DB-EFFECT-DATE
               PERFORM 840-FIND-PEPSET2
               MOVE "C"                          TO PAPEP-FC
           ELSE
               IF  (PA102WS-EFFECT-DATE > PEP-EFFECT-DATE)
                   MOVE "A"                      TO PAPEP-FC
               ELSE
040300             MOVE "C"                      TO PAPEP-FC
               END-IF
040400         MOVE PA102WS-EFFECT-DATE          TO PAPEP-EFFECT-DATE
               INITIALIZE                        PAPEP-UPDPEP-DATE
               SET PAPEP-USEPOSEFF-DT            TO TRUE. 
029100
       1725-END.

039900******************************************************************
040000 1750-LOAD-HREMP-EFFECT-DATE.
040100******************************************************************

           MOVE PA102WS-EFFECT-DATE       TO HREMP-PAPOS-EFFECT-DATE.
           MOVE "C"                       TO HREMP-FC.

           MOVE HREMP-EMPLOYEE            TO DB-EMPLOYEE.
           MOVE PA102WS-SAVE-POS-LEVEL    TO DB-POS-LEVEL.
           MOVE PEPSET3-POS-LEVEL         TO WS-DB-BEG-RNG. 
           PERFORM 850-FIND-BEGRNG-PEPSET3.
           IF (PEP-EFFECT-DATE > PA102WS-EFFECT-DATE)
J36155         PERFORM
J36155             UNTIL (PAEMPPOS-NOTFOUND)
J36155             OR    (PEP-POSITION    NOT = PA102WS-POSITION)
J36155             OR    (PEP-EFFECT-DATE <= PA102WS-EFFECT-DATE)
J36155                 MOVE PEP-EFFECT-DATE TO PA102WS-SAVE-EFFECT
J36155                 PERFORM 860-FIND-NXTRNG-PEPSET3
J36155         END-PERFORM
               IF  (PAEMPPOS-FOUND)
               AND (PEP-POSITION = PA102WS-POSITION)
                   IF (PEP-EFFECT-DATE <= PA102WS-EFFECT-DATE)
                       MOVE PA102WS-EFFECT-DATE  TO HREMP-EFFECT-DATE
                       MOVE PA102WS-SAVE-EFFECT-DATE
                                                 TO HREMP-UPDPEP-DATE
                       SET HREMP-USEUPDATE-DT    TO TRUE
                   END-IF
               ELSE
                   IF (PAEMPPOS-FOUND)
                       MOVE PA102WS-SAVE-EFFECT-DATE
                                              TO HREMP-UPDPEP-DATE
                   END-IF
      * If not found and pa102 date < all pep dates 
                   IF (PA102WS-SAVE-EFFECT > PA102WS-EFFECT-DATE)
                     MOVE PA102WS-SAVE-EFFECT-DATE TO 
                                                      HREMP-UPDPEP-DATE
                   END-IF
                   MOVE PA102WS-SAVE-EFFECT   TO HREMP-EFFECT-DATE
               END-IF
J36155         MOVE PA102WS-SAVE-EFFECT-DATE  TO DB-EFFECT-DATE
J36155         PERFORM 840-FIND-PEPSET2
           ELSE
040400         MOVE PA102WS-EFFECT-DATE       TO HREMP-EFFECT-DATE
               INITIALIZE                        HREMP-UPDPEP-DATE
               SET HREMP-USEPOSEFF-DT         TO TRUE. 
029100
       1750-END.

015480******************************************************************
015490 1800-SWAP-ED-TABLE-DATA.
015500******************************************************************
015510
015520     MOVE WS-ACTION-CODE (I2)    TO WS-SWAP-ACTION.
015530     MOVE WS-ACTION-NBR (I2)     TO WS-SWAP-ACTION-NBR.
015540     MOVE WS-EFFECT-DATE (I2)    TO WS-SWAP-EFFECT-DATE.
015550     MOVE WS-ACTION-TYPE (I2)    TO WS-SWAP-ACTION-TYPE.
015560     MOVE WS-POSITION (I2)       TO WS-SWAP-POSITION.
015570     MOVE WS-POS-EFF-DT (I2)     TO WS-SWAP-POS-EFF-DT.
015580     MOVE WS-END-DATE (I2)       TO WS-SWAP-END-DATE.
015590     MOVE WS-END-DATE-FLG (I2)   TO WS-SWAP-END-DATE-FLG.
015600     MOVE WS-END-POS-LEVEL (I2)  TO WS-SWAP-END-POS-LEVEL.
015610     MOVE WS-POSFLDCHG (I2)      TO WS-SWAP-POSFLDCHG.
015620     MOVE WS-ACTION-CODE (I3)    TO WS-ACTION-CODE (I2).
015630     MOVE WS-ACTION-NBR (I3)     TO WS-ACTION-NBR (I2).
015640     MOVE WS-EFFECT-DATE (I3)    TO WS-EFFECT-DATE (I2).
015650     MOVE WS-ACTION-TYPE (I3)    TO WS-ACTION-TYPE (I2).
015660     MOVE WS-POSITION (I3)       TO WS-POSITION (I2).
015670     MOVE WS-POS-EFF-DT (I3)     TO WS-POS-EFF-DT (I2).
015680     MOVE WS-END-DATE (I3)       TO WS-END-DATE (I2).
015690     MOVE WS-END-DATE-FLG (I3)   TO WS-END-DATE-FLG (I2).
015700     MOVE WS-END-POS-LEVEL (I3)  TO WS-END-POS-LEVEL (I2).
015710     MOVE WS-POSFLDCHG (I3)      TO WS-POSFLDCHG (I2).
015720     MOVE WS-SWAP-ACTION         TO WS-ACTION-CODE (I3).
015730     MOVE WS-SWAP-ACTION-NBR     TO WS-ACTION-NBR (I3).
015740     MOVE WS-SWAP-EFFECT-DATE    TO WS-EFFECT-DATE (I3).
015750     MOVE WS-SWAP-ACTION-TYPE    TO WS-ACTION-TYPE (I3).
015760     MOVE WS-SWAP-POSITION       TO WS-POSITION (I3).
015770     MOVE WS-SWAP-POS-EFF-DT     TO WS-POS-EFF-DT (I3).
015780     MOVE WS-SWAP-END-DATE       TO WS-END-DATE (I3).
015790     MOVE WS-SWAP-END-DATE-FLG   TO WS-END-DATE-FLG (I3).
015800     MOVE WS-SWAP-END-POS-LEVEL  TO WS-END-POS-LEVEL (I3).
015810     MOVE WS-SWAP-POSFLDCHG      TO WS-POSFLDCHG (I3).
015820
015830 1800-END.
015840
015850******************************************************************
015860 2000-PROCESS-ACTIONS.
015870******************************************************************
015880
015890     IF (WS-END-DATE-FLG (I1)     = "Y")
015900         IF (WS-EFFECT-DATE (I1)      <= PA102WS-EFFECT-DATE)
015910             IF   (WS-END-POS-LEVEL (I1) = 1)
015920             OR  ((WS-END-POS-LEVEL (I1) NOT = 1)
015930             AND  (PEP-POS-LEVEL         = WS-END-POS-LEVEL (I1)))
015940                 MOVE WS-TRUE              TO WS-SKIP-EMPLOYEE-SW
015950                 IF (PRM-UPDATE = "Y")
015960                     PERFORM 2050-UPDATE-PERSACTION
015970                     THRU    2050-END
015980                         VARYING I1 FROM I1 BY 1
015990                         UNTIL  (I1 > 50)
016000                         OR     (WS-ACTION-CODE (I1) = SPACES)
016010                 END-IF
016020             END-IF
016030         END-IF
016040         GO TO 2000-END.
016050
016060     IF (WS-POSITION (I1) NOT = PA102WS-POSITION)
016070         IF (WS-EFFECT-DATE (I1) <= PA102WS-EFFECT-DATE)
016080             MOVE WS-TRUE              TO WS-SKIP-EMPLOYEE-SW
016090             IF (PRM-UPDATE = "Y")
016100                 PERFORM 2050-UPDATE-PERSACTION
016110                 THRU    2050-END
016120                     VARYING I1 FROM I1 BY 1
016130                     UNTIL  (I1 > 50)
016140                     OR     (WS-ACTION-CODE (I1) = SPACES)
016150             END-IF
016160         END-IF
016170         GO TO 2000-END.
016180
016190     IF (WS-POS-EFF-DT (I1) > PA102WS-EFFECT-DATE)
016200         GO TO 2000-END.
016210
016220     MOVE 1 TO I4.
016230     PERFORM
016240         UNTIL  (I4 > 50)
016250         OR     (WS-ACTION-CODE (I4) = SPACES)
016260         OR     (WS-POSFLDCHG (I4)   = "Y")
016270             ADD 1 TO I4.
016280
016290     IF (I4 > 50)
016300     OR (WS-ACTION-CODE (I4) = SPACES)
016310         GO TO 2000-END.
016320
016330     IF (PRM-UPDATE         = "Y")
016340         MOVE PRM-COMPANY               TO DB-COMPANY
016350         MOVE PEP-EMPLOYEE              TO DB-EMPLOYEE
016360         INITIALIZE                        DB-REQUISITION
016370         MOVE PA102WS-POSITION          TO DB-POSITION
016380         MOVE PA102WS-EFFECT-DATE       TO DB-EFFECT-DATE
016390         MOVE "1  "                     TO DB-UPDATE-TYPE
016400         PERFORM 840-FIND-PPESET1
016410         IF (PAPOSERR-NOTFOUND)
016420             PERFORM 800-CREATE-PAPOSERR
016430             MOVE PRM-COMPANY           TO PPE-COMPANY
016440             MOVE PEP-EMPLOYEE          TO PPE-EMPLOYEE
016450             INITIALIZE                    PPE-REQUISITION
016460             MOVE PA102WS-POSITION      TO PPE-POSITION
016470             MOVE PA102WS-EFFECT-DATE   TO PPE-EFFECT-DATE
016480             MOVE "1  "                 TO PPE-UPDATE-TYPE
016490             MOVE PEP-POS-LEVEL         TO PPE-POS-LEVEL (1)
016500             PERFORM 820-STORE-PAPOSERR
016510         ELSE
                   PERFORM
                       VARYING I3 FROM 1 BY 1
                       UNTIL  (I3 > 98)
                       OR     (PPE-POS-LEVEL (I3) = PEP-POS-LEVEL)
                           CONTINUE
                   END-PERFORM
016520             IF (I3 > 98)
016570                 PERFORM 840-MODIFY-PPESET1
016580                 PERFORM
016590                     VARYING I3 FROM 1 BY 1
016600                     UNTIL  (I3 > 98)
016610                     OR     (PPE-POS-LEVEL (I3) = ZEROES)
016620                         MOVE PEP-POS-LEVEL TO PPE-POS-LEVEL (I3) 
016630                 END-PERFORM
016640                 PERFORM 820-STORE-PAPOSERR.
016650
016660     MOVE WS-POSITION (I4)              TO G9A-PPC-POSITION.
016670     MOVE PA102WS-POS-DESCRIPTION       TO G9A-POS-DESCRIPTION.
016680     MOVE WS-EFFECT-DATE (I4)           TO G9A-PPC-EFFECT-DATE.
016690     MOVE HRWS-FORMAT-NAME              TO PA102WS-NAME.
016700     MOVE PA102WS-EMP-NAME              TO G9A-DESCRIPTION.
016710     MOVE PEP-EMPLOYEE                  TO G9A-EMP-REQ.
           MOVE PEP-POS-LEVEL                 TO G9A-POS-LEVEL.
P58562     MOVE WS-PA102-MSG-118              TO G9A-COMMENTS.
016750     MOVE GN9A-ERROR-DETAIL             TO RPT-GROUP-REQUEST.
016760     PERFORM 700-PRINT-RPT-GRP.
           IF (NO-ERR-DATA-TO-PRINT)
               SET ERR-DATA-TO-PRINT          TO TRUE
           END-IF.
016770     MOVE WS-TRUE                       TO WS-SKIP-EMPLOYEE-SW.
016780
016790     IF (PRM-UPDATE = "Y")
016800         PERFORM 2050-UPDATE-PERSACTION
016810         THRU    2050-END
016820             VARYING I1 FROM I1 BY 1
016830             UNTIL  (I1 > 50)
016840             OR     (WS-ACTION-CODE (I1) = SPACES).
016850
016860 2000-END.
016870
016880******************************************************************
016890 2050-UPDATE-PERSACTION.
016900******************************************************************
016910
016920     IF  (WS-POSITION (I1)   = PA102WS-POSITION)
016930     AND (WS-POS-EFF-DT (I1) < PA102WS-EFFECT-DATE)
016940         MOVE PRM-COMPANY            TO DB-COMPANY
016950         MOVE WS-ACTION-TYPE (I1)    TO DB-ACTION-TYPE
016960         MOVE PEP-EMPLOYEE           TO DB-EMPLOYEE
016970         MOVE WS-ACTION-CODE (I1)    TO DB-ACTION-CODE
016980         MOVE WS-EFFECT-DATE (I1)    TO DB-EFFECT-DATE
016990         MOVE WS-ACTION-NBR (I1)     TO DB-ACTION-NBR
017000         PERFORM 840-MODIFY-PCTSET2
017010         IF (PERSACTION-FOUND)
017020            MOVE PA102WS-EFFECT-DATE TO PCT-POS-EFF-DT
                  PERFORM 8200-BEFORE-STORE-PERSACTION
017030            PERFORM 820-STORE-PERSACTION.
017040
017050 2050-END.
017060
017070******************************************************************
017080 2100-CHECK-VALUE.   
017090******************************************************************
017100
017110     IF (PA102WS-FIELD-NBR (I1) = PAPOS-JOB-CODE-DN)
017120         MOVE PEP-JOB-CODE       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017130         IF (PEP-JOB-CODE     = PA102WS-VALUE-PRIOR (I1))
017140             IF (PEP-JOB-CODE     NOT = PA102WS-VALUE (I1))
017150                 IF (PA102WS-NOUPDATES)
017160                     SET PA102WS-UPDATES          TO TRUE
017170                 END-IF
017180                 PERFORM 2150-MOVE-VALUE
017190                 THRU    2150-END
017200             ELSE
017210                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
017230                 GO TO 2100-END
017240             END-IF
017250         ELSE
017260            IF (PA102WS-NOUPDATES)
017270                SET PA102WS-UPDATES          TO TRUE
017280            END-IF
017290            SET PA102WS-NO-DEFAULT    TO TRUE.

017300     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PROCESS-LEVEL-DN)
017310         MOVE PEP-PROCESS-LEVEL  TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017320         IF (PEP-PROCESS-LEVEL      = PA102WS-VALUE-PRIOR (I1))
017330             IF (PEP-PROCESS-LEVEL NOT = PA102WS-VALUE (I1))
017360                 IF (PA102WS-NOUPDATES)
017370                     SET PA102WS-UPDATES          TO TRUE
017380                 END-IF
                       IF (PA102WS-VALUE (I1) = SPACES)
                           MOVE PA102WS-VALUE (I1)      TO
                                                      PA102WS-EMP-NEW-PL
                       END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
017390             ELSE
017400                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
017420                 GO TO 2100-END
017430             END-IF
017440         ELSE
017450             IF (PA102WS-NOUPDATES)
017460                 SET PA102WS-UPDATES          TO TRUE
017470             END-IF
017480             SET PA102WS-NO-DEFAULT           TO TRUE.

017490     IF (PA102WS-FIELD-NBR (I1) = PAPOS-DEPARTMENT-DN)
017500         MOVE PEP-DEPARTMENT     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017510         IF (PEP-DEPARTMENT         = PA102WS-VALUE-PRIOR (I1))
017520             IF (PEP-DEPARTMENT NOT = PA102WS-VALUE (I1))
017550                 IF (PA102WS-NOUPDATES)
017560                     SET PA102WS-UPDATES          TO TRUE
017570                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
017580             ELSE
017590                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
017610                 GO TO 2100-END
017620             END-IF
017630         ELSE
017640             IF (PA102WS-NOUPDATES)
017650                 SET PA102WS-UPDATES          TO TRUE
017660             END-IF
017670            SET PA102WS-NO-DEFAULT    TO TRUE.

017680     IF (PA102WS-FIELD-NBR (I1) = PAPOS-USER-LEVEL-DN)
017690         MOVE PEP-USER-LEVEL     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017710         IF (PEP-USER-LEVEL = PA102WS-VALUE-PRIOR (I1))
                   IF (PEP-USER-LEVEL NOT = PA102WS-VALUE (I1))
017740                 IF (PA102WS-NOUPDATES)
017750                     SET PA102WS-UPDATES   TO TRUE
017760                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
017770             ELSE
017780                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
017800                 GO TO 2100-END
017810             END-IF
017820         ELSE
017830             IF (PA102WS-NOUPDATES)
017840                 SET PA102WS-UPDATES       TO TRUE
017850             END-IF
017860             SET PA102WS-NO-DEFAULT         TO TRUE.

017870     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-RATE-DN)
017880         MOVE PEP-PAY-RATE       TO HRWS-DEC-FIELD
017890         MOVE 0                  TO HRWS-SIZE
017900         MOVE 4                  TO HRWS-NBR-DECIMALS
017910         PERFORM 770-HR-FORMAT-DEC-FIELD
017920         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017940         IF (PEP-PAY-RATE           = PA102WS-PAY-RATE)       
017950             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
017960                 IF (PA102WS-NOUPDATES)
017970                     SET PA102WS-UPDATES          TO TRUE
017980                 END-IF
017990                 PERFORM 2150-MOVE-VALUE
018000                 THRU    2150-END
018010             ELSE
018020                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
018040                 GO TO 2100-END
018050             END-IF
018060        ELSE
018070             IF (PA102WS-NOUPDATES)
018080                 SET PA102WS-UPDATES          TO TRUE
018090             END-IF
018100             SET PA102WS-NO-DEFAULT    TO TRUE.

018110     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-SALARY-CLASS-DN)
018120     AND (PEP-POS-LEVEL          = 1)
018130         MOVE EMP-SALARY-CLASS   TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
018150         IF  (EMP-SALARY-CLASS       = PA102WS-VALUE-PRIOR (I1))
018160         AND (PEP-POS-LEVEL         = 1)
018170             IF (EMP-SALARY-CLASS NOT = PA102WS-VALUE (I1))
018180                 IF (PA102WS-NOUPDATES)
018190                     SET PA102WS-UPDATES          TO TRUE
018200                 END-IF
018210                 PERFORM 2150-MOVE-VALUE
018220                 THRU    2150-END
018230             ELSE
018240                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
018260                 GO TO 2100-END
018270             END-IF
018280         ELSE
018290             IF (PA102WS-NOUPDATES)
018300                 SET PA102WS-UPDATES          TO TRUE
018310             END-IF
018320            SET PA102WS-NO-DEFAULT    TO TRUE.

018330     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-FREQUENCY-DN)
018340         MOVE EMP-PAY-FREQUENCY  TO HRWS-DEC-FIELD
018350         MOVE 0                  TO HRWS-SIZE
018360         MOVE 0                  TO HRWS-NBR-DECIMALS
018370         PERFORM 770-HR-FORMAT-DEC-FIELD
018380         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
018400         IF  (EMP-PAY-FREQUENCY      = PA102WS-PAY-FREQUENCY)  
018410         AND (PEP-POS-LEVEL         = 1)
018420             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
018430                 IF (PA102WS-NOUPDATES)
018440                     SET PA102WS-UPDATES          TO TRUE
018450                 END-IF
018460                 PERFORM 2150-MOVE-VALUE
018470                 THRU    2150-END
018480             ELSE
018490                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
018510                 GO TO 2100-END
018520             END-IF
018530         ELSE
018540             IF (PA102WS-NOUPDATES)
018550                 SET PA102WS-UPDATES          TO TRUE
018560             END-IF
018570             SET PA102WS-NO-DEFAULT    TO TRUE.

018580     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SCHEDULE-DN)
018590         MOVE PEP-SCHEDULE       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
               IF  (PEP-SCHEDULE           = PA102WS-VALUE-PRIOR (I1))
018610             IF  (PEP-SCHEDULE       NOT = PA102WS-VALUE (I1))
                       IF  (PA102WS-NOUPDATES)
                           SET PA102WS-UPDATES          TO TRUE
                       END-IF
018620                 PERFORM 2150-MOVE-VALUE
018630                 THRU    2150-END
018670             ELSE
018680                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
018700                 GO TO 2100-END
018710             END-IF
018720         ELSE
018730             IF (PA102WS-NOUPDATES)
018740                 SET PA102WS-UPDATES          TO TRUE
018750             END-IF
018760             SET PA102WS-NO-DEFAULT    TO TRUE.

018770     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-GRADE-DN)
018780         MOVE PEP-PAY-GRADE      TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
018800         IF (PEP-PAY-GRADE          = PA102WS-VALUE-PRIOR (I1))
018810             IF (PEP-PAY-GRADE NOT = PA102WS-VALUE (I1))
018840                 IF (PA102WS-NOUPDATES)
018850                     SET PA102WS-UPDATES          TO TRUE
018860                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
018870             ELSE
018880                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
018900                 GO TO 2100-END
018910             END-IF
018920         ELSE
018930             IF (PA102WS-NOUPDATES)
018940                 SET PA102WS-UPDATES          TO TRUE
018950             END-IF
018960             SET PA102WS-NO-DEFAULT    TO TRUE.

018970     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-STEP-DN)
018980         MOVE PEP-PAY-STEP       TO HRWS-DEC-FIELD
018990         MOVE 0                  TO HRWS-SIZE
019000         MOVE 0                  TO HRWS-NBR-DECIMALS
019010         PERFORM 770-HR-FORMAT-DEC-FIELD
019020         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
019040         IF (PEP-PAY-STEP           = PA102WS-PAY-STEP)
019050             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
019080                 IF (PA102WS-NOUPDATES)
019090                     SET PA102WS-UPDATES          TO TRUE
019100                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
019110             ELSE
019120                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
019140                 GO TO 2100-END
019150             END-IF
019160         ELSE
019170             IF (PA102WS-NOUPDATES)
019180                 SET PA102WS-UPDATES          TO TRUE
019190             END-IF
019200             SET PA102WS-NO-DEFAULT    TO TRUE.

019210     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SUPERVISOR-DN)
019220         MOVE PEP-SUPERVISOR     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
019240         IF (PEP-SUPERVISOR         = PA102WS-VALUE-PRIOR (I1))
019250             IF (PEP-SUPERVISOR NOT = PA102WS-VALUE (I1))
019280                 IF (PA102WS-NOUPDATES)
019290                     SET PA102WS-UPDATES          TO TRUE
019300                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
019310             ELSE
019320                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
019340                 GO TO 2100-END
019350             END-IF
019360         ELSE
019370             IF (PA102WS-NOUPDATES)
019380                 SET PA102WS-UPDATES          TO TRUE
019390             END-IF
019400             SET PA102WS-NO-DEFAULT    TO TRUE.

019410     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SHIFT-DN)
019420         MOVE PEP-SHIFT          TO HRWS-DEC-FIELD
019430         MOVE 0                  TO HRWS-SIZE
019440         MOVE 0                  TO HRWS-NBR-DECIMALS
019450         PERFORM 770-HR-FORMAT-DEC-FIELD
019460         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
019480         IF (PEP-SHIFT              = PA102WS-SHIFT)
019490             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
019520                 IF (PA102WS-NOUPDATES)
019530                     SET PA102WS-UPDATES          TO TRUE
019540                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
019550             ELSE
019560                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
019580                 GO TO 2100-END
019590             END-IF
019600         ELSE
019610             IF (PA102WS-NOUPDATES)
019620                 SET PA102WS-UPDATES          TO TRUE
019630             END-IF
019640             SET PA102WS-NO-DEFAULT  TO TRUE.

019650     IF (PA102WS-FIELD-NBR (I1) = PAPOS-LOCAT-CODE-DN)
019660         MOVE PEP-LOCAT-CODE     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
019680         IF (PEP-LOCAT-CODE         = PA102WS-VALUE-PRIOR (I1))
019690             IF (PEP-LOCAT-CODE NOT = PA102WS-VALUE (I1))
019720                 IF (PA102WS-NOUPDATES)
019730                     SET PA102WS-UPDATES          TO TRUE
019740                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
019750             ELSE
019760                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
019780                 GO TO 2100-END
019790             END-IF
019800         ELSE
019810             IF (PA102WS-NOUPDATES)
019820                 SET PA102WS-UPDATES          TO TRUE
019830             END-IF
019840             SET PA102WS-NO-DEFAULT    TO TRUE.

019850     IF (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-COMPANY-DN)
019860         MOVE PEP-EXP-COMPANY    TO HRWS-DEC-FIELD
019870         MOVE 0                  TO HRWS-SIZE
019880         MOVE 0                  TO HRWS-NBR-DECIMALS
019890         PERFORM 770-HR-FORMAT-DEC-FIELD
019900         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
019920         IF (PEP-EXP-COMPANY = PA102WS-EXP-COMPANY)
019930             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
019960                 IF (PA102WS-NOUPDATES)
019970                     SET PA102WS-UPDATES          TO TRUE
019980                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
019990             ELSE
020000                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
020020                 GO TO 2100-END
020030             END-IF
020040         ELSE
020050             IF (PA102WS-NOUPDATES)
020060                 SET PA102WS-UPDATES          TO TRUE
020070             END-IF
020080             SET PA102WS-NO-DEFAULT    TO TRUE.

020090     IF (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-ACCT-UNIT-DN)
020100         MOVE PEP-EXP-ACCT-UNIT  TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
020120         IF (PEP-EXP-ACCT-UNIT = PA102WS-VALUE-PRIOR (I1))
020130             IF (PEP-EXP-ACCT-UNIT NOT = PA102WS-VALUE (I1))
020160                 IF (PA102WS-NOUPDATES)
020170                     SET PA102WS-UPDATES        TO TRUE
020180                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
020190             ELSE
020200                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
020220                 GO TO 2100-END
020230             END-IF
020240         ELSE
020250             IF (PA102WS-NOUPDATES)
020260                 SET PA102WS-UPDATES        TO TRUE
020270             END-IF
020280             SET PA102WS-NO-DEFAULT    TO TRUE.

020290     IF (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-ACCOUNT-DN)
020300         MOVE PEP-EXP-ACCOUNT    TO HRWS-DEC-FIELD
020310         MOVE 0                  TO HRWS-SIZE
020320         MOVE 0                  TO HRWS-NBR-DECIMALS
020330         PERFORM 770-HR-FORMAT-DEC-FIELD
020340         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
020360         IF (PEP-EXP-ACCOUNT  = PA102WS-EXP-ACCOUNT)
020370             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
020400                 IF (PA102WS-NOUPDATES)
020410                     SET PA102WS-UPDATES          TO TRUE
020420                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
020430             ELSE
020440                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
020460                 GO TO 2100-END
020470             END-IF
020480         ELSE
020490             IF (PA102WS-NOUPDATES)
020500                 SET PA102WS-UPDATES          TO TRUE
020510             END-IF
020520             SET PA102WS-NO-DEFAULT    TO TRUE.

020530     IF (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-SUB-ACCT-DN)
020540         MOVE PEP-EXP-SUB-ACCT   TO HRWS-DEC-FIELD
020550         MOVE 0                  TO HRWS-SIZE
020560         MOVE 0                  TO HRWS-NBR-DECIMALS
020570         PERFORM 770-HR-FORMAT-DEC-FIELD
020580         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
020600         IF (PEP-EXP-SUB-ACCT = PA102WS-EXP-SUB-ACCT)
020610             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
020640                 IF (PA102WS-NOUPDATES)
020650                     SET PA102WS-UPDATES          TO TRUE
020660                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
020670             ELSE
020680                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
020700                 GO TO 2100-END
020710             END-IF
020720         ELSE
020730             IF (PA102WS-NOUPDATES)
020740                 SET PA102WS-UPDATES          TO TRUE
020750             END-IF
020760             SET PA102WS-NO-DEFAULT    TO TRUE.

020770     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-ACTIVITY-DN)
020790         MOVE PEP-ACTIVITY       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
020810         IF  (PEP-ACTIVITY           = PA102WS-VALUE-PRIOR (I1))
020830             IF (PEP-ACTIVITY NOT = PA102WS-VALUE (I1))
020860                 IF (PA102WS-NOUPDATES)
020870                     SET PA102WS-UPDATES          TO TRUE
020880                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
020890             ELSE
020900                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
020920                 GO TO 2100-END
020930             END-IF
020940         ELSE
020950             IF (PA102WS-NOUPDATES)
020960                 SET PA102WS-UPDATES          TO TRUE
020970             END-IF
020980            SET PA102WS-NO-DEFAULT    TO TRUE.

020990     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-ACCT-CATEGORY-DN)
021010         MOVE PEP-ACCT-CATEGORY  TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
021030         IF (PEP-ACCT-CATEGORY      = PA102WS-VALUE-PRIOR (I1))
021040             IF (PEP-ACCT-CATEGORY NOT = PA102WS-VALUE (I1))
021070                 IF (PA102WS-NOUPDATES)
021080                     SET PA102WS-UPDATES          TO TRUE
021090                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
021100             ELSE
021110                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
021130                 GO TO 2100-END
021140             END-IF
021150         ELSE
021160             IF (PA102WS-NOUPDATES)
021170                 SET PA102WS-UPDATES          TO TRUE
021180             END-IF
021190            SET PA102WS-NO-DEFAULT    TO TRUE.

021200     IF (PA102WS-FIELD-NBR (I1) = PAPOS-ANNUAL-HOURS-DN)
021220         MOVE PEP-ANNUAL-HOURS   TO HRWS-DEC-FIELD
021230         MOVE 0                  TO HRWS-SIZE
111167*        MOVE 0                  TO HRWS-NBR-DECIMALS
111167         MOVE 4                  TO HRWS-NBR-DECIMALS
021250         PERFORM 770-HR-FORMAT-DEC-FIELD
021260         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
021280         IF (PEP-ANNUAL-HOURS = PA102WS-ANNUAL-HOURS)
021290             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
021320                 IF (PA102WS-NOUPDATES)
021330                     SET PA102WS-UPDATES          TO TRUE
021340                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
021350             ELSE
021360                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
021380                 GO TO 2100-END
021390             END-IF
021400         ELSE
021410             IF (PA102WS-NOUPDATES)
021420                 SET PA102WS-UPDATES          TO TRUE
021430             END-IF
021440             SET PA102WS-NO-DEFAULT    TO TRUE.

021450     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-OT-PLAN-CODE-DN)
021460     AND (PEP-POS-LEVEL          = 1)
021470         MOVE EMP-OT-PLAN-CODE   TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
021490         IF  (EMP-OT-PLAN-CODE       = PA102WS-VALUE-PRIOR (I1))
021500         AND (PEP-POS-LEVEL         = 1)
021510             IF (EMP-OT-PLAN-CODE NOT = PA102WS-VALUE (I1))
021540                 IF (PA102WS-NOUPDATES)
021550                     SET PA102WS-UPDATES          TO TRUE
021560                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
021570             ELSE
021580                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
021600                 GO TO 2100-END
021610             END-IF
021620         ELSE
021630             IF (PA102WS-NOUPDATES)
021640                 SET PA102WS-UPDATES          TO TRUE
021650             END-IF
021660             SET PA102WS-NO-DEFAULT    TO TRUE.

021670     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-EXEMPT-EMP-DN)
021680     AND (PEP-POS-LEVEL          = 1)
021690         MOVE EMP-EXEMPT-EMP     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
021710         IF (EMP-EXEMPT-EMP         = PA102WS-VALUE-PRIOR (I1))
021720             IF (EMP-EXEMPT-EMP NOT = PA102WS-VALUE (I1))
021750                 IF (PA102WS-NOUPDATES)
021760                     SET PA102WS-UPDATES          TO TRUE
021770                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
021780             ELSE
021790                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
021810                 GO TO 2100-END
021820             END-IF
021830         ELSE
021840             IF (PA102WS-NOUPDATES)
021850                 SET PA102WS-UPDATES          TO TRUE
021860             END-IF
021870             SET PA102WS-NO-DEFAULT    TO TRUE.

021880     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SUPERVISOR-IND-DN)
021890         MOVE PEP-SUPERVISOR-IND TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
021910         IF (PEP-SUPERVISOR-IND     = PA102WS-VALUE-PRIOR (I1))
021920             IF (PEP-SUPERVISOR-IND NOT = PA102WS-VALUE (I1))
021950                 IF (PA102WS-NOUPDATES)
021960                     SET PA102WS-UPDATES          TO TRUE
021970                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
021980             ELSE
021990                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
022010                 GO TO 2100-END
022020             END-IF
022030         ELSE
022040             IF (PA102WS-NOUPDATES)
022050                 SET PA102WS-UPDATES          TO TRUE
022060             END-IF
022070            SET PA102WS-NO-DEFAULT    TO TRUE.

022080     IF (PA102WS-FIELD-NBR (I1) = PAPOS-WORK-SCHED-DN)
022090         MOVE PEP-WORK-SCHED     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
022110         IF (PEP-WORK-SCHED         = PA102WS-VALUE-PRIOR (I1))
022120             IF (PEP-WORK-SCHED NOT = PA102WS-VALUE (I1))
022150                 IF (PA102WS-NOUPDATES)
022160                     SET PA102WS-UPDATES          TO TRUE
022170                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
022180             ELSE
022190                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
022210                 GO TO 2100-END
022220             END-IF
022230         ELSE
022240             IF (PA102WS-NOUPDATES)
022250                 SET PA102WS-UPDATES          TO TRUE
022260             END-IF
022270             SET PA102WS-NO-DEFAULT    TO TRUE.

022280     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SEC-LOCATION-DN)
022290     AND (PEP-POS-LEVEL         = 1)
022300         MOVE EMP-SEC-LOCATION   TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
022320         IF (EMP-SEC-LOCATION       = PA102WS-VALUE-PRIOR (I1))
022330             IF (EMP-SEC-LOCATION NOT = PA102WS-VALUE (I1))
022360                 IF (PA102WS-NOUPDATES)
022370                     SET PA102WS-UPDATES          TO TRUE
022380                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
022390             ELSE
022400                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
022420                 GO TO 2100-END
022430             END-IF
022440         ELSE
022450             IF (PA102WS-NOUPDATES)
022460                 SET PA102WS-UPDATES          TO TRUE
022470             END-IF
022480             SET PA102WS-NO-DEFAULT    TO TRUE.

022490     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SEC-LVL-DN)
022500     AND (PEP-POS-LEVEL         = 1)
022510         MOVE EMP-SEC-LVL        TO HRWS-DEC-FIELD
022520         MOVE 0                  TO HRWS-SIZE
022530         MOVE 0                  TO HRWS-NBR-DECIMALS
022540         PERFORM 770-HR-FORMAT-DEC-FIELD
022550         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
022570         IF (EMP-SEC-LVL            = PA102WS-SEC-LVL)
022580             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
022610                 IF (PA102WS-NOUPDATES)
022620                     SET PA102WS-UPDATES          TO TRUE
022630                 END-IF
                       PERFORM 2150-MOVE-VALUE
                       THRU    2150-END
022640             ELSE
022650                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
022670                 GO TO 2100-END
022680             END-IF
022690         ELSE
022700             IF (PA102WS-NOUPDATES)
022710                 SET PA102WS-UPDATES          TO TRUE
022720             END-IF
022730            SET PA102WS-NO-DEFAULT    TO TRUE.
022740
017110     IF (PA102WS-FIELD-NBR (I1) = PAPOS-UNION-CODE-DN)
017120         MOVE PEP-UNION-CODE     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017130         IF (PEP-UNION-CODE   = PA102WS-VALUE-PRIOR (I1))
017140             IF (PEP-UNION-CODE   NOT = PA102WS-VALUE (I1))
017150                 IF (PA102WS-NOUPDATES)
017160                     SET PA102WS-UPDATES          TO TRUE
017170                 END-IF
017180                 PERFORM 2150-MOVE-VALUE
017190                 THRU    2150-END
017200             ELSE
017210                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
017230                 GO TO 2100-END
017240             END-IF
017250         ELSE
017260            IF (PA102WS-NOUPDATES)
017270                SET PA102WS-UPDATES          TO TRUE
017280            END-IF
017290            SET PA102WS-NO-DEFAULT    TO TRUE.

017110     IF (PA102WS-FIELD-NBR (I1) = PAPOS-BARGAIN-UNIT-DN)
017120         MOVE PEP-BARGAIN-UNIT   TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
017130         IF (PEP-BARGAIN-UNIT = PA102WS-VALUE-PRIOR (I1))
017140             IF (PEP-BARGAIN-UNIT NOT = PA102WS-VALUE (I1))
017150                 IF (PA102WS-NOUPDATES)
017160                     SET PA102WS-UPDATES          TO TRUE
017170                 END-IF
017180                 PERFORM 2150-MOVE-VALUE
017190                 THRU    2150-END
017200             ELSE
017210                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
017230                 GO TO 2100-END
017240             END-IF
017250         ELSE
017260            IF (PA102WS-NOUPDATES)
017270                SET PA102WS-UPDATES          TO TRUE
017280            END-IF
017290            SET PA102WS-NO-DEFAULT    TO TRUE.

022750 2100-END.
022760
022770******************************************************************
022780 2150-MOVE-VALUE.   
022790******************************************************************
022800
022810     IF (PA102WS-FIELD-NBR (I1) = PAPOS-END-DATE-DN)
022820         IF (PEP-POS-LEVEL    > 1)
022830             IF (PA102WS-END-DATE NOT = PAPEP-END-DATE)
022840                 MOVE WS-STAR             TO
022850                                      G2AWS-FIELD-CHANGED (G2-IND)
022860                 MOVE PA102WS-END-DATE    TO PAPEP-END-DATE
022870                 MOVE 1                   TO PAPEP-END-DATE-FN
022880             ELSE
022890                 MOVE "N"                  TO
022900                                      G2AWS-FIELD-CHANGED (G2-IND)
022910                 GO TO 2150-END
022920             END-IF
022930         ELSE
022940             MOVE "N"                  TO
022950                                      G2AWS-FIELD-CHANGED (G2-IND)
022960             GO TO 2150-END
022970         END-IF
022980     ELSE             
022990     IF (PA102WS-FIELD-NBR (I1) = PAPOS-JOB-CODE-DN)
023000         IF (PEP-POS-LEVEL      = 1)
023010             IF (PA102WS-VALUE (I1) NOT = HREMP-JOB-CODE) 
023020                 MOVE WS-STAR             TO
023030                                     G2AWS-FIELD-CHANGED (G2-IND)
023040                 MOVE EMP-JOB-CODE        TO
023050                                   G2AWS-PPC-VALUE-PRIOR (G2-IND)
023060                 MOVE PA102WS-VALUE (I1)  TO HREMP-JOB-CODE
023070                 MOVE 1                   TO HREMP-JOB-CODE-FN
023080             ELSE
023090                 MOVE "N"                  TO
023100                                      G2AWS-FIELD-CHANGED (G2-IND)
023110                 GO TO 2150-END
023120             END-IF
023130         ELSE
023140             IF (PA102WS-VALUE (I1) NOT = PAPEP-JOB-CODE) 
023150                 MOVE WS-STAR             TO
023160                                     G2AWS-FIELD-CHANGED (G2-IND)
023170                 MOVE PEP-JOB-CODE        TO
023180                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
023190                 MOVE PA102WS-VALUE (I1)  TO PAPEP-JOB-CODE
023200                 MOVE 1                   TO PAPEP-JOB-CODE-FN
023210             ELSE
023220                 MOVE "N"                  TO
023230                                      G2AWS-FIELD-CHANGED (G2-IND)
023240                 GO TO 2150-END
023250             END-IF
023260         END-IF
023270     ELSE             
023280     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PROCESS-LEVEL-DN)
023290         IF (PEP-POS-LEVEL = 1)
023300             IF (PA102WS-VALUE (I1) NOT = HREMP-PROCESS-LEVEL)
023310                 MOVE WS-STAR                TO
023320                                     G2AWS-FIELD-CHANGED (G2-IND)
023330                 MOVE PEP-PROCESS-LEVEL   TO
023340                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
023350                 MOVE PA102WS-VALUE (I1) TO HREMP-PROCESS-LEVEL
                                                  PA102WS-EMP-NEW-PL
023360                 MOVE 1                  TO HREMP-PROCESS-LEVEL-FN
                       INITIALIZE                 HREMP-CURRENCY-CODE
                       MOVE 1                  TO HREMP-CURRENCY-CODE-FN
                       INITIALIZE                 HREMP-WORK-COUNTRY
                       MOVE 1                  TO HREMP-WORK-COUNTRY-FN
                       IF (PA102WS-VALUE (I1) = SPACES)
                           MOVE PA102WS-VALUE (I1)
                                               TO PA102WS-EMP-NEW-PL
                       END-IF
023370             ELSE
023380                 MOVE "N"                  TO
023390                                      G2AWS-FIELD-CHANGED (G2-IND)
023400                 GO TO 2150-END 
023410             END-IF
023420         ELSE
023430             IF (PA102WS-VALUE (I1) NOT = PAPEP-PROCESS-LEVEL)
023440                 MOVE WS-STAR                TO
023450                                     G2AWS-FIELD-CHANGED (G2-IND)
023460                 MOVE PEP-PROCESS-LEVEL   TO
023470                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
023480                 MOVE PA102WS-VALUE (I1) TO PAPEP-PROCESS-LEVEL 
023490                 MOVE 1                  TO PAPEP-PROCESS-LEVEL-FN
023480                 INITIALIZE                 PAPEP-CURRENCY-CODE 
023490                 MOVE 1                  TO PAPEP-CURRENCY-CODE-FN
                       IF (PA102WS-VALUE (I1) = SPACES)
                           MOVE PA102WS-VALUE (I1)
                                               TO PA102WS-EMP-NEW-PL
                       END-IF
023500             ELSE
023510                 MOVE "N"                  TO
023520                                      G2AWS-FIELD-CHANGED (G2-IND)
023530                 GO TO 2150-END
023540             END-IF
023550         END-IF
023560     ELSE
023570     IF (PA102WS-FIELD-NBR (I1) = PAPOS-DEPARTMENT-DN)
023580         IF (PEP-POS-LEVEL = 1)
023590             IF (PA102WS-VALUE (I1) NOT = HREMP-DEPARTMENT)
023600                 MOVE WS-STAR                TO
023610                                     G2AWS-FIELD-CHANGED (G2-IND)
023620                 MOVE PEP-DEPARTMENT      TO
023630                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
023640                 MOVE PA102WS-VALUE (I1)  TO HREMP-DEPARTMENT
023650                 MOVE 1                   TO HREMP-DEPARTMENT-FN
023660             ELSE
023670                 MOVE "N"                  TO
023680                                      G2AWS-FIELD-CHANGED (G2-IND)
023690                 GO TO 2150-END
023700             END-IF
023710         ELSE
023720             IF (PA102WS-VALUE (I1) NOT = PAPEP-DEPARTMENT)
023730                 MOVE WS-STAR                TO
023740                                     G2AWS-FIELD-CHANGED (G2-IND)
023750                 MOVE PEP-DEPARTMENT      TO
023760                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
023770                 MOVE PA102WS-VALUE (I1)  TO PAPEP-DEPARTMENT 
023780                 MOVE 1                   TO PAPEP-DEPARTMENT-FN
023790             ELSE
023800                 MOVE "N"                  TO
023810                                      G2AWS-FIELD-CHANGED (G2-IND)
023820                 GO TO 2150-END
023830             END-IF
023840         END-IF
023850     ELSE
023860     IF (PA102WS-FIELD-NBR (I1) = PAPOS-USER-LEVEL-DN)
023870         IF (PEP-POS-LEVEL = 1)
023880             IF (PA102WS-VALUE (I1) NOT = HREMP-USER-LEVEL)
023890                 MOVE WS-STAR                TO
023900                                     G2AWS-FIELD-CHANGED (G2-IND)
023910                 MOVE PEP-USER-LEVEL      TO
023920                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
023930                 MOVE PA102WS-VALUE (I1)  TO HREMP-USER-LEVEL
023940                 MOVE 1                   TO HREMP-USER-LEVEL-FN
023950              ELSE
023960                 MOVE "N"                  TO
023970                                      G2AWS-FIELD-CHANGED (G2-IND)
023980                  GO TO 2150-END
023990              END-IF
024000         ELSE
024010             IF (PA102WS-VALUE (I1) NOT = PAPEP-USER-LEVEL)
024020                 MOVE WS-STAR                TO
024030                                     G2AWS-FIELD-CHANGED (G2-IND)
024040                 MOVE PEP-USER-LEVEL      TO
024050                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
024060                 MOVE PA102WS-VALUE (I1)  TO PAPEP-USER-LEVEL 
024070                 MOVE 1                   TO PAPEP-USER-LEVEL-FN
024080             ELSE
024090                 MOVE "N"                  TO
024100                                      G2AWS-FIELD-CHANGED (G2-IND)
024110                 GO TO 2150-END
024120             END-IF
024130         END-IF
024140     ELSE
           IF  (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-COMPANY-DN)
               MOVE PEP-EXP-COMPANY    TO HRWS-DEC-FIELD
               MOVE 0                  TO HRWS-SIZE
               MOVE 0                  TO HRWS-NBR-DECIMALS
               PERFORM 770-HR-FORMAT-DEC-FIELD
               IF (HRWS-VALUE = PA102WS-VALUE (I1))
                   MOVE "N"            TO G2AWS-FIELD-CHANGED (G2-IND)
                   GO TO 2150-END
               END-IF
               MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
               MOVE WS-STAR            TO G2AWS-FIELD-CHANGED (G2-IND)
               MOVE PA102WS-VALUE (I1) TO PAPCT-FIELD
               PERFORM 5200-CONVERT-NUMERIC-FIELD
               IF (PEP-POS-LEVEL = 1)
                   MOVE PAPCT-NUMERIC      TO HREMP-HM-DIST-CO 
                   MOVE 1                  TO HREMP-HM-DIST-CO-FN
               ELSE
                   MOVE PAPCT-NUMERIC      TO PAPEP-EXP-DIST-CO
                   MOVE 1                  TO PAPEP-EXP-DIST-CO-FN
               END-IF
           ELSE
024390     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-ACCT-UNIT-DN)
024400         IF (PEP-POS-LEVEL          = 1)
024410             IF (EMP-HM-ACCT-UNIT NOT = PA102WS-VALUE (I1))
024420                 MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
024440                 MOVE EMP-HM-ACCT-UNIT
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
024460                 MOVE PA102WS-VALUE (I1) TO HREMP-HM-ACCT-UNIT
024470                 MOVE 1                  TO HREMP-HM-ACCT-UNIT-FN
024480             ELSE
024490                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
024510                 GO TO 2150-END
024520             END-IF
024530         ELSE
                   IF (PA102WS-VALUE (I1) NOT = PAPEP-EXP-ACCT-UNIT)
                       MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
                       MOVE PEP-EXP-ACCT-UNIT
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
                       MOVE PA102WS-VALUE (I1) TO PAPEP-EXP-ACCT-UNIT
                       MOVE 1                  TO PAPEP-EXP-ACCT-UNIT-FN
                   ELSE
                       MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
                       GO TO 2150-END
                   END-IF
               END-IF
           ELSE
           IF  (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-ACCOUNT-DN)
               MOVE PEP-EXP-ACCOUNT    TO HRWS-DEC-FIELD
               MOVE 0                  TO HRWS-SIZE
               MOVE 0                  TO HRWS-NBR-DECIMALS
               PERFORM 770-HR-FORMAT-DEC-FIELD
               IF (HRWS-VALUE = PA102WS-VALUE (I1))
                   MOVE "N"            TO G2AWS-FIELD-CHANGED (G2-IND)
                   GO TO 2150-END
               END-IF
               MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
               MOVE WS-STAR            TO G2AWS-FIELD-CHANGED (G2-IND)
               MOVE PA102WS-VALUE (I1) TO PAPCT-FIELD
               PERFORM 5200-CONVERT-NUMERIC-FIELD
               IF (PEP-POS-LEVEL = 1)
                   MOVE PAPCT-NUMERIC      TO HREMP-HM-ACCOUNT
                   MOVE 1                  TO HREMP-HM-ACCOUNT-FN
               ELSE
                   MOVE PAPCT-NUMERIC      TO PAPEP-EXP-ACCOUNT
                   MOVE 1                  TO PAPEP-EXP-ACCOUNT-FN
               END-IF
           ELSE
           IF  (PA102WS-FIELD-NBR (I1) = PAPOS-EXP-SUB-ACCT-DN)
               MOVE PEP-EXP-SUB-ACCT  TO HRWS-DEC-FIELD
               MOVE 0                  TO HRWS-SIZE
               MOVE 0                  TO HRWS-NBR-DECIMALS
               PERFORM 770-HR-FORMAT-DEC-FIELD
               IF (HRWS-VALUE = PA102WS-VALUE (I1))
                   MOVE "N"            TO G2AWS-FIELD-CHANGED (G2-IND)
                   GO TO 2150-END
               END-IF
               MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
               MOVE WS-STAR            TO G2AWS-FIELD-CHANGED (G2-IND)
               MOVE PA102WS-VALUE (I1) TO PAPCT-FIELD
               PERFORM 5200-CONVERT-NUMERIC-FIELD
               IF (PEP-POS-LEVEL = 1)
                   MOVE PAPCT-NUMERIC      TO HREMP-HM-SUB-ACCT
                   MOVE 1                  TO HREMP-HM-SUB-ACCT-FN
               ELSE
                   MOVE PAPCT-NUMERIC      TO PAPEP-EXP-SUB-ACCT
                   MOVE 1                  TO PAPEP-EXP-SUB-ACCT-FN
               END-IF
           ELSE
025110     IF (PA102WS-FIELD-NBR (I1) = PAPOS-ACTIVITY-DN)
025120         IF (PEP-POS-LEVEL         = 1)
025130             IF (EMP-ACTIVITY NOT = PA102WS-VALUE (I1)) 
025140                 MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
025160                 MOVE EMP-ACTIVITY
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
025180                 MOVE PA102WS-VALUE (I1) TO HREMP-ACTIVITY 
025190                 MOVE 1                  TO HREMP-ACTIVITY-FN
025200             ELSE
025210                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
025230                 GO TO 2150-END
025240             END-IF
025250         ELSE
                   IF (PA102WS-VALUE (I1) NOT = PAPEP-ACTIVITY)
                       MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
                       MOVE PEP-ACTIVITY
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
                       MOVE PA102WS-VALUE (I1) TO PAPEP-ACTIVITY
                       MOVE 1                  TO PAPEP-ACTIVITY-FN
                   ELSE
                       MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
                       GO TO 2150-END
                   END-IF
025290         END-IF
025300     ELSE
025310     IF (PA102WS-FIELD-NBR (I1) = PAPOS-ACCT-CATEGORY-DN)
025320         IF (PEP-POS-LEVEL         = 1)
025330             IF (PA102WS-VALUE (I1) NOT = EMP-ACCT-CATEGORY)
025340                 MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
025360                 MOVE EMP-ACCT-CATEGORY
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
025380                 MOVE PA102WS-VALUE (I1) TO HREMP-ACCT-CATEGORY 
025390                 MOVE 1                  TO HREMP-ACCT-CATEGORY-FN
025400             ELSE
025410                 MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
025430                 GO TO 2150-END
025440             END-IF
025450         ELSE
                   IF (PA102WS-VALUE (I1) NOT = PAPEP-ACCT-CATEGORY)
                       MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
                       MOVE PEP-ACCT-CATEGORY
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
                       MOVE PA102WS-VALUE (I1) TO PAPEP-ACCT-CATEGORY
                       MOVE 1                  TO PAPEP-ACCT-CATEGORY-FN
                   ELSE
                       MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
                       GO TO 2150-END
                   END-IF
025490         END-IF
025500     ELSE
025510     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-RATE-DN)
025520         MOVE PEP-PAY-RATE       TO HRWS-DEC-FIELD
025530         MOVE 0                  TO HRWS-SIZE
025540         MOVE 4                  TO HRWS-NBR-DECIMALS
025550         PERFORM 770-HR-FORMAT-DEC-FIELD
025560         IF (HRWS-VALUE = PA102WS-VALUE (I1))
025570             MOVE "N"            TO G2AWS-FIELD-CHANGED (G2-IND)
025590             GO TO 2150-END
025600         END-IF
               SET PA102WS-PAY-RATE-UPD TO TRUE
025640         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
025660         MOVE WS-STAR            TO G2AWS-FIELD-CHANGED (G2-IND)
025610         MOVE PA102WS-VALUE (I1) TO PAPCT-FIELD
025620         PERFORM 5200-CONVERT-NUMERIC-FIELD
025630         IF (PEP-POS-LEVEL = 1)
025680             MOVE PAPCT-4-DECIMALS   TO HREMP-PAY-RATE
025690             MOVE 1                  TO HREMP-PAY-RATE-FN
025700         ELSE
025750             MOVE PAPCT-4-DECIMALS   TO PAPEP-PAY-RATE
025760             MOVE 1                  TO PAPEP-PAY-RATE-FN
025770         END-IF
025780     ELSE
025790     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-SALARY-CLASS-DN)
025800         IF (PEP-POS-LEVEL         = 1)
025810             IF (PA102WS-VALUE (I1) NOT = EMP-SALARY-CLASS)
025820                 MOVE WS-STAR             TO
025830                                     G2AWS-FIELD-CHANGED (G2-IND)
025840                 MOVE EMP-SALARY-CLASS    TO
025850                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
025860                 MOVE PA102WS-VALUE (I1)  TO HREMP-SALARY-CLASS 
025870                 MOVE 1                   TO HREMP-SALARY-CLASS-FN
025880             ELSE
025890                 MOVE "N"                  TO
025900                                      G2AWS-FIELD-CHANGED (G2-IND)
025910                 GO TO 2150-END
025920             END-IF
025930         ELSE
025940             MOVE "N"                  TO
025950                                      G2AWS-FIELD-CHANGED (G2-IND)
025960             GO TO 2150-END
025970         END-IF
025980     ELSE
025990     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-FREQUENCY-DN)
026000         IF (PEP-POS-LEVEL          = 1)
026010             MOVE WS-STAR                TO
026020                                     G2AWS-FIELD-CHANGED (G2-IND)
026030             MOVE EMP-PAY-FREQUENCY      TO HRWS-DEC-FIELD
026040             MOVE 0                      TO HRWS-SIZE
026050             MOVE 0                      TO HRWS-NBR-DECIMALS
026060             PERFORM 770-HR-FORMAT-DEC-FIELD
026070             MOVE HRWS-VALUE             TO
026080                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
026090             IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
026100                 MOVE PA102WS-VALUE (I1) TO PAPCT-FIELD
026110                 PERFORM 5200-CONVERT-NUMERIC-FIELD
026120                 MOVE PAPCT-NUMERIC      TO HREMP-PAY-FREQUENCY 
026130                 MOVE 1                  TO HREMP-PAY-FREQUENCY-FN
026140             ELSE
026150                 MOVE "N"                  TO
026160                                      G2AWS-FIELD-CHANGED (G2-IND)
026170                 GO TO 2150-END
026180             END-IF
026190         ELSE
026200             MOVE "N"                  TO
026210                                      G2AWS-FIELD-CHANGED (G2-IND)
026220             GO TO 2150-END
026230         END-IF
026240     ELSE
026250     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SCHEDULE-DN)
026260         IF (PEP-POS-LEVEL      = 1)
026270             IF (PA102WS-VALUE (I1) NOT = HREMP-SCHEDULE)
026280                 MOVE WS-STAR                TO
026290                                     G2AWS-FIELD-CHANGED (G2-IND)
026300                 MOVE PEP-SCHEDULE               TO
026310                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
026320                 MOVE PA102WS-VALUE (I1) TO HREMP-SCHEDULE  
026330                 MOVE 1                  TO HREMP-SCHEDULE-FN
026340             ELSE
026350                 MOVE "N"                  TO
026360                                      G2AWS-FIELD-CHANGED (G2-IND)
026370                 GO TO 2150-END
026380             END-IF
026390         ELSE
026400             IF (PA102WS-VALUE (I1) NOT = PAPEP-SCHEDULE)
026410                 MOVE WS-STAR                TO
026420                                     G2AWS-FIELD-CHANGED (G2-IND)
026430                 MOVE PEP-SCHEDULE               TO
026440                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
026450                 MOVE PA102WS-VALUE (I1) TO PAPEP-SCHEDULE  
026460                 MOVE 1                  TO PAPEP-SCHEDULE-FN
026470             ELSE
026480                 MOVE "N"                  TO
026490                                      G2AWS-FIELD-CHANGED (G2-IND)
026500                 GO TO 2150-END
026510             END-IF
026520         END-IF
026530     ELSE
           IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-GRADE-DN)
               IF (PEP-POS-LEVEL      = 1)
                   IF (PA102WS-VALUE (I1) NOT = HREMP-PAY-GRADE)
                       MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
                       MOVE PEP-PAY-GRADE
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
                       MOVE PA102WS-VALUE (I1) TO HREMP-PAY-GRADE  
                       MOVE 1                  TO HREMP-PAY-GRADE-FN
                   ELSE
                       MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
                       GO TO 2150-END
                   END-IF
               ELSE
                   IF (PA102WS-VALUE (I1) NOT = PAPEP-PAY-GRADE)
                       MOVE WS-STAR    TO G2AWS-FIELD-CHANGED (G2-IND)
                       MOVE PEP-PAY-GRADE
                                       TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
                       MOVE PA102WS-VALUE (I1) TO PAPEP-PAY-GRADE  
                       MOVE 1                  TO PAPEP-PAY-GRADE-FN
                   ELSE
                       MOVE "N"        TO G2AWS-FIELD-CHANGED (G2-IND)
                       GO TO 2150-END
                   END-IF
               END-IF
           ELSE
026680     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-STEP-DN)
026690         MOVE PEP-PAY-STEP             TO HRWS-DEC-FIELD
026700         MOVE 0                        TO HRWS-SIZE
026710         MOVE 0                        TO HRWS-NBR-DECIMALS
026720         PERFORM 770-HR-FORMAT-DEC-FIELD
026730         IF (HRWS-VALUE NOT = PA102WS-VALUE (I1))
026770             MOVE HRWS-VALUE     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
026790             MOVE WS-STAR        TO G2AWS-FIELD-CHANGED (G2-IND)
026740             MOVE PA102WS-VALUE (I1)     TO PAPCT-FIELD
026750             PERFORM 5200-CONVERT-NUMERIC-FIELD
026760             IF (PEP-POS-LEVEL = 1)
026810                MOVE PAPCT-NUMERIC        TO HREMP-PAY-STEP 
026820                MOVE 1                    TO HREMP-PAY-STEP-FN
026830             ELSE
026880                 MOVE PAPCT-NUMERIC        TO PAPEP-PAY-STEP 
026890                 MOVE 1                    TO PAPEP-PAY-STEP-FN
026900             END-IF
026910         ELSE
026920             MOVE "N"                  TO
026930                                      G2AWS-FIELD-CHANGED (G2-IND)
026940             GO TO 2150-END
026950         END-IF
026960     ELSE
026970     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SUPERVISOR-DN)
026980         IF (PEP-SUPERVISOR = PA102WS-VALUE (I1))
026990             MOVE "N"                  TO
027000                                      G2AWS-FIELD-CHANGED (G2-IND)
027010             GO TO 2150-END
027020         ELSE
027030             MOVE WS-STAR                TO
027040                                     G2AWS-FIELD-CHANGED (G2-IND)
027050             MOVE PEP-SUPERVISOR            TO
027060                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
027070             IF (PEP-POS-LEVEL = 1)
027080                 MOVE PA102WS-VALUE (I1)  TO HREMP-SUPERVISOR
027090                 MOVE 1                   TO HREMP-SUPERVISOR-FN
027100             ELSE
027110                 MOVE PA102WS-VALUE (I1)  TO PAPEP-SUPERVISOR
027120                 MOVE 1                   TO PAPEP-SUPERVISOR-FN
027130             END-IF
027140         END-IF 
027150     ELSE
027160     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SHIFT-DN)
027170         MOVE PEP-SHIFT                TO HRWS-DEC-FIELD
027180         MOVE 0                        TO HRWS-SIZE
027190         MOVE 0                        TO HRWS-NBR-DECIMALS
027200         PERFORM 770-HR-FORMAT-DEC-FIELD
027210         IF (HRWS-VALUE = PA102WS-VALUE (I1))
027220             GO TO 2150-END
027230         END-IF
027240         MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
027260         MOVE WS-STAR            TO G2AWS-FIELD-CHANGED (G2-IND)
027280         MOVE PA102WS-VALUE (I1)     TO PAPCT-FIELD
027290         PERFORM 5200-CONVERT-NUMERIC-FIELD
027300         IF (PEP-POS-LEVEL = 1)
027310             MOVE PAPCT-NUMERIC       TO HREMP-SHIFT 
027320             MOVE 1                   TO HREMP-SHIFT-FN
027330         ELSE
027340             MOVE PAPCT-NUMERIC       TO PAPEP-SHIFT
027350             MOVE 1                   TO PAPEP-SHIFT-FN
027360         END-IF
027370     ELSE
027380     IF (PA102WS-FIELD-NBR (I1) = PAPOS-LOCAT-CODE-DN)
027390         IF (PEP-LOCAT-CODE = PA102WS-VALUE (I1))
027400             MOVE "N"                  TO
027410                                      G2AWS-FIELD-CHANGED (G2-IND)
027420             GO TO 2150-END
027430         END-IF
027440         MOVE PEP-LOCAT-CODE           TO
027450                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
027460         MOVE WS-STAR                TO
027470                                     G2AWS-FIELD-CHANGED (G2-IND)
027480         IF (PEP-POS-LEVEL = 1)
027490             MOVE PA102WS-VALUE (I1)  TO HRPEM-LOCAT-CODE
027500             MOVE 1                   TO HRPEM-LOCAT-CODE-FN
027510         ELSE
027520             MOVE PA102WS-VALUE (I1)  TO PAPEP-LOCAT-CODE 
027530             MOVE 1                   TO PAPEP-LOCAT-CODE-FN
027540         END-IF
027550     ELSE
027560     IF (PA102WS-FIELD-NBR (I1) = PAPOS-OT-PLAN-CODE-DN)
027570         IF (PEP-POS-LEVEL          = 1)
027580             IF (EMP-OT-PLAN-CODE = PA102WS-VALUE (I1))
027590                 MOVE "N"                  TO
027600                                      G2AWS-FIELD-CHANGED (G2-IND)
027610                 GO TO 2150-END
027620             END-IF
027630             MOVE WS-STAR                TO
027640                                     G2AWS-FIELD-CHANGED (G2-IND)
027650             MOVE EMP-OT-PLAN-CODE        TO
027660                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
027670             MOVE PA102WS-VALUE (I1)      TO HREMP-OT-PLAN-CODE 
027680             MOVE 1                       TO HREMP-OT-PLAN-CODE-FN
027690         ELSE
027700             MOVE "N"                  TO
027710                                      G2AWS-FIELD-CHANGED (G2-IND)
027720             GO TO 2150-END
027730         END-IF
027740     ELSE
027750     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SUPERVISOR-IND-DN)
027760         IF (PEP-SUPERVISOR-IND = PA102WS-VALUE (I1))
027770             MOVE "N"                  TO
027780                                      G2AWS-FIELD-CHANGED (G2-IND)
027790             GO TO 2150-END
027800         END-IF
027810         MOVE WS-STAR                TO
027820                                     G2AWS-FIELD-CHANGED (G2-IND)
027830         MOVE PEP-SUPERVISOR-IND        TO
027840                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
027850         IF (PEP-POS-LEVEL = 1)
027860             MOVE PA102WS-VALUE (I1)  TO HREMP-SUPERVISOR-IND
027870             MOVE 1                   TO HREMP-SUPERVISOR-IND-FN
027880         ELSE
027890             MOVE PA102WS-VALUE (I1)  TO PAPEP-SUPERVISOR-IND 
027900             MOVE 1                     TO PAPEP-SUPERVISOR-IND-FN
027910         END-IF
027920     ELSE
027930     IF (PA102WS-FIELD-NBR (I1) = PAPOS-WORK-SCHED-DN)
027940         IF (PEP-WORK-SCHED = PA102WS-VALUE (I1))
027950             MOVE "N"                  TO
027960                                      G2AWS-FIELD-CHANGED (G2-IND)
027970             GO TO 2150-END
027980         END-IF
027990         MOVE WS-STAR                     TO
028000                                     G2AWS-FIELD-CHANGED (G2-IND)
028010         MOVE PEP-WORK-SCHED              TO
028020                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
028030         IF (PEP-POS-LEVEL = 1)
028040             MOVE PA102WS-VALUE (I1)      TO HREMP-WORK-SCHED
028050             MOVE 1                       TO HREMP-WORK-SCHED-FN
028060         ELSE
028070            MOVE PA102WS-VALUE (I1)       TO PAPEP-WORK-SCHED 
028080            MOVE 1                        TO PAPEP-WORK-SCHED-FN
028090         END-IF
028100     ELSE
028110     IF  (PA102WS-FIELD-NBR (I1) = PAPOS-EXEMPT-EMP-DN)
028120         IF (PEP-POS-LEVEL         = 1)
028130             IF (HREMP-EXEMPT-EMP = PA102WS-VALUE (I1))
028140                 MOVE "N"                  TO
028150                                      G2AWS-FIELD-CHANGED (G2-IND)
028160                 GO TO 2150-END
028170             END-IF
028180             MOVE WS-STAR                 TO
028190                                     G2AWS-FIELD-CHANGED (G2-IND)
028200             MOVE EMP-EXEMPT-EMP          TO
028210                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
028220             MOVE PA102WS-VALUE (I1)      TO HREMP-EXEMPT-EMP 
028230             MOVE 1                       TO HREMP-EXEMPT-EMP-FN
028240         ELSE
028250             MOVE "N"                  TO
028260                                      G2AWS-FIELD-CHANGED (G2-IND)
028270             GO TO 2150-END
028280         END-IF
028290     ELSE
028300     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SEC-LVL-DN)
028310         IF (PEP-POS-LEVEL         = 1)
028320             MOVE EMP-SEC-LVL             TO HRWS-DEC-FIELD
028330             MOVE 0                       TO HRWS-SIZE
028340             MOVE 0                       TO HRWS-NBR-DECIMALS
028350             PERFORM 770-HR-FORMAT-DEC-FIELD
028360             IF (HRWS-VALUE = PA102WS-VALUE (I1))
028370                 MOVE "N"                  TO
028380                                      G2AWS-FIELD-CHANGED (G2-IND)
028390                 GO TO 2150-END
028400             END-IF
028410             MOVE HRWS-VALUE     TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
028430             MOVE WS-STAR        TO G2AWS-FIELD-CHANGED (G2-IND)
028450             MOVE PA102WS-VALUE (I1)      TO PAPCT-FIELD
028460             PERFORM 5200-CONVERT-NUMERIC-FIELD
028470             MOVE PAPCT-NUMERIC           TO HREMP-SEC-LVL 
028480             MOVE 1                       TO HREMP-SEC-LVL-FN
028490         ELSE
028500             MOVE "N"                  TO
028510                                      G2AWS-FIELD-CHANGED (G2-IND)
028520             GO TO 2150-END
028530         END-IF
028540     ELSE
028550     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SEC-LOCATION-DN)
028560         IF (PEP-POS-LEVEL         = 1)
028570             IF (EMP-SEC-LOCATION = PA102WS-VALUE (I1))
028580                 GO TO 2150-END
028590             END-IF
028600             MOVE WS-STAR                TO
028610                                     G2AWS-FIELD-CHANGED (G2-IND)
028620             MOVE EMP-SEC-LOCATION        TO
028630                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
028640             MOVE PA102WS-VALUE (I1)      TO HREMP-SEC-LOCATION
028650             MOVE 1                       TO HREMP-SEC-LOCATION-FN
028660         ELSE
028670             MOVE "N"                  TO
028680                                      G2AWS-FIELD-CHANGED (G2-IND)
028690             GO TO 2150-END
028700         END-IF
028710     ELSE
           IF  (PA102WS-FIELD-NBR (I1) = PAPOS-ANNUAL-HOURS-DN)
               MOVE PEP-ANNUAL-HOURS  TO HRWS-DEC-FIELD
               MOVE 0                  TO HRWS-SIZE
111167*        MOVE 0                  TO HRWS-NBR-DECIMALS
111167         MOVE 4                  TO HRWS-NBR-DECIMALS
               PERFORM 770-HR-FORMAT-DEC-FIELD
               IF (HRWS-VALUE = PA102WS-VALUE (I1))
                   MOVE "N"            TO G2AWS-FIELD-CHANGED (G2-IND)
                   GO TO 2150-END
               END-IF
               MOVE HRWS-VALUE         TO G2AWS-PPC-VALUE-PRIOR (G2-IND)
               MOVE WS-STAR            TO G2AWS-FIELD-CHANGED (G2-IND)
               MOVE PA102WS-VALUE (I1) TO PAPCT-FIELD
               PERFORM 5200-CONVERT-NUMERIC-FIELD
               IF (PEP-POS-LEVEL = 1)
111167*            MOVE PAPCT-NUMERIC      TO HREMP-ANNUAL-HOURS
111167             MOVE PAPCT-4-DECIMALS   TO HREMP-ANNUAL-HOURS
                   MOVE 1                  TO HREMP-ANNUAL-HOURS-FN
               ELSE
111167*            MOVE PAPCT-NUMERIC      TO PAPEP-ANNUAL-HOURS
111167             MOVE PAPCT-4-DECIMALS   TO PAPEP-ANNUAL-HOURS
                   MOVE 1                  TO PAPEP-ANNUAL-HOURS-FN
               END-IF
           ELSE
027930     IF (PA102WS-FIELD-NBR (I1) = PAPOS-UNION-CODE-DN)
027940         IF (PEP-UNION-CODE = PA102WS-VALUE (I1))
027950             MOVE "N"                  TO
027960                                      G2AWS-FIELD-CHANGED (G2-IND)
027970             GO TO 2150-END
027980         END-IF
027990         MOVE WS-STAR                     TO
028000                                     G2AWS-FIELD-CHANGED (G2-IND)
028010         MOVE PEP-UNION-CODE              TO
028020                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
028030         IF (PEP-POS-LEVEL = 1)
028040             MOVE PA102WS-VALUE (I1)      TO HREMP-UNION-CODE
028050             MOVE 1                       TO HREMP-UNION-CODE-FN
028060         ELSE
028070            MOVE PA102WS-VALUE (I1)       TO PAPEP-UNION-CODE 
028080            MOVE 1                        TO PAPEP-UNION-CODE-FN
028090         END-IF
028100     ELSE
027930     IF (PA102WS-FIELD-NBR (I1) = PAPOS-BARGAIN-UNIT-DN)
027940         IF (PEP-BARGAIN-UNIT = PA102WS-VALUE (I1))
027950             MOVE "N"                  TO
027960                                      G2AWS-FIELD-CHANGED (G2-IND)
027970             GO TO 2150-END
027980         END-IF
027990         MOVE WS-STAR                     TO
028000                                     G2AWS-FIELD-CHANGED (G2-IND)
028010         MOVE PEP-BARGAIN-UNIT            TO
028020                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
028030         IF (PEP-POS-LEVEL = 1)
028040             MOVE PA102WS-VALUE (I1)      TO HRPEM-BARGAIN-UNIT
028050             MOVE 1                       TO HRPEM-BARGAIN-UNIT-FN
028060         ELSE
028070             MOVE PA102WS-VALUE (I1)      TO PAPEP-BARGAIN-UNIT
028080             MOVE 1                       TO PAPEP-BARGAIN-UNIT-FN
028090         END-IF
028100     END-IF.
028950
028960     SET PA102WS-DEFAULT              TO TRUE.
028970
028980     IF (PA102WS-NOUPDATES)
028990         SET PA102WS-UPDATES          TO TRUE.
029000
029010 2150-END.
029020
029030******************************************************************
029040 2200-PROCESS-PAJOBREQ.
029050******************************************************************
029060
029070     IF (PJR-CLOSED-DATE NOT = ZEROES)
029080         GO TO 2200-FIND-NEXT-PAJOBREQ.
029090
029100     IF (PJR-POS-EFFECT-DAT > PA102WS-EFFECT-DATE)
029110         GO TO 2200-FIND-NEXT-PAJOBREQ.
029120
029130     IF (PA102WS-END-DATE NOT = ZEROES)
029140         MOVE PA102WS-POSITION        TO G9A-PPC-POSITION
029150         MOVE PA102WS-POS-DESCRIPTION TO G9A-POS-DESCRIPTION
029160         MOVE PJR-DATE-NEEDED         TO G9A-PPC-EFFECT-DATE
029170         MOVE PJR-REQUISITION         TO G9A-EMP-REQ
               MOVE ZEROES                  TO G9A-POS-LEVEL
029180         MOVE PJR-DESCRIPTION         TO G9A-DESCRIPTION
029190         MOVE 115                     TO CRT-MSG-NBR 
029200         PERFORM 790-GET-MSG
029210         MOVE CRT-MESSAGE             TO G9A-COMMENTS
029220         MOVE GN9A-ERROR-DETAIL       TO RPT-GROUP-REQUEST
               IF (NO-ERR-DATA-TO-PRINT)
                   SET ERR-DATA-TO-PRINT    TO TRUE
               END-IF
029230         SET PA102WS-UPDATES          TO TRUE
029240         PERFORM 700-PRINT-RPT-GRP
029320         IF (PRM-UPDATE = "Y")
029250             MOVE PRM-COMPANY           TO DB-COMPANY
029260             MOVE PJR-REQUISITION       TO DB-REQUISITION
029270             INITIALIZE                    DB-EMPLOYEE   
029280             MOVE PA102WS-POSITION      TO DB-POSITION
029290             MOVE PA102WS-EFFECT-DATE   TO DB-EFFECT-DATE
029300             MOVE "2  "                 TO DB-UPDATE-TYPE
029310             PERFORM 840-FIND-PPESET1
029330             IF (PAPOSERR-NOTFOUND)
029340               PERFORM 800-CREATE-PAPOSERR
029350               MOVE PRM-COMPANY           TO PPE-COMPANY
029360               MOVE PJR-REQUISITION       TO PPE-REQUISITION
029370               INITIALIZE                    PPE-EMPLOYEE
029380               MOVE PA102WS-POSITION      TO PPE-POSITION
029390               MOVE PA102WS-EFFECT-DATE   TO PPE-EFFECT-DATE
029400               MOVE "2  "                 TO PPE-UPDATE-TYPE
029410               INITIALIZE                    PPE-POS-LEVEL (1)
029420               PERFORM 820-STORE-PAPOSERR.
029430
029440     MOVE "C"                         TO PAPJR-FC.
029450     SET PAPJR-POS-CHG                TO TRUE.
029460     MOVE PJR-COMPANY                 TO PAPJR-COMPANY.
029470     MOVE PJR-EFFECT-DATE             TO PAPJR-EFFECT-DATE.
029480     MOVE PJR-REQUISITION             TO PAPJR-REQUISITION.
029490     MOVE PJR-DESCRIPTION             TO PAPJR-DESCRIPTION.
029500     MOVE PJR-DATE-NEEDED             TO PAPJR-DATE-NEEDED.
029510     MOVE PJR-REQ-STATUS              TO PAPJR-REQ-STATUS.
029520     MOVE PJR-REQUEST-DATE            TO PAPJR-REQUEST-DATE.
029530     MOVE PJR-OPEN-DATE               TO PAPJR-OPEN-DATE.
029540     MOVE PJR-DATE-NEEDED             TO PAPJR-DATE-NEEDED.
029550     MOVE PJR-CLOSED-DATE             TO PAPJR-CLOSED-DATE.
029560     INITIALIZE                          PAPJR-END-DATE.
029570
029580     MOVE "RQ"                        TO DB-TYPE.
029590     MOVE PJR-REQ-STATUS              TO DB-CODE.
029600     PERFORM 840-FIND-PCOSET1.
029610     IF (PCODES-FOUND)
029620         MOVE PCO-COUNT               TO PAPJR-COUNT.
029630
029640     IF  (PAPJR-COUNT       = 1)
029650     AND (PJR-CLOSED-DATE  > PJR-DATE-NEEDED)
029660         MOVE PJR-CLOSED-DATE         TO PAPJR-END-DATE.
029670     MOVE PJR-OPENINGS                TO PAPJR-OPENINGS.
029680     MOVE PJR-OFFERS-ACCEPT           TO PAPJR-OFFERS-ACCEPT.
029690     COMPUTE PAPJR-REMAINING-OPEN =
029700         (PAPJR-OPENINGS - PAPJR-OFFERS-ACCEPT).
029710     MOVE PJR-OPEN-FTE                TO PAPJR-OPEN-FTE.
029720     MOVE PJR-FILLED-FTE              TO PAPJR-FILLED-FTE.
029730     COMPUTE PAPJR-REMAINING-FTE =
029740         (PAPJR-OPEN-FTE - PAPJR-FILLED-FTE).
029750     MOVE PJR-POSITION                TO PAPJR-POSITION.
029760     MOVE PJR-PROCESS-LEVEL           TO PAPJR-PROCESS-LEVEL.
029770     MOVE PJR-DEPARTMENT              TO PAPJR-DEPARTMENT.
029780     MOVE PJR-JOB-CODE                TO PAPJR-JOB-CODE.
029790     MOVE PJR-APP-STATUS              TO PAPJR-APP-STATUS.
029800     MOVE PJR-TEMP-BEGIN              TO PAPJR-TEMP-BEGIN.
029810     MOVE PJR-TEMP-END                TO PAPJR-TEMP-END.
029820     MOVE PJR-USER-LEVEL              TO PAPJR-USER-LEVEL.
029830     MOVE PJR-SUPERVISOR              TO PAPJR-SUPERVISOR.
029840     MOVE PJR-LOCAT-CODE              TO PAPJR-LOCAT-CODE.
029850     MOVE PJR-SALARY-CLASS            TO PAPJR-SALARY-CLASS.
029860     MOVE PJR-BEG-PAY-RATE            TO PAPJR-BEG-PAY-RATE.
029870     MOVE PJR-END-PAY-RATE            TO PAPJR-END-PAY-RATE.
           MOVE PJR-CURRENCY-CODE           TO PAPJR-CURRENCY-CODE.
029880     MOVE PJR-EXEMPT-EMP              TO PAPJR-EXEMPT-EMP.
029890     MOVE PJR-SCHEDULE                TO PAPJR-SCHEDULE.
029900     MOVE PJR-PAY-GRADE               TO PAPJR-PAY-GRADE.
029910     MOVE PJR-PAY-STEP                TO PAPJR-PAY-STEP.
029920     MOVE PJR-WORK-SCHED              TO PAPJR-WORK-SCHED.
029930     MOVE PJR-SHIFT                   TO PAPJR-SHIFT.
029940     MOVE PA102WS-EFFECT-DATE         TO PAPJR-POS-EFFECT-DAT.
029950     MOVE PA102WS-END-DATE            TO PAPJR-POS-END-DATE.
029960     MOVE PJR-REQUEST-BY              TO PAPJR-REQUEST-BY.
029970     MOVE PJR-BUDGETED-FLAG           TO PAPJR-BUDGETED-FLAG.
029980     MOVE PJR-REPLACEMENT             TO PAPJR-REPLACEMENT.
029990     MOVE PJR-REP-EMPLOYEE            TO PAPJR-REP-EMPLOYEE.
030000     MOVE PJR-NBR-APPROVALS           TO PAPJR-NBR-APPROVALS.
030010     MOVE PJR-APPROVAL-DESC (1)       TO PAPJR-APPROVAL-DESC-1.
030020     MOVE PJR-APPROVAL-DATE (1)       TO PAPJR-APPROVAL-DATE-1.
030030     MOVE PJR-APPROVAL-EMP (1)        TO PAPJR-APPROVAL-EMP-1.
030040     MOVE PJR-APPROVAL-DESC (2)       TO PAPJR-APPROVAL-DESC-2.
030050     MOVE PJR-APPROVAL-DATE (2)       TO PAPJR-APPROVAL-DATE-2.
030060     MOVE PJR-APPROVAL-EMP (2)        TO PAPJR-APPROVAL-EMP-2.
030070     MOVE PJR-APPROVAL-DESC (3)       TO PAPJR-APPROVAL-DESC-3.
030080     MOVE PJR-APPROVAL-DATE (3)       TO PAPJR-APPROVAL-DATE-3.
030090     MOVE PJR-APPROVAL-EMP (3)        TO PAPJR-APPROVAL-EMP-3.
030100     MOVE PJR-APPROVAL-DESC (4)       TO PAPJR-APPROVAL-DESC-4.
030110     MOVE PJR-APPROVAL-DATE (4)       TO PAPJR-APPROVAL-DATE-4.
030120     MOVE PJR-APPROVAL-EMP (4)        TO PAPJR-APPROVAL-EMP-4.
030130     MOVE PJR-APPROVAL-DESC (5)       TO PAPJR-APPROVAL-DESC-5.
030140     MOVE PJR-APPROVAL-DATE (5)       TO PAPJR-APPROVAL-DATE-5.
030150     MOVE PJR-APPROVAL-EMP (5)        TO PAPJR-APPROVAL-EMP-5.
030160     MOVE PJR-APPROVAL-DESC (6)       TO PAPJR-APPROVAL-DESC-6.
030170     MOVE PJR-APPROVAL-DATE (6)       TO PAPJR-APPROVAL-DATE-6.
030180     MOVE PJR-APPROVAL-EMP (6)        TO PAPJR-APPROVAL-EMP-6.
030190     MOVE PJR-APPROVAL-DESC (7)       TO PAPJR-APPROVAL-DESC-7.
030200     MOVE PJR-APPROVAL-DATE (7)       TO PAPJR-APPROVAL-DATE-7.
030210     MOVE PJR-APPROVAL-EMP (7)        TO PAPJR-APPROVAL-EMP-7.
030220     MOVE PJR-APPROVAL-DESC (8)       TO PAPJR-APPROVAL-DESC-8.
030230     MOVE PJR-APPROVAL-DATE (8)       TO PAPJR-APPROVAL-DATE-8.
030240     MOVE PJR-APPROVAL-EMP (8)        TO PAPJR-APPROVAL-EMP-8.
030250     MOVE PJR-APPROVAL-DESC (9)       TO PAPJR-APPROVAL-DESC-9.
030260     MOVE PJR-APPROVAL-DATE (9)       TO PAPJR-APPROVAL-DATE-9.
030270     MOVE PJR-APPROVAL-EMP (9)        TO PAPJR-APPROVAL-EMP-9.
030280     MOVE PJR-APPROVAL-DESC (10)      TO PAPJR-APPROVAL-DESC-10.
030290     MOVE PJR-APPROVAL-DATE (10)      TO PAPJR-APPROVAL-DATE-10.
030300     MOVE PJR-APPROVAL-EMP (10)       TO PAPJR-APPROVAL-EMP-10.
030310     MOVE PJR-INTERNAL-START          TO PAPJR-INTERNAL-START.
030320     MOVE PJR-INTERNAL-STOP           TO PAPJR-INTERNAL-STOP.
030330     MOVE PJR-EXTERNAL-START          TO PAPJR-EXTERNAL-START.
030340     MOVE PJR-EXTERNAL-STOP           TO PAPJR-EXTERNAL-STOP.
030350     MOVE PJR-CONTACT-NBR             TO PAPJR-CONTACT-NBR.
030360     MOVE PJR-CONTACT-LAST            TO PAPJR-CONTACT-LAST.
030370     MOVE PJR-CONTACT-FIRST           TO PAPJR-CONTACT-FIRST.
030380     MOVE PJR-CONTACT-MI              TO PAPJR-CONTACT-MI.
030390     MOVE PJR-WK-PHONE-CNTRY          TO PAPJR-WK-PHONE-CNTRY.
030400     MOVE PJR-WK-PHONE-NBR            TO PAPJR-WK-PHONE-NBR.
030410     MOVE PJR-WK-PHONE-EXT            TO PAPJR-WK-PHONE-EXT.
030420     MOVE PJR-SHORT-DESC1             TO PAPJR-SHORT-DESC1.
030430     MOVE PJR-SHORT-DESC2             TO PAPJR-SHORT-DESC2.
030440     MOVE PJR-SHORT-DESC3             TO PAPJR-SHORT-DESC3.
030450     MOVE PJR-SPEC-REQ1               TO PAPJR-SPEC-REQ1.
030460     MOVE PJR-SPEC-REQ2               TO PAPJR-SPEC-REQ2.
030470     MOVE PJR-SPEC-REQ3               TO PAPJR-SPEC-REQ3.
P68717     MOVE PJR-UNION-CODE              TO PAPJR-UNION-CODE.
P68717     MOVE PJR-BARGAIN-UNIT            TO PAPJR-BARGAIN-UNIT.
P86231     MOVE PJR-APPROVAL-FLAG           TO PAPJR-APPROVAL-FLAG.
030480
030490     INITIALIZE                          G2AWS.
030500     MOVE 1                           TO G2-IND.
030510     SET PA102WS-NOUPDATES            TO TRUE.
030520     PERFORM
030530       VARYING I1 FROM 1 BY 1
030540       UNTIL  (I1 > PA102WS-COUNTER)
030550       OR     (PA102WS-FIELD-NBR (I1) = ZEROES)
030560         MOVE WS-FALSE                TO WS-VALUE-CHANGE-SW 
030570                                         WS-DEFAULT-INFO-SW
030580         IF (PA102WS-DEFAULT-FLG (I1) = 2 OR 3)
030940             MOVE PA102WS-EFFECT-DATE TO
030950                                G2AWS-PPC-EFFECT-DATE (G2-IND)
                   SET WS-NOT-PJR-FIELD     TO TRUE
030590             MOVE PJR-REQUISITION     TO G2AWS-EMP-REQ (G2-IND)
030600             MOVE PJR-DESCRIPTION     TO
030610                                   G2AWS-NAME-DESCRIPTION (G2-IND)
030620             INITIALIZE             G2AWS-PPC-LVL (G2-IND)
030630                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
030640             IF (PA102WS-DEFAULT-FLG (I1) = 3)
030650                 PERFORM 2350-MOVE-VALUE
030660                 THRU    2350-END
030670                 IF (G2AWS-PPC-VALUE-PRIOR (G2-IND) =
030680                                            PA102WS-VALUE (I1))
030690                     MOVE "N"      TO G2AWS-FIELD-CHANGED (G2-IND)
030700                     INITIALIZE    G2AWS-PPC-VALUE-PRIOR (G2-IND)
030710                 ELSE   
                           IF (G2AWS-COMMENTS (G2-IND) = SPACES)
                               IF (G2AWS-COMMENTS (G2-IND) = SPACES)
P68827                             MOVE WS-PA102-MSG-119 TO
P58562                                          G2AWS-COMMENTS (G2-IND)
                               END-IF
                           END-IF
030770                 END-IF
030780             END-IF
030790             IF (PA102WS-DEFAULT-FLG (I1) = 2)
030800                 PERFORM 2300-CHECK-VALUE
030810                 THRU    2300-END
030820                 IF (G2AWS-PPC-VALUE-PRIOR (G2-IND) =
030830                                            PA102WS-VALUE (I1))
030840                     MOVE "N"      TO G2AWS-FIELD-CHANGED (G2-IND)
030850                     INITIALIZE    G2AWS-PPC-VALUE-PRIOR (G2-IND)
030860                 ELSE   
030870                 IF (G2AWS-FIELD-CHANGED (G2-IND) = SPACES)
                           IF (G2AWS-COMMENTS (G2-IND) = SPACES)
P58562                         MOVE WS-PA102-MSG-117 TO
P58562                                          G2AWS-COMMENTS (G2-IND)
                           END-IF
030930                 ELSE   
                           IF (G2AWS-COMMENTS (G2-IND) = SPACES)
P58562                         MOVE WS-PA102-MSG-119 TO
P58562                                          G2AWS-COMMENTS (G2-IND)
                           END-IF
030990                 END-IF
031000                 END-IF
031010             END-IF
                   IF (WS-NOT-PJR-FIELD)
                       MOVE 129                    TO CRT-MSG-NBR
                       PERFORM 790-GET-MSG
                       MOVE CRT-MESSAGE            TO
                                                 G2AWS-COMMENTS (G2-IND)
                   END-IF
031030             MOVE PA102WS-FIELD-NBR2 (I1)
031040                                         TO G2AWS-FLD-NBR (G2-IND)
031050             MOVE PA102WS-ITEM-NAME (I1)
031060                                      TO
031070                                  G2AWS-PAD-ITEM-NAME (G2-IND)
031080             ADD 1 TO G2-IND 
031100         END-IF
031110     END-PERFORM.
031120
031130     IF  (PA102WS-FIELD-NBR (1) = ZEROES)
031140     AND (PA102WS-FIELD-NBR (2) = ZEROES)
031150     AND (PA102WS-END-DATE      NOT = ZEROES)
031160         IF (PRM-UPDATE = "Y")
031170             MOVE PJR-COMPANY            TO DB-COMPANY
031180             MOVE PJR-REQUISITION        TO DB-REQUISITION
031190             PERFORM 840-MODIFY-PJRSET1
031200             MOVE PA102WS-EFFECT-DATE    TO PJR-POS-EFFECT-DAT
031210             MOVE WS-SYSTEM-DATE-YMD     TO PJR-DATE-STAMP
031220             MOVE HHMMSS                 TO PJR-TIME-STAMP
031230             MOVE CRT-USER-NAME          TO PJR-USER-ID
031240             PERFORM 820-STORE-PAJOBREQ
031250             GO TO 2200-FIND-NEXT-PAJOBREQ
031260         ELSE
031270             GO TO 2200-FIND-NEXT-PAJOBREQ.
031280
031290     IF (PA102WS-NOUPDATES)
               MOVE PJR-POSITION            TO G9A-PPC-POSITION
               MOVE PA102WS-POS-DESCRIPTION TO G9A-POS-DESCRIPTION
               MOVE PJR-EFFECT-DATE         TO G9A-PPC-EFFECT-DATE
               MOVE PJR-REQUISITION         TO G9A-EMP-REQ
               MOVE ZEROES                  TO G9A-POS-LEVEL
               MOVE PJR-DESCRIPTION         TO PA102WS-NAME
               MOVE PA102WS-EMP-NAME        TO G9A-DESCRIPTION
P58562         MOVE WS-PA102-MSG-118        TO G9A-COMMENTS
               MOVE GN9A-ERROR-DETAIL       TO RPT-GROUP-REQUEST
               PERFORM 700-PRINT-RPT-GRP
               IF (NO-ERR-DATA-TO-PRINT)
                   SET ERR-DATA-TO-PRINT    TO TRUE
               END-IF
031400         IF (PRM-UPDATE = "Y")
031410             MOVE PJR-COMPANY            TO DB-COMPANY
031420             MOVE PJR-REQUISITION        TO DB-REQUISITION
031430             PERFORM 840-MODIFY-PJRSET1
031440             MOVE PA102WS-EFFECT-DATE    TO PJR-POS-EFFECT-DAT
031450             MOVE WS-SYSTEM-DATE-YMD     TO PJR-DATE-STAMP
031460             MOVE HHMMSS                 TO PJR-TIME-STAMP
031470             MOVE CRT-USER-NAME          TO PJR-USER-ID
031480             PERFORM 820-STORE-PAJOBREQ
031490             GO TO 2200-FIND-NEXT-PAJOBREQ
031500         ELSE
031510             GO TO 2200-FIND-NEXT-PAJOBREQ.
031520
031530     IF (PA102WS-NOREQS)
031540         SET PA102WS-REQS             TO TRUE.
031550
031560     PERFORM 2000-PAPJR-EDIT-TRAN.
031570     IF (ERROR-FOUND)
               IF (NO-ERR-DATA-TO-PRINT)
                   SET ERR-DATA-TO-PRINT    TO TRUE
               END-IF
031580         PERFORM 2700-WRITE-REQ-PAPOSERR
031590         THRU    2700-END
031600         INITIALIZE                      CRT-ERROR-NBR
031610         MOVE "PA102"                 TO CRT-ERROR-CAT
031620         GO TO 2200-FIND-NEXT-PAJOBREQ
031630     ELSE
031640     IF (PRM-UPDATE = "Y")
031650         PERFORM 3000-PAPJR-PROCESS-TRAN
031660         MOVE "PA102"                     TO CRT-ERROR-CAT.
031670
031680     SET PA102WS-NONAME-PRINT             TO TRUE.
031690
031700***   THESE FIELDS ARE THE ONLY ONES PRINTED AND CHANGED FOR REQS
031710
031720     PERFORM
031730         VARYING G2-IND FROM 1 BY 1
031740         UNTIL  (G2-IND > 30)
031750         OR     (G2AWS-EMP-REQ (G2-IND) = ZEROES)
031760           IF  (G2AWS-FLD-NBR (G2-IND) NOT = HREMP-HM-DIST-CO-DN)
031770           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031780                                           HREMP-HM-ACCT-UNIT-DN)
031790           AND (G2AWS-FLD-NBR (G2-IND) NOT = HREMP-HM-ACCOUNT-DN)
031800           AND (G2AWS-FLD-NBR (G2-IND) NOT = HREMP-HM-SUB-ACCT-DN)
031810           AND (G2AWS-FLD-NBR (G2-IND) NOT = HREMP-ACTIVITY-DN)
031820           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031830                                           HREMP-ACCT-CATEGORY-DN)
031840           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031850                                          HREMP-SUPERVISOR-IND-DN)
031860           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031870                                            HREMP-ANNUAL-HOURS-DN)
031880           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031890                                           HREMP-PAY-FREQUENCY-DN)
031900           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031910                                           HREMP-SEC-LVL-DN)
031920           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031930                                           HREMP-SEC-LOCATION-DN)
031920           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031930                                           HRPEM-BARGAIN-UNIT-DN)
031920           AND (G2AWS-FLD-NBR (G2-IND) NOT =
031930                                           HREMP-UNION-CODE-DN)
031940             IF (PA102WS-NONAME-PRINT)
031950                 MOVE G2AWS-EMP-REQ (G2-IND)  TO G2RA-EMP-REQ
031960                 MOVE G2AWS-NAME-DESCRIPTION (G2-IND)
031970                                          TO G2RA-NAME-DESCRIPTION
031980                 SET PA102WS-NAME-PRINT   TO TRUE
031990             ELSE
032000                 INITIALIZE                  G2RA-EMP-REQ
032010                                             G2RA-NAME-DESCRIPTION
032020             END-IF
032030             MOVE G2AWS-PAD-ITEM-NAME (G2-IND)    
032040                                          TO G2RA-PAD-ITEM-NAME
032050             MOVE G2AWS-PPC-VALUE-PRIOR (G2-IND) 
032060                                          TO G2RA-PPC-VALUE-PRIOR
032070             MOVE G2AWS-PPC-LVL (G2-IND)  TO G2RA-PPC-LVL
032080             MOVE G2AWS-PPC-EFFECT-DATE (G2-IND) 
032090                                          TO G2RA-PPC-EFFECT-DATE
032100             MOVE G2AWS-COMMENTS (G2-IND) TO G2RA-COMMENTS
032110             MOVE GN2RA-FIELD-NBR         TO RPT-GROUP-REQUEST
032120             PERFORM 700-PRINT-RPT-GRP.
032130
032140 2200-FIND-NEXT-PAJOBREQ.
032150
032160     PERFORM 860-FIND-NXTRNG-PJRSET2.
032170
032180 2200-END.
032190
032200******************************************************************
032210 2300-CHECK-VALUE.   
032220******************************************************************
032230
032240     IF (PA102WS-FIELD-NBR (I1) = PAPOS-JOB-CODE-DN)
               SET WS-PJR-FIELD            TO TRUE
032250         IF (PJR-JOB-CODE           = PA102WS-VALUE (I1))
032260             GO TO 2300-END
032270         END-IF
032280         IF (PA102WS-NOUPDATES)
032290             SET PA102WS-UPDATES      TO TRUE
032300         END-IF
032310         MOVE PJR-JOB-CODE           TO
032320                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
032330         IF (PJR-JOB-CODE           = PA102WS-VALUE-PRIOR (I1))
032340             SET PA102WS-VALUECHG     TO TRUE
032350             PERFORM 2350-MOVE-VALUE
032360             THRU    2350-END
032370         ELSE
032380            SET PA102WS-NO-DEFAULT    TO TRUE.
032390     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PROCESS-LEVEL-DN)
               SET WS-PJR-FIELD            TO TRUE
032400         IF (PJR-PROCESS-LEVEL           = PA102WS-VALUE (I1))
032410             GO TO 2300-END
032420         END-IF
032430         IF (PA102WS-NOUPDATES)
032440             SET PA102WS-UPDATES      TO TRUE
032450         END-IF
032460         MOVE PJR-PROCESS-LEVEL      TO
032470                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
032480         IF (PJR-PROCESS-LEVEL      = PA102WS-VALUE-PRIOR (I1))
032490             SET PA102WS-VALUECHG     TO TRUE
032500             PERFORM 2350-MOVE-VALUE
032510             THRU    2350-END
032520         ELSE
032530            SET PA102WS-NO-DEFAULT    TO TRUE.
032540     IF (PA102WS-FIELD-NBR (I1) = PAPOS-DEPARTMENT-DN)
               SET WS-PJR-FIELD            TO TRUE
032550         IF (PJR-DEPARTMENT           = PA102WS-VALUE (I1))
032560             GO TO 2300-END
032570         END-IF
032580         IF (PA102WS-NOUPDATES)
032590             SET PA102WS-UPDATES      TO TRUE
032600         END-IF
032610         MOVE PJR-DEPARTMENT         TO
032620                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
032630         IF (PJR-DEPARTMENT         = PA102WS-VALUE-PRIOR (I1))
032640             SET PA102WS-VALUECHG     TO TRUE
032650             PERFORM 2350-MOVE-VALUE
032660             THRU    2350-END
032670         ELSE
032680            SET PA102WS-NO-DEFAULT    TO TRUE.
032690     IF (PA102WS-FIELD-NBR (I1) = PAPOS-USER-LEVEL-DN)
               SET WS-PJR-FIELD            TO TRUE
032700         IF (PJR-USER-LEVEL           = PA102WS-VALUE (I1))
032710             GO TO 2300-END
032720         END-IF
032730         IF (PA102WS-NOUPDATES)
032740             SET PA102WS-UPDATES      TO TRUE
032750         END-IF
032760         MOVE PJR-USER-LEVEL         TO
032770                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
032780         IF (PJR-USER-LEVEL         = PA102WS-VALUE-PRIOR (I1))
032790             SET PA102WS-VALUECHG     TO TRUE
032800             PERFORM 2350-MOVE-VALUE
032810             THRU    2350-END
032820         ELSE
032830            SET PA102WS-NO-DEFAULT    TO TRUE.
032840     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SCHEDULE-DN)
               SET WS-PJR-FIELD            TO TRUE
032850         IF (PJR-SCHEDULE           = PA102WS-VALUE (I1))
032860             GO TO 2300-END
032870         END-IF
032880         IF (PA102WS-NOUPDATES)
032890             SET PA102WS-UPDATES      TO TRUE
032900         END-IF
032910         MOVE PJR-SCHEDULE           TO
032920                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
032930         IF (PJR-SCHEDULE           = PA102WS-VALUE-PRIOR (I1))
032940             SET PA102WS-VALUECHG     TO TRUE
032950             PERFORM 2350-MOVE-VALUE
032960             THRU    2350-END
032970         ELSE
032980            SET PA102WS-NO-DEFAULT    TO TRUE.
032990     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-GRADE-DN)
               SET WS-PJR-FIELD            TO TRUE
033000         IF (PJR-PAY-GRADE           = PA102WS-VALUE (I1))
033010             GO TO 2300-END
033020         END-IF
033030         IF (PA102WS-NOUPDATES)
033040             SET PA102WS-UPDATES      TO TRUE
033050         END-IF
033060         MOVE PJR-PAY-GRADE          TO
033070                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
033080         IF (PJR-PAY-GRADE          = PA102WS-VALUE-PRIOR (I1))
033090             SET PA102WS-VALUECHG     TO TRUE
033100             PERFORM 2350-MOVE-VALUE
033110             THRU    2350-END
033120         ELSE
033130            SET PA102WS-NO-DEFAULT    TO TRUE.
033140     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-STEP-DN)
               SET WS-PJR-FIELD            TO TRUE
033150         MOVE PJR-PAY-STEP             TO HRWS-DEC-FIELD
033160         MOVE 0                        TO HRWS-SIZE
033170         MOVE 0                        TO HRWS-NBR-DECIMALS
033180         PERFORM 770-HR-FORMAT-DEC-FIELD
033190         IF (HRWS-VALUE = PA102WS-VALUE (I1))
033200             GO TO 2300-END
033210         END-IF
033220         IF (PA102WS-NOUPDATES)
033230             SET PA102WS-UPDATES      TO TRUE
033240         END-IF
033250         IF (PJR-PAY-STEP           = PA102WS-PAY-STEP)
033260             SET PA102WS-VALUECHG     TO TRUE
033270             PERFORM 2350-MOVE-VALUE
033280             THRU    2350-END
033290         ELSE
033300            SET PA102WS-NO-DEFAULT    TO TRUE.
033310     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SUPERVISOR-DN)
               SET WS-PJR-FIELD            TO TRUE
033320         IF (PJR-SUPERVISOR           = PA102WS-VALUE (I1))
033330             GO TO 2300-END
033340         END-IF
033350         IF (PA102WS-NOUPDATES)
033360             SET PA102WS-UPDATES      TO TRUE
033370         END-IF
033380         MOVE PJR-SUPERVISOR         TO
033390                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
033400         IF (PJR-SUPERVISOR         = PA102WS-VALUE-PRIOR (I1))
033410             SET PA102WS-VALUECHG     TO TRUE
033420             PERFORM 2350-MOVE-VALUE
033430             THRU    2350-END
033440         ELSE
033450            SET PA102WS-NO-DEFAULT    TO TRUE.
033460     IF (PA102WS-FIELD-NBR (I1) = PAPOS-LOCAT-CODE-DN)
               SET WS-PJR-FIELD            TO TRUE
033470         IF (PJR-LOCAT-CODE          = PA102WS-VALUE (I1))
033480             GO TO 2300-END
033490         END-IF
033500         IF (PA102WS-NOUPDATES)
033510             SET PA102WS-UPDATES      TO TRUE
033520         END-IF
033530         MOVE PJR-LOCAT-CODE         TO
033540                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
033550         IF (PJR-LOCAT-CODE         = PA102WS-VALUE-PRIOR (I1))
033560             SET PA102WS-VALUECHG     TO TRUE
033570             PERFORM 2350-MOVE-VALUE
033580             THRU    2350-END
033590         ELSE
033600            SET PA102WS-NO-DEFAULT    TO TRUE.
033610     IF (PA102WS-FIELD-NBR (I1) = PAPOS-WORK-SCHED-DN)
               SET WS-PJR-FIELD            TO TRUE
033620         IF (PJR-WORK-SCHED          = PA102WS-VALUE (I1))
033630             GO TO 2300-END
033640         END-IF
033650         IF (PA102WS-NOUPDATES)
033660             SET PA102WS-UPDATES      TO TRUE
033670         END-IF
033680         MOVE PJR-WORK-SCHED         TO
033690                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
033700         IF (PJR-WORK-SCHED         = PA102WS-VALUE-PRIOR (I1))
033710             SET PA102WS-VALUECHG     TO TRUE
033720             PERFORM 2350-MOVE-VALUE
033730             THRU    2350-END
033740         ELSE
033750            SET PA102WS-NO-DEFAULT    TO TRUE.
033760     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SHIFT-DN)
               SET WS-PJR-FIELD            TO TRUE
033770         MOVE PJR-SHIFT                TO HRWS-DEC-FIELD
033780         MOVE 0                        TO HRWS-SIZE
033790         MOVE 0                        TO HRWS-NBR-DECIMALS
033800         PERFORM 770-HR-FORMAT-DEC-FIELD
033810         IF (HRWS-VALUE = PA102WS-VALUE (I1))
033820             GO TO 2300-END
033830         END-IF
033840         IF (PA102WS-NOUPDATES)
033850             SET PA102WS-UPDATES          TO TRUE
033860         END-IF
033870         MOVE HRWS-VALUE                  TO
033880                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
033890         IF (PJR-SHIFT              = PA102WS-SHIFT)
033900             PERFORM 2350-MOVE-VALUE
033910             THRU    2350-END
033920         ELSE
033930            SET PA102WS-NO-DEFAULT  TO TRUE.
033940     IF (PA102WS-FIELD-NBR (I1) = PAPOS-EXEMPT-EMP-DN)
               SET WS-PJR-FIELD            TO TRUE
033950         IF (PJR-EXEMPT-EMP = PA102WS-VALUE (I1))
033960             GO TO 2300-END
033970         END-IF
033980         IF (PA102WS-NOUPDATES)
033990             SET PA102WS-UPDATES      TO TRUE
034000         END-IF
034010         MOVE PJR-EXEMPT-EMP         TO
034020                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034030         IF (PJR-EXEMPT-EMP         = PA102WS-VALUE-PRIOR (I1))
034040             SET PA102WS-VALUECHG     TO TRUE
034050             PERFORM 2350-MOVE-VALUE
034060             THRU    2350-END
034070         ELSE
034080            SET PA102WS-NO-DEFAULT    TO TRUE.
034090     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SALARY-CLASS-DN)
               SET WS-PJR-FIELD            TO TRUE
034100         IF (PJR-SALARY-CLASS = PA102WS-VALUE (I1))
034110             GO TO 2300-END
034120         END-IF
034130         IF (PA102WS-NOUPDATES)
034140             SET PA102WS-UPDATES      TO TRUE
034150         END-IF
034160         MOVE PJR-SALARY-CLASS       TO
034170                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034180         IF (PJR-SALARY-CLASS       = PA102WS-VALUE-PRIOR (I1))
034190             SET PA102WS-VALUECHG     TO TRUE
034200             PERFORM 2350-MOVE-VALUE
034210             THRU    2350-END
034220         ELSE
034230            SET PA102WS-NO-DEFAULT    TO TRUE.
P68717     IF (PA102WS-FIELD-NBR (I1) = PAPOS-UNION-CODE-DN)
P68717         SET WS-PJR-FIELD            TO TRUE
P68717         IF (PJR-UNION-CODE = PA102WS-VALUE (I1))
P68717             GO TO 2300-END
P68717         END-IF
P68717         IF (PA102WS-NOUPDATES)
P68717             SET PA102WS-UPDATES      TO TRUE
P68717         END-IF
P68717         MOVE PJR-UNION-CODE         TO
P68717                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
P68717         IF (PJR-UNION-CODE         = PA102WS-VALUE-PRIOR (I1))
P68717             SET PA102WS-VALUECHG     TO TRUE
P68717             PERFORM 2350-MOVE-VALUE
P68717             THRU    2350-END
P68717         ELSE
P68717            SET PA102WS-NO-DEFAULT    TO TRUE.
P68717     IF (PA102WS-FIELD-NBR (I1) = PAPOS-BARGAIN-UNIT-DN)
P68717         SET WS-PJR-FIELD            TO TRUE
P68717         IF (PJR-BARGAIN-UNIT = PA102WS-VALUE (I1))
P68717             GO TO 2300-END
P68717         END-IF
P68717         IF (PA102WS-NOUPDATES)
P68717             SET PA102WS-UPDATES      TO TRUE
P68717         END-IF
P68717         MOVE PJR-BARGAIN-UNIT       TO
P68717                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
P68717         IF (PJR-BARGAIN-UNIT       = PA102WS-VALUE-PRIOR (I1))
P68717             SET PA102WS-VALUECHG     TO TRUE
P68717             PERFORM 2350-MOVE-VALUE
P68717             THRU    2350-END
P68717         ELSE
P68717            SET PA102WS-NO-DEFAULT    TO TRUE.
034240
034250 2300-END.
034260
034270******************************************************************
034280 2350-MOVE-VALUE.   
034290******************************************************************
034300
034310     IF (PA102WS-FIELD-NBR (I1) = PAPOS-JOB-CODE-DN)
               SET WS-PJR-FIELD            TO TRUE
034320         IF (PJR-JOB-CODE = PA102WS-VALUE (I1))
034330             GO TO 2350-END
034340         END-IF
034350         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034360         MOVE PJR-JOB-CODE        TO
034370                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034380         MOVE PA102WS-VALUE (I1)  TO PAPJR-JOB-CODE
034390     ELSE             
034400     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PROCESS-LEVEL-DN)
               SET WS-PJR-FIELD            TO TRUE
034410         IF (PJR-PROCESS-LEVEL = PA102WS-VALUE (I1))
034420             GO TO 2350-END
034430         END-IF
034440         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034450         MOVE PJR-PROCESS-LEVEL   TO
034460                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034470         MOVE PA102WS-VALUE (I1)  TO PAPJR-PROCESS-LEVEL
               IF (PA102WS-BEFORE-CURRENCY NOT =
                                             PA102WS-AFTER-CURRENCY)   
                   MOVE 127              TO CRT-MSG-NBR
                   MOVE PA102WS-AFTER-CURRENCY
                                             TO CRT-ERR-VAR1
                   PERFORM 790-GET-MSG
                   SET PA102-PJR         TO TRUE
                   PERFORM 3200-WRITE-ERR-MSG
               END-IF
034480     ELSE
034490     IF (PA102WS-FIELD-NBR (I1) = PAPOS-DEPARTMENT-DN)
               SET WS-PJR-FIELD            TO TRUE
034500         IF (PJR-DEPARTMENT = PA102WS-VALUE (I1))
034510             GO TO 2350-END
034520         END-IF
034530         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034540         MOVE PJR-DEPARTMENT      TO
034550                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034560         MOVE PA102WS-VALUE (I1)  TO PAPJR-DEPARTMENT
034570     ELSE
034580     IF (PA102WS-FIELD-NBR (I1) = PAPOS-USER-LEVEL-DN)
               SET WS-PJR-FIELD            TO TRUE
034590         IF (PJR-USER-LEVEL = PA102WS-VALUE (I1))
034600             GO TO 2350-END
034610         END-IF
034620         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034630         MOVE PJR-USER-LEVEL      TO
034640                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034650         MOVE PA102WS-VALUE (I1)  TO PAPJR-USER-LEVEL
034660     ELSE
034670     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SCHEDULE-DN)
               SET WS-PJR-FIELD            TO TRUE
034680         IF (PJR-SCHEDULE = PA102WS-VALUE (I1))
034690             GO TO 2350-END
034700         END-IF
034710         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034720         MOVE PJR-SCHEDULE       TO
034730                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034740         MOVE PA102WS-VALUE (I1) TO PAPJR-SCHEDULE  
034750     ELSE
034760     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-GRADE-DN)
               SET WS-PJR-FIELD            TO TRUE
034770         IF (PJR-PAY-GRADE = PA102WS-VALUE (I1))
034780             GO TO 2350-END
034790         END-IF
034800         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034810         MOVE PJR-PAY-GRADE       TO
034820                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
034830         MOVE PA102WS-VALUE (I1)  TO PAPJR-PAY-GRADE 
034840     ELSE
034850     IF (PA102WS-FIELD-NBR (I1) = PAPOS-PAY-STEP-DN)
               SET WS-PJR-FIELD            TO TRUE
034860         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
034870         MOVE PJR-PAY-STEP             TO HRWS-DEC-FIELD
034880         MOVE 0                        TO HRWS-SIZE
034890         MOVE 0                        TO HRWS-NBR-DECIMALS
034900         PERFORM 770-HR-FORMAT-DEC-FIELD
034910         IF (HRWS-VALUE = PA102WS-VALUE (I1))
034920             GO TO 2350-END
034930         END-IF
034940         MOVE PA102WS-VALUE (I1)     TO PAPCT-FIELD
034950         PERFORM 5200-CONVERT-NUMERIC-FIELD
034960         MOVE PAPCT-NUMERIC        TO PAPJR-PAY-STEP 
034970     ELSE
034980     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SUPERVISOR-DN)
               SET WS-PJR-FIELD            TO TRUE
034990         IF (PJR-SUPERVISOR = PA102WS-VALUE (I1))
035000             GO TO 2350-END
035010         END-IF
035020         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
035030         MOVE PJR-SUPERVISOR      TO
035040                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
035050         MOVE PA102WS-VALUE (I1)  TO PAPJR-SUPERVISOR
035060     ELSE
035070     IF (PA102WS-FIELD-NBR (I1) = PAPOS-LOCAT-CODE-DN)
               SET WS-PJR-FIELD            TO TRUE
035080         IF (PJR-LOCAT-CODE = PA102WS-VALUE (I1))
035090             GO TO 2350-END
035100         END-IF
035110         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
035120         MOVE PJR-LOCAT-CODE      TO
035130                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
035140         MOVE PA102WS-VALUE (I1)  TO PAPJR-LOCAT-CODE
035150     ELSE
035160     IF (PA102WS-FIELD-NBR (I1) = PAPOS-WORK-SCHED-DN)
               SET WS-PJR-FIELD            TO TRUE
035170         IF (PJR-WORK-SCHED = PA102WS-VALUE (I1))
035180             GO TO 2350-END
035190         END-IF
035200         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
035210         MOVE PJR-WORK-SCHED       TO
035220                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
035230         MOVE PA102WS-VALUE (I1)   TO PAPJR-WORK-SCHED
035240     ELSE
035250     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SHIFT-DN)
               SET WS-PJR-FIELD            TO TRUE
035260         MOVE PJR-SHIFT                TO HRWS-DEC-FIELD
035270         MOVE 0                        TO HRWS-SIZE
035280         MOVE 0                        TO HRWS-NBR-DECIMALS
035290         PERFORM 770-HR-FORMAT-DEC-FIELD
035300         IF (HRWS-VALUE = PA102WS-VALUE (I1))
035310             GO TO 2350-END
035320         END-IF
035330         MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
035340         MOVE HRWS-VALUE               TO
035350                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
035360         MOVE PA102WS-VALUE (I1)     TO PAPCT-FIELD
035370         PERFORM 5200-CONVERT-NUMERIC-FIELD
035380         MOVE PAPCT-NUMERIC           TO PAPJR-SHIFT 
035390     ELSE
035400     IF (PA102WS-FIELD-NBR (I1) = PAPOS-EXEMPT-EMP-DN)
               SET WS-PJR-FIELD            TO TRUE
035410         IF (PJR-EXEMPT-EMP = PA102WS-VALUE (I1))
035420             GO TO 2350-END
035430         END-IF
035440        MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
035450        MOVE PJR-EXEMPT-EMP        TO
035460                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
035470        MOVE PA102WS-VALUE (I1)   TO PAPJR-EXEMPT-EMP
035480     ELSE
035490     IF (PA102WS-FIELD-NBR (I1) = PAPOS-SALARY-CLASS-DN)
               SET WS-PJR-FIELD            TO TRUE
035500         IF (PJR-SALARY-CLASS = PA102WS-VALUE (I1))
035510             GO TO 2350-END
035520         END-IF
035530        MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
035540        MOVE PJR-SALARY-CLASS      TO
035550                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
P68717        MOVE PA102WS-VALUE (I1)   TO PAPJR-SALARY-CLASS
P68717     ELSE
P68717     IF (PA102WS-FIELD-NBR (I1) = PAPOS-UNION-CODE-DN)
P68717         SET WS-PJR-FIELD            TO TRUE
P68717         IF (PJR-UNION-CODE = PA102WS-VALUE (I1))
P68717             GO TO 2350-END
P68717         END-IF
P68717        MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
P68717        MOVE PJR-UNION-CODE        TO
P68717                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
P68717        MOVE PA102WS-VALUE (I1)   TO PAPJR-UNION-CODE
P68717     ELSE
P68717     IF (PA102WS-FIELD-NBR (I1) = PAPOS-BARGAIN-UNIT-DN)
P68717         SET WS-PJR-FIELD            TO TRUE
P68717         IF (PJR-BARGAIN-UNIT = PA102WS-VALUE (I1))
P68717             GO TO 2350-END
P68717         END-IF
P68717        MOVE WS-STAR             TO G2AWS-FIELD-CHANGED (G2-IND)
P68717        MOVE PJR-BARGAIN-UNIT      TO
P68717                                    G2AWS-PPC-VALUE-PRIOR (G2-IND)
P68717        MOVE PA102WS-VALUE (I1)   TO PAPJR-BARGAIN-UNIT.
035570
035580     SET PA102WS-DEFAULT          TO TRUE.
035590
035600     IF (PA102WS-NOUPDATES)
035610         SET PA102WS-UPDATES      TO TRUE.
035620
035630     IF (PA102WS-NOVALUECHG)
035640         MOVE WS-TRUE             TO  WS-VALUE-CHANGE-SW.
035650
035660 2350-END.
035670
035680******************************************************************
035690 2400-PROCESS-NEW-HIRES. 
035700******************************************************************
035710   
P58562     IF (AC-POS-EFF-DT > PA102WS-EFFECT-DATE)
P58562         GO TO 2400-FIND-NEXT-PERSACTION.
P58562
P58562     MOVE 1 TO I1.
P58562     PERFORM
P58562         UNTIL (I1 > 36)
P58562         OR   ((AC-FLD-NBR (I1)   = HREMP-POSITION-DN)
P58562         AND   (AC-NEW-VALUE (I1) = AC-POSITION))
P58562             ADD 1 TO I1.
P58562      
P58562      IF (I1 > 36)
P58562          GO TO 2400-FIND-NEXT-PERSACTION.
P58562
035790     MOVE AC-EFFECT-DATE             TO DB-EFFECT-DATE.
035800     MOVE AC-ACTION-CODE             TO DB-ACTION-CODE.
035810     MOVE AC-PARTICIPNT              TO DB-EMPLOYEE.
035820     MOVE AC-ACTION-NBR              TO DB-ACTION-NBR.
035830     MOVE AC-COMPANY                 TO DB-COMPANY.
035840     MOVE AC-EMPLOYEE                TO DB-APPLICANT.
035850     PERFORM 840-FIND-APLSET1.
035860     IF (APPLICANT-NOTFOUND)
035870         GO TO 2400-FIND-NEXT-PERSACTION
035880     ELSE
035890         MOVE APL-LAST-NAME          TO HRWS-LAST-NAME
035900         MOVE APL-FIRST-NAME         TO HRWS-FIRST-NAME
035910         MOVE APL-MIDDLE-INIT        TO HRWS-MIDDLE-INIT
               MOVE APL-LAST-NAME-PRE      TO HRWS-LAST-NAME-PRE
               MOVE APL-NAME-SUFFIX        TO HRWS-NAME-SUFFIX
035920         PERFORM 750-HR-FORMAT-NAME.
035930
P58562     MOVE AC-COMPANY                 TO DB-COMPANY.
P58562     MOVE AC-ACTION-TYPE             TO DB-ACTION-TYPE.
P58562     MOVE AC-EFFECT-DATE             TO DB-EFFECT-DATE.
P58562     MOVE AC-ACTION-CODE             TO DB-ACTION-CODE.
P58562     MOVE AC-EMPLOYEE                TO DB-EMPLOYEE.
P58562     MOVE AC-ACTION-NBR              TO DB-ACTION-NBR.
P58562     IF (PRM-UPDATE = "Y")
P58562         PERFORM 840-MODIFY-PCTSET1
P58562     ELSE
P58562         PERFORM 840-FIND-PCTSET1
P58562     END-IF.
P58562
P58562     IF (PERSACTION-NOTFOUND)
P58562         GO TO 2400-FIND-NEXT-PERSACTION
P58562     END-IF.
P58562
035940     SET PA102WS-NOUPDATES           TO TRUE.
           SET PA102WS-NO-PL-UPD           TO TRUE.
           SET PA102WS-NO-CURR-UPD         TO TRUE.
035950     PERFORM
035960       VARYING I1 FROM 1 BY 1
035970       UNTIL  (I1 > PA102WS-COUNTER)
035980       OR     (PA102WS-FIELD-NBR (I1) = ZEROES)
035990         MOVE WS-FALSE               TO WS-VALUE-CHANGE-SW 
               SET PA102WS-NO-DEFAULT      TO TRUE
               SET WS-FIELD-NOT-ON-ACTION  TO TRUE
036000         INITIALIZE                     G2HA-PPC-VALUE-PRIOR
                                              G2HA-COMMENTS
036010         IF (PA102WS-DEFAULT-FLG (I1) = 3)
036020             PERFORM 2550-MOVE-VALUE
036030             THRU    2550-END
036040         END-IF
036050         IF (PA102WS-DEFAULT-FLG (I1) = 2)
036060             PERFORM 2500-CHECK-VALUE
036070             THRU    2500-END
036080         END-IF
036090         IF  (PA102WS-DEFAULT-FLG (I1) = 2 OR 3)
               AND (WS-FIELD-ON-ACTION)
036100             MOVE PCT-EMPLOYEE            TO G2HA-EMP-REQ
036110             MOVE HRWS-FORMAT-NAME        TO G2HA-NAME-DESCRIPTION
036120             MOVE PCT-POS-LEVEL           TO G2HA-PPC-LVL
036130             MOVE PA102WS-ITEM-NAME (I1)  TO G2HA-PAD-ITEM-NAME
036150             MOVE PCT-EFFECT-DATE         TO G2HA-PPC-EFFECT-DATE
036140             IF (PA102WS-NO-DEFAULT)
P58562                 MOVE WS-PA102-MSG-117     TO G2HA-COMMENTS
036190             END-IF
036200             IF (PA102WS-VALUECHG)
                       IF (G2HA-COMMENTS = SPACES)
P58562                     MOVE WS-PA102-MSG-119 TO G2HA-COMMENTS
                       END-IF
036260             END-IF
036270             MOVE GN2HA-FIELD-NBR      TO RPT-GROUP-REQUEST
036280             PERFORM 700-PRINT-RPT-GRP
036290         END-IF
036300     END-PERFORM.
036310
           IF  (PA102WS-UPD-CURR)
               PERFORM
                   VARYING I2 FROM 1 BY 1
                   UNTIL  (I2 > 36)
                   IF  (PCT-FLD-NBR (I2) = HREMP-CURRENCY-CODE-DN)
                       MOVE PA102WS-AFTER-CURRENCY
                                            TO PCT-NEW-VALUE (I2)
                   END-IF
               END-PERFORM
           END-IF.

036320     IF (PA102WS-NOUPDATES)
036330         MOVE PCT-EMPLOYEE            TO G2HA-EMP-REQ
036340         MOVE HRWS-FORMAT-NAME        TO G2HA-NAME-DESCRIPTION
036350         MOVE PCT-EFFECT-DATE         TO G2HA-PPC-EFFECT-DATE
036360         MOVE PCT-POS-LEVEL           TO G2HA-PPC-LVL
036370         INITIALIZE                      G2HA-PPC-VALUE-PRIOR
036380                                         G2HA-PAD-ITEM-NAME
P58562         MOVE WS-PA102-MSG-118        TO G2HA-COMMENTS
036420         MOVE GN2HA-FIELD-NBR         TO RPT-GROUP-REQUEST
036430         PERFORM 700-PRINT-RPT-GRP
036440         GO TO 2400-FIND-NEXT-PERSACTION
           END-IF.
036450
036460     IF (PA102WS-NOHIRES)
036470         SET PA102WS-HIRES            TO TRUE.
036480
036490     IF (PRM-UPDATE = "Y")
036500         MOVE PA102WS-EFFECT-DATE     TO PCT-POS-EFF-DT
036510         PERFORM 820-STORE-PERSACTION.
036520
036530 2400-FIND-NEXT-PERSACTION.
036540
P58562     PERFORM 8600-FIND-NEXT-ACTIONS.
036590
036600 2400-END.
036610
036620******************************************************************
036630 2500-CHECK-VALUE.   
036640******************************************************************
036650
           PERFORM
               VARYING I3 FROM 1 BY 1
               UNTIL  (I3 > PAPOSEMP-TABLE-SIZE)
               IF  (PA102WS-FIELD-NBR (I1) = PAPOSEMP-POS-FLD (I3))
                   NEXT SENTENCE
               END-IF
           END-PERFORM.

           PERFORM
               VARYING I2 FROM 1 BY 1
               UNTIL  (I2 > 36)

               IF  (PCT-FLD-NBR (I2) = PAPOSEMP-EMP-FLD (I3))
                   SET WS-FIELD-ON-ACTION TO TRUE
                   IF  (PCT-NEW-VALUE (I2) = PA102WS-VALUE (I1))
                       GO TO 2500-END
                   END-IF
                   SET PA102WS-UPDATES TO TRUE
                   MOVE PCT-NEW-VALUE (I2)     TO G2HA-PPC-VALUE-PRIOR
                   IF  (PCT-NEW-VALUE (I2) = PA102WS-VALUE-PRIOR (I1))
                       MOVE PA102WS-VALUE (I1)     TO PCT-NEW-VALUE (I2)
                       SET PA102WS-DEFAULT TO TRUE
                       SET PA102WS-VALUECHG TO TRUE
                       IF  (PA102WS-FIELD-NBR (I1) =
                                               PAPOS-PROCESS-LEVEL-DN)
                           IF (WS-BEF-WORK-COUNTRY NOT =
                                               WS-AFT-WORK-COUNTRY)
                               MOVE 132                TO CRT-MSG-NBR
                               PERFORM 790-GET-MSG
                               SET PA102-PCT TO TRUE
                               PERFORM 3200-WRITE-ERR-MSG
                           END-IF
                           IF  (PA102WS-BEFORE-CURRENCY NOT =
                                               PA102WS-AFTER-CURRENCY)
                               MOVE 131                TO CRT-MSG-NBR
                               MOVE PA102WS-AFTER-CURRENCY
                                                       TO CRT-ERR-VAR1
                               PERFORM 790-GET-MSG
                               SET PA102-PCT TO TRUE
                               PERFORM 3200-WRITE-ERR-MSG
                               SET PA102WS-PL-UPD    TO TRUE
                               SET PA102WS-UPD-CURR  TO TRUE
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-PERFORM.
040630
040640 2500-END.
040650
040660******************************************************************
040670 2550-MOVE-VALUE.   
040680******************************************************************
040690
           PERFORM
               VARYING I3 FROM 1 BY 1
               UNTIL  (I3 > PAPOSEMP-TABLE-SIZE)
               IF  (PA102WS-FIELD-NBR (I1) = PAPOSEMP-POS-FLD (I3))
                   NEXT SENTENCE
               END-IF
           END-PERFORM.

           PERFORM
               VARYING I2 FROM 1 BY 1
               UNTIL  (I2 > 36)

               IF  (PCT-FLD-NBR (I2) = PAPOSEMP-EMP-FLD (I3))
                   SET WS-FIELD-ON-ACTION TO TRUE
                   IF  (PCT-NEW-VALUE (I2) = PA102WS-VALUE (I1))
                       GO TO 2550-END
                   END-IF
189056             SET PA102WS-UPDATES         TO TRUE
                   MOVE PCT-NEW-VALUE (I2)     TO G2HA-PPC-VALUE-PRIOR
                   MOVE PA102WS-VALUE (I1)     TO PCT-NEW-VALUE (I2)
                   SET PA102WS-DEFAULT TO TRUE
                   SET PA102WS-VALUECHG TO TRUE
                   IF  (PA102WS-FIELD-NBR (I1) = PAPOS-PROCESS-LEVEL-DN)
                       IF (WS-BEF-WORK-COUNTRY NOT =
                                           WS-AFT-WORK-COUNTRY)
                           MOVE 132                TO CRT-MSG-NBR
                           PERFORM 790-GET-MSG
                           SET PA102-PCT TO TRUE
                           PERFORM 3200-WRITE-ERR-MSG
                       END-IF
                       IF  (PA102WS-BEFORE-CURRENCY NOT =
                                           PA102WS-AFTER-CURRENCY)
                           MOVE 131                TO CRT-MSG-NBR
                           MOVE PA102WS-AFTER-CURRENCY
                                                   TO CRT-ERR-VAR1
                           PERFORM 790-GET-MSG
                           SET PA102-PCT TO TRUE
                           PERFORM 3200-WRITE-ERR-MSG
                           SET PA102WS-PL-UPD    TO TRUE
                           SET PA102WS-UPD-CURR  TO TRUE
                       END-IF
                   END-IF
               END-IF
           END-PERFORM.
042510
042570 2550-END.
042580
042590******************************************************************
042600 2600-WRITE-EMP-PAPOSERR.
042610******************************************************************
042620
042630     PERFORM
042640         VARYING I2 FROM 1 BY 1
042650         UNTIL  (I2 > HREMP-I2)
042660             MOVE SPACES              TO WS-FIELD-VALUE
042670             PERFORM 2650-GET-FIELD-VALUE
042680             THRU    2650-END
042690             IF (WS-FIELD-VALUE = SPACES)
042700                 MOVE HREMP-MESSAGE (I2)
042710                                      TO G9A-COMMENTS
042720             ELSE
042730                 MOVE HREMP-MESSAGE (I2)
042740                                      TO WS-ERR-MSG
042750                 MOVE WS-ERROR-MESSAGE
042760                                      TO G9A-COMMENTS  
042770             END-IF   
042780             MOVE PA102WS-POSITION    TO G9A-PPC-POSITION
042790             MOVE PA102WS-POS-DESCRIPTION
042800                                      TO G9A-POS-DESCRIPTION
042810             MOVE PA102WS-PEP-EFFECT-DATE
042820                                      TO G9A-PPC-EFFECT-DATE
042830             MOVE PA102WS-PEP-EMPLOYEE
042840                                      TO G9A-EMP-REQ
                   MOVE PA102WS-PEP-POS-LEVEL
                                            TO G9A-POS-LEVEL
042850             MOVE HRWS-FORMAT-NAME    TO PA102WS-NAME    
042860             MOVE PA102WS-EMP-NAME    TO G9A-DESCRIPTION
042870             MOVE GN9A-ERROR-DETAIL   TO RPT-GROUP-REQUEST
042880             PERFORM 700-PRINT-RPT-GRP
                   IF (NO-ERR-DATA-TO-PRINT)
                       SET ERR-DATA-TO-PRINT TO TRUE
                   END-IF
042890     END-PERFORM.
042900
042910     IF  (PRM-UPDATE NOT = "Y")
042920         GO TO 2600-END.
042930
042940     MOVE PRM-COMPANY                 TO DB-COMPANY.
042950     MOVE PA102WS-PEP-EMPLOYEE        TO DB-EMPLOYEE.
042960     INITIALIZE                          DB-REQUISITION.
042970     MOVE PA102WS-POSITION            TO DB-POSITION.
042980     MOVE PA102WS-EFFECT-DATE         TO DB-EFFECT-DATE.
042990     MOVE "3  "                       TO DB-UPDATE-TYPE.
043000     PERFORM 840-FIND-PPESET1.
043010     IF (PAPOSERR-NOTFOUND)
043020         PERFORM 800-CREATE-PAPOSERR
043030         MOVE PRM-COMPANY             TO PPE-COMPANY
043040         MOVE PA102WS-PEP-EMPLOYEE    TO PPE-EMPLOYEE
043050         INITIALIZE                      PPE-REQUISITION
043060         MOVE PA102WS-POSITION        TO PPE-POSITION
043070         MOVE PA102WS-EFFECT-DATE     TO PPE-EFFECT-DATE
043080         MOVE "3  "                   TO PPE-UPDATE-TYPE
043090         PERFORM 820-STORE-PAPOSERR.
043100
043110 2600-END. 
043120
042590******************************************************************
042600 2610-WRITE-PAY-PAPOSERR.
042610******************************************************************
042620
042660     MOVE SPACES                      TO WS-FIELD-VALUE.
042710     MOVE CRT-MESSAGE                 TO G9A-COMMENTS.
042780     MOVE PA102WS-POSITION            TO G9A-PPC-POSITION.
042790     MOVE PA102WS-POS-DESCRIPTION     TO G9A-POS-DESCRIPTION.
042810     MOVE PA102WS-PEP-EFFECT-DATE     TO G9A-PPC-EFFECT-DATE.
042830     MOVE PA102WS-PEP-EMPLOYEE        TO G9A-EMP-REQ.
           MOVE PA102WS-PEP-POS-LEVEL       TO G9A-POS-LEVEL.
042850     MOVE HRWS-FORMAT-NAME            TO PA102WS-NAME.    
042860     MOVE PA102WS-EMP-NAME            TO G9A-DESCRIPTION.
042870     MOVE GN9A-ERROR-DETAIL           TO RPT-GROUP-REQUEST.
042880     PERFORM 700-PRINT-RPT-GRP.
           IF (NO-ERR-DATA-TO-PRINT)
               SET ERR-DATA-TO-PRINT      TO TRUE
           END-IF.
042900
042910     IF  (PRM-UPDATE NOT = "Y")
042920         GO TO 2610-END.
042930
042940     MOVE PRM-COMPANY                 TO DB-COMPANY.
042950     MOVE PA102WS-PEP-EMPLOYEE        TO DB-EMPLOYEE.
042960     INITIALIZE                          DB-REQUISITION.
042970     MOVE PA102WS-POSITION            TO DB-POSITION.
042980     MOVE PA102WS-EFFECT-DATE         TO DB-EFFECT-DATE.
042990     MOVE "3  "                       TO DB-UPDATE-TYPE.
043000     PERFORM 840-FIND-PPESET1.
043010     IF (PAPOSERR-NOTFOUND)
043020         PERFORM 800-CREATE-PAPOSERR
043030         MOVE PRM-COMPANY             TO PPE-COMPANY
043040         MOVE PA102WS-PEP-EMPLOYEE    TO PPE-EMPLOYEE
043050         INITIALIZE                      PPE-REQUISITION
043060         MOVE PA102WS-POSITION        TO PPE-POSITION
043070         MOVE PA102WS-EFFECT-DATE     TO PPE-EFFECT-DATE
043080         MOVE "3  "                   TO PPE-UPDATE-TYPE
043090         PERFORM 820-STORE-PAPOSERR.
043100
043110 2610-END. 
043120
042590******************************************************************
042600 2625-WRITE-EMPMSG-PAPOSERR.
042610******************************************************************
042620
042630     PERFORM
042640         VARYING I2 FROM 1 BY 1
042650         UNTIL  (I2 > HREMP-I2)
042660             MOVE SPACES              TO WS-FIELD-VALUE
042670             PERFORM 2650-GET-FIELD-VALUE
042680             THRU    2650-END
042690             IF (WS-FIELD-VALUE = SPACES)
042700                 MOVE HREMP-MESSAGE (I2)
042710                                      TO W3-COMMENTS
042720             ELSE
042730                 MOVE HREMP-MESSAGE (I2)
042740                                      TO WS-ERR-MSG
042750                 MOVE WS-ERROR-MESSAGE
042760                                      TO W3-COMMENTS  
042770             END-IF   
042780             MOVE PA102WS-POSITION    TO W3-PPC-POSITION
042790             MOVE PA102WS-POS-DESCRIPTION
042800                                      TO W3-POS-DESCRIPTION
042810             MOVE PA102WS-PEP-EFFECT-DATE
042820                                      TO W3-PPC-EFFECT-DATE
042830             MOVE PA102WS-PEP-EMPLOYEE
042840                                      TO W3-EMP-REQ
                   MOVE PA102WS-PEP-POS-LEVEL
                                            TO W3-POS-LEVEL
042850             MOVE HRWS-FORMAT-NAME    TO PA102WS-NAME    
042860             MOVE PA102WS-EMP-NAME    TO W3-DESCRIPTION
042870             MOVE WN3-ERROR-DETAIL   TO RPT-GROUP-REQUEST
042880             PERFORM 700-PRINT-RPT-GRP
042890     END-PERFORM.
042900
043110 2625-END. 
043120
043130******************************************************************
043140 2650-GET-FIELD-VALUE.
043150******************************************************************
043160
043170     IF (HREMP-FIELD-NBR (I1) = ZEROS)
043180         GO TO 2650-END.
043190
043200     IF (HREMP-FIELD-NBR (I1) = HREMP-FICA-NBR-DN)

               MOVE PRS-COMPANY            TO DB-COMPANY
               MOVE SPACES                 TO DB-COUNTRY-CD-REQ
                                              DB-PROCESS-LEVEL
               MOVE HREMP-FICA-NBR-DN      TO DB-FLD-NBR
               PERFORM 840-FIND-PASSET1
               IF (PASCRTY-FOUND)
                   MOVE PAS-SEC-LEVEL      TO HRWS-SEC-LEVEL
                   PERFORM 730-HR-FIELD-SECURITY
                   IF (HRWS-FLD-SECURED)
                       MOVE SPACES         TO WS-FIELD-VALUE
                   ELSE
                       MOVE EMP-FICA-NBR   TO WS-FIELD-VALUE
                   END-IF
                END-IF
043220          GO TO 2650-END
            END-IF.
043230
043240     IF (HREMP-FIELD-NBR (I1) = HREMP-EMP-STATUS-DN)
043250         MOVE HREMP-EMP-STATUS      TO WS-FIELD-VALUE
043260         GO TO 2650-END.
043270
043280     IF (HREMP-FIELD-NBR (I1) = HREMP-PROCESS-LEVEL-DN)
043290         MOVE HREMP-PROCESS-LEVEL   TO WS-FIELD-VALUE
043300         GO TO 2650-END.
043310
043320     IF (HREMP-FIELD-NBR (I1) = HREMP-DEPARTMENT-DN)
043330         MOVE HREMP-DEPARTMENT     TO WS-FIELD-VALUE
043340         GO TO 2650-END.
043350
043360     IF (HREMP-FIELD-NBR (I1) = HREMP-USER-LEVEL-DN)
043370         MOVE HREMP-USER-LEVEL      TO WS-FIELD-VALUE
043380         GO TO 2650-END.
043390
043400     IF (HREMP-FIELD-NBR (I1) = HREMP-HM-DIST-CO-DN)
043410         MOVE HREMP-HM-DIST-CO      TO WS-FIELD-VAL-N
043420         GO TO 2650-END.
043430
043440     IF (HREMP-FIELD-NBR (I1) = HREMP-HM-ACCT-UNIT-DN)
043450         MOVE HREMP-HM-ACCT-UNIT    TO WS-FIELD-VALUE
043460         GO TO 2650-END.
043470
043480     IF (HREMP-FIELD-NBR (I1) = HREMP-HM-ACCOUNT-DN)
043490         MOVE HREMP-HM-ACCOUNT      TO WS-FIELD-VAL-N
043500         GO TO 2650-END.
043510
043520     IF (HREMP-FIELD-NBR (I1) = HREMP-HM-SUB-ACCT-DN)
043530         MOVE HREMP-HM-SUB-ACCT     TO WS-FIELD-VAL-N
043540         GO TO 2650-END.
043550
043560     IF (HREMP-FIELD-NBR (I1) = HREMP-ACTIVITY-DN)
043570         MOVE HREMP-ACTIVITY        TO WS-FIELD-VALUE
043580         GO TO 2650-END.
043590
043600     IF (HREMP-FIELD-NBR (I1) = HREMP-JOB-CODE-DN)
043610         MOVE HREMP-JOB-CODE        TO WS-FIELD-VALUE
043620         GO TO 2650-END.
043630
043640     IF (HREMP-FIELD-NBR (I1) = HREMP-NBR-FTE-DN) 
043650         MOVE HREMP-NBR-FTE         TO WS-FIELD-VAL-N
043660         GO TO 2650-END.
043670
043680     IF (HREMP-FIELD-NBR (I1) = HREMP-UNION-CODE-DN)
043690         MOVE HREMP-UNION-CODE      TO WS-FIELD-VALUE
043700         GO TO 2650-END.
043710
043680     IF (HREMP-FIELD-NBR (I1) = HRPEM-BARGAIN-UNIT-DN)
043690         MOVE HRPEM-BARGAIN-UNIT    TO WS-FIELD-VALUE
043700         GO TO 2650-END.
043710
043720     IF (HREMP-FIELD-NBR (I1) = HREMP-SUPERVISOR-DN)
043730         MOVE HREMP-SUPERVISOR      TO WS-FIELD-VALUE
043740         GO TO 2650-END.
043750
043760     IF (HREMP-FIELD-NBR (I1) = HREMP-PAY-FREQUENCY-DN)
043770         MOVE HREMP-PAY-FREQUENCY   TO WS-FIELD-VAL-N
043780         GO TO 2650-END.
043790
043800     IF (HREMP-FIELD-NBR (I1) = HREMP-SHIFT-DN)
043810         MOVE HREMP-SHIFT           TO WS-FIELD-VAL-N
043820         GO TO 2650-END.
043830
043840     IF (HREMP-FIELD-NBR (I1) = HREMP-SALARY-CLASS-DN)
043850         MOVE HREMP-SALARY-CLASS    TO WS-FIELD-VALUE
043860         GO TO 2650-END.
043870
043880     IF (HREMP-FIELD-NBR (I1) = HREMP-PAY-STEP-DN)
043890         MOVE HREMP-PAY-STEP        TO WS-FIELD-VAL-N
043900         GO TO 2650-END.
043910
043920     IF (HREMP-FIELD-NBR (I1) = HREMP-PAY-GRADE-DN)
043930         MOVE HREMP-PAY-GRADE       TO WS-FIELD-VALUE
043940         GO TO 2650-END.
043950
043960     IF (HREMP-FIELD-NBR (I1) = HREMP-SCHEDULE-DN)
043970         MOVE HREMP-SCHEDULE        TO WS-FIELD-VALUE
043980         GO TO 2650-END.
043990
044000     IF (HREMP-FIELD-NBR (I1)    = HREMP-PAY-RATE-DN)
044010         MOVE HREMP-PAY-RATE        TO WS-FIELD-VAL-N
044020         GO TO 2650-END.
044030
044040     IF (HREMP-FIELD-NBR (I1) = HREMP-EXEMPT-EMP-DN)
044050         MOVE HREMP-EXEMPT-EMP      TO WS-FIELD-VALUE
044060         GO TO 2650-END.
044070
044080     IF (HREMP-FIELD-NBR (I1) = HREMP-OT-PLAN-CODE-DN)
044090         MOVE HREMP-OT-PLAN-CODE    TO WS-FIELD-VALUE
044100         GO TO 2650-END.
044110
044120     IF (HREMP-FIELD-NBR (I1) = HRPEM-LOCAT-CODE-DN)
044130         MOVE HRPEM-LOCAT-CODE      TO WS-FIELD-VALUE
044140         GO TO 2650-END.
044150
044160     IF (HREMP-FIELD-NBR (I1) = HREMP-POSITION-DN)
044170         MOVE HREMP-POSITION        TO WS-FIELD-VALUE
044180         GO TO 2650-END.
044190
044200     IF (HREMP-FIELD-NBR (I1) = HREMP-TIPPED-DN)
044210         MOVE HREMP-TIPPED          TO WS-FIELD-VALUE
044220         GO TO 2650-END.
044230
044240     IF (HREMP-FIELD-NBR (I1)        = HREMP-ACCT-CATEGORY-DN)
044250         MOVE HREMP-ACCT-CATEGORY   TO WS-FIELD-VALUE
044260         GO TO 2650-END.
044270
044280     IF (HREMP-FIELD-NBR (I1)     = HREMP-SEC-LVL-DN)
044290         MOVE HREMP-SEC-LVL         TO WS-FIELD-VAL-N
044300         GO TO 2650-END.
044310
044320     IF (HREMP-FIELD-NBR (I1)       = PAPOS-SEC-LOCATION-DN)
044330         MOVE HREMP-SEC-LOCATION    TO WS-FIELD-VALUE
044340         GO TO 2650-END.
044350
044360     IF (HREMP-FIELD-NBR (I1)  = HREMP-SUPERVISOR-IND-DN)
044370         MOVE HREMP-SUPERVISOR-IND  TO WS-FIELD-VALUE
044380         GO TO 2650-END.
044390
044400     IF (HREMP-FIELD-NBR (I1)  = HREMP-WORK-SCHED-DN)
044410         MOVE HREMP-WORK-SCHED      TO WS-FIELD-VALUE
044420         GO TO 2650-END.
044430
044440     IF (HREMP-FIELD-NBR (I1)  = HREMP-ANNUAL-HOURS-DN)
044450         MOVE HREMP-ANNUAL-HOURS    TO WS-FIELD-VAL-N
044460         GO TO 2650-END.
044470
044480 2650-END.
044490
044500******************************************************************
044510 2700-WRITE-REQ-PAPOSERR.
044520******************************************************************
044530
044540     MOVE PA102WS-POSITION            TO G9A-PPC-POSITION.
044550     MOVE PA102WS-POS-DESCRIPTION     TO G9A-POS-DESCRIPTION.
044560     MOVE PJR-DATE-NEEDED             TO G9A-PPC-EFFECT-DATE.
044570     MOVE PJR-REQUISITION             TO G9A-EMP-REQ.
           MOVE ZEROES                      TO G9A-POS-LEVEL.
044580     MOVE PJR-DESCRIPTION             TO G9A-DESCRIPTION.
044590     MOVE CRT-ERROR-NBR               TO CRT-MSG-NBR.
044600     PERFORM 790-GET-MSG.
044610     MOVE CRT-MESSAGE                 TO G9A-COMMENTS.
044620     MOVE GN9A-ERROR-DETAIL           TO RPT-GROUP-REQUEST.
044630     PERFORM 700-PRINT-RPT-GRP.
           IF (NO-ERR-DATA-TO-PRINT)
               SET ERR-DATA-TO-PRINT        TO TRUE
           END-IF.
044640     IF (PRM-UPDATE         = "Y")
044650         MOVE PRM-COMPANY               TO DB-COMPANY
044660         MOVE PJR-REQUISITION           TO DB-REQUISITION
044670         INITIALIZE                        DB-EMPLOYEE
044680         MOVE PA102WS-POSITION          TO DB-POSITION
044690         MOVE PA102WS-EFFECT-DATE       TO DB-EFFECT-DATE
044700         MOVE "3  "                     TO DB-UPDATE-TYPE
044710         PERFORM 840-FIND-PPESET1
044720         IF (PAPOSERR-NOTFOUND)
044730             PERFORM 800-CREATE-PAPOSERR
044740             MOVE PRM-COMPANY           TO PPE-COMPANY
044750             MOVE PJR-REQUISITION       TO PPE-REQUISITION
044760             INITIALIZE                    PPE-EMPLOYEE
044770             MOVE PA102WS-POSITION      TO PPE-POSITION
044780             MOVE PA102WS-EFFECT-DATE   TO PPE-EFFECT-DATE
044790             MOVE "3  "                 TO PPE-UPDATE-TYPE
044800             PERFORM 820-STORE-PAPOSERR.
044810
044820 2700-END.
044830
P58562******************************************************************
P58562 2750-SAVE-ACTIONS.     
P58562******************************************************************
P58562
P58562     IF (PCT-POSITION = SPACES)
P58562         GO TO 2750-NEXT-PERSACTION.
P58562
P58562     MOVE  PCT-COMPANY           TO AC-COMPANY.
P58562     MOVE  PCT-POSITION          TO AC-POSITION.
P58562     MOVE  PCT-POS-EFF-DT        TO AC-POS-EFF-DT.
P58562     MOVE  PCT-ACTION-TYPE       TO AC-ACTION-TYPE.
P58562     MOVE  PCT-EFFECT-DATE       TO AC-EFFECT-DATE.
P58562     MOVE  PCT-ACTION-CODE       TO AC-ACTION-CODE.
P58562     MOVE  PCT-EMPLOYEE          TO AC-EMPLOYEE.
P58562     MOVE  PCT-ACTION-NBR        TO AC-ACTION-NBR.
P58562     MOVE  PCT-POS-LEVEL         TO AC-POS-LEVEL.
P58562     MOVE  PCT-PARTICIPNT        TO AC-PARTICIPNT.
P58562     PERFORM
P58562         VARYING I1 FROM 1 BY 1
P58562         UNTIL  (I1 > 36)
P58562             MOVE PCT-FLD-NBR (I1)   TO AC-FLD-NBR (I1)
P58562             MOVE PCT-NEW-VALUE (I1) TO AC-NEW-VALUE (I1)
P58562     END-PERFORM.
P58562     PERFORM 8200-STORE-ACTIONS.
P58562
P58562     IF (NO-ACTIONS-STORED)
P58562         SET ACTIONS-STORED      TO TRUE.
P58562 
P58562 2750-NEXT-PERSACTION.
P58562     PERFORM 860-FIND-NXTRNG-PCTSET1.
P58562
P58562 2750-END.
P58562
044840******************************************************************
044850 2800-PROCESS-TRANSFERS.
044860******************************************************************
044870
P58562     IF (AC-POS-EFF-DT > PA102WS-EFFECT-DATE)
P58562         GO TO 2800-NEXT-ACTIONS.
P58562
P58562     MOVE 1 TO I1.
P58562     PERFORM
P58562         UNTIL  (I1 > 36)
P58562         OR    ((AC-FLD-NBR (I1)   = HREMP-POSITION-DN)
P58562         AND    (AC-NEW-VALUE (I1) = AC-POSITION))
P58562             ADD 1 TO I1.
P58562
044990     IF (I1 > 36)
045000         GO TO 2800-NEXT-ACTIONS.
045010         
P58562     MOVE AC-COMPANY                  TO DB-COMPANY.
P58562     MOVE AC-EMPLOYEE                 TO DB-EMPLOYEE.
045040     PERFORM 840-FIND-EMPSET1.
045050     IF (EMP-TERM-DATE NOT = ZEROES)
045060         GO TO 2800-NEXT-ACTIONS.
045070
045080     MOVE EMP-LAST-NAME               TO HRWS-LAST-NAME.
045090     MOVE EMP-FIRST-NAME              TO HRWS-FIRST-NAME.
045100     MOVE EMP-MIDDLE-INIT             TO HRWS-MIDDLE-INIT.
           MOVE EMP-LAST-NAME-PRE           TO HRWS-LAST-NAME-PRE.
           MOVE EMP-NAME-SUFFIX             TO HRWS-NAME-SUFFIX.
045110     PERFORM 750-HR-FORMAT-NAME.
045120
P58562     IF (AC-POS-LEVEL = 1)
045140         PERFORM 840-FIND-PEMSET1
045150         INITIALIZE HREMP-SCR-FIELDS
045160                    HRPEM-SCR-FIELDS
045170         PERFORM 7000-HREMP-DEFAULT
045180         PERFORM 7000-HRPEM-DEFAULT
045190     ELSE
P58562         MOVE AC-POS-LEVEL  TO DB-POS-LEVEL
045210         INITIALIZE            DB-EFFECT-DATE
045220         PERFORM 850-FIND-NLT-PEPSET2
045230         IF  (PAEMPPOS-FOUND)
045240         AND (PEP-COMPANY   = DB-COMPANY)
045250         AND (PEP-EMPLOYEE  = DB-EMPLOYEE)
045260             IF (PEP-POS-LEVEL = DB-POS-LEVEL)
045290                 INITIALIZE PAPEP-SCR-FIELDS
045300                 PERFORM 7000-PAPEP-DEFAULT
045310             END-IF
045320         ELSE
045330             INITIALIZE              PAPEP-SCR-FIELDS.
045340
045350     INITIALIZE                      PA102WS-FLDS-NEEDED
045360                                     PA102WS-FLDS-AVAILABLE.

           SET PA102WS-NO-PL-UPD            TO TRUE.
           SET PA102WS-NO-PAY-RATE-UPD      TO TRUE.

045370     MOVE 1 TO I4.
045380     PERFORM
045390         VARYING I2 FROM 1 BY 1 
045400         UNTIL  (I2 > 30)
045410         OR     (PA102WS-FIELD-NBR (I2) = ZEROES)
045420             MOVE 1 TO I3
045430             PERFORM
045440                 UNTIL  (I3 > 36)
P58562                 OR     (AC-FLD-NBR (I3) =
045460                                        PA102WS-FIELD-NBR2 (I2))
045470                     ADD 1 TO I3
045480             END-PERFORM
045490             IF (I3 NOT > 36)
045500                 INITIALIZE             WS-VALUE
P58562                 IF (AC-NEW-VALUE (I3) = SPACES)
045520                     PERFORM 2850-GET-VALUE
045530                     THRU    2850-END
045540                 ELSE
P58562                     MOVE AC-NEW-VALUE (I3) TO WS-VALUE
045560                 END-IF
045570                 IF  (WS-VALUE NOT = PA102WS-VALUE (I2))
045580                 AND (PA102WS-DEFAULT-FLG (I2) = 3)
P58562                     MOVE AC-FLD-NBR (I3)  TO PA102WS-FIELD (I4)
045610                     MOVE WS-VALUE TO PA102WS-FIELD-VALUE (I4)
045620                     MOVE "C"             TO PA102WS-MOVE (I4)
045630                     ADD 1 TO I4
045640                 END-IF 
045650                 IF  (PA102WS-DEFAULT-FLG (I2) = 2)
045660                 AND (WS-VALUE = PA102WS-VALUE-PRIOR (I2))
P58562                     MOVE AC-FLD-NBR (I3) TO
045680                                       PA102WS-FIELD (I4)
045690                     MOVE WS-VALUE         TO
045700                                          PA102WS-FIELD-VALUE (I4)
045710                     MOVE "C"             TO PA102WS-MOVE (I4)
045720                     ADD 1 TO I4
045730                 END-IF
045740             ELSE
045750                 IF (PA102WS-DEFAULT-FLG (I2) = 3)
045760                     PERFORM 2850-GET-VALUE
045770                     THRU    2850-END
045780                     IF (WS-VALUE NOT = PA102WS-VALUE (I2))
045790                         MOVE PA102WS-FIELD-NBR2 (I2) TO
045800                                       PA102WS-FIELD (I4)
045810                         MOVE WS-VALUE         TO
045820                                          PA102WS-FIELD-VALUE (I4)
045830                         MOVE "A"             TO PA102WS-MOVE (I4)
045840                         ADD 1 TO I4
045850                     END-IF
045860                 END-IF
045870                 IF (PA102WS-DEFAULT-FLG (I2) = 2)
045880                     PERFORM 2850-GET-VALUE
045890                     THRU    2850-END
045900                     IF  (WS-VALUE = PA102WS-VALUE-PRIOR (I2))
045910                     AND (WS-VALUE NOT = PA102WS-VALUE (I2))
045920                         MOVE PA102WS-FIELD-NBR2 (I2) TO
045930                                   PA102WS-FIELD (I4)
045940                         MOVE WS-VALUE                 TO
045950                                       PA102WS-FIELD-VALUE (I4)
045960                         MOVE "A"   TO PA102WS-MOVE (I4)
045970                         ADD 1 TO I4
045980                     END-IF    
045990                 END-IF
046000             END-IF
046010     END-PERFORM.
046020      
P58562     IF (AC-ACTION-TYPE = "E")
046040         INITIALIZE          PA102WS-FLDS-NEEDED
046050         PERFORM
046060             VARYING I2 FROM 1 BY 1
046070             UNTIL  (I2 > 30)
046080                 IF (PA102WS-MOVE (I2) = "A")
046090                     ADD 1 TO PA102WS-FLDS-NEEDED
046100                 END-IF
046110         END-PERFORM
046120         INITIALIZE PA102WS-FLDS-AVAILABLE
046130         PERFORM
046140             VARYING I2 FROM 1 BY 1
046150             UNTIL  (I2 > 36)
P58562                 IF (AC-FLD-NBR (I2) = ZEROES)
046170                     COMPUTE PA102WS-FLDS-AVAILABLE =
046180                                  (PA102WS-FLDS-AVAILABLE + 1)
046190                 END-IF
046200         END-PERFORM
046210         IF (PA102WS-FLDS-NEEDED > PA102WS-FLDS-AVAILABLE)
046220             PERFORM 3000-WRITE-ACT-PAPOSERR
046230             THRU    3000-END
046240             GO TO 2800-NEXT-ACTIONS.
046250
046260     IF (PA102WS-NOACTIONS)
046270         SET PA102WS-ACTIONS          TO TRUE.
046280
046290     IF (PRM-UPDATE = "Y")
P58562         MOVE AC-COMPANY      TO DB-COMPANY
P58562         MOVE AC-ACTION-TYPE  TO DB-ACTION-TYPE
P58562         MOVE AC-EFFECT-DATE  TO DB-EFFECT-DATE
P58562         MOVE AC-ACTION-CODE  TO DB-ACTION-CODE
P58562         MOVE AC-EMPLOYEE     TO DB-EMPLOYEE
P58562         MOVE AC-ACTION-NBR   TO DB-ACTION-NBR
046360         PERFORM 840-MODIFY-PCTSET1
046370         IF (PERSACTION-FOUND)
046380             PERFORM 2900-MOVE-FIELDS
046390             THRU    2900-END
046400                 VARYING I2 FROM 1 BY 1
046410                 UNTIL  (I2 > 66)
046420                 OR     (PA102WS-FIELD (I2) = ZEROES)
046430             MOVE PA102WS-EFFECT-DATE     TO PCT-POS-EFF-DT
                   PERFORM 8200-BEFORE-STORE-PERSACTION
046440             PERFORM 820-STORE-PERSACTION
046450         END-IF
046460     ELSE
P58562         MOVE AC-COMPANY      TO DB-COMPANY
P58562         MOVE AC-ACTION-TYPE  TO DB-ACTION-TYPE
P58562         MOVE AC-EFFECT-DATE  TO DB-EFFECT-DATE
P58562         MOVE AC-ACTION-CODE  TO DB-ACTION-CODE
P58562         MOVE AC-EMPLOYEE     TO DB-EMPLOYEE
P58562         MOVE AC-ACTION-NBR   TO DB-ACTION-NBR
P58562         PERFORM 840-FIND-PCTSET1
P58562         IF (PERSACTION-FOUND)
046470             PERFORM 2900-MOVE-FIELDS
046480             THRU    2900-END
046490                 VARYING I2 FROM 1 BY 1
046500                 UNTIL  (I2 > 66)
046510                 OR     (PA102WS-FIELD (I2) = ZEROES)
P58562         END-IF.
046520
P58562 2800-NEXT-ACTIONS.
046540
P58562     PERFORM 8600-FIND-NEXT-ACTIONS.
046560
046570 2800-END.
046580
046590******************************************************************
046600 2850-GET-VALUE.            
046610******************************************************************
046620
046630     IF (PA102WS-FIELD-NBR (I2) = PAPOS-JOB-CODE-DN)
P58562         IF (AC-POS-LEVEL = 1)
046650             MOVE HREMP-JOB-CODE       TO WS-VALUE
046660         ELSE                        
046670             MOVE PAPEP-JOB-CODE       TO WS-VALUE
046680         END-IF
046690     ELSE
046700     IF (PA102WS-FIELD-NBR (I2) = PAPOS-PROCESS-LEVEL-DN)
P58562         IF (AC-POS-LEVEL = 1)
046720             MOVE HREMP-PROCESS-LEVEL  TO WS-VALUE
046730         ELSE
046740             MOVE PAPEP-PROCESS-LEVEL  TO WS-VALUE
046750         END-IF
046760     ELSE
046770     IF (PA102WS-FIELD-NBR (I2) = PAPOS-DEPARTMENT-DN)
P58562         IF (AC-POS-LEVEL = 1)
046790             MOVE HREMP-DEPARTMENT     TO WS-VALUE
046800         ELSE
046810             MOVE PAPEP-DEPARTMENT     TO WS-VALUE
046820         END-IF
046830     ELSE
046840     IF (PA102WS-FIELD-NBR (I2) = PAPOS-USER-LEVEL-DN)
P58562         IF (AC-POS-LEVEL = 1)
046860             MOVE HREMP-USER-LEVEL     TO WS-VALUE
046870         ELSE
046880             MOVE PAPEP-USER-LEVEL     TO WS-VALUE
046890         END-IF
046900     ELSE
046910     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-EXP-COMPANY-DN)
P58562         IF (AC-POS-LEVEL = 1)
                   MOVE HREMP-HM-DIST-CO     TO HRWS-DEC-FIELD
               ELSE
                   MOVE PAPEP-EXP-DIST-CO    TO HRWS-DEC-FIELD
               END-IF
046950         MOVE 0                        TO HRWS-SIZE
046960         MOVE 0                        TO HRWS-NBR-DECIMALS
046970         PERFORM 770-HR-FORMAT-DEC-FIELD
046980         MOVE HRWS-VALUE               TO WS-VALUE
046990     ELSE
047000     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-EXP-ACCT-UNIT-DN)
P58562         IF  (AC-POS-LEVEL = 1)
                   MOVE HREMP-HM-ACCT-UNIT   TO WS-VALUE
               ELSE
                   MOVE PAPEP-EXP-ACCT-UNIT  TO WS-VALUE
               END-IF
047030     ELSE
047040     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-EXP-ACCOUNT-DN)
P58562         IF  (AC-POS-LEVEL = 1)
                   MOVE HREMP-HM-ACCOUNT     TO HRWS-DEC-FIELD
               ELSE
                   MOVE PAPEP-EXP-ACCOUNT    TO HRWS-DEC-FIELD
               END-IF
047070         MOVE 0                        TO HRWS-SIZE
047080         MOVE 0                        TO HRWS-NBR-DECIMALS
047090         PERFORM 770-HR-FORMAT-DEC-FIELD
047100         MOVE HRWS-VALUE               TO WS-VALUE
047110     ELSE
047120     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-EXP-SUB-ACCT-DN)
P58562         IF  (AC-POS-LEVEL = 1)
                   MOVE HREMP-HM-SUB-ACCT    TO HRWS-DEC-FIELD
               ELSE
                   MOVE PAPEP-EXP-SUB-ACCT   TO HRWS-DEC-FIELD
               END-IF
047150         MOVE 0                        TO HRWS-SIZE
047160         MOVE 0                        TO HRWS-NBR-DECIMALS
047170         PERFORM 770-HR-FORMAT-DEC-FIELD
047180         MOVE HRWS-VALUE               TO WS-VALUE
047190     ELSE
047200     IF (PA102WS-FIELD-NBR (I2) = PAPOS-PAY-RATE-DN)
P58562         IF (AC-POS-LEVEL = 1)
047220             MOVE HREMP-PAY-RATE       TO HRWS-DEC-FIELD
047230         ELSE
047240             MOVE PAPEP-PAY-RATE       TO HRWS-DEC-FIELD
047250         END-IF 
047260         MOVE 0                        TO HRWS-SIZE
047270         MOVE 4                        TO HRWS-NBR-DECIMALS
047280         PERFORM 770-HR-FORMAT-DEC-FIELD
047290         MOVE HRWS-VALUE               TO WS-VALUE
047300     ELSE
047310     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-SALARY-CLASS-DN)
P58562     AND (AC-POS-LEVEL = 1)
047330         MOVE HREMP-SALARY-CLASS       TO WS-VALUE
047340     ELSE
047350     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-PAY-FREQUENCY-DN)
P58562     AND (AC-POS-LEVEL = 1)
047370         MOVE HREMP-PAY-FREQUENCY      TO WS-VALUE
047380     ELSE
047390     IF (PA102WS-FIELD-NBR (I2) = PAPOS-SCHEDULE-DN)
P58562         IF (AC-POS-LEVEL = 1)
047410             MOVE HREMP-SCHEDULE       TO WS-VALUE
047420         ELSE
047430             MOVE PAPEP-SCHEDULE       TO WS-VALUE
047440         END-IF
047450     ELSE
047460     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-PAY-GRADE-DN)
P58562         IF (AC-POS-LEVEL = 1)
047480             MOVE HREMP-PAY-GRADE      TO WS-VALUE
047490         ELSE
047500             MOVE PAPEP-PAY-GRADE      TO WS-VALUE
047510         END-IF
047520     ELSE
047530     IF (PA102WS-FIELD-NBR (I2) = PAPOS-PAY-STEP-DN)
P58562         IF (AC-POS-LEVEL = 1)
047550             MOVE HREMP-PAY-STEP       TO HRWS-DEC-FIELD
047560         ELSE
047570             MOVE PAPEP-PAY-STEP       TO HRWS-DEC-FIELD
047580         END-IF
047590         MOVE 0                        TO HRWS-SIZE
047600         MOVE 0                        TO HRWS-NBR-DECIMALS
047610         PERFORM 770-HR-FORMAT-DEC-FIELD
047620         MOVE HRWS-VALUE               TO WS-VALUE
047630     ELSE
047640     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-SUPERVISOR-DN)
P58562         IF (AC-POS-LEVEL = 1)
047660             MOVE HREMP-SUPERVISOR     TO WS-VALUE
047670         ELSE
047680             MOVE PAPEP-SUPERVISOR     TO WS-VALUE
047690         END-IF
047700     ELSE
047710     IF (PA102WS-FIELD-NBR (I2) = PAPOS-SHIFT-DN)
P58562         IF (AC-POS-LEVEL = 1)
047730             MOVE HREMP-SHIFT          TO HRWS-DEC-FIELD
047740         ELSE
047750             MOVE PAPEP-SHIFT          TO HRWS-DEC-FIELD
047760         END-IF
047770         MOVE 0                        TO HRWS-SIZE
047780         MOVE 0                        TO HRWS-NBR-DECIMALS
047790         PERFORM 770-HR-FORMAT-DEC-FIELD
047800         MOVE HRWS-VALUE               TO WS-VALUE
047810     ELSE
047820     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-LOCAT-CODE-DN)
P58562         IF (AC-POS-LEVEL = 1)
047840             MOVE HRPEM-LOCAT-CODE     TO WS-VALUE
047850         ELSE
047860             MOVE PAPEP-LOCAT-CODE     TO WS-VALUE
047870         END-IF
047880     ELSE
047890     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-ACTIVITY-DN)
P58562         IF  (AC-POS-LEVEL  = 1)
                   MOVE HREMP-ACTIVITY       TO WS-VALUE
               ELSE
                   MOVE PAPEP-ACTIVITY       TO WS-VALUE
               END-IF
047920     ELSE
047930     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-ACCT-CATEGORY-DN)
P58562         IF  (AC-POS-LEVEL  = 1)
                   MOVE HREMP-ACCT-CATEGORY  TO WS-VALUE
               ELSE
                   MOVE PAPEP-ACCT-CATEGORY  TO WS-VALUE
               END-IF
047960     ELSE
047970     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-OT-PLAN-CODE-DN)
P58562     AND (AC-POS-LEVEL  = 1)
047990          MOVE HREMP-OT-PLAN-CODE      TO WS-VALUE
048000     ELSE
048010     IF (PA102WS-FIELD-NBR (I2) = PAPOS-SUPERVISOR-IND-DN)
P58562         IF (AC-POS-LEVEL = 1)
048030             MOVE HREMP-SUPERVISOR-IND TO WS-VALUE
048040         ELSE
048050             MOVE PAPEP-SUPERVISOR-IND TO WS-VALUE
048060         END-IF
048070     ELSE
048080     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-WORK-SCHED-DN)
P58562         IF (AC-POS-LEVEL = 1)
048100             MOVE HREMP-WORK-SCHED     TO WS-VALUE
048110         ELSE
048120             MOVE PAPEP-WORK-SCHED     TO WS-VALUE
048130         END-IF
048140     ELSE
048150     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-EXEMPT-EMP-DN)
P58562     AND (AC-POS-LEVEL = 1)
048170         MOVE HREMP-EXEMPT-EMP         TO WS-VALUE
048180     ELSE
048190     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-SEC-LVL-DN)
P58562     AND (AC-POS-LEVEL = 1)
048210         MOVE HREMP-SEC-LVL            TO HRWS-DEC-FIELD
048220         MOVE 0                        TO HRWS-SIZE
048230         MOVE 0                        TO HRWS-NBR-DECIMALS
048240         PERFORM 770-HR-FORMAT-DEC-FIELD
048250         MOVE HRWS-VALUE               TO WS-VALUE
048260     ELSE
048270     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-SEC-LOCATION-DN)
P58562     AND (AC-POS-LEVEL = 1)
048290         MOVE HREMP-SEC-LOCATION       TO WS-VALUE
048300     ELSE
048310     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-ANNUAL-HOURS-DN)
P58562         IF  (AC-POS-LEVEL = 1)
                   MOVE HREMP-ANNUAL-HOURS   TO HRWS-DEC-FIELD
               ELSE
                   MOVE PAPEP-ANNUAL-HOURS   TO HRWS-DEC-FIELD
               END-IF
048340         MOVE 0                        TO HRWS-SIZE
111167*        MOVE 0                        TO HRWS-NBR-DECIMALS
111167         MOVE 4                        TO HRWS-NBR-DECIMALS
048360         PERFORM 770-HR-FORMAT-DEC-FIELD
P68717         MOVE HRWS-VALUE               TO WS-VALUE
P68717     ELSE
P68717     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-BARGAIN-UNIT-DN)
P68717         IF  (AC-POS-LEVEL  = 1)
P68717             MOVE HRPEM-BARGAIN-UNIT   TO WS-VALUE
P68717         ELSE
P68717             MOVE PAPEP-BARGAIN-UNIT   TO WS-VALUE
P68717         END-IF
P68717     ELSE
P68717     IF  (PA102WS-FIELD-NBR (I2) = PAPOS-UNION-CODE-DN)
P68717         IF  (AC-POS-LEVEL = 1)
P68717             MOVE HREMP-UNION-CODE     TO WS-VALUE
P68717         ELSE
P68717             MOVE PAPEP-UNION-CODE     TO WS-VALUE
P68717         END-IF
P68717     END-IF.
048380
048390 2850-END.
048400
048410******************************************************************
048420 2900-MOVE-FIELDS.      
048430******************************************************************
048440
048450     MOVE 1 TO I4.
048460     IF (PA102WS-MOVE (I2) = "A" OR "C")
048470         PERFORM
048480             UNTIL  (I4 > 30)
048490             OR     (PA102WS-FIELD-NBR2 (I4) = PA102WS-FIELD (I2))
048500                 ADD 1 TO I4.
048510
048520     IF (PCT-POS-LEVEL > 1)
048570         IF (PA102WS-FIELD-NBR (I4) = PAPOS-SALARY-CLASS-DN)
048580         OR (PA102WS-FIELD-NBR (I4) = PAPOS-PAY-FREQUENCY-DN)
048610         OR (PA102WS-FIELD-NBR (I4) = PAPOS-OT-PLAN-CODE-DN)
048620         OR (PA102WS-FIELD-NBR (I4) = PAPOS-EXEMPT-EMP-DN)
048630         OR (PA102WS-FIELD-NBR (I4) = PAPOS-SEC-LVL-DN)
048640         OR (PA102WS-FIELD-NBR (I4) = PAPOS-SEC-LOCATION-DN)
048660             GO TO 2900-END.
048670
048680     IF (PA102WS-MOVE (I2) = "C")
048690       MOVE 1 TO I3
048700       PERFORM
048710         UNTIL  (I3 > 36)
048720         OR     (PCT-FLD-NBR (I3) = PA102WS-FIELD-NBR2 (I4))
048730             ADD 1 TO I3
048740       END-PERFORM
048750       IF  (I3 NOT > 36)
048760       AND (PRM-UPDATE       = "Y")
048770           MOVE PA102WS-VALUE (I4)       TO PCT-NEW-VALUE (I3).
048780
048790     IF (PA102WS-MOVE (I2) = "A")
048800       MOVE 1 TO I3
048810       PERFORM
048820         UNTIL  (I3 > 36)
048830         OR     (PCT-FLD-NBR (I3) = ZEROES)
048840             ADD 1 TO I3
048850       END-PERFORM
048860       IF  (I3 NOT > 36)
048870       AND (PRM-UPDATE       = "Y")
048880           MOVE PA102WS-FIELD-NBR2 (I4)  TO PCT-FLD-NBR (I3)
048890           MOVE PA102WS-VALUE (I4)       TO PCT-NEW-VALUE (I3).
048900
048910     MOVE PA102WS-FIELD-VALUE (I2)       TO G2TA-PPC-VALUE-PRIOR.
048920     MOVE PCT-POS-LEVEL                  TO G2TA-PPC-LVL.
048930     MOVE PCT-EFFECT-DATE                TO G2TA-PPC-EFFECT-DATE.
048940     MOVE PCT-EMPLOYEE                   TO G2TA-EMP-REQ.
048950     MOVE PA102WS-ITEM-NAME (I4)         TO G2TA-PAD-ITEM-NAME.
048960     MOVE HRWS-FORMAT-NAME               TO G2TA-NAME-DESCRIPTION.
           IF (PA102WS-MOVE (I2)       = "A" OR "C")
               IF  (PA102WS-BEFORE-CURRENCY NOT =
                                            PA102WS-AFTER-CURRENCY)
               AND (PA102WS-FIELD (I2) = HREMP-PROCESS-LEVEL-DN)
               AND (PA102WS-NO-PAY-RATE-UPD)
                   MOVE 131                    TO CRT-MSG-NBR
                   MOVE PA102WS-AFTER-CURRENCY TO CRT-ERR-VAR1
                   PERFORM 790-GET-MSG
                   SET PA102-PCT               TO TRUE
                   PERFORM 3200-WRITE-ERR-MSG
                   SET PA102WS-PL-UPD          TO TRUE
               ELSE
               IF  (PA102WS-BEFORE-CURRENCY NOT =
                                            PA102WS-AFTER-CURRENCY)
               AND (PA102WS-FIELD (I2) = HREMP-PAY-RATE-DN)
               AND (PA102WS-NO-PL-UPD) 
                   MOVE 131                    TO CRT-MSG-NBR
                   MOVE PA102WS-AFTER-CURRENCY TO CRT-ERR-VAR1
                   PERFORM 790-GET-MSG
                   SET PA102-PCT               TO TRUE
                   PERFORM 3200-WRITE-ERR-MSG
                   SET PA102WS-PAY-RATE-UPD    TO TRUE
               ELSE
048970         IF (PA102WS-MOVE (I2) = "A")
048980             MOVE 124                    TO CRT-MSG-NBR
049020             PERFORM 790-GET-MSG
049030             MOVE CRT-MESSAGE            TO G2TA-COMMENTS
049040             MOVE GN2TA-FIELD-NBR        TO RPT-GROUP-REQUEST
049050             PERFORM 700-PRINT-RPT-GRP
048990         ELSE
049000         IF (PA102WS-MOVE (I2) = "C")
049010             MOVE 125                    TO CRT-MSG-NBR
049020             PERFORM 790-GET-MSG
049030             MOVE CRT-MESSAGE            TO G2TA-COMMENTS
049040             MOVE GN2TA-FIELD-NBR        TO RPT-GROUP-REQUEST
049050             PERFORM 700-PRINT-RPT-GRP
               END-IF.
049060
049070 2900-END.
049080
049090******************************************************************
049100 3000-WRITE-ACT-PAPOSERR.
049110******************************************************************
049120
049130     MOVE PA102WS-POSITION            TO G9A-PPC-POSITION.
049140     MOVE PA102WS-POS-DESCRIPTION     TO G9A-POS-DESCRIPTION.
P58562     MOVE AC-EFFECT-DATE              TO G9A-PPC-EFFECT-DATE.
P58562     MOVE AC-EMPLOYEE                 TO G9A-EMP-REQ.
P58562     MOVE AC-POS-LEVEL                TO G9A-POS-LEVEL.
049170     MOVE HRWS-FORMAT-NAME            TO PA102WS-NAME.   
049180     MOVE PA102WS-EMP-NAME            TO G9A-DESCRIPTION.
049190     MOVE 123                         TO CRT-MSG-NBR.
049200     PERFORM 790-GET-MSG.
049210     MOVE CRT-MESSAGE                 TO G9A-COMMENTS.
049220     MOVE GN9A-ERROR-DETAIL           TO RPT-GROUP-REQUEST.
049230     PERFORM 700-PRINT-RPT-GRP.
           IF (NO-ERR-DATA-TO-PRINT)
               SET ERR-DATA-TO-PRINT        TO TRUE
           END-IF.
049240
049250 3000-END.
049260
049270******************************************************************
049280 1000-END.
049290******************************************************************

042590******************************************************************
042600 3200-WRITE-ERR-MSG              SECTION.
042610******************************************************************

           IF (NO-WARN-DATA-TO-PRINT)
               SET WARN-DATA-TO-PRINT       TO TRUE.

           IF (PA102-PJR)
009260         MOVE PA102WS-POSITION        TO W3-PPC-POSITION
009270         MOVE PA102WS-POS-DESCRIPTION TO W3-POS-DESCRIPTION
009280         MOVE PJR-DATE-NEEDED         TO W3-PPC-EFFECT-DATE
009310         MOVE PJR-REQUISITION         TO W3-EMP-REQ
009300         MOVE PJR-DESCRIPTION         TO W3-DESCRIPTION
               MOVE ZEROES                  TO W3-POS-LEVEL
009380         MOVE CRT-MESSAGE             TO W3-COMMENTS
           ELSE
           IF (PA102-EMP)
009260         MOVE PA102WS-POSITION        TO W3-PPC-POSITION
009270         MOVE PA102WS-POS-DESCRIPTION TO W3-POS-DESCRIPTION
               MOVE PA102WS-PEP-POS-LEVEL   TO W3-POS-LEVEL
               IF (PA102WS-PEP-POS-LEVEL = 1)
009280             MOVE HREMP-EFFECT-DATE   TO W3-PPC-EFFECT-DATE
009310             MOVE HREMP-EMPLOYEE      TO W3-EMP-REQ
               ELSE
009280             MOVE PAPEP-EFFECT-DATE   TO W3-PPC-EFFECT-DATE
009310             MOVE PAPEP-EMPLOYEE      TO W3-EMP-REQ
               END-IF
               MOVE HRWS-FORMAT-NAME        TO PA102WS-NAME   
               MOVE PA102WS-EMP-NAME        TO W3-DESCRIPTION
009380         MOVE CRT-MESSAGE             TO W3-COMMENTS
           ELSE
009260         MOVE PA102WS-POSITION        TO W3-PPC-POSITION
009270         MOVE PA102WS-POS-DESCRIPTION TO W3-POS-DESCRIPTION
009280         MOVE PCT-EFFECT-DATE         TO W3-PPC-EFFECT-DATE
009310         MOVE PCT-EMPLOYEE            TO W3-EMP-REQ
               MOVE PCT-POS-LEVEL           TO W3-POS-LEVEL
               MOVE HRWS-FORMAT-NAME        TO PA102WS-NAME   
               MOVE PA102WS-EMP-NAME        TO W3-DESCRIPTION
009380         MOVE CRT-MESSAGE             TO W3-COMMENTS.

009390     MOVE WN3-ERROR-DETAIL        TO RPT-GROUP-REQUEST.
009400     PERFORM 700-PRINT-RPT-GRP.

           INITIALIZE CRT-MESSAGE.

       3200-END.

P78926******************************************************************
P78926 7500-GET-OBJECT-ID              SECTION.
P78926******************************************************************
P78926 7500-START.
P78926
P78926     MOVE "PAACT"                       TO   IFOBIWS-OBJ-TYPE.
P78926     IF  (PA102-OBJ-ID-OPTIMIZE)
P78926         IF (PA102-OBJ-ID-LEFT = ZEROES)
P78926            MOVE WS-MAX-OPS-IN-TRAN     TO   IFOBIWS-NBR-OBJECTS
P78926                                             PA102-OBJ-ID-LEFT
P78926            PERFORM 7000-ASSIGN-OBJ-ID-70
P78926            MOVE IFOBIWS-OBJ-ID         TO   PA102-MEM-OBJ-ID
P78926            SUBTRACT WS-MAX-OPS-IN-TRAN FROM PA102-MEM-OBJ-ID
P78926         END-IF
P78926         ADD 1                          TO   PA102-MEM-OBJ-ID
P78926         MOVE PA102-MEM-OBJ-ID          TO   IFOBIWS-OBJ-ID
P78926         SUBTRACT 1                     FROM PA102-OBJ-ID-LEFT
P78926     ELSE
P78926         PERFORM 7000-ASSIGN-OBJ-ID-70
P78926     END-IF.
P78926
P78926******************************************************************
P78926 7500-END.
P78926******************************************************************
P58562******************************************************************
P58562 8200-STORE-ACTIONS              SECTION.
P58562******************************************************************
P58562 8200-START.
P58562
P58562     WRITE ACTIONS-REC.
P58562
P58562 8200-END.
P58562
P58562******************************************************************
P58562 8500-FIND-NLT-ACTIONS           SECTION.
P58562******************************************************************
P58562 8500-START.
P58562
P58562     MOVE WS-FALSE               TO WS-ACTIONS-SW.
P58562
P58562     START ACTIONS-FILE          KEY NOT < AC-KEY
P58562         INVALID KEY
P58562             MOVE WS-TRUE        TO WS-ACTIONS-SW.
P58562
P58562     IF (ACTIONS-FOUND)
P58562         PERFORM 8600-FIND-NEXT-ACTIONS.
P58562
P58562 8500-END.
P58562
P58562******************************************************************
P58562 8600-FIND-NEXT-ACTIONS          SECTION.
P58562******************************************************************
P58562 8600-START.
P58562
P58562     MOVE WS-FALSE               TO WS-ACTIONS-SW.
P58562
P58562     READ ACTIONS-FILE NEXT RECORD
P58562         AT END
P58562             MOVE WS-TRUE        TO WS-ACTIONS-SW.
P58562
P58562 8600-END.
P58562
P58562******************************************************************
P58562 9800-OPEN-OUTPUT-ACTIONS        SECTION.
P58562******************************************************************
P58562 9800-START.
P58562
P58562     OPEN OUTPUT ACTIONS-FILE.
P58562
P58562 9800-END.
P58562
P58562******************************************************************
P58562 9810-OPEN-IO-ACTIONS            SECTION.
P58562******************************************************************
P58562 9810-START.
P58562
P58562     OPEN I-O ACTIONS-FILE.
P58562
P58562 9810-END.
P58562
P58562******************************************************************
P58562 9820-OPEN-INPUT-ACTIONS         SECTION.
P58562******************************************************************
P58562 9820-START.
P58562
P58562     OPEN INPUT ACTIONS-FILE.
P58562
P58562 9820-END.
P58562
P58562******************************************************************
P58562 9900-CLOSE-ACTIONS              SECTION.
P58562******************************************************************
P58562 9900-START.
P58562
P58562     CLOSE ACTIONS-FILE.
P58562
P58562 9000-END.
P58562
