******* PR29PD 29 <1757645145>
************************************************************************
*******CHANGE LOG:
*******  GW 2/2006 ADDED DISPLAY OF PNP-PENS-SEQ-NBR ON PAY-TAB WO #3505
******** GW6/2007 RE MSP11 LINE 195 WAS HANGING OVER INTO POS 73
      *
      * 10/29/10  M. HUNTER - ACS - REAPPLIED ABOVE CUSTOMIZATIONS AFTER
      *                             9.0 APPS UPGRADE.
      * 08/19/11  M. HUNTER - ACS - REAPPLIED ABOVE MODS AFTER 9.0.1
      *                             APPS UPGRADE.
      ******************************************************************
000010******************************************************************
000020 PR29S1-TRANSACTION              SECTION 10.
000030******************************************************************
000040 PR29S1-START.
000050
000060     PERFORM 200-EDIT-TRAN
000070     THRU    200-END.
000080
000090     IF (NO-ERROR-FOUND)
P71470         IF  (PR29-2-ROTH-YEAR-NOT-ENTERED)
P68632         AND (PR29F1-FC = "A")
P68632         AND (PRPNP-PENS-DIST-TYPE   =  1 OR  2 OR  3 OR  4 OR  5
P68632                                    OR  6 OR  7 OR  8 OR  9 OR 10
P68632                                    OR 13 OR 14 OR 17 OR 19 OR 25
P68632                                    OR 28)
P68632         AND ((PRPNP-PENS-DIST-CODE      = "B")
P68632         OR   (PRPNP-PENS-DST-CODE2      = "B"))
P68632             MOVE PRPNP-COMPANY          TO DB-COMPANY
P68632             MOVE "US"                   TO DB-COUNTRY-CODE
P68632             MOVE "E"                    TO DB-RECORD-TYPE
P68632             MOVE PRPNP-EMPLOYEE         TO DB-EMPLOYEE
P68632             MOVE SPACES                 TO DB-REPORT-ENTITY
P68632             MOVE ZEROES                 TO DB-PAYROLL-YEAR
P68632             MOVE "E1"                   TO DB-TOPIC
P68632             MOVE 4019                   TO DB-FLD-NBR
P68632             MOVE 1                      TO DB-SEQ-NBR
P68632             PERFORM 840-FIND-RGPSET3
P68632             IF  (PRREGPARM-NOTFOUND)
P68632                 MOVE "I"                TO CRT-DISPLAY-FC
P68632                                            CRT-PASS-FC
P68632                 MOVE PR29F1-FC          TO PR29F1-PASS-FC
P68632
P68632                 MOVE CRT-MANUAL-CF      TO CRT-REQUEST
P68632                 MOVE "PR292"            TO CRT-SCREEN-CODE
P71470             ELSE
P71470                 PERFORM 400-PROCESS-TRAN
P71470                 THRU    400-END
P68632             END-IF
P71470         ELSE
P71470             INITIALIZE PR29-2-ROTH-YEAR-SW
000100             PERFORM 400-PROCESS-TRAN
000110             THRU    400-END.
000120
000130     GO TO PR29S1-TRANSACTION-END.
000140
000150******************************************************************
000160 200-EDIT-TRAN.
000170******************************************************************
000180
000190     PERFORM 210-EDIT-ACCESS
000200     THRU    210-END.
000210
000220     IF (ERROR-FOUND)
000230         GO TO 200-END.
000240
000250     IF (PR29F1-FC = "A" OR "C" OR "D")
000260         PERFORM 230-EDIT-DATA
000270         THRU    230-END.
000280
000290 200-END.
000300
000310******************************************************************
000320 210-EDIT-ACCESS.
000330******************************************************************
000340
002830     INITIALIZE HREMP-SCR-FIELDS.
002840     INITIALIZE PRPNP-TIME-TABLE-GROUP.
           INITIALIZE PRPNP-SRC-TABLE-GROUP.
RETROP     INITIALIZE PRPNP-TIME-TABLE-GROUP2.
RETROP     INITIALIZE PRPNP-SRC-TABLE-GROUP2.
002850
000350     MOVE WS-FALSE                   TO PRPNP-RATE-SECURED-SW.
000360     MOVE PR29F1-PNP-COMPANY         TO DB-COMPANY.
000370     MOVE HREMP-PAY-RATE-DN          TO DB-FLD-NBR.
000380     INITIALIZE                         DB-COUNTRY-CD-REQ
                                              DB-PROCESS-LEVEL.
000390     PERFORM 840-FIND-PASSET1.
000400     IF (PASCRTY-FOUND)
000410         MOVE PAS-SEC-LEVEL          TO HRWS-SEC-LEVEL
000420         PERFORM 730-HR-FIELD-SECURITY
000430         IF (HRWS-FLD-SECURED)
000440             MOVE WS-TRUE            TO PRPNP-RATE-SECURED-SW.
000450
000460
000470     MOVE PR29F1-PNP-COMPANY         TO DB-COMPANY.
000480     MOVE PR29F1-PNP-EMPLOYEE        TO DB-EMPLOYEE.
000490     MOVE PR29F1-PNP-EFFECT-DATE     TO DB-EFFECT-DATE.

DKR        IF (PR29F1-FC = "D")
               PERFORM 850-FIND-NLT-TRDSET13
               IF (TIMERECORD-NOTFOUND)
                   CONTINUE
               ELSE
                   IF (TRD-CHECK-TYPE = "M")  AND
                      (TRD-CHECK-ID NOT = 0)
                       MOVE 201                TO CRT-ERROR-NBR
                       MOVE PR29F1-FC-FN       TO CRT-FIELD-NBR
                       GO TO 210-END
                   END-IF
               END-IF
          END-IF.
000500
000510     IF  (PR29F1-FC = "P")
000520     AND (PR29F1-PNP-PENS-SEQ-NBR = ZEROS)
000530         MOVE WS-HIGH-VALUES         TO PR29F1-PNP-PENS-SEQ-NBR
000540                                        DB-PENS-SEQ-NBR.
000550
000510     IF  (PR29F1-FC = "N" OR "P")
000520     AND (PR29F1-PNP-EFFECT-DATE = ZEROS)
000530         MOVE WS-HIGH-VALUES         TO DB-EFFECT-DATE.
000550
000560     IF (PR29F1-FC = "N")
000570         PERFORM 850-FIND-NLT-PNPSET3
000580         IF  (PRPENPAY-FOUND)
000590         AND (PNP-COMPANY      = DB-COMPANY)
000600         AND (PNP-EMPLOYEE     = DB-EMPLOYEE)
000610         AND (PNP-EFFECT-DATE  = DB-EFFECT-DATE)
000620         AND (PNP-PENS-SEQ-NBR = DB-PENS-SEQ-NBR)
000630              PERFORM 860-FIND-NEXT-PNPSET3.
000640
000650     IF (PR29F1-FC = "P")
000660         PERFORM 850-FIND-NLT-PNPSET3
               PERFORM 870-FIND-PREV-PNPSET3.
000730
000740     IF (PR29F1-FC = "N" OR "P")
000750         IF (PRPENPAY-NOTFOUND)
000760         OR (PNP-COMPANY   NOT = PR29F1-PNP-COMPANY)
000770             MOVE 114                TO CRT-ERROR-NBR
000780             MOVE PR29F1-FC-FN       TO CRT-FIELD-NBR
000790             GO TO 210-END
000800         ELSE
000810             MOVE PNP-EMPLOYEE       TO DB-EMPLOYEE
000820                                        PR29F1-PNP-EMPLOYEE.
000830
000840     MOVE PR29F1-PNP-COMPANY         TO DB-COMPANY.
000850     MOVE PR29F1-PNP-EMPLOYEE        TO DB-EMPLOYEE.
000860     PERFORM 840-FIND-EMPSET1.
000870     IF (EMPLOYEE-NOTFOUND)
000880         MOVE 101                    TO CRT-ERROR-NBR
000890         MOVE PR29F1-PNP-EMPLOYEE-FN TO CRT-FIELD-NBR
000900         GO TO 210-END.
000910
000920     MOVE ZEROS                      TO HRWS-NEXT-COUNT.
000930     MOVE EMP-COMPANY                TO CRT-COMPANY.
000940     MOVE EMP-PROCESS-LEVEL          TO CRT-PROCESS-LEVEL.
000950     PERFORM 700-HR-EMP-SECURITY.
000960     IF (HRWS-EMP-SECURED)
000970         IF (PR29F1-FC NOT = "N" AND "P")
000980             MOVE 231                TO CRT-ERROR-NBR
000990             MOVE PR29F1-PNP-EMPLOYEE-FN
001000                                     TO CRT-FIELD-NBR
001010             GO TO 210-END
001020         ELSE
001030             IF (PR29F1-FC = "N")
001040                 PERFORM 860-FIND-NEXT-PNPSET3
001050                 PERFORM 212-GET-NEXT-EMPLOYEE
001060                 THRU    212-END
001070                     UNTIL (PRPENPAY-NOTFOUND)
001080                     OR    (PNP-COMPANY     NOT = DB-COMPANY)
001090                     OR    (HRWS-EMP-NOT-SECURED)
001100                     OR   ((HRWS-NEXT-COUNT > PRS-SEC-SEARCH)
001110                     AND   (PRS-SEC-SEARCH  > ZEROS))
001120             ELSE
001130                 PERFORM 870-FIND-PREV-PNPSET3
001140                 PERFORM 212-GET-NEXT-EMPLOYEE
001150                 THRU    212-END
001160                     UNTIL (PRPENPAY-NOTFOUND)
001170                     OR    (PNP-COMPANY     NOT = DB-COMPANY)
001180                     OR    (HRWS-EMP-NOT-SECURED)
001190                     OR   ((HRWS-NEXT-COUNT > PRS-SEC-SEARCH)
001200                     AND   (PRS-SEC-SEARCH  > ZEROS)).
001210
001220     IF  (PR29F1-FC = "N" OR "P")
001230     AND (HRWS-NEXT-COUNT > PRS-SEC-SEARCH)
001240     AND (PRS-SEC-SEARCH  > ZEROS)
001250         MOVE PRS-SEC-SEARCH         TO HRWS-SEARCH-NBR
001260         MOVE HRWS-SEARCH-VAR        TO CRT-ERR-VAR1
001270         MOVE 99                     TO CRT-ERROR-NBR
001280         MOVE PR29F1-FC-FN           TO CRT-FIELD-NBR
001290         GO TO 210-END.
001300
001310     IF (PR29F1-FC = "N" OR "P")
001320         IF (PRPENPAY-NOTFOUND)
001330         OR (PNP-COMPANY   NOT = PR29F1-PNP-COMPANY)
001340             MOVE 200                TO CRT-ERROR-NBR
001350             MOVE PR29F1-FC-FN       TO CRT-FIELD-NBR
001360             GO TO 210-END
001370         ELSE
001380             MOVE PNP-EMPLOYEE       TO DB-EMPLOYEE
001390                                        PR29F1-PNP-EMPLOYEE
001400             MOVE PNP-EFFECT-DATE    TO DB-EFFECT-DATE
001410                                        PR29F1-PNP-EFFECT-DATE
001420             MOVE PNP-PENS-SEQ-NBR   TO DB-PENS-SEQ-NBR
001430                                        PR29F1-PNP-PENS-SEQ-NBR 
GW0607                                     PR29F1-PNP-PENS-SEQ-NBR-DISP.
001440
001450     IF (PR29F1-FC  NOT = "N" AND "P" AND "A")
001460         MOVE PR29F1-PNP-EFFECT-DATE TO DB-EFFECT-DATE
001470         MOVE PR29F1-PNP-PENS-SEQ-NBR
001480                                     TO DB-PENS-SEQ-NBR
001490         PERFORM 850-FIND-NLT-PNPSET3
001500         IF (PRPENPAY-NOTFOUND)
001510         OR (PNP-COMPANY     NOT = DB-COMPANY)
001520         OR (PNP-EMPLOYEE    NOT = DB-EMPLOYEE)
001530         OR (PNP-EFFECT-DATE NOT = DB-EFFECT-DATE)
001540             INITIALIZE                 DB-PENS-SEQ-NBR
001550             PERFORM 850-FIND-NLT-PNPSET3
001560             IF (PRPENPAY-NOTFOUND)
001570             OR (PNP-COMPANY     NOT = DB-COMPANY)
001580             OR (PNP-EMPLOYEE    NOT = DB-EMPLOYEE)
001590             OR (PNP-EFFECT-DATE NOT = DB-EFFECT-DATE)
001600                 MOVE 203            TO CRT-ERROR-NBR
001610                 MOVE PR29F1-FC-FN   TO CRT-FIELD-NBR
001620                 GO TO 210-END.
001630
001640     IF (PR29F1-FC = "A")
001650         MOVE PR29F1-PNP-PENS-DIST-TYPE
001660                                     TO PRPNP-PENS-DIST-TYPE-SW
001670     ELSE
001680         MOVE PNP-PENS-DIST-TYPE     TO PRPNP-PENS-DIST-TYPE-SW.
001690
001700     IF (PRPNP-PENS-DIST-TYPE-STM)
001710     OR (PRPNP-PENS-DIST-TYPE-TRD)
001720         NEXT SENTENCE
001730     ELSE
001740         MOVE 111                    TO CRT-ERROR-NBR
001750         MOVE PR29F1-FC-FN           TO CRT-FIELD-NBR
001760         GO TO 210-END.

J16269     IF (PR29F1-PNP-COUNTRY-CODE NOT = "US" AND SPACES)
J16269     OR ((PR29F1-PNP-COUNTRY-CODE = SPACES)
J16269     AND (EMP-COUNTRY-CODE NOT = "US"))
J16269             IF (PR29F1-PNP-IAT = "Y")
J16260                 MOVE 232                    TO CRT-ERROR-NBR
J16269                 MOVE PR29F1-FC-FN           TO CRT-FIELD-NBR
J16269                 GO TO 210-END 
J16269             END-IF
J16269     END-IF.
001770
001780     MOVE PNP-PENS-SEQ-NBR           TO DB-PENS-SEQ-NBR
001790                                        PR29F1-PNP-PENS-SEQ-NBR.
001800
001810     IF (PR29F1-FC = "A" OR "I" OR "N" OR "P")
001830         INITIALIZE DB-PAY-CODE
001840         INITIALIZE DB-SEQ-NBR
001850         INITIALIZE DB-CHECK-ID
001860         INITIALIZE DB-TIME-SEQ
001870     ELSE
001880     IF (PR29F1-FC = "+")
001900         MOVE PR29F1-PT-PAY-CODE     TO DB-PAY-CODE
001910         MOVE PR29F1-PT-SEQ-NBR      TO DB-SEQ-NBR
001920         MOVE PR29F1-PT-CHECK-ID     TO DB-CHECK-ID
001930         MOVE PR29F1-PT-TIME-SEQ     TO DB-TIME-SEQ
001940     ELSE
001960         MOVE PR29F1-PAY-CODE (1)    TO DB-PAY-CODE
001970         MOVE PR29F1-SEQ-NBR  (1)    TO DB-SEQ-NBR
001980         MOVE PR29F1-CHECK-ID (1)    TO DB-CHECK-ID
001990         MOVE PR29F1-TIME-SEQ (1)    TO DB-TIME-SEQ.
           INITIALIZE DB-TIME-GROUP.
RETROP     INITIALIZE WS-RETRO-PAYMENT.
002000
002010     IF (PRPNP-PENS-DIST-TYPE-STM)
002020         PERFORM 850-FIND-NLT-STMSET6
002030         IF (PR29F1-FC = "-")
002040             PERFORM 870-FIND-PREV-STMSET6.
002050
002060     IF (PRPNP-PENS-DIST-TYPE-TRD)
002070         PERFORM 850-FIND-NLT-TRDSET13
002080         IF (PR29F1-FC = "-")
002090             PERFORM 870-FIND-PREV-TRDSET13.
002100
           SET PRPNP-STANDTIME-NOTFOUND TO TRUE.
           SET PRPNP-TIMERECORD-NOTFOUND TO TRUE.
           SET PRPNP-USE-NOTHING TO TRUE.
002130
002140     IF  (PRPNP-PENS-DIST-TYPE-STM)
002150     AND (STANDTIME-FOUND)
002160     AND (STM-COMPANY      = DB-COMPANY)
002170     AND (STM-EMPLOYEE     = DB-EMPLOYEE)
002180     AND (STM-PENS-SEQ-NBR = DB-PENS-SEQ-NBR)
002190           SET PRPNP-STANDTIME-FOUND TO TRUE.
002200
002230     IF  (PRPNP-PENS-DIST-TYPE-TRD)
002240     AND (TIMERECORD-FOUND)
002250     AND (TRD-COMPANY      = DB-COMPANY)
002260     AND (TRD-EMPLOYEE     = DB-EMPLOYEE)
002270     AND (TRD-PENS-SEQ-NBR = DB-PENS-SEQ-NBR)
RETROP     AND (TRD-RETRO-PENSION = SPACE)
                 SET PRPNP-USE-TRD TO TRUE
                 SET PRPNP-TIMERECORD-FOUND TO TRUE.
002290
002300     IF  (PRPNP-PENS-DIST-TYPE-TRD)
002310     AND (PRPNP-USE-NOTHING)
002320     AND (PR29F1-FC NOT = "A")
002350         PERFORM 850-FIND-NLT-PRTSET8
002360         IF (PR29F1-FC = "-")
002370             PERFORM 870-FIND-PREV-PRTSET8
002380         END-IF
002390         IF  (PRTIME-FOUND)
002400         AND (PRT-COMPANY       = DB-COMPANY)
002410         AND (PRT-EMPLOYEE      = DB-EMPLOYEE)
002420         AND (PRT-PENS-SEQ-NBR  = DB-PENS-SEQ-NBR)
RETROP         AND (PRT-RETRO-PENSION = SPACE)
                   SET PRPNP-USE-PRT TO TRUE.
002450
002460 210-END.
002470
002480******************************************************************
002490 212-GET-NEXT-EMPLOYEE.
002500******************************************************************
002510
002520     IF (PNP-EMPLOYEE = DB-EMPLOYEE)
002530         GO TO 212-NEXT.
002540
002550     ADD 1                       TO HRWS-NEXT-COUNT.
002560     MOVE PNP-EMPLOYEE           TO DB-EMPLOYEE.
002570     PERFORM 840-FIND-EMPSET1.
002580     MOVE EMP-COMPANY            TO CRT-COMPANY.
002590     MOVE EMP-PROCESS-LEVEL      TO CRT-PROCESS-LEVEL.
002600     PERFORM 700-HR-EMP-SECURITY.
002610     IF (HRWS-EMP-NOT-SECURED)
002620         IF (PR29F1-FC = "N")
002630             GO TO 212-END
002640         ELSE
002650             PERFORM 850-FIND-NLT-PNPSET3
002660             GO TO 212-END.
002670
002680 212-NEXT.
002690     IF (PR29F1-FC = "P")
002700         PERFORM 870-FIND-PREV-PNPSET3
002710     ELSE
002720         PERFORM 860-FIND-NEXT-PNPSET3.
002730
002740 212-END.
002750
002760******************************************************************
002770 230-EDIT-DATA.
002780******************************************************************
002790
002800     PERFORM 500-MOVE-SCR-TO-WS
002810     THRU    500-END.
002820
           INITIALIZE I2.
002860     PERFORM 502-MOVE-TIME-SCR-TO-WS
002870     THRU    502-END
002880       VARYING I1 FROM 1 BY 1
002890        UNTIL  (I1 > PR29F1-TRD-CNT).
002900
           INITIALIZE I2.
002910     PERFORM 501-MOVE-SRC-SCR-TO-WS
002920     THRU    501-END
002930       VARYING I1 FROM 1 BY 1
002940        UNTIL  (I1 > PR29F1-SRC-CNT).
002950
RETROP     MOVE "N"           TO WS-RETRO-EXIST-SW.
RETROP     MOVE "N"           TO WS-SOURCE2-EXIST-SW.
RETROP
002960     PERFORM 260-EDIT-DTL-TRAN
002970     THRU    260-END
002980         VARYING I1 FROM 1 BY 1
002990         UNTIL  (I1 > PR29F1-TRD-CNT)
003000         OR     (ERROR-FOUND).
003010
003020     IF (ERROR-FOUND)
003030         GO TO 230-END.
003040
RETROP     IF  (PRPNP-FC = "C")
RETROP     AND (WS-RATE-TOTAL = ZEROS)
RETROP     AND (WS-FUND-AMOUNT-TOTAL = ZEROS)
RETROP     AND (RETRO-EXIST-YES)
RETROP         MOVE 115                      TO CRT-ERROR-NBR
RETROP         MOVE PR29F1-PNF-FUNDING-SOURCE2-FN(1) TO CRT-FIELD-NBR.
RETROP
RETROP     IF (ERROR-FOUND)
RETROP         GO TO 230-END.
RETROP
RETROP     PERFORM 275-EDIT-DATA
RETROP       THRU  275-END.
RETROP
RETROP     IF (ERROR-FOUND)
RETROP         GO TO 230-END.

003050     PERFORM 2000-PRPNP-EDIT-TRAN.
003060     IF (ERROR-FOUND)
003070         GO TO 230-END.
003080
003090     PERFORM 530-MOVE-WS-TO-SCR
003100     THRU    530-END.
003110
           PERFORM 531-MOVE-SRC-WS-TO-SCR
           THRU    531-END
               VARYING I1 FROM 1 BY 1
               UNTIL  (I1 > PRPNP-SRC-LINES).

003120     PERFORM 532-MOVE-TIME-WS-TO-SCR
003130     THRU    532-END
003140         VARYING I1 FROM 1 BY 1
003150         UNTIL  (I1 > PRPNP-TIME-LINES).
003160
003170 230-END.
003180
003190******************************************************************
003200 260-EDIT-DTL-TRAN.
003210******************************************************************
003220
003230     IF (PR29F1-LINE-FC (I1) = SPACES)
RETROP         GO TO 260-NEXT.
003250
003260     IF  (PR29F1-RATE (I1) NOT = ZEROS)
003270     AND (PRPNP-RATE-SECURED)
003280         MOVE 110                    TO CRT-ERROR-NBR
003290         MOVE PR29F1-RATE-FN (I1)    TO CRT-FIELD-NBR
003300         GO TO 260-END.
003310
003320     IF (PR29F1-LINE-FC (I1) = "A")
003330         MOVE ZEROS                  TO PR29F1-RATE1 (I1).
003340
RETROP 260-NEXT.
RETROP
RETROP     COMPUTE WS-FUND-AMOUNT-TOTAL
RETROP           = WS-FUND-AMOUNT-TOTAL
RETROP           + PR29F1-PNF-FUND-AMOUNT2 (I1).
RETROP
RETROP     IF (PRPNP-RATE-SECURED)
RETROP         COMPUTE WS-RATE-TOTAL
RETROP           = WS-RATE-TOTAL
RETROP           + PR29F1-RATE12 (I1)
RETROP     ELSE
RETROP         COMPUTE WS-RATE-TOTAL
RETROP           = WS-RATE-TOTAL
RETROP           + PR29F1-RATE2 (I1).
RETROP
RETROP     IF  (PR29F1-PNF-FUNDING-SOURCE2 (I1) NOT = SPACES)
RETROP          MOVE "Y"                  TO WS-SOURCE2-EXIST-SW.
RETROP
RETROP     IF (PR29F1-LINE-FC2 (I1) = SPACES)
RETROP         GO TO 260-END.
RETROP
RETROP     IF  (PR29F1-RATE2 (I1) NOT = ZEROS)
RETROP     AND (PRPNP-RATE-SECURED)
RETROP         MOVE 110                    TO CRT-ERROR-NBR
RETROP         MOVE PR29F1-RATE2-FN (I1)   TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
RETROP     IF (PR29F1-LINE-FC2 (I1) = "A")
RETROP         MOVE ZEROS                  TO PR29F1-RATE12 (I1)
RETROP         MOVE "Y"                    TO PR29F1-RETRO-PAYMENT2 (I1)
RETROP         MOVE "Y"                    TO WS-RETRO-EXIST-SW.
RETROP
RETROP     IF (PR29F1-LINE-FC2 (I1) = "C")
RETROP     OR (PR29F1-LINE-FC2 (I1) = "D")
RETROP         MOVE "Y"                    TO PR29F1-RETRO-PAYMENT2(I1)
RETROP         MOVE "Y"                    TO WS-RETRO-EXIST-SW.
RETROP
RETROP     IF  (PR29F1-PAY-CODE2 (I1) NOT = SPACES)
RETROP     AND (PR29F1-RATE2 (I1)     NOT = ZEROS)
RETROP          NEXT SENTENCE
RETROP     ELSE
RETROP     IF  (PR29F1-PAY-CODE2 (I1)     = SPACES)
RETROP         MOVE 163                                TO CRT-ERROR-NBR
RETROP         MOVE PR29F1-PAY-CODE2-FN (I1)           TO CRT-FIELD-NBR
RETROP         GO TO 260-END
RETROP     ELSE
RETROP     IF  (PR29F1-RATE2 (I1)         = ZEROS)
RETROP         MOVE 163                                TO CRT-ERROR-NBR
RETROP         MOVE PR29F1-RATE2-FN (I1)               TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
RETROP     PERFORM 265-PRPNP-EDIT-PAY-CODE
RETROP     THRU    265-END.
RETROP
RETROP     IF  (PR29F1-PNP-PENS-DIST-TYPE = 11 OR 12 OR 24)
RETROP     AND (PRPNP-TAX-FORM-TYPE     NOT = 1)
RETROP         MOVE 127                                TO CRT-ERROR-NBR
RETROP         MOVE PR29F1-PAY-CODE2-FN (I1)           TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
RETROP     IF  (PR29F1-PNP-PENS-DIST-TYPE = 1 OR  2 OR  3 OR  4 OR  5 OR
RETROP                                      6 OR  7 OR  8 OR  9 OR 10 OR
RETROP                                     13 OR 14 OR 15 OR 17 OR 18 OR
RETROP                                     19)
RETROP     AND (PRPNP-TAX-FORM-TYPE     NOT = 2)
RETROP         MOVE 127                                TO CRT-ERROR-NBR
RETROP         MOVE PRPNP-TTB-PAY-CODE2-FN (1)          TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
RETROP     IF  (PR29F1-PNP-PENS-DIST-TYPE = 16)
RETROP     AND (PRPNP-TAX-FORM-TYPE     NOT = 3)
RETROP         MOVE 127                                TO CRT-ERROR-NBR
RETROP         MOVE PRPNP-TTB-PAY-CODE2-FN (1)          TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
RETROP     IF  (PR29F1-PNP-PENS-DIST-TYPE = 20 OR 21)
RETROP     AND (PRPNP-TAX-FORM-TYPE     NOT = 4)
RETROP         MOVE 127                                TO CRT-ERROR-NBR
RETROP         MOVE PRPNP-TTB-PAY-CODE2-FN (1)          TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
RETROP
RETROP     IF  (PR29F1-PNP-PENS-DIST-TYPE = 22 OR 23)
RETROP     AND (PRPNP-TAX-FORM-TYPE     NOT = 5)
RETROP         MOVE 127                                TO CRT-ERROR-NBR
RETROP         MOVE PRPNP-TTB-PAY-CODE2-FN (1)          TO CRT-FIELD-NBR
RETROP         GO TO 260-END.
RETROP
003350 260-END.
003360
RETROP******************************************************************
RETROP 265-PRPNP-EDIT-PAY-CODE.
RETROP*****************************************************************
RETROP
RETROP     MOVE PR29F1-PNP-COMPANY          TO DB-COMPANY.
RETROP     MOVE PR29F1-PROCESS-LEVEL        TO DB-PROCESS-LEVEL.
RETROP     MOVE EMP-JOB-CODE                TO DB-JOB-CODE.
RETROP     MOVE PR29F1-PAY-CODE2 (I1)       TO DB-PAY-CODE.
RETROP     PERFORM 840-FIND-PCDSET1.
RETROP     IF (PRPAYCODE-NOTFOUND)
RETROP         INITIALIZE DB-PROCESS-LEVEL
RETROP         PERFORM 840-FIND-PCDSET1
RETROP         IF (PRPAYCODE-NOTFOUND)
RETROP             MOVE PRPNP-PROCESS-LEVEL    TO DB-PROCESS-LEVEL
RETROP             INITIALIZE DB-JOB-CODE
RETROP             PERFORM 840-FIND-PCDSET1
RETROP             IF (PRPAYCODE-NOTFOUND)
RETROP                 INITIALIZE DB-PROCESS-LEVEL
RETROP                 PERFORM 840-FIND-PCDSET1
RETROP                 IF (PRPAYCODE-NOTFOUND)
RETROP                     INITIALIZE PRPAYCODE
RETROP                     GO TO 265-ERROR.
RETROP
RETROP     MOVE PR29F1-PNP-COMPANY          TO DB-COMPANY.
RETROP     MOVE PCD-PAY-SUM-GRP        TO DB-PAY-SUM-GRP.
RETROP     PERFORM 840-FIND-PSGSET1.
RETROP     IF (PAYSUMGRP-NOTFOUND)
RETROP         GO TO 265-ERROR.
RETROP
RETROP     IF (PRPAYCODE-FOUND)
RETROP         MOVE PCD-PAY-SUM-GRP TO PRPNP-TTB-PAY-SUM-GRP(I1).
RETROP
RETROP     PERFORM 270-PRPNP-EDIT-SAME-TAX-FORM
RETROP     THRU    270-END.
RETROP
RETROP     GO TO 265-END.
RETROP
RETROP 265-ERROR.
RETROP
RETROP     IF  (PRPNP-I1 = ZEROES)
RETROP         GO TO 265-END.
RETROP
RETROP     MOVE PCDSET4-PAY-CODE       TO WS-DB-BEG-RNG.
RETROP     PERFORM 850-FIND-BEGRNG-PCDSET4.
RETROP     IF  (PRPAYCODE-FOUND)
RETROP         MOVE 177                                TO CRT-ERROR-NBR
RETROP     ELSE
RETROP         MOVE 161                                TO CRT-ERROR-NBR.
RETROP
RETROP     MOVE PR29F1-PAY-CODE2 (I1)                  TO CRT-ERR-VAR1.
RETROP     MOVE PR29F1-PAY-CODE2-FN (I1)               TO CRT-FIELD-NBR.
RETROP
RETROP 265-END.
RETROP
RETROP******************************************************************
RETROP 270-PRPNP-EDIT-SAME-TAX-FORM.
RETROP*****************************************************************
RETROP
RETROP     IF  (PRPNP-TAX-FORM-TYPE = ZEROES)
RETROP         MOVE PSG-TAX-FORM-TYPE  TO PRPNP-TAX-FORM-TYPE.
RETROP
RETROP     IF  (I1 NOT = ZEROES)
RETROP     AND (PSG-TAX-FORM-TYPE NOT = PRPNP-TAX-FORM-TYPE)
RETROP         MOVE 170                          TO CRT-ERROR-NBR
RETROP         MOVE PR29F1-PAY-CODE2-FN (I1)     TO CRT-FIELD-NBR
RETROP         GO TO 270-END.
RETROP
RETROP 270-END.
RETROP
RETROP******************************************************************
RETROP 275-EDIT-DATA.
RETROP*****************************************************************
RETROP
RETROP     COMPUTE WS-SRC-LINES-1 = PRPNP-SRC-LINES - 1.
RETROP
RETROP     PERFORM
RETROP     VARYING I1 FROM 1 BY 1
RETROP     UNTIL   (I1 > WS-SRC-LINES-1)
RETROP         COMPUTE I2 = I1 + 1
RETROP         PERFORM
RETROP         VARYING I3 FROM I2 BY 1
RETROP         UNTIL   (I3 > PRPNP-SRC-LINES)
RETROP             IF  (PRPNP-STB-FUNDING-SOURCE2 (I1)
RETROP                = PRPNP-STB-FUNDING-SOURCE2 (I3))
RETROP             AND (PRPNP-STB-FUNDING-SOURCE2 (I3) NOT = SPACES)
RETROP                 MOVE 113        TO CRT-ERROR-NBR
RETROP                 MOVE PRPNP-STB-FUNDING-SOURCE2 (I1)
RETROP                                 TO CRT-ERR-VAR1
RETROP                 MOVE PRPNP-STB-FUNDING-SOURCE2-FN (I3)
RETROP                                 TO CRT-FIELD-NBR
RETROP                 GO TO 275-END.
RETROP
RETROP 275-END.
003360
003370******************************************************************
003380 400-PROCESS-TRAN.
003390******************************************************************
003400
003420
003430     IF (PR29F1-FC = "A" OR "C" OR "D")
003440         PERFORM 910-AUDIT-BEGIN
003490         PERFORM 500-MOVE-SCR-TO-WS
003500         THRU    500-END
003510
               INITIALIZE I2
003520         PERFORM 501-MOVE-SRC-SCR-TO-WS
003530         THRU    501-END
003540             VARYING I1 FROM 1 BY 1
003550             UNTIL  (I1 > PR29F1-SRC-CNT)
003560
               INITIALIZE I2
003570         PERFORM 502-MOVE-TIME-SCR-TO-WS
003580         THRU    502-END
003590             VARYING I1 FROM 1 BY 1
003600             UNTIL  (I1 > PR29F1-TRD-CNT)
003610
003620         PERFORM 430-UPDATE
003630         THRU    430-END
003650     ELSE
003660     IF (PR29F1-FC = "I" OR "+" OR "-" OR "N" OR "P")
003670         PERFORM 480-INQUIRE
003680         THRU    480-END.
003690
003770 400-END.
003780
003790******************************************************************
003800 430-UPDATE.
003810******************************************************************
003820
003830     PERFORM 3000-PRPNP-PROCESS-TRAN.

GW5/03***** WBP MODS
           MOVE PNP-COMPANY            TO DB-COMPANY.
           MOVE PNP-EMPLOYEE           TO DB-EMPLOYEE.
           MOVE PNP-EFFECT-DATE        TO DB-EFFECT-DATE.
           MOVE PNP-PENS-SEQ-NBR       TO DB-PENS-SEQ-NBR.

           PERFORM 840-MODIFY-WPNSET1.
           IF  (WBPPRPENPY-FOUND)
               IF (PR29F1-FC = "A" OR "C")
                  MOVE PR29F1-WPN-BEN-START-DATE TO WPN-BEN-START-DATE
                  MOVE PR29F1-WPN-REVIEW-DATE    TO WPN-REVIEW-DATE   
                  MOVE PR29F1-WPN-REVIEW-REASON  TO WPN-REVIEW-REASON  
                  MOVE PR29F1-WPN-BEN-STOP-RSN   TO WPN-BEN-STOP-RSN    
                  PERFORM  820-STORE-WBPPRPENPY
               ELSE
               IF (PR29F1-FC = "D")
                  PERFORM 830-DELETE-WBPPRPENPY
               END-IF
               END-IF
           ELSE
           IF (PR29F1-FC = "A" OR "C")
               PERFORM 800-CREATE-WBPPRPENPY
               MOVE PNP-COMPANY               TO WPN-COMPANY
               MOVE PNP-EMPLOYEE              TO WPN-EMPLOYEE
               MOVE PNP-EFFECT-DATE           TO WPN-EFFECT-DATE
               MOVE PNP-PENS-SEQ-NBR          TO WPN-PENS-SEQ-NBR
               MOVE PR29F1-WPN-BEN-START-DATE TO WPN-BEN-START-DATE
               MOVE PR29F1-WPN-REVIEW-DATE    TO WPN-REVIEW-DATE   
               MOVE PR29F1-WPN-REVIEW-REASON  TO WPN-REVIEW-REASON  
               MOVE PR29F1-WPN-BEN-STOP-RSN   TO WPN-BEN-STOP-RSN    

               PERFORM  820-STORE-WBPPRPENPY.
******** THERE SHOULD ONLY BE ONE PAY-CODE AND SEQ-NBR *********
           IF (PR29F1-FC = "A" OR "C")

016220        MOVE PRPNP-COMPANY              TO DB-COMPANY
016230        MOVE PRPNP-EMPLOYEE             TO DB-EMPLOYEE
              PERFORM 840-FIND-EMPSET1
016240        MOVE PRPNP-PENS-SEQ-NBR         TO DB-PENS-SEQ-NBR
              MOVE STMSET6-PENS-SEQ-NBR   TO WS-DB-BEG-RNG
              PERFORM 850-MODIFY-BEGRNG-STMSET6
              PERFORM
                  UNTIL (STANDTIME-NOTFOUND)
                  IF (EMP-EMP-STATUS = "AI" OR "AM" OR "AR" OR "AS")
                     MOVE "3"                 TO STM-CHECK-GRP
                  ELSE
                  IF (PRPNP-PENS-DIST-CODE  = "G" OR "H")
                  OR (PRPNP-PENS-DST-CODE2  = "G" OR "H")
                     MOVE "B"                 TO STM-CHECK-GRP
                  ELSE
                     MOVE "A"                 TO STM-CHECK-GRP
                  END-IF
                  END-IF
                  PERFORM 820-STORE-STANDTIME
                  PERFORM 860-MODIFY-NXTRNG-STMSET6
              END-PERFORM.
              
********** END WBP MODS
P68632
003840     PERFORM 920-AUDIT-END.
003850     IF (ERROR-FOUND)
003860         GO TO 430-END.
003870
004380     IF  (PR29F1-FC = "D")
004390         MOVE CRT-RECS-DELETED       TO CRT-MESSAGE
               PERFORM
                   VARYING I1 FROM 1 BY 1
                   UNTIL  (I1 > PR29F1-TRD-CNT)
                   INITIALIZE PR29F1-LINE-FC (I1)
RETROP             INITIALIZE PR29F1-LINE-FC2 (I1)
               END-PERFORM
               GO TO 430-END.

           IF  (PR29F1-FC = "A")
               MOVE PRPNP-COMPANY          TO DB-COMPANY
               MOVE PRPNP-EMPLOYEE         TO DB-EMPLOYEE
               MOVE PRPNP-PENS-SEQ-NBR     TO DB-PENS-SEQ-NBR
               INITIALIZE                     DB-TIME-SEQ
                                              DB-PAY-CODE
                                              DB-SEQ-NBR
RETROP                                        WS-RETRO-PAYMENT
               IF  (PRPNP-PENS-DIST-TYPE-TRD)
                   PERFORM 850-FIND-NLT-TRDSET13
                   IF  (TIMERECORD-FOUND)
                   AND (TRD-COMPANY      = DB-COMPANY)
                   AND (TRD-EMPLOYEE     = DB-EMPLOYEE)
                   AND (TRD-PENS-SEQ-NBR = DB-PENS-SEQ-NBR)
RETROP             AND (TRD-RETRO-PENSION = SPACE)
                       SET PRPNP-USE-TRD TO TRUE
                       SET PRPNP-TIMERECORD-FOUND TO TRUE
                   ELSE
                       SET PRPNP-USE-NOTHING TO TRUE
                       SET PRPNP-TIMERECORD-NOTFOUND TO TRUE
                   END-IF
               ELSE
                   PERFORM 850-FIND-NLT-STMSET6
                   IF  (STANDTIME-FOUND)
                   AND (STM-COMPANY      = DB-COMPANY)
                   AND (STM-EMPLOYEE     = DB-EMPLOYEE)
                   AND (STM-PENS-SEQ-NBR = DB-PENS-SEQ-NBR)
                       SET PRPNP-STANDTIME-FOUND TO TRUE
                   ELSE
                       SET PRPNP-STANDTIME-NOTFOUND TO TRUE
                   END-IF
               END-IF.

003880     PERFORM 480-INQUIRE
003890     THRU    480-END.
003900
004200     IF  (PR29F1-FC = "A")
004210     AND (PRPNP-WARNING-FLAG = WS-TRUE)
004220          MOVE 171                   TO CRT-MSG-NBR
004230          MOVE PRPNP-EMPLOYEE-FN     TO CRT-FIELD-NBR
004240          PERFORM 790-GET-MSG
004250     ELSE
004260     IF  (PR29F1-FC = "C")
004270     AND (PRPNP-WARNING-FLAG = WS-TRUE)
004280          MOVE 172                   TO CRT-MSG-NBR
004290          MOVE PRPNP-EMPLOYEE-FN     TO CRT-FIELD-NBR
004300          PERFORM 790-GET-MSG
004310     ELSE
           IF  (CRT-MSG-NBR NOT = ZEROES)
               INITIALIZE CRT-MESSAGE
           ELSE
004320     IF  (PR29F1-FC = "A")
004330         MOVE CRT-ADD-COMPLETE       TO CRT-MESSAGE
004340     ELSE
004350     IF  (PR29F1-FC = "C")
004360         MOVE CRT-CHG-COMPLETE       TO CRT-MESSAGE.
004400
004410 430-END.
004420
004430******************************************************************
004440 480-INQUIRE.
004450******************************************************************
004460
004470     IF (PR29F1-FC = "I")
004480         MOVE "+"                     TO PR29F1-FC.
004490
004500     PERFORM 600-MOVE-TO-SCREEN
004510     THRU    600-END.
RETROP     INITIALIZE PR29F1-DETAIL-DATA.
RETROP     INITIALIZE PR29F1-DETAIL-DATA2.
GW5/03****** WBP MODS *********
           PERFORM 605-MOVE-WPN-TO-SCREEN
           THRU    605-END.

           PERFORM 610-MOVE-HEU-TO-SCREEN
           THRU    610-END.
*********  WBP MODS END
D04520
004640     IF (PRPNP-PENS-DIST-TYPE-STM)
004650         PERFORM 481-INQUIRE-STANDTIME
004660         THRU    481-END
RETROP         PERFORM 488-INQUIRE-TIMERECORD-RETRO
RETROP         THRU    488-END
004670     ELSE
004680     IF  (PRPNP-PENS-DIST-TYPE-TRD)
               IF  (PRPNP-USE-TRD)
                   PERFORM 482-INQUIRE-TIMERECORD
                   THRU    482-END
               ELSE
               IF  (PRPNP-USE-PRT)
                   PERFORM 483-INQUIRE-PRTIME
                   THRU    483-END
               ELSE
                   INITIALIZE PR29F1-DETAIL-DATA
                   MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
               END-IF.
004760
004770     PERFORM 484-INQUIRE-PRPENFSRC
004780     THRU    484-END.
004790
004800     PERFORM 485-INQUIRE-EMACHDEPST
004810     THRU    485-END.
004820
004830 480-END.
004840
004850******************************************************************
004860 481-INQUIRE-STANDTIME.
004870******************************************************************
004880
004890     IF (PR29F1-FC = "I" OR "A" OR "C" OR "N" OR "P")
004910         INITIALIZE DB-PAY-CODE
004920         INITIALIZE DB-SEQ-NBR
004930     ELSE
004940     IF (PR29F1-FC = "+")
004960         MOVE PR29F1-PT-PAY-CODE     TO DB-PAY-CODE
004970         MOVE PR29F1-PT-SEQ-NBR      TO DB-SEQ-NBR
004980     ELSE
005000         MOVE PR29F1-PAY-CODE (1)    TO DB-PAY-CODE
005010         MOVE PR29F1-SEQ-NBR  (1)    TO DB-SEQ-NBR.
005020
005030     IF (PRPNP-PENS-DIST-TYPE-STM)
005040         PERFORM 850-FIND-NLT-STMSET6
005050         IF (PR29F1-FC = "-")
005060             PERFORM 870-FIND-PREV-STMSET6.
005070
005080     MOVE STANDTIME-SW           TO PRPNP-STANDTIME-SW.
005090
005110     IF  (STANDTIME-NOTFOUND)
005120     OR (STM-COMPANY      NOT = DB-COMPANY)
005130     OR (STM-EMPLOYEE     NOT = DB-EMPLOYEE)
005140     OR (STM-PENS-SEQ-NBR NOT = DB-PENS-SEQ-NBR)
005150         SET PRPNP-STANDTIME-NOTFOUND TO TRUE
005440         MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
               GO TO 481-END.
005160
005170     MOVE STM-PROCESS-LEVEL          TO DB-PROCESS-LEVEL
005180                                        PR29F1-PROCESS-LEVEL
005190                                        PRPNP-PROCESS-LEVEL.
      *
5/03GW****  BEGIN WBP MOD
*******     ASSUMES THERE WILL BE ONLY ONE PAY-CODE ON TIME-RECORD TAB
*******     
           MOVE STM-CHECK-GRP              TO PR29F1-STM-CHECK-GRP.
      *
5/03GW****  END WBP MOD
89233      MOVE STM-PROCESS-LEVEL          TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-PRSSET1.
           IF (PRSYSTEM-FOUND)
               MOVE PRS-NAME               TO PR29F1-PROCESS-LEV-NAME.
005200
005210     MOVE STM-DEPARTMENT             TO DB-DEPARTMENT
005220                                        PR29F1-DEPARTMENT
005230                                        PRPNP-DEPARTMENT.

           MOVE STM-TAX-FREQ-OVER          TO PR29F1-TAX-FREQ-OVER
                                              PRPNP-TAX-FREQ-OVER.
           MOVE STM-PROCESS-GRP            TO PR29F1-PROCESS-GRP
                                              PRPNP-PROCESS-GRP.
005240
005250     IF (PR29F1-FC = "-")
005260         MOVE 12                     TO I1
005280         MOVE PR29F1-PAY-CODE (1)    TO PR29F1-PT-PAY-CODE
005290         MOVE PR29F1-SEQ-NBR (1)     TO PR29F1-PT-SEQ-NBR
005300         INITIALIZE PR29F1-DETAIL-DATA
005310         PERFORM 611-MOVE-STM-DTL-TO-SCREEN
005320         THRU    611-END
005330             UNTIL  (I1            < 1)
005340             OR     (STANDTIME-NOTFOUND)
005350             OR     (STM-COMPANY  NOT = PR29F1-PNP-COMPANY)
005360             OR     (STM-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
005370             OR     (STM-PENS-SEQ-NBR
005380                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
005390
005400         IF  (STANDTIME-NOTFOUND)
005410         OR  (STM-COMPANY         NOT = PR29F1-PNP-COMPANY)
005420         OR  (STM-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
005430         OR  (STM-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
005440             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
005450         ELSE
005460             MOVE CRT-MORE-RECS      TO CRT-MESSAGE
005470     ELSE
005480         MOVE 1                      TO I1
005490         INITIALIZE PR29F1-DETAIL-DATA
005500         PERFORM 611-MOVE-STM-DTL-TO-SCREEN
005510         THRU    611-END
005520             UNTIL  (I1            > PR29F1-TRD-CNT)
005530             OR     (STANDTIME-NOTFOUND)
005540             OR     (STM-COMPANY  NOT = PR29F1-PNP-COMPANY)
005550             OR     (STM-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
005560             OR     (STM-PENS-SEQ-NBR
005570                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
005580
005590         IF  (STANDTIME-NOTFOUND)
005600         OR  (STM-COMPANY         NOT = PR29F1-PNP-COMPANY)
005610         OR  (STM-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
005620         OR  (STM-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
005640             INITIALIZE                 PR29F1-PT-PAY-CODE
005650                                        PR29F1-PT-SEQ-NBR
005660             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
005670         ELSE
005690             MOVE STM-PAY-CODE       TO PR29F1-PT-PAY-CODE
005700             MOVE STM-SEQ-NBR        TO PR29F1-PT-SEQ-NBR
005710             MOVE CRT-MORE-RECS      TO CRT-MESSAGE.
005720
005730 481-END.
005740
005750******************************************************************
005760 482-INQUIRE-TIMERECORD.
005770******************************************************************
005780
005790     IF (PR29F1-FC = "I" OR "A" OR "C" OR "N" OR "P")
005800         INITIALIZE DB-TIME-SEQ
005810     ELSE
005820     IF (PR29F1-FC = "+")
005830         MOVE PR29F1-PT-TIME-SEQ     TO DB-TIME-SEQ
005840     ELSE
005850         MOVE PR29F1-TIME-SEQ (1)    TO DB-TIME-SEQ.
005860
005870     IF (PRPNP-PENS-DIST-TYPE-TRD)
005880         PERFORM 850-FIND-NLT-TRDSET13
005890         IF (PR29F1-FC = "-")
005900             PERFORM 870-FIND-PREV-TRDSET13.
005910
005920     MOVE TIMERECORD-SW          TO PRPNP-TIMERECORD-SW.
005930
RETROP     MOVE SPACE                  TO WS-RETRO-PAYMENT.
RETROP     IF  (TIMERECORD-FOUND)
RETROP     AND (TRD-COMPANY           = DB-COMPANY)
RETROP     AND (TRD-EMPLOYEE          = DB-EMPLOYEE)
RETROP     AND (TRD-PENS-SEQ-NBR      = DB-PENS-SEQ-NBR)
RETROP         IF  (TRD-RETRO-PENSION NOT = WS-RETRO-PAYMENT)
RETROP             IF (PR29F1-FC = "-")
RETROP                 PERFORM 621-PREV-TIMERECORD THRU 621-END
RETROP             ELSE
RETROP                 PERFORM 620-NEXT-TIMERECORD THRU 620-END.
RETROP
005950     IF  (TIMERECORD-NOTFOUND)
005960     OR  (TRD-COMPANY      NOT = DB-COMPANY)
005970     OR  (TRD-EMPLOYEE     NOT = DB-EMPLOYEE)
005980     OR  (TRD-PENS-SEQ-NBR NOT = DB-PENS-SEQ-NBR)
005990         SET PRPNP-TIMERECORD-NOTFOUND TO TRUE
005440         MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
               GO TO 482-END.
006000
006010     MOVE TRD-DIST-PROC-LEV          TO DB-PROCESS-LEVEL
006020                                        PR29F1-PROCESS-LEVEL
006030                                        PRPNP-PROCESS-LEVEL.
      *
89233      MOVE TRD-DIST-PROC-LEV          TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-PRSSET1.
           IF (PRSYSTEM-FOUND)
               MOVE PRS-NAME               TO PR29F1-PROCESS-LEV-NAME.
006040*
006050     MOVE TRD-DIST-DEPART            TO DB-DEPARTMENT
006060                                        PR29F1-DEPARTMENT
006070                                        PRPNP-DEPARTMENT.

           MOVE TRD-TAX-FREQ-OVER          TO PR29F1-TAX-FREQ-OVER
                                              PRPNP-TAX-FREQ-OVER.
           MOVE TRD-PROCESS-GRP            TO PR29F1-PROCESS-GRP
                                              PRPNP-PROCESS-GRP.
006080
006090     IF (PR29F1-FC = "-")
006100         MOVE 12                     TO I1
006110         MOVE PR29F1-TIME-SEQ (1)     TO PR29F1-PT-TIME-SEQ
006120         INITIALIZE PR29F1-DETAIL-DATA
006130         PERFORM 612-MOVE-TRD-DTL-TO-SCREEN
006140         THRU    612-END
006150             UNTIL  (I1            < 1)
006160             OR     (TIMERECORD-NOTFOUND)
006170             OR     (TRD-COMPANY  NOT = PR29F1-PNP-COMPANY)
006180             OR     (TRD-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
006190             OR     (TRD-PENS-SEQ-NBR
006200                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
006210
006220         IF  (TIMERECORD-NOTFOUND)
006230         OR  (TRD-COMPANY         NOT = PR29F1-PNP-COMPANY)
006240         OR  (TRD-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
006250         OR  (TRD-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
006260             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
006270         ELSE
006280             MOVE CRT-MORE-RECS      TO CRT-MESSAGE
006290     ELSE
006300         MOVE 1                      TO I1
006310         INITIALIZE PR29F1-DETAIL-DATA
006320         PERFORM 612-MOVE-TRD-DTL-TO-SCREEN
006330         THRU    612-END
006340             UNTIL  (I1            > PR29F1-TRD-CNT)
006350             OR     (TIMERECORD-NOTFOUND)
006360             OR     (TRD-COMPANY  NOT = PR29F1-PNP-COMPANY)
006370             OR     (TRD-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
006380             OR     (TRD-PENS-SEQ-NBR
006390                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
006400
006410         IF  (TIMERECORD-NOTFOUND)
006420         OR  (TRD-COMPANY         NOT = PR29F1-PNP-COMPANY)
006430         OR  (TRD-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
006440         OR  (TRD-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
006450             INITIALIZE                 PR29F1-PT-TIME-SEQ
006460             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
006470         ELSE
006480             MOVE TRD-TIME-SEQ       TO PR29F1-PT-TIME-SEQ
006490             MOVE CRT-MORE-RECS      TO CRT-MESSAGE.
006500
006510 482-END.
006520
006530******************************************************************
006540 483-INQUIRE-PRTIME.
006550******************************************************************
006560
006570     IF (PR29F1-FC = "I" OR "A" OR "C" OR "N" OR "P")
006580         INITIALIZE DB-TIME-SEQ
006590     ELSE
006600     IF (PR29F1-FC = "+")
006610         MOVE PR29F1-PT-TIME-SEQ     TO DB-TIME-SEQ
006620     ELSE
006630         MOVE PR29F1-TIME-SEQ (1)    TO DB-TIME-SEQ.
006640
006650     IF (PRPNP-PENS-DIST-TYPE-TRD)
006660         PERFORM 850-FIND-NLT-PRTSET8
006670         IF (PR29F1-FC = "-")
006680             PERFORM 870-FIND-PREV-PRTSET8.
RETROP
RETROP     MOVE SPACE                  TO WS-RETRO-PAYMENT.
RETROP     IF  (PRTIME-FOUND)
RETROP     AND (PRT-COMPANY           = DB-COMPANY)
RETROP     AND (PRT-EMPLOYEE          = DB-EMPLOYEE)
RETROP     AND (PRT-PENS-SEQ-NBR      = DB-PENS-SEQ-NBR)
RETROP         IF  (PRT-RETRO-PENSION NOT = WS-RETRO-PAYMENT)
RETROP             IF (PR29F1-FC = "-")
RETROP                 PERFORM 623-PREV-PRTIME THRU 623-END
RETROP             ELSE
RETROP                 PERFORM 622-NEXT-PRTIME THRU 622-END.
RETROP
005950     IF  (PRTIME-NOTFOUND)
005960     OR  (PRT-COMPANY      NOT = DB-COMPANY)
005970     OR  (PRT-EMPLOYEE     NOT = DB-EMPLOYEE)
005980     OR  (PRT-PENS-SEQ-NBR NOT = DB-PENS-SEQ-NBR)
005440         MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
               GO TO 483-END.

006700     MOVE PRT-PROCESS-LEVEL          TO DB-PROCESS-LEVEL
006710                                        PR29F1-PROCESS-LEVEL
006720                                        PRPNP-PROCESS-LEVEL.
      *
89233      MOVE PRT-PROCESS-LEVEL          TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-PRSSET1.
           IF (PRSYSTEM-FOUND)
               MOVE PRS-NAME               TO PR29F1-PROCESS-LEV-NAME.
006730
006740     MOVE PRT-DEPARTMENT             TO DB-DEPARTMENT
006750                                        PR29F1-DEPARTMENT
006760                                        PRPNP-DEPARTMENT.

           MOVE PRT-TAX-FREQ-OVER          TO PR29F1-TAX-FREQ-OVER
                                              PRPNP-TAX-FREQ-OVER.
           INITIALIZE                         PR29F1-PROCESS-GRP
                                              PRPNP-PROCESS-GRP.
006770
006780     IF (PR29F1-FC = "-")
006790         MOVE 12                     TO I1
006800         MOVE PR29F1-CHECK-ID (1)     TO PR29F1-PT-CHECK-ID
006810         MOVE PR29F1-TIME-SEQ (1)     TO PR29F1-PT-TIME-SEQ
006820         INITIALIZE PR29F1-DETAIL-DATA
006830         PERFORM 613-MOVE-DTL-TO-SCREEN
006840         THRU    613-END
006850             UNTIL  (I1            < 1)
006860             OR     (PRTIME-NOTFOUND)
006870             OR     (PRT-COMPANY  NOT = PR29F1-PNP-COMPANY)
006880             OR     (PRT-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
006890             OR     (PRT-PENS-SEQ-NBR
006900                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
006910
006920         IF  (PRTIME-NOTFOUND)
006930         OR  (PRT-COMPANY         NOT = PR29F1-PNP-COMPANY)
006940         OR  (PRT-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
006950         OR  (PRT-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
006960             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
006970         ELSE
006980             MOVE CRT-MORE-RECS      TO CRT-MESSAGE
006990     ELSE
007000         MOVE 1                      TO I1
007010         INITIALIZE PR29F1-DETAIL-DATA
007020         PERFORM 613-MOVE-DTL-TO-SCREEN
007030         THRU    613-END
007040             UNTIL  (I1            > PR29F1-TRD-CNT)
007050             OR     (PRTIME-NOTFOUND)
007060             OR     (PRT-COMPANY  NOT = PR29F1-PNP-COMPANY)
007070             OR     (PRT-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
007080             OR     (PRT-PENS-SEQ-NBR
007090                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
007100
007110         IF  (PRTIME-NOTFOUND)
007120         OR  (PRT-COMPANY         NOT = PR29F1-PNP-COMPANY)
007130         OR  (PRT-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
007140         OR  (PRT-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
007150             INITIALIZE                 PR29F1-PT-CHECK-ID
007160             INITIALIZE                 PR29F1-PT-TIME-SEQ
007170             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
007180         ELSE
007190             MOVE PRT-CHECK-ID       TO PR29F1-PT-CHECK-ID
007200             MOVE PRT-TIME-SEQ       TO PR29F1-PT-TIME-SEQ
007210             MOVE CRT-MORE-RECS      TO CRT-MESSAGE.
007220
007230 483-END.
007240
007250******************************************************************
007260 484-INQUIRE-PRPENFSRC.
007270******************************************************************
007280
007290     MOVE PNP-COMPANY            TO DB-COMPANY.
007300     MOVE PNP-EMPLOYEE           TO DB-EMPLOYEE.
007310     MOVE PNP-PENS-SEQ-NBR       TO DB-PENS-SEQ-NBR.
007320     MOVE PNFSET1-PENS-SEQ-NBR   TO WS-DB-BEG-RNG.
007330     PERFORM 850-FIND-BEGRNG-PNFSET1.
007340
007350     MOVE 1                      TO I1.
007360     INITIALIZE PR29F1-PNF-DETAIL-DATA
007370                PR29F1-DISTRIBUTION-AMT.
007380     PERFORM
007390        UNTIL (PRPENFSRC-NOTFOUND)
007400          OR  (I1 >  PR29F1-SRC-CNT)
007410
RETROP         IF (PNF-RETRO-PAYMENT = SPACES)
007420           MOVE PNF-FUNDING-SOURCE TO PRPNP-STB-FUNDING-SOURCE(I1)
007440           MOVE PNF-FUND-AMOUNT    TO PRPNP-STB-FUND-AMOUNT   (I1)
007450           MOVE PNF-PAYMENT-DESC   TO PRPNP-STB-PAYMENT-DESC  (I1)

007470           COMPUTE PR29F1-DISTRIBUTION-AMT
007480                 = PR29F1-DISTRIBUTION-AMT
007490                 + PNF-FUND-AMOUNT
RETROP           PERFORM 534-MOVE-SRC-WS-TO-SCR
RETROP           THRU    534-END
007520
007530           COMPUTE I1 = I1 + 1
RETROP         END-IF
007540
007550         PERFORM 860-FIND-NXTRNG-PNFSET1
007560
007570     END-PERFORM.
007580
RETROP     MOVE PNP-COMPANY            TO DB-COMPANY.
RETROP     MOVE PNP-EMPLOYEE           TO DB-EMPLOYEE.
RETROP     MOVE PNP-PENS-SEQ-NBR       TO DB-PENS-SEQ-NBR.
RETROP     MOVE PNFSET1-PENS-SEQ-NBR   TO WS-DB-BEG-RNG.
RETROP     PERFORM 850-FIND-BEGRNG-PNFSET1.
RETROP
RETROP     MOVE 1                      TO I1.
RETROP     INITIALIZE PR29F1-PNF-DETAIL-DATA2
RETROP                PR29F1-DISTRIBUTION-AMT2.
RETROP     PERFORM
RETROP        UNTIL (PRPENFSRC-NOTFOUND)
RETROP          OR  (I1 >  PR29F1-SRC-CNT)
RETROP
RETROP            IF (PNF-RETRO-PAYMENT = "Y")
RETROP               MOVE PNF-FUNDING-SOURCE TO
RETROP                    PRPNP-STB-FUNDING-SOURCE2 (I1)
RETROP               MOVE PNF-FUND-AMOUNT    TO
RETROP                    PRPNP-STB-FUND-AMOUNT2   (I1)
RETROP               MOVE PNF-PAYMENT-DESC   TO
RETROP                    PRPNP-STB-PAYMENT-DESC2  (I1)
RETROP           END-IF
RETROP
RETROP           IF (PNF-RETRO-PAYMENT = "Y")
RETROP               COMPUTE PR29F1-DISTRIBUTION-AMT2
RETROP                     = PR29F1-DISTRIBUTION-AMT2
RETROP                     + PNF-FUND-AMOUNT
RETROP               PERFORM 535-MOVE-SRC-WS-TO-SCR
RETROP               THRU    535-END
RETROP
RETROP              COMPUTE I1 = I1 + 1
RETROP           END-IF
RETROP           PERFORM 860-FIND-NXTRNG-PNFSET1
RETROP
RETROP     END-PERFORM.
007580
007590 484-END.
007600
007610******************************************************************
007620 485-INQUIRE-EMACHDEPST.
007630******************************************************************
007640
007650     MOVE PNP-COMPANY            TO DB-COMPANY.
007660     MOVE PNP-EMPLOYEE           TO DB-EMPLOYEE.
007670     MOVE PNP-PENS-SEQ-NBR       TO DB-PENS-SEQ-NBR.
007680     MOVE EADSET8-PENS-SEQ-NBR   TO WS-DB-BEG-RNG.
007690     PERFORM 850-FIND-BEGRNG-EADSET8.
007700     IF (EMACHDEPST-FOUND)
007710         MOVE EAD-EBANK-ID       TO PR29F1-EAD-EBANK-ID
007720         MOVE EAD-DESCRIPTION    TO PR29F1-EAD-DESCRIPTION
007730         MOVE EAD-EBNK-ACCT-NBR  TO PR29F1-EAD-EBNK-ACCT-NBR
007740         MOVE EAD-ACCOUNT-TYPE   TO PR29F1-EAD-ACCOUNT-TYPE
007750         MOVE EAD-CHECK-DESC     TO PR29F1-EAD-CHECK-DESC
007780     ELSE
007790         INITIALIZE                 PR29F1-EAD-EBANK-ID
007800                                    PR29F1-EAD-DESCRIPTION
007810                                    PR29F1-EAD-EBNK-ACCT-NBR
007820                                    PR29F1-EAD-ACCOUNT-TYPE
007830                                    PR29F1-EAD-CHECK-DESC.
007860
007870 485-END.

RETROP******************************************************************
RETROP 488-INQUIRE-TIMERECORD-RETRO.
RETROP******************************************************************
RETROP
RETROP     IF (PR29F1-FC = "I" OR "A" OR "C" OR "N" OR "P")
RETROP         INITIALIZE DB-TIME-SEQ
RETROP     ELSE
RETROP     IF (PR29F1-FC = "+")
RETROP         MOVE PR29F1-PT-TIME-SEQ2     TO DB-TIME-SEQ
RETROP     ELSE
RETROP         MOVE PR29F1-TIME-SEQ2 (1)    TO DB-TIME-SEQ.
RETROP
RETROP     PERFORM 850-FIND-NLT-TRDSET13.
RETROP     IF (PR29F1-FC = "-")
RETROP         PERFORM 870-FIND-PREV-TRDSET13.
RETROP
RETROP     MOVE TIMERECORD-SW          TO PRPNP-TIMERECORD-SW.
RETROP
RETROP     MOVE "Y"                    TO WS-RETRO-PAYMENT.
RETROP     IF  (TIMERECORD-FOUND)
RETROP     AND (TRD-COMPANY           = DB-COMPANY)
RETROP     AND (TRD-EMPLOYEE          = DB-EMPLOYEE)
RETROP     AND (TRD-PENS-SEQ-NBR      = DB-PENS-SEQ-NBR)
RETROP         IF  (TRD-RETRO-PENSION NOT = WS-RETRO-PAYMENT)
RETROP             IF (PR29F1-FC = "-")
RETROP                 PERFORM 621-PREV-TIMERECORD THRU 621-END
RETROP             ELSE
RETROP                 PERFORM 620-NEXT-TIMERECORD THRU 620-END.
RETROP
RETROP     IF  (TIMERECORD-NOTFOUND)
RETROP     OR  (TRD-COMPANY       NOT = DB-COMPANY)
RETROP     OR  (TRD-EMPLOYEE      NOT = DB-EMPLOYEE)
RETROP     OR  (TRD-PENS-SEQ-NBR  NOT = DB-PENS-SEQ-NBR)
RETROP         INITIALIZE PR29F1-DETAIL-DATA2
RETROP         SET PRPNP-TIMERECORD-NOTFOUND TO TRUE
RETROP         MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
RETROP         GO TO 488-END.
RETROP
RETROP     MOVE TRD-DIST-PROC-LEV          TO DB-PROCESS-LEVEL
RETROP                                        PR29F1-PROCESS-LEVEL
RETROP                                        PRPNP-PROCESS-LEVEL.
RETROP
RETROP     MOVE TRD-DIST-DEPART            TO DB-DEPARTMENT
RETROP                                        PR29F1-DEPARTMENT
RETROP                                        PRPNP-DEPARTMENT.
RETROP
RETROP     MOVE TRD-TAX-FREQ-OVER          TO PR29F1-TAX-FREQ-OVER
RETROP                                        PRPNP-TAX-FREQ-OVER.
RETROP     MOVE TRD-PROCESS-GRP            TO PR29F1-PROCESS-GRP
RETROP                                        PRPNP-PROCESS-GRP.
RETROP
RETROP     IF (PR29F1-FC = "-")
RETROP         MOVE 12                     TO I1
RETROP         MOVE PR29F1-TIME-SEQ2 (1)     TO PR29F1-PT-TIME-SEQ2
RETROP         INITIALIZE PR29F1-DETAIL-DATA2
RETROP         PERFORM 614-MOVE-TRD-DTL-TO-SCREEN
RETROP         THRU    614-END
RETROP             UNTIL  (I1            < 1)
RETROP             OR     (TIMERECORD-NOTFOUND)
RETROP             OR     (TRD-COMPANY  NOT = PR29F1-PNP-COMPANY)
RETROP             OR     (TRD-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
RETROP             OR     (TRD-PENS-SEQ-NBR
RETROP                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
RETROP
RETROP         IF  (TIMERECORD-NOTFOUND)
RETROP         OR  (TRD-COMPANY         NOT = PR29F1-PNP-COMPANY)
RETROP         OR  (TRD-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
RETROP         OR  (TRD-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
RETROP             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
RETROP         ELSE
RETROP             MOVE CRT-MORE-RECS      TO CRT-MESSAGE
RETROP     ELSE
RETROP         MOVE 1                      TO I1
RETROP         INITIALIZE PR29F1-DETAIL-DATA2
RETROP         PERFORM 614-MOVE-TRD-DTL-TO-SCREEN
RETROP         THRU    614-END
RETROP             UNTIL  (I1            > PR29F1-TRD-CNT)
RETROP             OR     (TIMERECORD-NOTFOUND)
RETROP             OR     (TRD-COMPANY  NOT = PR29F1-PNP-COMPANY)
RETROP             OR     (TRD-EMPLOYEE NOT = PR29F1-PNP-EMPLOYEE)
RETROP             OR     (TRD-PENS-SEQ-NBR
RETROP                                  NOT = PR29F1-PNP-PENS-SEQ-NBR)
RETROP
RETROP         IF  (TIMERECORD-NOTFOUND)
RETROP         OR  (TRD-COMPANY         NOT = PR29F1-PNP-COMPANY)
RETROP         OR  (TRD-EMPLOYEE        NOT = PR29F1-PNP-EMPLOYEE)
RETROP         OR  (TRD-PENS-SEQ-NBR    NOT = PR29F1-PNP-PENS-SEQ-NBR)
RETROP             INITIALIZE                 PR29F1-PT-TIME-SEQ2
RETROP             MOVE CRT-INQ-COMPLETE   TO CRT-MESSAGE
RETROP         ELSE
RETROP             MOVE TRD-TIME-SEQ       TO PR29F1-PT-TIME-SEQ2
RETROP             MOVE CRT-MORE-RECS      TO CRT-MESSAGE.
RETROP
RETROP 488-END.
007880
007890******************************************************************
007900 500-MOVE-SCR-TO-WS.
007910******************************************************************
007920
007930     INITIALIZE PRPNP-SCR-FIELDS.
007940
007950     IF (PR29F1-FC = "N" OR "P")
007960         MOVE "I"                    TO PRPNP-FC
007970     ELSE
007980         MOVE PR29F1-FC              TO PRPNP-FC.
007990
008000     MOVE PR29F1-FC-FN               TO PRPNP-FC-FN.
008010     MOVE PR29F1-PNP-COMPANY         TO PRPNP-COMPANY.
008020     MOVE PR29F1-PNP-COMPANY-FN      TO PRPNP-COMPANY-FN.
008030     MOVE PR29F1-PNP-EMPLOYEE        TO PRPNP-EMPLOYEE.
008040     MOVE PR29F1-PNP-EMPLOYEE-FN     TO PRPNP-EMPLOYEE-FN.
008050     MOVE PR29F1-PNP-EFFECT-DATE     TO PRPNP-EFFECT-DATE.
008060     MOVE PR29F1-PNP-EFFECT-DATE-FN  TO PRPNP-EFFECT-DATE-FN.
008070     MOVE PR29F1-PNP-END-DATE        TO PRPNP-END-DATE.
008080     MOVE PR29F1-PNP-END-DATE-FN     TO PRPNP-END-DATE-FN.
008090     MOVE PR29F1-PNP-PENS-SEQ-NBR    TO PRPNP-PENS-SEQ-NBR.
008100     MOVE PR29F1-PNP-PENS-SEQ-NBR-FN TO PRPNP-PENS-SEQ-NBR-FN.
008110
008120     IF (PR29F1-PROCESS-LEVEL = SPACES)
008130         MOVE EMP-PROCESS-LEVEL      TO PRPNP-PROCESS-LEVEL
008140     ELSE
008150         MOVE PR29F1-PROCESS-LEVEL   TO PRPNP-PROCESS-LEVEL.
008160     MOVE PR29F1-PROCESS-LEVEL-FN    TO PRPNP-PROCESS-LEVEL-FN.
008170
P54988     IF (PR29F1-DEPARTMENT = SPACES)
P54988         MOVE EMP-DEPARTMENT         TO PRPNP-DEPARTMENT
P54988                                        PR29F1-DEPARTMENT
P54988     ELSE
008210         MOVE PR29F1-DEPARTMENT      TO PRPNP-DEPARTMENT.
008220     MOVE PR29F1-DEPARTMENT-FN       TO PRPNP-DEPARTMENT-FN.
008230
008240     MOVE PR29F1-TAX-FREQ-OVER       TO PRPNP-TAX-FREQ-OVER.
008250     MOVE PR29F1-TAX-FREQ-OVER-FN    TO PRPNP-TAX-FREQ-OVER-FN.
008260     MOVE PR29F1-PROCESS-GRP         TO PRPNP-PROCESS-GRP.
008270     MOVE PR29F1-PROCESS-GRP-FN      TO PRPNP-PROCESS-GRP-FN.
008280
008290     MOVE PR29F1-PNP-END-DATE        TO PRPNP-END-DATE.
008300     MOVE PR29F1-PNP-END-DATE-FN     TO PRPNP-END-DATE-FN.
008310     MOVE PR29F1-PNP-PENS-DIST-TYPE  TO PRPNP-PENS-DIST-TYPE.
008320     MOVE PR29F1-PNP-PENS-DIST-TYPE-FN
008330                                     TO PRPNP-PENS-DIST-TYPE-FN.
008340     MOVE PR29F1-PNP-PENS-DIST-CODE  TO PRPNP-PENS-DIST-CODE.
008350     MOVE PR29F1-PNP-PENS-DIST-CODE-FN
008360                                     TO PRPNP-PENS-DIST-CODE-FN.
008370     MOVE PR29F1-PNP-PENS-DST-CODE2  TO PRPNP-PENS-DST-CODE2.
008380     MOVE PR29F1-PNP-PENS-DST-CODE2-FN
008390                                     TO PRPNP-PENS-DST-CODE2-FN.
008400     MOVE PR29F1-PNP-TAX-CATEGORY    TO PRPNP-TAX-CATEGORY.
008410     MOVE PR29F1-PNP-TAX-CATEGORY-FN TO PRPNP-TAX-CATEGORY-FN.
008420     MOVE PR29F1-PNP-ADDL-FED-TAX    TO PRPNP-ADDL-FED-TAX.
008430     MOVE PR29F1-PNP-ADDL-FED-TAX-FN TO PRPNP-ADDL-FED-TAX-FN.
008440     MOVE PR29F1-PNP-PERC-TOT-DIST   TO PRPNP-PERC-TOT-DIST.
008450     MOVE PR29F1-PNP-PERC-TOT-DIST-FN
008460                                     TO PRPNP-PERC-TOT-DIST-FN.
008470     MOVE PR29F1-PNP-PAYABLE-TO      TO PRPNP-PAYABLE-TO.
008480     MOVE PR29F1-PNP-PAYABLE-TO-FN   TO PRPNP-PAYABLE-TO-FN.
008490     MOVE PR29F1-PNP-FBO-NAME        TO PRPNP-FBO-NAME.
008500     MOVE PR29F1-PNP-FBO-NAME-FN     TO PRPNP-FBO-NAME-FN.
008510     MOVE PR29F1-PNP-ADDR1           TO PRPNP-ADDR1.
008520     MOVE PR29F1-PNP-ADDR1-FN        TO PRPNP-ADDR1-FN.
008530     MOVE PR29F1-PNP-ADDR2           TO PRPNP-ADDR2.
008540     MOVE PR29F1-PNP-ADDR2-FN        TO PRPNP-ADDR2-FN.
008550     MOVE PR29F1-PNP-ADDR3           TO PRPNP-ADDR3.
008560     MOVE PR29F1-PNP-ADDR3-FN        TO PRPNP-ADDR3-FN.
008570     MOVE PR29F1-PNP-ADDR4           TO PRPNP-ADDR4.
008580     MOVE PR29F1-PNP-ADDR4-FN        TO PRPNP-ADDR4-FN.
008590     MOVE PR29F1-PNP-CITY            TO PRPNP-CITY.
008600     MOVE PR29F1-PNP-CITY-FN         TO PRPNP-CITY-FN.
008610     MOVE PR29F1-PNP-STATE           TO PRPNP-STATE.
008620     MOVE PR29F1-PNP-STATE-FN        TO PRPNP-STATE-FN.
008630     MOVE PR29F1-PNP-POSTAL-CODE     TO PRPNP-POSTAL-CODE.
008640     MOVE PR29F1-PNP-POSTAL-CODE-FN  TO PRPNP-POSTAL-CODE-FN.
008650     MOVE PR29F1-PNP-COUNTRY-CODE-FN TO PRPNP-COUNTRY-CODE-FN.
008660     MOVE PR29F1-PNP-COUNTRY-CODE    TO PRPNP-COUNTRY-CODE.
008670     MOVE PR29F1-PNP-ROLLOVER-ACCT   TO PRPNP-ROLLOVER-ACCT.
008680     MOVE PR29F1-PNP-ROLLOVER-ACCT-FN
008690                                     TO PRPNP-ROLLOVER-ACCT-FN.
008700     MOVE PR29F1-PNP-MISCELLANEOUS   TO PRPNP-MISCELLANEOUS.
008710     MOVE PR29F1-PNP-MISCELLANEOUS-FN
008720                                     TO PRPNP-MISCELLANEOUS-FN.
008730     MOVE PR29F1-PNP-MISCELLANEOUS2  TO PRPNP-MISCELLANEOUS2.
008740     MOVE PR29F1-PNP-MISCELLANEOUS2-FN
008750                                     TO PRPNP-MISCELLANEOUS2-FN.
008760     MOVE PR29F1-EAD-EBANK-ID        TO PRPNP-EAD-EBANK-ID.
008770     MOVE PR29F1-EAD-EBANK-ID-FN     TO PRPNP-EAD-EBANK-ID-FN.
008780     MOVE PR29F1-EAD-DESCRIPTION     TO PRPNP-EAD-DESCRIPTION.
008790     MOVE PR29F1-EAD-DESCRIPTION-FN  TO PRPNP-EAD-DESCRIPTION-FN.
008800     MOVE PR29F1-EAD-EBNK-ACCT-NBR   TO PRPNP-EAD-EBNK-ACCT-NBR.
008810     MOVE PR29F1-EAD-EBNK-ACCT-NBR-FN
008820                                    TO PRPNP-EAD-EBNK-ACCT-NBR-FN.
008830     MOVE PR29F1-EAD-ACCOUNT-TYPE    TO PRPNP-EAD-ACCOUNT-TYPE.
008840     MOVE PR29F1-EAD-ACCOUNT-TYPE-FN TO PRPNP-EAD-ACCOUNT-TYPE-FN.
008850     MOVE PR29F1-EAD-CHECK-DESC      TO PRPNP-EAD-CHECK-DESC.
008860     MOVE PR29F1-EAD-CHECK-DESC-FN   TO PRPNP-EAD-CHECK-DESC-FN.
008870     MOVE PR29F1-PNP-WIRE-IND        TO PRPNP-WIRE-IND.
008880     MOVE PR29F1-PNP-WIRE-IND-FN     TO PRPNP-WIRE-IND-FN.
008890     MOVE PR29F1-PNP-CA-EFT          TO PRPNP-CA-EFT.
008900     MOVE PR29F1-PNP-CA-EFT-FN       TO PRPNP-CA-EFT-FN.
J93849     MOVE PR29F1-PNP-IAT             TO PRPNP-PNP-IAT.
008910
008920 500-END.
008930
008940******************************************************************
008950 501-MOVE-SRC-SCR-TO-WS.
008960******************************************************************
008970
           IF  (PR29F1-PNF-FUNDING-SOURCE (I1) = SPACES)
RETROP         GO TO 501-NEXT.

           ADD 1                       TO I2.
009000     MOVE PR29F1-PNF-FUNDING-SOURCE (I1)
009010                             TO PRPNP-STB-FUNDING-SOURCE  (I2).
009020     MOVE PR29F1-PNF-FUNDING-SOURCE-FN(I1)
009030                             TO PRPNP-STB-FUNDING-SOURCE-FN(I2).
009040     MOVE PR29F1-PNF-FUND-AMOUNT (I1)
009050                             TO PRPNP-STB-FUND-AMOUNT     (I2).
009060     MOVE PR29F1-PNF-FUND-AMOUNT-FN(I1)
009070                             TO PRPNP-STB-FUND-AMOUNT-FN  (I2).
009080     MOVE PR29F1-PNF-PAYMENT-DESC   (I1)
009090                             TO PRPNP-STB-PAYMENT-DESC    (I2).
009100     MOVE PR29F1-PNF-PAYMENT-DESC-FN(I1)
009110                             TO PRPNP-STB-PAYMENT-DESC-FN (I2).
009120
RETROP 501-NEXT.
RETROP
RETROP     IF  (PR29F1-PNF-FUNDING-SOURCE (I1) = SPACES)
RETROP         ADD 1                       TO I2
RETROP     END-IF.
RETROP
RETROP     MOVE PR29F1-PNF-FUNDING-SOURCE2 (I1)
RETROP                             TO PRPNP-STB-FUNDING-SOURCE2  (I2).
RETROP     MOVE PR29F1-PNF-FUNDING-SOURCE2-FN (I1)    
RETROP                             TO PRPNP-STB-FUNDING-SOURCE2-FN(I2).
RETROP     MOVE PR29F1-PNF-FUND-AMOUNT2 (I1)
RETROP                             TO PRPNP-STB-FUND-AMOUNT2     (I2).
RETROP     MOVE PR29F1-PNF-FUND-AMOUNT2-FN (I1)   
RETROP                             TO PRPNP-STB-FUND-AMOUNT2-FN  (I2).
RETROP     MOVE PR29F1-PNF-PAYMENT-DESC2    (I1)
RETROP                             TO PRPNP-STB-PAYMENT-DESC2    (I2).
RETROP     MOVE PR29F1-PNF-PAYMENT-DESC2-FN (I1)   
RETROP                             TO PRPNP-STB-PAYMENT-DESC2-FN (I2).
RETROP
009130 501-END.
009140
009150******************************************************************
009160 502-MOVE-TIME-SCR-TO-WS.
009170******************************************************************
009180
           IF  (PR29F1-LINE-FC (I1) = SPACES)
RETROP         GO TO 502-NEXT.

           ADD 1                       TO I2.
009190     MOVE PR29F1-LINE-FC    (I1)   TO PRPNP-TTB-LINE-FC     (I2).
009200     MOVE PR29F1-LINE-FC-FN (I1)   TO PRPNP-TTB-LINE-FC-FN  (I2).
009230     MOVE PR29F1-SEQ-NBR    (I1)   TO PRPNP-TTB-SEQ-NBR     (I2).
009240     MOVE PR29F1-SEQ-NBR-FN (I1)   TO PRPNP-TTB-SEQ-NBR-FN  (I2).
009250     MOVE PR29F1-TIME-SEQ   (I1)   TO PRPNP-TTB-TIME-SEQ    (I2).
009260     MOVE PR29F1-TIME-SEQ-FN(I1)   TO PRPNP-TTB-TIME-SEQ-FN (I2).
009270     MOVE PR29F1-CHECK-ID   (I1)   TO PRPNP-TTB-CHECK-ID    (I2).
009280     MOVE PR29F1-CHECK-ID-FN(I1)   TO PRPNP-TTB-CHECK-ID-FN (I2).
009290     MOVE PR29F1-PAY-CODE   (I1)   TO PRPNP-TTB-PAY-CODE    (I2).
009300     MOVE PR29F1-PAY-CODE-FN(I1)   TO PRPNP-TTB-PAY-CODE-FN (I2).
           MOVE I1                       TO PRPNP-TTB-LINE-NBR (I2).
009310
009320     IF (PRPNP-RATE-SECURED)
009330         MOVE PR29F1-RATE1(I1)     TO PRPNP-TTB-RATE (I2)
009340     ELSE
009350         MOVE PR29F1-RATE (I1)     TO PRPNP-TTB-RATE (I2).
009360
009370     MOVE PR29F1-RATE-FN  (I1)     TO PRPNP-TTB-RATE-FN (I2).
009380
RETROP 502-NEXT.
RETROP
RETROP     IF  (PR29F1-LINE-FC2 (I1) = SPACES)
RETROP         GO TO 502-END.
RETROP
RETROP     IF  (PR29F1-LINE-FC (I1) = SPACES)
RETROP          ADD 1                       TO I2
RETROP     END-IF.
RETROP
RETROP     MOVE PR29F1-LINE-FC2   (I1)    TO PRPNP-TTB-LINE-FC2    (I2).
RETROP     MOVE PR29F1-LINE-FC2-FN (I1)   TO PRPNP-TTB-LINE-FC2-FN (I2).
RETROP     MOVE PR29F1-SEQ-NBR2    (I1)   TO PRPNP-TTB-SEQ-NBR2    (I2).
RETROP     MOVE PR29F1-SEQ-NBR2-FN (I1)   TO PRPNP-TTB-SEQ-NBR2-FN (I2).
RETROP     MOVE PR29F1-TIME-SEQ2   (I1)   TO PRPNP-TTB-TIME-SEQ2   (I2).
RETROP     MOVE PR29F1-TIME-SEQ2-FN (I1)  TO PRPNP-TTB-TIME-SEQ2-FN(I2).
RETROP     MOVE PR29F1-CHECK-ID2   (I1)   TO PRPNP-TTB-CHECK-ID2   (I2).
RETROP     MOVE PR29F1-CHECK-ID2-FN (I1)  TO PRPNP-TTB-CHECK-ID2-FN(I2).
RETROP     MOVE PR29F1-PAY-CODE2   (I1)   TO PRPNP-TTB-PAY-CODE2   (I2).
RETROP     MOVE PR29F1-PAY-CODE2-FN (I1)  TO PRPNP-TTB-PAY-CODE2-FN(I2).
RETROP     MOVE PR29F1-RETRO-PAYMENT2 (I1) TO PRPNP-RETRO-PAYMENT2 (I2).
RETROP     MOVE PR29F1-RETRO-PAYMENT2-FN (I1) TO
RETROP          PRPNP-RETRO-PAYMENT2-FN (I2).
RETROP     MOVE I1                        TO PRPNP-TTB-LINE-NBR2 (I2).
RETROP
RETROP     IF (PRPNP-RATE-SECURED)
RETROP         MOVE PR29F1-RATE12(I1)    TO PRPNP-TTB-RATE2 (I2)
RETROP     ELSE
RETROP         MOVE PR29F1-RATE2 (I1)    TO PRPNP-TTB-RATE2 (I2).
RETROP
RETROP     MOVE PR29F1-RATE2-FN (I1)     TO PRPNP-TTB-RATE2-FN (I2).
RETROP
009390 502-END.
009400
009410******************************************************************
009420 530-MOVE-WS-TO-SCR.
009430******************************************************************
009440
009450     MOVE PRPNP-COMPANY            TO PR29F1-PNP-COMPANY.
009460     MOVE PRPNP-EMPLOYEE           TO PR29F1-PNP-EMPLOYEE.
009470     MOVE PRPNP-EFFECT-DATE        TO PR29F1-PNP-EFFECT-DATE.
009480     MOVE PRPNP-END-DATE           TO PR29F1-PNP-END-DATE.
009490     MOVE PRPNP-PENS-SEQ-NBR       TO PR29F1-PNP-PENS-SEQ-NBR.
009500     MOVE PRPNP-TAX-FREQ-OVER      TO PR29F1-TAX-FREQ-OVER.
009510     MOVE PRPNP-PROCESS-GRP        TO PR29F1-PROCESS-GRP.
009520     MOVE PRPNP-END-DATE           TO PR29F1-PNP-END-DATE.
009530     MOVE PRPNP-PENS-DIST-TYPE     TO PR29F1-PNP-PENS-DIST-TYPE.
009540     MOVE PRPNP-PENS-DIST-CODE     TO PR29F1-PNP-PENS-DIST-CODE.
009550     MOVE PRPNP-PENS-DST-CODE2     TO PR29F1-PNP-PENS-DST-CODE2.
009560     MOVE PRPNP-TAX-CATEGORY       TO PR29F1-PNP-TAX-CATEGORY.
009570     MOVE PRPNP-ADDL-FED-TAX       TO PR29F1-PNP-ADDL-FED-TAX.
009580     MOVE PRPNP-PERC-TOT-DIST      TO PR29F1-PNP-PERC-TOT-DIST.
009590     MOVE PRPNP-PAYABLE-TO         TO PR29F1-PNP-PAYABLE-TO.
009600     MOVE PRPNP-FBO-NAME           TO PR29F1-PNP-FBO-NAME.
009610     MOVE PRPNP-ADDR1              TO PR29F1-PNP-ADDR1.
009620     MOVE PRPNP-ADDR2              TO PR29F1-PNP-ADDR2.
009630     MOVE PRPNP-ADDR3              TO PR29F1-PNP-ADDR3.
009640     MOVE PRPNP-ADDR4              TO PR29F1-PNP-ADDR4.
009650     MOVE PRPNP-CITY               TO PR29F1-PNP-CITY.
009660     MOVE PRPNP-STATE              TO PR29F1-PNP-STATE.
009670     MOVE PRPNP-POSTAL-CODE        TO PR29F1-PNP-POSTAL-CODE.
009680     MOVE PRPNP-COUNTRY-CODE       TO PR29F1-PNP-COUNTRY-CODE.
009690     MOVE PRPNP-ROLLOVER-ACCT      TO PR29F1-PNP-ROLLOVER-ACCT.
009700     MOVE PRPNP-MISCELLANEOUS      TO PR29F1-PNP-MISCELLANEOUS.
009710     MOVE PRPNP-MISCELLANEOUS2     TO PR29F1-PNP-MISCELLANEOUS2.
009720     MOVE PRPNP-EAD-EBANK-ID       TO PR29F1-EAD-EBANK-ID.
009730     MOVE PRPNP-EAD-DESCRIPTION    TO PR29F1-EAD-DESCRIPTION.
009740     MOVE PRPNP-EAD-EBNK-ACCT-NBR  TO PR29F1-EAD-EBNK-ACCT-NBR.
009750     MOVE PRPNP-EAD-ACCOUNT-TYPE   TO PR29F1-EAD-ACCOUNT-TYPE.
009760     MOVE PRPNP-EAD-CHECK-DESC     TO PR29F1-EAD-CHECK-DESC.
009770     MOVE PRPNP-WIRE-IND           TO PR29F1-PNP-WIRE-IND.
009780     MOVE PRPNP-CA-EFT             TO PR29F1-PNP-CA-EFT.
J93849     MOVE PRPNP-PNP-IAT            TO PR29F1-PNP-IAT.
009790
009800 530-END.
009810
009820******************************************************************
009830 531-MOVE-SRC-WS-TO-SCR.
009840******************************************************************
009850
009860     MOVE PRPNP-STB-FUNDING-SOURCE (I1)
009870                                 TO PR29F1-PNF-FUNDING-SOURCE(I1).
009890     MOVE PRPNP-STB-FUND-AMOUNT (I1)
009900                                 TO PR29F1-PNF-FUND-AMOUNT   (I1).
           INITIALIZE                     PR29F1-PNF-PAYMENT-DESC  (I1)
                                          PR29F1-GLM-DESCRIPTION (I1).
009930
009940     MOVE PR29F1-PNP-COMPANY     TO DB-COMPANY.
           MOVE PR29F1-PROCESS-LEVEL   TO DB-PROCESS-LEVEL.
           MOVE PR29F1-DEPARTMENT      TO DB-DEPARTMENT.
009980     MOVE PR29F1-PNF-FUNDING-SOURCE (I1)
009990                                 TO DB-FUNDING-SOURCE.
010000     PERFORM 840-FIND-PFSSET1.
013220     IF (PRFUNDSRC-NOTFOUND)
013230         INITIALIZE                    DB-DEPARTMENT
013240         PERFORM 840-FIND-PFSSET1
013250         IF (PRFUNDSRC-NOTFOUND)
013260             INITIALIZE                DB-PROCESS-LEVEL
013270             PERFORM 840-FIND-PFSSET1
013280             IF (PRFUNDSRC-NOTFOUND)
RETROP                GO TO 531-NEXT.

010040     MOVE PFS-PAYMENT-DESC       TO PR29F1-PNF-PAYMENT-DESC (I1).
010080
010100     MOVE PFS-DIST-COMPANY       TO IFACWS-COMPANY.
010110     MOVE PFS-DST-ACCT-UNIT      TO IFACWS-ACCT-UNIT.
010120     MOVE PFS-DST-ACCOUNT        TO IFACWS-ACCOUNT.
010130     MOVE PFS-DST-SUB-ACCT       TO IFACWS-SUB-ACCOUNT.
010140     MOVE 4                      TO IFACWS-EDIT-TYPE.
010150     PERFORM 635-EDIT-GLMASTER-60.
010160     MOVE IFACWS-GLM-DESCRIPTION TO PR29F1-GLM-DESCRIPTION (I1).
010200
RETROP 531-NEXT.
RETROP
RETROP     MOVE PRPNP-STB-FUNDING-SOURCE2 (I1)
RETROP                                TO PR29F1-PNF-FUNDING-SOURCE2(I1).
RETROP     MOVE PRPNP-STB-FUND-AMOUNT2 (I1)
RETROP                                 TO PR29F1-PNF-FUND-AMOUNT2  (I1).
RETROP     INITIALIZE                     PR29F1-PNF-PAYMENT-DESC2 (I1)
RETROP                                    PR29F1-GLM-DESCRIPTION2  (I1).
RETROP
RETROP     MOVE PR29F1-PNP-COMPANY     TO DB-COMPANY.
RETROP     MOVE PR29F1-PROCESS-LEVEL   TO DB-PROCESS-LEVEL.
RETROP     MOVE PR29F1-DEPARTMENT      TO DB-DEPARTMENT.
RETROP     MOVE PR29F1-PNF-FUNDING-SOURCE2(I1)
RETROP                                 TO DB-FUNDING-SOURCE.
RETROP
RETROP     PERFORM 840-FIND-PFSSET1.
RETROP     IF (PRFUNDSRC-NOTFOUND)
RETROP         INITIALIZE                    DB-DEPARTMENT
RETROP         PERFORM 840-FIND-PFSSET1
RETROP         IF (PRFUNDSRC-NOTFOUND)
RETROP             INITIALIZE                DB-PROCESS-LEVEL
RETROP             PERFORM 840-FIND-PFSSET1
RETROP             IF (PRFUNDSRC-NOTFOUND)
RETROP                GO TO 531-END.
RETROP
RETROP     IF (PRFUNDSRC-FOUND)
RETROP         MOVE PFS-PAYMENT-DESC   TO PR29F1-PNF-PAYMENT-DESC2(I1).
RETROP
RETROP     MOVE PFS-DIST-COMPANY       TO IFACWS-COMPANY.
RETROP     MOVE PFS-DST-ACCT-UNIT      TO IFACWS-ACCT-UNIT.
RETROP     MOVE PFS-DST-ACCOUNT        TO IFACWS-ACCOUNT.
RETROP     MOVE PFS-DST-SUB-ACCT       TO IFACWS-SUB-ACCOUNT.
RETROP     MOVE 4                      TO IFACWS-EDIT-TYPE.
RETROP     PERFORM 635-EDIT-GLMASTER-60.
RETROP
RETROP     MOVE IFACWS-GLM-DESCRIPTION TO PR29F1-GLM-DESCRIPTION2(I1).
RETROP
010210 531-END.
010220
010230******************************************************************
010240 532-MOVE-TIME-WS-TO-SCR.
010250******************************************************************
010260
           IF  (PRPNP-TTB-LINE-NBR (I1) = ZEROES)
RETROP         GO TO 532-NEXT.

           MOVE PRPNP-TTB-LINE-NBR (I1)     TO I2.
010270     MOVE PRPNP-TTB-LINE-FC    (I1)   TO PR29F1-LINE-FC     (I2).
010290     MOVE PRPNP-TTB-SEQ-NBR    (I1)   TO PR29F1-SEQ-NBR     (I2).
010300     MOVE PRPNP-TTB-TIME-SEQ   (I1)   TO PR29F1-TIME-SEQ    (I2).
010310     MOVE PRPNP-TTB-CHECK-ID   (I1)   TO PR29F1-CHECK-ID    (I2).
010320     MOVE PRPNP-TTB-PAY-CODE   (I1)   TO PR29F1-PAY-CODE    (I2).
010330
010340     IF (PRPNP-RATE-SECURED)
010350         MOVE PRPNP-TTB-RATE (I1)     TO PR29F1-RATE1(I2)
010360     ELSE
010370         MOVE PRPNP-TTB-RATE (I1)     TO PR29F1-RATE (I2).
010380
RETROP 532-NEXT.
RETROP
RETROP     IF  (PRPNP-TTB-LINE-NBR2 (I1) = ZEROES)
RETROP         GO TO 532-END.
RETROP
RETROP     MOVE PRPNP-TTB-LINE-NBR2 (I1)     TO I2.
RETROP     MOVE PRPNP-TTB-LINE-FC2    (I1)   TO PR29F1-LINE-FC2   (I2).
RETROP     MOVE PRPNP-TTB-SEQ-NBR2    (I1)   TO PR29F1-SEQ-NBR2    (I2).
RETROP     MOVE PRPNP-TTB-TIME-SEQ2   (I1)   TO PR29F1-TIME-SEQ2   (I2).
RETROP     MOVE PRPNP-TTB-CHECK-ID2   (I1)   TO PR29F1-CHECK-ID2   (I2).
RETROP     MOVE PRPNP-TTB-PAY-CODE2   (I1)   TO PR29F1-PAY-CODE2   (I2).
RETROP     MOVE PRPNP-RETRO-PAYMENT2  (I1) TO PR29F1-RETRO-PAYMENT2(I2).
RETROP
RETROP     IF (PRPNP-RATE-SECURED)
RETROP         MOVE PRPNP-TTB-RATE2 (I1)     TO PR29F1-RATE12(I2)
RETROP     ELSE
RETROP         MOVE PRPNP-TTB-RATE2 (I1)     TO PR29F1-RATE2 (I2).
010390
010400 532-END.
010410
RETROP******************************************************************
RETROP 534-MOVE-SRC-WS-TO-SCR.
RETROP******************************************************************
RETROP
RETROP     MOVE PRPNP-STB-FUNDING-SOURCE (I1)
RETROP                                 TO PR29F1-PNF-FUNDING-SOURCE(I1).
RETROP     MOVE PRPNP-STB-FUND-AMOUNT (I1)
RETROP                                 TO PR29F1-PNF-FUND-AMOUNT   (I1).
RETROP     INITIALIZE                     PR29F1-PNF-PAYMENT-DESC  (I1)
RETROP                                    PR29F1-GLM-DESCRIPTION (I1).
RETROP
RETROP     MOVE PR29F1-PNP-COMPANY     TO DB-COMPANY.
RETROP     MOVE PR29F1-PROCESS-LEVEL   TO DB-PROCESS-LEVEL.
RETROP     MOVE PR29F1-DEPARTMENT      TO DB-DEPARTMENT.
RETROP     MOVE PR29F1-PNF-FUNDING-SOURCE (I1)
RETROP                                 TO DB-FUNDING-SOURCE.
RETROP     PERFORM 840-FIND-PFSSET1.
RETROP     IF (PRFUNDSRC-NOTFOUND)
RETROP         INITIALIZE                    DB-DEPARTMENT
RETROP         PERFORM 840-FIND-PFSSET1
RETROP         IF (PRFUNDSRC-NOTFOUND)
RETROP             INITIALIZE                DB-PROCESS-LEVEL
RETROP             PERFORM 840-FIND-PFSSET1
RETROP             IF (PRFUNDSRC-NOTFOUND)
RETROP                GO TO 534-END. 
RETROP
RETROP     MOVE PFS-PAYMENT-DESC       TO PR29F1-PNF-PAYMENT-DESC (I1).
RETROP
RETROP     MOVE PFS-DIST-COMPANY       TO IFACWS-COMPANY.
RETROP     MOVE PFS-DST-ACCT-UNIT      TO IFACWS-ACCT-UNIT.
RETROP     MOVE PFS-DST-ACCOUNT        TO IFACWS-ACCOUNT.
RETROP     MOVE PFS-DST-SUB-ACCT       TO IFACWS-SUB-ACCOUNT.
RETROP     MOVE 4                      TO IFACWS-EDIT-TYPE.
RETROP     PERFORM 635-EDIT-GLMASTER-60.
RETROP     MOVE IFACWS-GLM-DESCRIPTION TO PR29F1-GLM-DESCRIPTION (I1).
RETROP
RETROP 534-END.
RETROP
RETROP******************************************************************
RETROP 535-MOVE-SRC-WS-TO-SCR.
RETROP******************************************************************
RETROP
RETROP     MOVE PRPNP-STB-FUNDING-SOURCE2 (I1)
RETROP                                TO PR29F1-PNF-FUNDING-SOURCE2(I1).
RETROP     MOVE PRPNP-STB-FUND-AMOUNT2 (I1)
RETROP                                 TO PR29F1-PNF-FUND-AMOUNT2  (I1).
RETROP     INITIALIZE                     PR29F1-PNF-PAYMENT-DESC2 (I1)
RETROP                                    PR29F1-GLM-DESCRIPTION2(I1).
RETROP
RETROP     MOVE PR29F1-PNP-COMPANY     TO DB-COMPANY.
RETROP     MOVE PR29F1-PROCESS-LEVEL   TO DB-PROCESS-LEVEL.
RETROP     MOVE PR29F1-DEPARTMENT      TO DB-DEPARTMENT.
RETROP     MOVE PR29F1-PNF-FUNDING-SOURCE2 (I1)
RETROP                                 TO DB-FUNDING-SOURCE.
RETROP
RETROP     PERFORM 840-FIND-PFSSET1.
RETROP     IF (PRFUNDSRC-NOTFOUND)
RETROP         INITIALIZE                    DB-DEPARTMENT
RETROP         PERFORM 840-FIND-PFSSET1
RETROP         IF (PRFUNDSRC-NOTFOUND)
RETROP             INITIALIZE                DB-PROCESS-LEVEL
RETROP             PERFORM 840-FIND-PFSSET1
RETROP             IF (PRFUNDSRC-NOTFOUND)
RETROP                GO TO 535-END.
RETROP
RETROP     IF (PRFUNDSRC-FOUND)
RETROP         MOVE PFS-PAYMENT-DESC   TO PR29F1-PNF-PAYMENT-DESC2(I1).
RETROP
RETROP     MOVE PFS-DIST-COMPANY       TO IFACWS-COMPANY.
RETROP     MOVE PFS-DST-ACCT-UNIT      TO IFACWS-ACCT-UNIT.
RETROP     MOVE PFS-DST-ACCOUNT        TO IFACWS-ACCOUNT.
RETROP     MOVE PFS-DST-SUB-ACCT       TO IFACWS-SUB-ACCOUNT.
RETROP     MOVE 4                      TO IFACWS-EDIT-TYPE.
RETROP     PERFORM 635-EDIT-GLMASTER-60.
RETROP
RETROP     MOVE IFACWS-GLM-DESCRIPTION TO PR29F1-GLM-DESCRIPTION2(I1).
RETROP
RETROP 535-END.

010420******************************************************************
010430 600-MOVE-TO-SCREEN.
010440******************************************************************
010450
010460     MOVE SPACES                 TO DB-PROCESS-LEVEL.
010470     PERFORM 840-FIND-PRSSET1.
010480     MOVE PRS-NAME               TO PR29F1-PRS-NAME.
010490     MOVE EMP-LAST-NAME          TO HRWS-LAST-NAME.
010500     MOVE EMP-FIRST-NAME         TO HRWS-FIRST-NAME.
010510     MOVE EMP-MIDDLE-INIT        TO HRWS-MIDDLE-INIT.
010520     MOVE EMP-NAME-SUFFIX        TO HRWS-NAME-SUFFIX.
010530     MOVE EMP-LAST-NAME-PRE      TO HRWS-LAST-NAME-PRE.
010540     PERFORM 750-HR-FORMAT-NAME.
010550     MOVE HRWS-FORMAT-NAME       TO PR29F1-EMP-FULL-NAME.
010560
010570     MOVE PNP-COMPANY            TO PR29F1-PNP-COMPANY.
010580     MOVE PNP-EMPLOYEE           TO PR29F1-PNP-EMPLOYEE.
010590     MOVE PNP-EFFECT-DATE        TO PR29F1-PNP-EFFECT-DATE.
010600     MOVE PNP-PENS-SEQ-NBR       TO PR29F1-PNP-PENS-SEQ-NBR.
010610     MOVE PNP-END-DATE           TO PR29F1-PNP-END-DATE.
010620     MOVE PNP-PENS-DIST-TYPE     TO PR29F1-PNP-PENS-DIST-TYPE.
010630     MOVE PNP-PENS-DIST-CODE     TO PR29F1-PNP-PENS-DIST-CODE.
010640     MOVE PNP-PENS-DST-CODE2     TO PR29F1-PNP-PENS-DST-CODE2.
010650     MOVE PNP-TAX-CATEGORY       TO PR29F1-PNP-TAX-CATEGORY.
010660     MOVE PNP-ADDL-FED-TAX       TO PR29F1-PNP-ADDL-FED-TAX.
010670     MOVE PNP-PERC-TOT-DIST      TO PR29F1-PNP-PERC-TOT-DIST.
010680     MOVE PNP-PAYABLE-TO         TO PR29F1-PNP-PAYABLE-TO.
010690     MOVE PNP-FBO-NAME           TO PR29F1-PNP-FBO-NAME.
010700     MOVE PNP-ADDR1              TO PR29F1-PNP-ADDR1.
010710     MOVE PNP-ADDR2              TO PR29F1-PNP-ADDR2.
010720     MOVE PNP-ADDR3              TO PR29F1-PNP-ADDR3.
010730     MOVE PNP-ADDR4              TO PR29F1-PNP-ADDR4.
010740     MOVE PNP-CITY               TO PR29F1-PNP-CITY.
010750     MOVE PNP-STATE              TO PR29F1-PNP-STATE.
010760     MOVE PNP-POSTAL-CODE        TO PR29F1-PNP-POSTAL-CODE.
010770     MOVE PNP-COUNTRY-CODE       TO PR29F1-PNP-COUNTRY-CODE.
010780     MOVE PNP-ROLLOVER-ACCT      TO PR29F1-PNP-ROLLOVER-ACCT.
010790     MOVE PNP-MISCELLANEOUS      TO PR29F1-PNP-MISCELLANEOUS.
010800     MOVE PNP-MISCELLANEOUS2     TO PR29F1-PNP-MISCELLANEOUS2.
010810     MOVE PNP-WIRE-IND           TO PR29F1-PNP-WIRE-IND.
010820     MOVE PNP-CA-EFT             TO PR29F1-PNP-CA-EFT.
J93849     MOVE PNP-IAT-ACH            TO PR29F1-PNP-IAT.
010830
010840     MOVE PRPNP-DISTRIBUTION-AMT TO PR29F1-DISTRIBUTION-AMT.
010850     MOVE EMP-DEPARTMENT         TO PR29F1-EMP-DEPARTMENT.
010860     MOVE EMP-PROCESS-LEVEL      TO PR29F1-EMP-PROCESS-LEVEL.
      *
89233      MOVE EMP-PROCESS-LEVEL      TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-PRSSET1.
           IF (PRSYSTEM-FOUND)
               MOVE PRS-NAME           TO PR29F1-EMP-PROCESS-LEV-NAME.
010870
010880 600-END.
GW5/03****** BEGIN WBP MODS *********
ACS000******************************************************************
010430 605-MOVE-WPN-TO-SCREEN.
010440******************************************************************
           MOVE PNP-COMPANY            TO DB-COMPANY.
           MOVE PNP-EMPLOYEE           TO DB-EMPLOYEE.
           MOVE PNP-EFFECT-DATE        TO DB-EFFECT-DATE.
           MOVE PNP-PENS-SEQ-NBR       TO DB-PENS-SEQ-NBR.

           PERFORM 840-FIND-WPNSET1.
           IF (WBPPRPENPY-FOUND)
               MOVE WPN-BEN-START-DATE  TO PR29F1-WPN-BEN-START-DATE
               MOVE WPN-REVIEW-DATE     TO PR29F1-WPN-REVIEW-DATE
               MOVE WPN-REVIEW-REASON   TO PR29F1-WPN-REVIEW-REASON
               MOVE WPN-BEN-STOP-RSN    TO PR29F1-WPN-BEN-STOP-RSN

               IF (PR29F1-WPN-REVIEW-REASON > SPACES)
                  MOVE "BENREVRSN "              TO DB-CODE-NAME
                  MOVE PR29F1-WPN-REVIEW-REASON  TO DB-CODE-VALUE
                  PERFORM 840-FIND-WPCSET1
                  IF (WBPCODES-FOUND)
                     MOVE WPC-DESCRIPTION40 (1:14) 
                                 TO PR29F1-WPN-REVIEW-DESC
                  END-IF
              END-IF
              IF (PR29F1-WPN-BEN-STOP-RSN > SPACES)
                 MOVE "BENSTPRSN "              TO DB-CODE-NAME
                 MOVE PR29F1-WPN-BEN-STOP-RSN   TO DB-CODE-VALUE
                 PERFORM 840-FIND-WPCSET1
                 IF (WBPCODES-FOUND)
                     MOVE WPC-DESCRIPTION40 (1:14) 
                                   TO PR29F1-WPN-STOP-DESC
                 END-IF
              END-IF
           ELSE
               MOVE ZEROS               TO PR29F1-WPN-BEN-START-DATE
               MOVE ZEROS               TO PR29F1-WPN-REVIEW-DATE
               MOVE SPACES              TO PR29F1-WPN-REVIEW-REASON
               MOVE SPACES              TO PR29F1-WPN-REVIEW-DESC

               MOVE SPACES              TO PR29F1-WPN-BEN-STOP-RSN
               MOVE SPACES              TO PR29F1-WPN-STOP-DESC.

       605-END.

010420******************************************************************
010430 610-MOVE-HEU-TO-SCREEN.
010440******************************************************************

           MOVE "P-W9 RECEIVED DATE"       TO DB-FIELD-NAME.
           PERFORM 840-FIND-HRUSET2.
           IF (HRUSERFLDS-FOUND)
              MOVE HRU-FIELD-KEY           TO DB-FIELD-KEY
              MOVE PNP-COMPANY             TO DB-COMPANY
              MOVE PNP-EMPLOYEE            TO DB-EMPLOYEE
              INITIALIZE                      DB-EMP-APP
              PERFORM 840-FIND-HEUSET1
              IF (HREMPUSF-FOUND)
                 MOVE HEU-D-FIELD          TO PR29F1-HEU-D-FIELD-W9
              ELSE
                 MOVE ZEROS                TO PR29F1-HEU-D-FIELD-W9.

           MOVE "A-ROSTER CODE"            TO DB-FIELD-NAME.
           PERFORM 840-FIND-HRUSET2.
           IF (HRUSERFLDS-FOUND)
              MOVE HRU-FIELD-KEY           TO DB-FIELD-KEY
              MOVE PNP-COMPANY             TO DB-COMPANY
              MOVE PNP-EMPLOYEE            TO DB-EMPLOYEE
              INITIALIZE                      DB-EMP-APP
              PERFORM 840-FIND-HEUSET1
              IF (HREMPUSF-FOUND)
                 MOVE HEU-A-FIELD          TO PR29F1-HEU-A-FIELD-ROSTER
              ELSE
                 MOVE SPACES               TO PR29F1-HEU-A-FIELD-ROSTER.

           MOVE "A-QDRO-CRP"               TO DB-FIELD-NAME.
           PERFORM 840-FIND-HRUSET2.
           IF (HRUSERFLDS-FOUND)
              MOVE HRU-FIELD-KEY           TO DB-FIELD-KEY
              MOVE PNP-COMPANY             TO DB-COMPANY
              MOVE PNP-EMPLOYEE            TO DB-EMPLOYEE
              INITIALIZE                      DB-EMP-APP
              PERFORM 840-FIND-HEUSET1
              IF (HREMPUSF-FOUND)
                 MOVE HEU-A-FIELD          TO PR29F1-HEU-A-FIELD-QDRO  
              ELSE
                 MOVE SPACES               TO PR29F1-HEU-A-FIELD-QDRO.

           MOVE "R-PPPT#"                  TO DB-FIELD-NAME.
           PERFORM 840-FIND-HRUSET2.
           IF (HRUSERFLDS-FOUND)
              MOVE HRU-FIELD-KEY           TO DB-FIELD-KEY
              MOVE PNP-COMPANY             TO DB-COMPANY
              MOVE PNP-EMPLOYEE            TO DB-EMPLOYEE
              INITIALIZE                      DB-EMP-APP
              PERFORM 840-FIND-HEUSET1
              IF (HREMPUSF-FOUND)
                 MOVE HEU-A-FIELD          TO PR29F1-HEU-A-FIELD-R-PPPT
              ELSE
                 MOVE SPACES               TO PR29F1-HEU-A-FIELD-R-PPPT.

       610-END.

*******  WBP MODS END
010890
010900******************************************************************
010910 611-MOVE-STM-DTL-TO-SCREEN.
010920******************************************************************
010930
010940     MOVE STM-PROCESS-LEVEL      TO DB-PROCESS-LEVEL.
010950     MOVE STM-PAY-CODE           TO PR29F1-PAY-CODE     (I1).
010970     MOVE STM-SEQ-NBR            TO PR29F1-SEQ-NBR      (I1).
010980     INITIALIZE                     PR29F1-TIME-SEQ     (I1).
010990     INITIALIZE                     PR29F1-CHECK-ID     (I1).
011000
011010     IF (PRPNP-RATE-SECURED)
011020         MOVE STM-RATE           TO PR29F1-RATE1        (I1)
011030     ELSE
011040         MOVE STM-RATE           TO PR29F1-RATE         (I1).
011050
011060     MOVE STM-PAY-CODE           TO DB-PAY-CODE.
011070     MOVE STM-JOB-CODE           TO DB-JOB-CODE.
011080     PERFORM 840-FIND-PCDSET1.
011090     IF (PRPAYCODE-NOTFOUND)
011100         MOVE PCDSET4-PAY-CODE   TO WS-DB-BEG-RNG
011110         PERFORM 850-FIND-BEGRNG-PCDSET4.
011120
011130     IF (PRPAYCODE-FOUND)
011140         MOVE PCD-DESCRIPTION    TO PR29F1-PCD-DESCRIPTION (I1)
011150     ELSE
011160         MOVE SPACES             TO PR29F1-PCD-DESCRIPTION (I1).
011170
011180
011190     IF (PR29F1-FC = "-")
011200         SUBTRACT 1              FROM I1
011210         PERFORM 870-FIND-PREV-STMSET6
011220     ELSE
011230         ADD 1                   TO I1
011240         PERFORM 860-FIND-NEXT-STMSET6
011250     END-IF.
011260
011270 611-END.
011280
011290******************************************************************
011300 612-MOVE-TRD-DTL-TO-SCREEN.
011310******************************************************************
011320
011330     MOVE TRD-PROCESS-LEVEL      TO DB-PROCESS-LEVEL.
011340     MOVE TRD-PCD-SEQ-NBR        TO DB-SEQ-NBR.
011350     PERFORM 840-FIND-PCDSET5.
011360     IF (PRPAYCODE-FOUND)
011370         MOVE TRD-PAY-CODE       TO PR29F1-PAY-CODE        (I1)
011380         MOVE PCD-DESCRIPTION    TO PR29F1-PCD-DESCRIPTION (I1)
011390     ELSE
011400         INITIALIZE                 PR29F1-PAY-CODE        (I1)
011410                                    PR29F1-PCD-DESCRIPTION (I1).
011420
011430     MOVE TRD-PAY-SUM-GRP        TO PR29F1-PAY-SUM-GRP(I1).
011450     INITIALIZE                     PR29F1-SEQ-NBR    (I1).
011460     MOVE TRD-TIME-SEQ           TO PR29F1-TIME-SEQ   (I1).
011470     INITIALIZE                     PR29F1-CHECK-ID   (I1).
011480
011490     IF (PRPNP-RATE-SECURED)
011500         MOVE TRD-RATE           TO PR29F1-RATE1  (I1)
011510     ELSE
011520         MOVE TRD-RATE           TO PR29F1-RATE   (I1).
011530
011540     IF (PR29F1-FC = "-")
011550         SUBTRACT 1              FROM I1
RETROP         PERFORM 621-PREV-TIMERECORD
               THRU    621-END
011570     ELSE
011580         ADD 1                   TO I1
RETROP         PERFORM 620-NEXT-TIMERECORD
               THRU    620-END
011600     END-IF.
011610
011620 612-END.
011630
011640******************************************************************
011650 613-MOVE-DTL-TO-SCREEN.
011660******************************************************************
011670
           MOVE PRT-COMPANY            TO DB-COMPANY.
           MOVE PRT-EMPLOYEE           TO DB-EMPLOYEE.
           MOVE PRT-CHECK-ID           TO DB-CHECK-ID.
           PERFORM 840-FIND-PYMSET1.
           IF  (PAYMASTR-FOUND)
           AND (PYM-CHECK-TYPE = "R" OR "V")
               GO TO 613-NEXT.

011680     MOVE PRT-PROCESS-LEVEL      TO DB-PROCESS-LEVEL.
011690     MOVE PRT-PCD-SEQ-NBR        TO DB-SEQ-NBR.
011700     PERFORM 840-FIND-PCDSET5.
011710     IF (PRPAYCODE-FOUND)
011720         MOVE PCD-PAY-CODE       TO PR29F1-PAY-CODE        (I1)
011730         MOVE PCD-DESCRIPTION    TO PR29F1-PCD-DESCRIPTION (I1)
011740     ELSE
011750         INITIALIZE                 PR29F1-PAY-CODE        (I1)
011760                                    PR29F1-PCD-DESCRIPTION (I1).
011770
011790     INITIALIZE                     PR29F1-SEQ-NBR    (I1).
011800     MOVE PRT-TIME-SEQ           TO PR29F1-TIME-SEQ   (I1).
011810     MOVE PRT-CHECK-ID           TO PR29F1-CHECK-ID   (I1).
011820
011830     IF (PRPNP-RATE-SECURED)
011840         MOVE PRT-WAGE-AMOUNT    TO PR29F1-RATE1 (I1)
011850     ELSE
011860         MOVE PRT-WAGE-AMOUNT    TO PR29F1-RATE  (I1).
011870
011890     IF (PR29F1-FC = "-")
011900         SUBTRACT 1              FROM I1
011920     ELSE
           IF (PR29F1-FC = "I" OR "+" OR "N" OR "P")
011930         ADD 1                   TO I1
011950     END-IF.
011880
       613-NEXT.
011890     IF (PR29F1-FC = "-")
RETROP         PERFORM 623-PREV-PRTIME
               THRU    623-END
011920     ELSE
           IF (PR29F1-FC = "I" OR "+" OR "N" OR "P")
RETROP         PERFORM 622-NEXT-PRTIME
               THRU    622-END
011950     END-IF.
011960
011970 613-END.
011980
RETROP******************************************************************
RETROP 614-MOVE-TRD-DTL-TO-SCREEN.
RETROP******************************************************************
RETROP
RETROP     MOVE "N"                    TO WS-RETRO-TIME-SW.
RETROP
RETROP     MOVE TRD-COMPANY            TO DB-COMPANY.
RETROP     MOVE TRD-EMPLOYEE           TO DB-EMPLOYEE.
RETROP     MOVE TRD-PENS-SEQ-NBR       TO DB-PENS-SEQ-NBR.
RETROP     MOVE PNFSET1-PENS-SEQ-NBR   TO WS-DB-BEG-RNG.
RETROP     PERFORM 850-FIND-BEGRNG-PNFSET1.
RETROP
RETROP     PERFORM
RETROP        UNTIL (PRPENFSRC-NOTFOUND)
RETROP        OR    (PNF-COMPANY NOT      = DB-COMPANY)
RETROP        OR    (PNF-EMPLOYEE NOT     = DB-EMPLOYEE)
RETROP        OR    (PNF-PENS-SEQ-NBR NOT = DB-PENS-SEQ-NBR)
RETROP        OR    (RETRO-TIME-FOUND)
RETROP               IF (PNF-RETRO-PAYMENT = "Y")
RETROP                   MOVE "Y"      TO WS-RETRO-TIME-SW
RETROP               END-IF
RETROP     PERFORM 860-FIND-NXTRNG-PNFSET1
RETROP     END-PERFORM.
RETROP
RETROP     IF (WS-RETRO-TIME-SW  NOT = "Y")
RETROP         GO TO 614-NEXT.
RETROP
RETROP     MOVE TRD-PROCESS-LEVEL      TO DB-PROCESS-LEVEL.
RETROP     MOVE TRD-PCD-SEQ-NBR        TO DB-SEQ-NBR.
RETROP     PERFORM 840-FIND-PCDSET5.
RETROP     IF (PRPAYCODE-FOUND)
RETROP         MOVE TRD-PAY-CODE       TO PR29F1-PAY-CODE2        (I1)
RETROP         MOVE PCD-DESCRIPTION    TO PR29F1-PCD-DESCRIPTION2 (I1)
RETROP     ELSE
RETROP         INITIALIZE                 PR29F1-PAY-CODE2        (I1)
RETROP                                    PR29F1-PCD-DESCRIPTION2 (I1).
RETROP
RETROP     MOVE TRD-PAY-SUM-GRP        TO PR29F1-PAY-SUM-GRP2(I1).
RETROP     INITIALIZE                     PR29F1-SEQ-NBR2    (I1).
RETROP     MOVE TRD-TIME-SEQ           TO PR29F1-TIME-SEQ2   (I1).
RETROP     INITIALIZE                     PR29F1-CHECK-ID2   (I1).
RETROP     MOVE "Y"                    TO PR29F1-RETRO-PAYMENT2 (I1).
RETROP
RETROP     IF (PRPNP-RATE-SECURED)
RETROP         MOVE TRD-RATE           TO PR29F1-RATE12  (I1)
RETROP     ELSE
RETROP         MOVE TRD-RATE           TO PR29F1-RATE2   (I1).
RETROP 
RETROP 614-NEXT.
RETROP
RETROP     IF (PR29F1-FC = "-")
RETROP         SUBTRACT 1              FROM I1
RETROP         PERFORM 621-PREV-TIMERECORD
               THRU    621-END
RETROP     ELSE
RETROP         ADD 1                   TO I1
RETROP         PERFORM 620-NEXT-TIMERECORD
               THRU    620-END
RETROP     END-IF.
RETROP
RETROP 614-END.
RETROP
RETROP 620-NEXT-TIMERECORD.
RETROP
       620-NEXT-TRD-BEGIN.

RETROP     PERFORM 860-FIND-NEXT-TRDSET13.
RETROP
RETROP     IF  (TIMERECORD-NOTFOUND)
RETROP     OR  (TRD-COMPANY       NOT = DB-COMPANY)
RETROP     OR  (TRD-EMPLOYEE      NOT = DB-EMPLOYEE)
RETROP     OR  (TRD-PENS-SEQ-NBR  NOT = DB-PENS-SEQ-NBR)
RETROP         GO TO 620-END.
RETROP
RETROP     IF  (WS-PENS-REGULAR)
RETROP         IF (TRD-RETRO-PENSION NOT = "Y")
RETROP             GO TO 620-END
RETROP         ELSE
RETROP             GO TO 620-NEXT-TRD-BEGIN.
RETROP
RETROP     IF  (WS-PENS-RETRO)
RETROP         IF (TRD-RETRO-PENSION = "Y")
RETROP             GO TO 620-END
RETROP         ELSE
RETROP             GO TO 620-NEXT-TRD-BEGIN.
RETROP
RETROP 620-END.
RETROP
RETROP 621-PREV-TIMERECORD.
RETROP
       621-PREV-TRD-BEGIN.

RETROP     PERFORM 870-FIND-PREV-TRDSET13.
RETROP
RETROP     IF  (TIMERECORD-NOTFOUND)
RETROP     OR  (TRD-COMPANY       NOT = DB-COMPANY)
RETROP     OR  (TRD-EMPLOYEE      NOT = DB-EMPLOYEE)
RETROP     OR  (TRD-PENS-SEQ-NBR  NOT = DB-PENS-SEQ-NBR)
RETROP         GO TO 621-END.
RETROP
RETROP     IF  (WS-PENS-REGULAR)
RETROP         IF (TRD-RETRO-PENSION NOT = "Y")
RETROP             GO TO 621-END
RETROP         ELSE
RETROP             GO TO 621-PREV-TRD-BEGIN.
RETROP
RETROP     IF  (WS-PENS-RETRO)
RETROP         IF (TRD-RETRO-PENSION = "Y")
RETROP             GO TO 621-END
RETROP         ELSE
RETROP             GO TO 621-PREV-TRD-BEGIN.
RETROP
RETROP 621-END.
RETROP
RETROP 622-NEXT-PRTIME.

       622-NEXT-PRT-BEGIN.
RETROP
RETROP     PERFORM 860-FIND-NEXT-PRTSET8.
RETROP
RETROP     IF  (PRTIME-NOTFOUND)
RETROP     OR  (PRT-COMPANY       NOT = DB-COMPANY)
RETROP     OR  (PRT-EMPLOYEE      NOT = DB-EMPLOYEE)
RETROP     OR  (PRT-PENS-SEQ-NBR  NOT = DB-PENS-SEQ-NBR)
RETROP         GO TO 622-END.
RETROP
RETROP     IF  (WS-PENS-REGULAR)
RETROP         IF (PRT-RETRO-PENSION NOT = "Y")
RETROP             GO TO 622-END
RETROP         ELSE
RETROP             GO TO 622-NEXT-PRT-BEGIN.
RETROP
RETROP     IF  (WS-PENS-RETRO)
RETROP         IF (PRT-RETRO-PENSION = "Y")
RETROP             GO TO 622-END
RETROP         ELSE
RETROP             GO TO 622-NEXT-PRT-BEGIN.
RETROP
RETROP 622-END.
RETROP
RETROP 623-PREV-PRTIME.

       623-PREV-PRT-BEGIN.
RETROP
RETROP     PERFORM 870-FIND-PREV-PRTSET8.
RETROP
RETROP     IF  (PRTIME-NOTFOUND)
RETROP     OR  (PRT-COMPANY       NOT = DB-COMPANY)
RETROP     OR  (PRT-EMPLOYEE      NOT = DB-EMPLOYEE)
RETROP     OR  (PRT-PENS-SEQ-NBR  NOT = DB-PENS-SEQ-NBR)
RETROP         GO TO 623-END.
RETROP
RETROP     IF  (WS-PENS-REGULAR)
RETROP         IF (PRT-RETRO-PENSION NOT = "Y")
RETROP             GO TO 623-END
RETROP         ELSE
RETROP             GO TO 623-PREV-PRT-BEGIN.
RETROP
RETROP     IF  (WS-PENS-RETRO)
RETROP         IF (PRT-RETRO-PENSION = "Y")
RETROP             GO TO 623-END
RETROP         ELSE
RETROP             GO TO 623-PREV-PRT-BEGIN.
RETROP
RETROP 623-END.

011990******************************************************************
012000 PR29S1-TRANSACTION-END.
012010******************************************************************
P68632******************************************************************
P68632 PR29S2-TRANSACTION              SECTION 10.
P68632******************************************************************
P68632 PR29S2-START.
P68632
P68632     PERFORM 200-EDIT-DETAIL
P68632     THRU    200-END.
P68632
P68632     
P68632     IF (NO-ERROR-FOUND)
P68632         PERFORM 400-PROCESS-TRAN
P68632         THRU    400-END.
P68632
P68632     IF  (NO-ERROR-FOUND)
P68632         MOVE CRT-EXEC-CALLER    TO CRT-REQUEST
P68632         MOVE PR29F2-PASS-FC     TO CRT-PASS-FC
P68632         GO TO PR29S2-TRANSACTION-END.
P68632 
P68632     GO TO PR29S2-TRANSACTION-END.
P68632
P68632******************************************************************
P68632 200-EDIT-DETAIL.
P68632******************************************************************
P68632
P68632     IF  (PR29F2-ROTH-YEAR               < 2006)
P68632     OR  (PR29F2-ROTH-YEAR               > 2099)
P68632         MOVE 188                        TO CRT-ERROR-NBR
P68632         MOVE PR29F2-ROTH-YEAR-FN        TO CRT-FIELD-NBR
P68632         GO TO 200-END
P68632     END-IF.
P68632
P68632 200-END.
P68632
P68632******************************************************************
P68632 400-PROCESS-TRAN.
P68632******************************************************************
P68632
P68632     PERFORM 910-AUDIT-BEGIN.
P68632     PERFORM 800-CREATE-PRREGPARM.
P68632     MOVE PRPNP-COMPANY      TO RGP-COMPANY.
P68632     MOVE "US"               TO RGP-COUNTRY-CODE.
P68632     MOVE "E"                TO RGP-RECORD-TYPE.
P68632     MOVE PRPNP-EMPLOYEE     TO RGP-EMPLOYEE.
P68632     MOVE SPACES             TO RGP-REPORT-ENTITY.
P68632     MOVE ZEROES             TO RGP-PAYROLL-YEAR.
P68632     MOVE "E1"               TO RGP-TOPIC.
P68632     MOVE 4019               TO RGP-FLD-NBR.
P68632     MOVE 1                  TO RGP-SEQ-NBR.
P68632     MOVE PR29F2-ROTH-YEAR   TO RGP-S-VALUE.
P68632     PERFORM 820-STORE-PRREGPARM.
P68632     PERFORM 920-AUDIT-END.
P71470     SET PR29-2-ROTH-YEAR-ENTERED    TO TRUE.
P68632 
P68632 400-END.
P68632
P68632******************************************************************
P68632 PR29S2-TRANSACTION-END.
P68632******************************************************************
