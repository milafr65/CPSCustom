******* PA02PD 36 <4181052167>
ACS001******************************************************************
ACS001*CHANGE LOG                                                      *
ACS001*                                                                *
ACS001* MOD NBR   DATE        PROGRAMMER   DESCRIPTION                 *
ACS001*--------  ----------  ------------  ----------------------------*
ACS001*ACS001    10/28/2010  M. HUNTER     REAPPLIED CUSTOMIZATIONS    *
ACS001*                      ACS           AFTER 9.0 APPS UPGRADE      *
ACS001*                                    WHICH CONSISTED OF PF       *
ACS001*                                    TRIGGER CODE.               *
ACS001*          08/19/2011  M. HUNTER     REAPPLIED CUSTOMIZATIONS    *
ACS001*                      ACS           AFTER 9.0.1 APPS UPGRADE.   *
ACS001*                                                                *
000100******************************************************************
000100*                             PA02PD                             *
000200******************************************************************
      *  JT#      TAG      DESCRIPTION                                 *
      *  ------   ------   ------------------------------------------  *
      *  868741 | J68741 | ADD ROUTINE FOR PROCESS FLOW/AUTOMATION     *
      *  ------   ------   ------------------------------------------  *
000300******************************************************************
000400 PA02S1-TRANSACTION              SECTION 20.
000500******************************************************************
000600 PA02S1-START.
000700
000800     IF (PA02F1-FC = "T")
000900         PERFORM 700-SCREEN-XFER
001000         THRU    700-END
001100         GO TO PA02S1-TRANSACTION-END.
001800
J68741     PERFORM 1000-OPEN-WORKFLOW-DB.
J68741
J68741     MOVE PA02F1-FC          TO PAWF70-FC.
J68741
001900     PERFORM 200-EDIT-TRAN
002000     THRU    200-END.
002100
002200     IF (NO-ERROR-FOUND)
002300         PERFORM 400-PROCESS-TRAN
002400         THRU    400-END.
002500
002600     GO TO PA02S1-TRANSACTION-END.
002700
002800******************************************************************
002900 200-EDIT-TRAN.
003000******************************************************************
003100
           SET PRPXL-UPDATES-NOT-ALLOWED TO TRUE.

003200     PERFORM 210-EDIT-ACCESS
003300     THRU    210-END.
003400
003500     IF (ERROR-FOUND)
003600         GO TO 200-END.
003700
000310     IF (PA02F1-FC = "A" OR "C" OR "D")
000280         PERFORM 201-MOVE-SCR-TO-WS
000290         THRU    201-END
000320         PERFORM 2000-PAPOS73-EDIT-TRAN
000330         PERFORM 202-MOVE-WS-TO-SCR
000340         THRU    202-END.
004700
004800 200-END.
004900
005000******************************************************************
005100 201-MOVE-SCR-TO-WS.
005200******************************************************************
018500
           INITIALIZE                       PAPOS-SCR-FIELDS
                                            PAPOS-MISC-FIELDS
                                            PAPOS-COMPANY-FIELDS.

           MOVE PA02F1-FC                  TO PAPOS-FC.
           SET PAPOS-POSITION-CHG          TO TRUE.
229800     MOVE PA02F1-POS-COMPANY         TO PAPOS-COMPANY.
229900     MOVE PA02F1-POS-POSITION        TO PAPOS-POSITION.     
230000     MOVE PA02F1-POS-DESCRIPTION     TO PAPOS-DESCRIPTION.
230100     MOVE PA02F1-POS-POSIT-STATUS    TO PAPOS-POSIT-STATUS.
230200     MOVE PA02F1-POS-EFFECT-DATE     TO PAPOS-EFFECT-DATE.
230300     MOVE PA02F1-POS-END-DATE        TO PAPOS-END-DATE.
           MOVE PA02F1-POS-ORIG-END-DATE   TO PAPOS-ORIG-END-DATE.
230400     MOVE PA02F1-POS-JOB-CODE        TO PAPOS-JOB-CODE.
230500     MOVE PA02F1-POS-PROCESS-LEVEL   TO PAPOS-PROCESS-LEVEL.
230600     MOVE PA02F1-POS-DEPARTMENT      TO PAPOS-DEPARTMENT.
230700     MOVE PA02F1-POS-USER-LEVEL      TO PAPOS-USER-LEVEL.
230800     MOVE PA02F1-POS-EXP-COMPANY     TO PAPOS-EXP-COMPANY.
230900     MOVE PA02F1-POS-EXP-ACCT-UNIT   TO PAPOS-EXP-ACCT-UNIT.
231000     MOVE PA02F1-POS-EXP-ACCOUNT     TO PAPOS-EXP-ACCOUNT.
231100     MOVE PA02F1-POS-EXP-SUB-ACCT    TO PAPOS-EXP-SUB-ACCT.
231200     MOVE PA02F1-POS-PAY-RATE        TO PAPOS-PAY-RATE.
231300     MOVE PA02F1-POS-ANNUAL-HOURS    TO PAPOS-ANNUAL-HOURS.
231400     MOVE PA02F1-POS-SALARY-CLASS    TO PAPOS-SALARY-CLASS.
231500     MOVE PA02F1-POS-PAY-FREQUENCY   TO PAPOS-PAY-FREQUENCY.
231600     MOVE PA02F1-POS-SCHEDULE        TO PAPOS-SCHEDULE.
231700     MOVE PA02F1-POS-PAY-GRADE       TO PAPOS-PAY-GRADE.
231800     MOVE PA02F1-POS-PAY-STEP        TO PAPOS-PAY-STEP.
231900     MOVE PA02F1-POS-SUPERVISOR      TO PAPOS-SUPERVISOR.
232000     MOVE PA02F1-POS-SHIFT           TO PAPOS-SHIFT.
232100     MOVE PA02F1-POS-LOCAT-CODE      TO PAPOS-LOCAT-CODE.
           MOVE PA02F1-POS-UNION-CODE      TO PAPOS-UNION-CODE.
           MOVE PA02F1-POS-BARGAIN-UNIT    TO PAPOS-BARGAIN-UNIT.
232200     MOVE PA02F1-POS-CHG-REASON      TO PAPOS-CHG-REASON.
232300     MOVE PA02F1-POS-ACTIVITY        TO PAPOS-ACTIVITY.
           MOVE PA02F1-ENCUMBER-FLAG       TO PAPOS-ENCUMBER-FLAG.
232400     MOVE PA02F1-POS-ACCT-CATEGORY   TO PAPOS-ACCT-CATEGORY.
232500     MOVE PA02F1-POS-OT-PLAN-CODE    TO PAPOS-OT-PLAN-CODE.
           MOVE PA02F1-SPOT-CURR-RATE      TO PAPOS-SPOT-CURR-RATE.
232600     MOVE PA02F1-POS-SUPERVISOR-IND  TO PAPOS-SUPERVISOR-IND.
232800     MOVE PA02F1-POS-SUPERVISOR-LNK  TO PAPOS-SUPERVISOR-LNK.
233000     MOVE PA02F1-POS-WORK-SCHED      TO PAPOS-WORK-SCHED.   
233100     MOVE PA02F1-POS-EXEMPT-EMP      TO PAPOS-EXEMPT-EMP.
233200     MOVE PA02F1-POS-SEC-LVL         TO PAPOS-SEC-LVL.
233300     MOVE PA02F1-POS-SEC-LOCATION    TO PAPOS-SEC-LOCATION.
233700     MOVE PA02F1-OBJ-ID              TO PAPOS-OBJ-ID.
           MOVE PA02F1-POS-CURRENCY-CODE   TO PAPOS-CURRENCY-CODE.
           MOVE PA02F1-POS-CURR-ND         TO PAPOS-CURR-ND.
           MOVE PA02F1-POS-BASE-CURRENCY   TO PAPOS-BASE-CURRENCY.
           MOVE PA02F1-POS-BASE-ND         TO PAPOS-BASE-ND.
           MOVE PA02F1-POS-BASE-PAY-RATE   TO PAPOS-BASE-PAY-RATE.
           MOVE PA02F1-IMM-UPDATE-FLAG     TO PAPOS-IMM-UPDATE-FLAG.
           MOVE PA02F1-PROC-TYPE           TO PAPOS-PROC-TYPE.
           MOVE PA02F1-HIST-CORR           TO PAPOS-HIST-CORR.
           MOVE PA02F1-RETRO-DATE          TO PAPOS-RETRO-DATE.
TEMP  *     MOVE "Y"                        TO PA02F1-LTM-INTERFACE.
P83648     MOVE PA02F1-LTM-INTERFACE       TO PAPOS-LTM-INTERFACE.

           MOVE PA02F1-FC-FN               TO PAPOS-FC-FN.
229800     MOVE PA02F1-POS-COMPANY-FN      TO PAPOS-COMPANY-FN.
229900     MOVE PA02F1-POS-POSITION-FN     TO PAPOS-POSITION-FN.
230000     MOVE PA02F1-POS-DESCRIPTION-FN  TO PAPOS-DESCRIPTION-FN.
230100     MOVE PA02F1-POS-POSIT-STATUS-FN TO PAPOS-POSIT-STATUS-FN.
230200     MOVE PA02F1-POS-EFFECT-DATE-FN  TO PAPOS-EFFECT-DATE-FN.
230300     MOVE PA02F1-POS-END-DATE-FN     TO PAPOS-END-DATE-FN.
230400     MOVE PA02F1-POS-JOB-CODE-FN     TO PAPOS-JOB-CODE-FN.
230500     MOVE PA02F1-POS-PROCESS-LEVEL-FN
230500                                     TO PAPOS-PROCESS-LEVEL-FN.
230600     MOVE PA02F1-POS-DEPARTMENT-FN   TO PAPOS-DEPARTMENT-FN.
230700     MOVE PA02F1-POS-USER-LEVEL-FN   TO PAPOS-USER-LEVEL-FN.
230800     MOVE PA02F1-POS-EXP-COMPANY-FN  TO PAPOS-EXP-COMPANY-FN.
230900     MOVE PA02F1-POS-EXP-ACCT-UNIT-FN
230900                                     TO PAPOS-EXP-ACCT-UNIT-FN.
231000     MOVE PA02F1-POS-EXP-ACCOUNT-FN  TO PAPOS-EXP-ACCOUNT-FN.
231100     MOVE PA02F1-POS-EXP-SUB-ACCT-FN TO PAPOS-EXP-SUB-ACCT-FN.
231200     MOVE PA02F1-POS-PAY-RATE-FN     TO PAPOS-PAY-RATE-FN.
231300     MOVE PA02F1-POS-ANNUAL-HOURS-FN TO PAPOS-ANNUAL-HOURS-FN.
231400     MOVE PA02F1-POS-SALARY-CLASS-FN TO PAPOS-SALARY-CLASS-FN.
231500     MOVE PA02F1-POS-PAY-FREQUENCY-FN
231500                                     TO PAPOS-PAY-FREQUENCY-FN.
231600     MOVE PA02F1-POS-SCHEDULE-FN     TO PAPOS-SCHEDULE-FN.
231700     MOVE PA02F1-POS-PAY-GRADE-FN    TO PAPOS-PAY-GRADE-FN.
231800     MOVE PA02F1-POS-PAY-STEP-FN     TO PAPOS-PAY-STEP-FN.
231900     MOVE PA02F1-POS-SUPERVISOR-FN   TO PAPOS-SUPERVISOR-FN.
232000     MOVE PA02F1-POS-SHIFT-FN        TO PAPOS-SHIFT-FN.
232100     MOVE PA02F1-POS-LOCAT-CODE-FN   TO PAPOS-LOCAT-CODE-FN.
           MOVE PA02F1-POS-UNION-CODE-FN   TO PAPOS-UNION-CODE-FN.
           MOVE PA02F1-POS-BARGAIN-UNIT-FN TO PAPOS-BARGAIN-UNIT-FN.
232200     MOVE PA02F1-POS-CHG-REASON-FN   TO PAPOS-CHG-REASON-FN.
232300     MOVE PA02F1-POS-ACTIVITY-FN     TO PAPOS-ACTIVITY-FN.
232400     MOVE PA02F1-POS-ACCT-CATEGORY-FN
232400                                     TO PAPOS-ACCT-CATEGORY-FN.
232500     MOVE PA02F1-POS-OT-PLAN-CODE-FN TO PAPOS-OT-PLAN-CODE-FN.
232600     MOVE PA02F1-POS-SUPERVISOR-IND-FN 
232700                                     TO PAPOS-SUPERVISOR-IND-FN.
232800     MOVE PA02F1-POS-SUPERVISOR-LNK-FN    
232900                                     TO PAPOS-SUPERVISOR-LNK-FN.
233000     MOVE PA02F1-POS-WORK-SCHED-FN   TO PAPOS-WORK-SCHED-FN. 
233100     MOVE PA02F1-POS-EXEMPT-EMP-FN   TO PAPOS-EXEMPT-EMP-FN.
233200     MOVE PA02F1-POS-SEC-LVL-FN      TO PAPOS-SEC-LVL-FN.
233300     MOVE PA02F1-POS-SEC-LOCATION-FN TO PAPOS-SEC-LOCATION-FN.
233700     MOVE PA02F1-OBJ-ID-FN           TO PAPOS-OBJ-ID-FN.
           MOVE PA02F1-POS-CURRENCY-CODE-FN
                                           TO PAPOS-CURRENCY-CODE-FN.
           MOVE PA02F1-POS-CURR-ND-FN      TO PAPOS-CURR-ND-FN.
           MOVE PA02F1-POS-BASE-CURRENCY-FN
                                           TO PAPOS-BASE-CURRENCY-FN.
           MOVE PA02F1-POS-BASE-ND-FN      TO PAPOS-BASE-ND-FN.
           MOVE PA02F1-POS-BASE-PAY-RATE-FN
                                           TO PAPOS-BASE-PAY-RATE-FN.
           MOVE PA02F1-PROC-TYPE-FN        TO PAPOS-PROC-TYPE-FN.
           MOVE PA02F1-HIST-CORR-FN        TO PAPOS-HIST-CORR-FN.
           MOVE PA02F1-RETRO-DATE-FN       TO PAPOS-RETRO-DATE-FN.

018600 201-END.
005000******************************************************************
005100 202-MOVE-WS-TO-SCR.
005200******************************************************************
005300
229800     MOVE PAPOS-COMPANY              TO PA02F1-POS-COMPANY.
229900     MOVE PAPOS-POSITION             TO PA02F1-POS-POSITION.     
230000     MOVE PAPOS-DESCRIPTION          TO PA02F1-POS-DESCRIPTION.
233700     MOVE PAPOS-OBJ-ID               TO PA02F1-OBJ-ID.
           MOVE PAPOS-CURRENCY-CODE        TO PA02F1-POS-CURRENCY-CODE.
           MOVE PAPOS-CURR-ND              TO PA02F1-POS-CURR-ND.
           MOVE PAPOS-BASE-CURRENCY        TO PA02F1-POS-BASE-CURRENCY.
           MOVE PAPOS-BASE-ND              TO PA02F1-POS-BASE-ND.
           MOVE PAPOS-BASE-PAY-RATE        TO PA02F1-POS-BASE-PAY-RATE.

       202-END.
003500******************************************************************
003600 210-EDIT-ACCESS.
003700******************************************************************

010900     MOVE PA02F1-POS-COMPANY            TO DB-COMPANY.
011000     MOVE PA02F1-POS-POSITION           TO DB-POSITION.      
011100     MOVE PA02F1-POS-EFFECT-DATE        TO DB-EFFECT-DATE.
011200
           IF (PA02F1-FC = "I")
               PERFORM 840-FIND-POSSET1
               IF (PAPOSITION-NOTFOUND)
                   MOVE 10                     TO CRT-ERROR-NBR
                   MOVE PA02F1-POS-POSITION-FN TO CRT-FIELD-NBR
                   GO TO 210-END.

011300     IF (PA02F1-FC = "N")
011400         IF (PA02F1-POS-EFFECT-DATE = ZEROES)
011500             MOVE WS-HIGH-VALUES        TO DB-EFFECT-DATE
               END-IF
011600         PERFORM 850-FIND-NLT-POSSET2
012700         IF (PAPOSITION-FOUND)
                   IF  (POS-COMPANY      = DB-COMPANY)
                   AND (POS-POSITION     = DB-POSITION)
                   AND (POS-EFFECT-DATE  = DB-EFFECT-DATE)
011800                 PERFORM 860-FIND-NEXT-POSSET2
011900             END-IF
               END-IF
012000     END-IF.
012100
012200     IF (PA02F1-FC = "P")
012300         PERFORM 850-FIND-NLT-POSSET2
012400         PERFORM 870-FIND-PREV-POSSET2.
012500
012600     IF (PA02F1-FC = "N" OR "P")
012700         IF (PAPOSITION-NOTFOUND)
012800         OR (POS-COMPANY           NOT = DB-COMPANY)
012900             MOVE 12                    TO CRT-ERROR-NBR
013000             MOVE PA02F1-FC-FN          TO CRT-FIELD-NBR
013100             GO TO 210-END
013200         ELSE
013300             MOVE POS-COMPANY           TO PA02F1-POS-COMPANY
013400                                           DB-COMPANY
013500             MOVE POS-POSITION          TO PA02F1-POS-POSITION    
013600                                           DB-POSITION
013700             MOVE POS-EFFECT-DATE       TO PA02F1-POS-EFFECT-DATE
013800                                           DB-EFFECT-DATE.    
013900
000290     MOVE PA02F1-POS-COMPANY            TO DB-COMPANY. 
000300     INITIALIZE                            DB-PROCESS-LEVEL
000310                                           DB-DEPARTMENT
000320                                           DB-EFFECT-DATE.
000330     PERFORM 850-FIND-NLT-PPRSET1.
000340     IF (PAPOSRULE-NOTFOUND)
               MOVE 118                       TO CRT-ERROR-NBR
               MOVE PA02F1-FC-FN              TO CRT-FIELD-NBR
               GO TO 210-END
           ELSE
000400         MOVE WS-TRUE                   TO HREMP-PAUSER-FLAG-SW.
014200
       210-END.
108700******************************************************************
108800 400-PROCESS-TRAN.
108900******************************************************************
109000
002580     IF (PA02F1-FC = "A" OR "C" OR "D")
               INITIALIZE                     PA02WS-MSG-NBR
                                              PA02WS-ERR-VAR1
                                              PAPOS-DATE-ERR-VAR
002630         PERFORM 3000-PAPOS73-PROCESS-TRAN
117100         MOVE PAPOS-UPDATE-FLAG      TO PA02F1-POS-UPDATE-FLAG.
011200
002660
002670     IF (PA02F1-FC = "A" OR "C")
               IF  (PA02F1-FC = "C")
               OR  ((PA02F1-FC = "A")
               AND  (PAPOS-NOT-AUTO-PO))
                   IF (PAPOSITION-NOTFOUND)
                   OR (PA02F1-POS-COMPANY       NOT = POS-COMPANY)
                   OR (PA02F1-POS-POSITION      NOT = POS-POSITION)
                   OR (PA02F1-POS-EFFECT-DATE   NOT = POS-EFFECT-DATE)
                       MOVE PA02F1-POS-COMPANY     TO DB-COMPANY
                       MOVE PA02F1-POS-POSITION    TO DB-POSITION
                       MOVE PA02F1-POS-EFFECT-DATE TO DB-EFFECT-DATE
                       PERFORM 840-FIND-POSSET1
                   END-IF
               END-IF
002680         PERFORM 481-MOVE-TO-SCREEN
002690         THRU    481-END
               IF (PAPOSWS-IMM-MSG-NBR NOT = ZEROES)
                   MOVE "PAPOS"            TO CRT-ERROR-CAT
                   MOVE PAPOSWS-IMM-MSG-NBR
                                           TO CRT-MSG-NBR
                   PERFORM 790-GET-MSG
                   MOVE CRT-MESSAGE        TO PA02F1-IMM-UPDATE-INFO
               END-IF   
               IF (PAPOS-MSG-NBR NOT = ZEROES)
                   MOVE "PAPOS"            TO CRT-ERROR-CAT
                   MOVE PAPOS-MSG-NBR      TO CRT-MSG-NBR
                                              PA02WS-MSG-NBR
                   IF (PAPOS-DATE-ERR-VAR NOT = SPACES)
                       MOVE PAPOS-DATE-ERR-VAR TO CRT-ERR-VAR1
                                                  PA02WS-ERR-VAR1
                   END-IF
                   PERFORM 790-GET-MSG
               ELSE  
                   MOVE PA02F1-FC-FN           TO CRT-FIELD-NBR
                   IF (PA02F1-FC = "A")
                       MOVE CRT-ADD-COMPLETE   TO CRT-MESSAGE
P83648                 MOVE SPACES             TO PA02F1-LTM-INTERFACE
                   END-IF
                   IF (PA02F1-FC = "C")
                       MOVE CRT-CHG-COMPLETE   TO CRT-MESSAGE
P83648                 MOVE SPACES             TO PA02F1-LTM-INTERFACE
                   END-IF
               END-IF
002720     ELSE
002720     IF (PA02F1-FC = "D")
002720         MOVE CRT-RECS-DELETED       TO CRT-MESSAGE
002720     ELSE
002800     IF (PA02F1-FC = "I" OR "N" OR "P")
002810         PERFORM 480-INQUIRE
002820         THRU    480-END.
016200
            IF (PAPOS-FIELD-ADD)
                PERFORM 700-SCREEN-XFER
                THRU    700-END. 

016300 400-END.
016400
206300******************************************************************
206400 480-INQUIRE.
206500******************************************************************
206600
           MOVE WS-FALSE              TO PAPOS-FIELD-ADD-SW.

206700     PERFORM 481-MOVE-TO-SCREEN
206800     THRU    481-END.
206900     MOVE CRT-INQ-COMPLETE      TO CRT-MESSAGE.
P83648     MOVE SPACES                TO PA02F1-LTM-INTERFACE.
207000
207100 480-END.
207200
207300******************************************************************
207400 481-MOVE-TO-SCREEN.
207500******************************************************************
207600
207700     MOVE POS-COMPANY            TO PA02F1-POS-COMPANY.
207800     MOVE POS-POSITION           TO PA02F1-POS-POSITION.     
207900     MOVE POS-DESCRIPTION        TO PA02F1-POS-DESCRIPTION.
208000     MOVE POS-EFFECT-DATE        TO PA02F1-POS-EFFECT-DATE.
208100     MOVE POS-END-DATE           TO PA02F1-POS-END-DATE
208200                                    PA02F1-POS-ORIG-END-DATE.
208300     MOVE POS-CHG-REASON         TO PA02F1-POS-CHG-REASON.
208400     MOVE POS-POSIT-STATUS       TO PA02F1-POS-POSIT-STATUS.
208500     MOVE POS-PROCESS-LEVEL      TO PA02F1-POS-PROCESS-LEVEL.
208600     MOVE POS-DEPARTMENT         TO PA02F1-POS-DEPARTMENT.
209000     MOVE POS-USER-LEVEL         TO PA02F1-POS-USER-LEVEL.
209100     MOVE POS-JOB-CODE           TO PA02F1-POS-JOB-CODE.
209200     MOVE POS-LOCAT-CODE         TO PA02F1-POS-LOCAT-CODE.
           MOVE POS-UNION-CODE         TO PA02F1-POS-UNION-CODE.
           MOVE POS-BARGAIN-UNIT       TO PA02F1-POS-BARGAIN-UNIT.
           MOVE SPACES                 TO PA02F1-UNION-DESC.
           MOVE SPACES                 TO PA02F1-BARGAIN-DESC.
209300     MOVE POS-SUPERVISOR         TO PA02F1-POS-SUPERVISOR.
209400     MOVE POS-SUPERVISOR-IND     TO PA02F1-POS-SUPERVISOR-IND.
209500     MOVE POS-SUPERVISOR-LNK     TO PA02F1-POS-SUPERVISOR-LNK.
209600     MOVE POS-UPDATE-FLAG        TO PA02F1-POS-UPDATE-FLAG
                                          PA02F1-ORIG-POS-UPD-FLG.
209700     MOVE POS-WORK-SCHED         TO PA02F1-POS-WORK-SCHED.
209800     MOVE POS-SHIFT              TO PA02F1-POS-SHIFT.
209900     MOVE POS-SEC-LVL            TO PA02F1-POS-SEC-LVL.
210000     MOVE POS-SEC-LOCATION       TO PA02F1-POS-SEC-LOCATION.
210100     MOVE POS-ANNUAL-HOURS       TO PA02F1-POS-ANNUAL-HOURS.
210200     MOVE POS-SALARY-CLASS       TO PA02F1-POS-SALARY-CLASS.
210300     MOVE POS-PAY-FREQUENCY      TO PA02F1-POS-PAY-FREQUENCY.
210400     MOVE POS-PAY-RATE           TO PA02F1-POS-PAY-RATE
                                          PA02F1-PAY-RATE
                                          PA02WS-OLD-PAY-RATE.
210500     MOVE POS-EXEMPT-EMP         TO PA02F1-POS-EXEMPT-EMP.
210600     MOVE POS-OT-PLAN-CODE       TO PA02F1-POS-OT-PLAN-CODE.
210700     MOVE POS-SCHEDULE           TO PA02F1-POS-SCHEDULE.
210800     MOVE POS-PAY-GRADE          TO PA02F1-POS-PAY-GRADE.
210900     MOVE POS-PAY-STEP           TO PA02F1-POS-PAY-STEP.
211000     MOVE POS-EXP-COMPANY        TO PA02F1-POS-EXP-COMPANY.
211100     MOVE POS-EXP-ACCT-UNIT      TO PA02F1-POS-EXP-ACCT-UNIT.
211200     MOVE POS-EXP-ACCOUNT        TO PA02F1-POS-EXP-ACCOUNT.
211300     MOVE POS-EXP-SUB-ACCT       TO PA02F1-POS-EXP-SUB-ACCT.
211400     MOVE POS-ACTIVITY           TO PA02F1-POS-ACTIVITY.
           MOVE POS-ENCUMBER-FLAG      TO PA02F1-ENCUMBER-FLAG.
211500     MOVE POS-ACCT-CATEGORY      TO PA02F1-POS-ACCT-CATEGORY.
211600     MOVE POS-OBJ-ID             TO PA02F1-OBJ-ID.
           MOVE POS-CURRENCY-CODE      TO PA02F1-POS-CURRENCY-CODE
                                          PA02F1-POS-CURRENCY
                                          PA02WS-OLD-CURRENCY.
           MOVE POS-CURR-ND            TO PA02F1-POS-CURR-ND.
           MOVE 4                      TO PA02F1-CUC-FROM-DEC.
           MOVE POS-BASE-CURRENCY      TO PA02F1-POS-BASE-CURRENCY.
           MOVE POS-BASE-ND            TO PA02F1-POS-BASE-ND.
           MOVE 4                      TO PA02F1-CUC-TO-DEC.
           MOVE POS-BASE-PAY-RATE      TO PA02F1-POS-BASE-PAY-RATE
                                          PA02F1-BASE-PAY-RATE.
           MOVE "N"                    TO PA02F1-CHECK-DECIMAL.
           INITIALIZE                     PA02F1-SPOT-CURR-RATE.
           MOVE "Y"                    TO PA02F1-PR-FLAG.
211700
212100     MOVE SPACES                 TO PA02F1-SUPERVISOR-NAME.
212200     MOVE SPACES                 TO PA02F1-SUPERVISOR-IND-NAME.
212300     MOVE SPACES                 TO PA02F1-SUPERVISOR-LNK-NAME.
212400     MOVE SPACES                 TO PA02F1-LEVEL-DESC.
212500     MOVE SPACES                 TO PA02F1-DEPT-DESC.
212600     MOVE SPACES                 TO PA02F1-JOB-CODE-DESC.
212700     MOVE SPACES                 TO PA02F1-LOC-CODE-DESC.
212800     MOVE SPACES                 TO PA02F1-PCO-REASON-DESC.
212900     MOVE SPACES                 TO PA02F1-PCO-DESCRIPTION.
213000     MOVE SPACES                 TO PA02F1-WSC-WORK-DESC.
213100     MOVE SPACES                 TO PA02F1-OT-PLAN-CODE-DESC.
213200     MOVE SPACES                 TO PA02F1-GLM-DESCRIPTION.
213300     MOVE SPACES                 TO PA02F1-ACV-DESCRIPTION.
213400
213500     IF (PA02F1-FC = "I" OR "N" OR "P")
213600         MOVE SPACES             TO PA02F1-IMM-UPDATE-INFO
213700         MOVE "N"                TO PA02F1-IMM-UPDATE-FLAG.
213800
213900     IF (PA02F1-POS-OT-PLAN-CODE NOT = SPACES)
214000         MOVE PA02F1-POS-COMPANY       TO DB-COMPANY
214100         MOVE PA02F1-POS-OT-PLAN-CODE  TO DB-PLAN-CODE
214200         MOVE PA02F1-POS-EFFECT-DATE   TO DB-EFFECT-DATE
214300         PERFORM 850-FIND-NLT-PROSET2
214400         IF (PROVERTIME-FOUND)
214500             MOVE PRO-DESCRIPTION
214600                                 TO PA02F1-OT-PLAN-CODE-DESC
214700         END-IF.
214800
           MOVE PA02F1-POS-COMPANY         TO DB-COMPANY.
           MOVE SPACES                     TO DB-PROCESS-LEVEL.
           PERFORM 840-FIND-PRSSET1.
           IF (PRSYSTEM-FOUND)
               MOVE PRS-NAME               TO PA02F1-PRS-NAME
           END-IF.

           MOVE PA02F1-POS-PROCESS-LEVEL   TO DB-PROCESS-LEVEL.
           MOVE PA02F1-POS-DEPARTMENT      TO DB-DEPARTMENT.
           PERFORM 840-FIND-DPTSET1.

214900*     IF (PA02F1-POS-EXP-COMPANY NOT = ZEROES)
215000*         MOVE PA02F1-POS-EXP-COMPANY TO IFACWS-COMPANY
215100*                                        ACACWS-COMPANY
215200*     ELSE
      *         IF  (DEPTCODE-FOUND)
215300*             MOVE DPT-DEP-DIST-CO    TO IFACWS-COMPANY
215400*                                        ACACWS-COMPANY.
215500
216200     IF  (POS-EXP-ACCT-UNIT NOT = SPACES)
P49965     OR  (POS-EXP-ACCOUNT   NOT = ZEROES)
P49965     OR  (POS-EXP-SUB-ACCT  NOT = ZEROES)
P49965         IF (POS-EXP-COMPANY  NOT = ZEROES)
P49965            MOVE POS-EXP-COMPANY         TO IFACWS-COMPANY
P49965         ELSE
P44965            MOVE POS-COMPANY             TO IFACWS-COMPANY
P44965         END-IF
               MOVE POS-EXP-ACCT-UNIT          TO IFACWS-ACCT-UNIT
               MOVE POS-EXP-ACCOUNT            TO IFACWS-ACCOUNT
               MOVE POS-EXP-SUB-ACCT           TO IFACWS-SUB-ACCOUNT
               MOVE 4                          TO IFACWS-EDIT-TYPE
               MOVE "PR"                       TO IFACWS-SYSTEM
216500         PERFORM 635-EDIT-GLMASTER-60
216600         MOVE IFACWS-GLM-DESCRIPTION TO PA02F1-GLM-DESCRIPTION
216700     ELSE
216800         MOVE SPACES             TO PA02F1-GLM-DESCRIPTION.
216900
217000     IF (POS-ACTIVITY NOT = SPACES)
217100         MOVE POS-ACTIVITY       TO ACACWS-ACTIVITY
217200         MOVE 2                  TO ACACWS-EDIT-CODE
217300         PERFORM 640-EDIT-ACTIVITY-70
217400         MOVE ACACWS-ACV-DESCRIPTION TO PA02F1-ACV-DESCRIPTION.
217500
217600     IF (POS-SUPERVISOR NOT = SPACES)
217700         MOVE POS-COMPANY        TO DB-COMPANY
217800         MOVE POS-SUPERVISOR     TO DB-CODE
217900         PERFORM 840-FIND-HSUSET1
218000         IF  (HRSUPER-FOUND)
218100         AND (HSU-EMPLOYEE NOT = ZEROES)
218200             MOVE HSU-EMPLOYEE        TO DB-EMPLOYEE
218300             MOVE PTFSET1-EMPLOYEE    TO WS-DB-BEG-RNG
218400             PERFORM 850-FIND-BEGRNG-PTFSET1
218500             MOVE PTF-LAST-NAME       TO HRWS-LAST-NAME
218600             MOVE PTF-FIRST-NAME      TO HRWS-FIRST-NAME
218700             MOVE PTF-MIDDLE-INIT     TO HRWS-MIDDLE-INIT
218800             PERFORM 750-HR-FORMAT-NAME
218900             MOVE HRWS-FORMAT-NAME    TO PA02F1-SUPERVISOR-NAME.
219000
219100     IF (POS-SUPERVISOR-IND NOT = SPACES)
219200         MOVE POS-COMPANY        TO DB-COMPANY
219300         MOVE POS-SUPERVISOR-IND TO DB-CODE
219400         PERFORM 840-FIND-HSUSET1
219500         IF  (HRSUPER-FOUND)
219600         AND (HSU-EMPLOYEE NOT = ZEROES)
219700             MOVE HSU-EMPLOYEE        TO DB-EMPLOYEE
219800             MOVE PTFSET1-EMPLOYEE    TO WS-DB-BEG-RNG
219900             PERFORM 850-FIND-BEGRNG-PTFSET1
220000             MOVE PTF-LAST-NAME       TO HRWS-LAST-NAME
220100             MOVE PTF-FIRST-NAME      TO HRWS-FIRST-NAME
220200             MOVE PTF-MIDDLE-INIT     TO HRWS-MIDDLE-INIT
220300             PERFORM 750-HR-FORMAT-NAME
220400             MOVE HRWS-FORMAT-NAME    TO
220500                                  PA02F1-SUPERVISOR-IND-NAME.
220600
220700     IF (POS-SUPERVISOR-LNK NOT = SPACES)
220800         MOVE POS-COMPANY        TO DB-COMPANY
220900         MOVE POS-SUPERVISOR-LNK TO DB-CODE
221000         PERFORM 840-FIND-HSUSET1
221100         IF (HRSUPER-FOUND)
221200             MOVE HSU-DESCRIPTION TO            
221300                                  PA02F1-SUPERVISOR-LNK-NAME.
221400
221500     IF (PA02F1-POS-PROCESS-LEVEL NOT = SPACES)
221600         MOVE PA02F1-POS-COMPANY       TO DB-COMPANY
221700         MOVE PA02F1-POS-PROCESS-LEVEL TO DB-PROCESS-LEVEL
221800         PERFORM 840-FIND-PRSSET1
221900         IF (PRSYSTEM-FOUND)
222000             MOVE PRS-NAME             TO PA02F1-LEVEL-DESC.
222100
222200     IF (PA02F1-POS-DEPARTMENT NOT = SPACES)
222300         MOVE PA02F1-POS-COMPANY       TO DB-COMPANY
222400         MOVE PA02F1-POS-PROCESS-LEVEL TO DB-PROCESS-LEVEL
222500         MOVE PA02F1-POS-DEPARTMENT    TO DB-DEPARTMENT
222600         PERFORM 840-FIND-DPTSET1
222700         IF (DEPTCODE-FOUND)
222800             MOVE DPT-NAME             TO PA02F1-DEPT-DESC.
222900
223000     IF (PA02F1-POS-JOB-CODE NOT = SPACES)
223100         MOVE PA02F1-POS-COMPANY       TO DB-COMPANY
223200         MOVE PA02F1-POS-JOB-CODE      TO DB-JOB-CODE
223300         PERFORM 840-FIND-JBCSET1
223400         IF (JOBCODE-FOUND)
223500             MOVE JBC-DESCRIPTION      TO PA02F1-JOB-CODE-DESC.
223600
223700     IF (PA02F1-POS-CHG-REASON NOT = SPACES)
223800         MOVE "PO"                     TO DB-TYPE
223900         MOVE PA02F1-POS-CHG-REASON    TO DB-CODE
224000         PERFORM 840-FIND-PCOSET1
224100         IF (PCODES-FOUND)
224200             MOVE PCO-DESCRIPTION    TO PA02F1-PCO-REASON-DESC.
224300
224400     IF (PA02F1-POS-LOCAT-CODE NOT = SPACES)
224500         MOVE "LO"                     TO DB-TYPE
224600         MOVE PA02F1-POS-LOCAT-CODE    TO DB-CODE
224700         PERFORM 840-FIND-PCOSET1
224800         IF (PCODES-FOUND)
224900             MOVE PCO-DESCRIPTION    TO PA02F1-LOC-CODE-DESC.
225000
224400     IF (PA02F1-POS-UNION-CODE NOT = SPACES)
224500         MOVE "UN"                     TO DB-TYPE
224600         MOVE PA02F1-POS-UNION-CODE    TO DB-CODE
224700         PERFORM 840-FIND-PCOSET1
224800         IF (PCODES-FOUND)
224900             MOVE PCO-DESCRIPTION    TO PA02F1-UNION-DESC.
225000
224400     IF (PA02F1-POS-BARGAIN-UNIT NOT = SPACES)
224500         MOVE "BU"                     TO DB-TYPE
224600         MOVE PA02F1-POS-BARGAIN-UNIT  TO DB-CODE
224700         PERFORM 840-FIND-PCOSET1
224800         IF (PCODES-FOUND)
224900             MOVE PCO-DESCRIPTION    TO PA02F1-BARGAIN-DESC.
225000
225100     IF (PA02F1-POS-WORK-SCHED NOT = SPACES)
               MOVE PA02F1-POS-COMPANY TO DB-COMPANY
               MOVE PA02F1-POS-WORK-SCHED
                                       TO DB-WORK-SCHED
               MOVE ZEROES             TO DB-CONTRACT-YEAR
               MOVE HRWS-DATE-HIGH-VAL TO DB-EFFECT-DATE
               PERFORM 850-FIND-NLT-WSCSET1
               IF (HRWRKSCHD-NOTFOUND)
               OR (WSC-COMPANY    NOT = DB-COMPANY)
               OR (WSC-WORK-SCHED NOT = DB-WORK-SCHED)
                   MOVE 9999           TO DB-CONTRACT-YEAR
                   MOVE ZEROES         TO DB-EFFECT-DATE
                   PERFORM 850-FIND-NLT-WSCSET1
               END-IF
               IF  (HRWRKSCHD-FOUND)
               AND (WSC-COMPANY    = DB-COMPANY)
               AND (WSC-WORK-SCHED = DB-WORK-SCHED)
                   MOVE WSC-DESCRIPTION
                                       TO PA02F1-WSC-WORK-DESC
               END-IF.
225700
225800     IF (PA02F1-POS-USER-LEVEL NOT = SPACES)
225900         MOVE "UL"                     TO DB-TYPE
226000         MOVE PA02F1-POS-USER-LEVEL    TO DB-CODE
226100         PERFORM 840-FIND-PCOSET1
226200         IF (PCODES-FOUND)
226300             MOVE PCO-DESCRIPTION    TO PA02F1-PCO-DESCRIPTION.
226400
226500     INITIALIZE                         PA02F1-SCHEDULE-DESC.
226600     IF  (PA02F1-POS-SCHEDULE NOT = SPACES)
226700     AND (PA02F1-POS-PAY-STEP = ZEROES)
226800         MOVE PA02F1-POS-COMPANY       TO DB-COMPANY
226900         MOVE "G"                      TO DB-INDICATOR
227000         MOVE PA02F1-POS-SCHEDULE      TO DB-SCHEDULE
227100         MOVE PA02F1-POS-EFFECT-DATE   TO DB-EFFECT-DATE
227200         PERFORM 850-FIND-NLT-SGHSET2
227300         IF  (PRSAGHEAD-FOUND)
227400         AND (SGH-COMPANY   = DB-COMPANY)
227500         AND (SGH-INDICATOR = DB-INDICATOR)
227600         AND (SGH-SCHEDULE  = DB-SCHEDULE)
227700             MOVE SGH-DESCRIPTION        TO PA02F1-SCHEDULE-DESC.
227800
227900     IF  (PA02F1-POS-SCHEDULE NOT = SPACES)
228000     AND (PA02F1-POS-PAY-STEP NOT = ZEROES)
228100         MOVE PA02F1-POS-COMPANY       TO DB-COMPANY
228200         MOVE "S"                      TO DB-INDICATOR
228300         MOVE PA02F1-POS-SCHEDULE      TO DB-SCHEDULE
228400         MOVE PA02F1-POS-EFFECT-DATE   TO DB-EFFECT-DATE
228500         PERFORM 850-FIND-NLT-SGHSET2
228600         IF  (PRSAGHEAD-FOUND)
228700         AND (SGH-COMPANY   = DB-COMPANY)
228800         AND (SGH-INDICATOR = DB-INDICATOR)
228900         AND (SGH-SCHEDULE  = DB-SCHEDULE)
229000             MOVE SGH-DESCRIPTION        TO PA02F1-SCHEDULE-DESC.
229100
           IF (PA02F1-POS-CURRENCY-CODE NOT = SPACES)
               MOVE PA02F1-POS-CURRENCY-CODE  TO IFCCWS-CURRENCY-CODE
               PERFORM 605-EDIT-CURRENCY-CODE-60
               MOVE IFCCWS-FORMS-EXP   TO PA02F1-CUC-FORMS-EXP
           END-IF.

           INITIALIZE PA02F1-PROC-TYPE
                      PA02F1-HIST-CORR
                      PA02F1-RETRO-DATE
                      CRT-ERROR-NBR
                      CRT-ERROR-CAT.

229200 481-END.
229300
301100******************************************************************
301200 700-SCREEN-XFER.
301300******************************************************************
301400     MOVE PA02F1-POS-COMPANY       TO DB-COMPANY.
301500     MOVE PA02F1-POS-POSITION      TO DB-POSITION.      
301600     MOVE PA02F1-POS-EFFECT-DATE   TO DB-EFFECT-DATE.
301700
301800     PERFORM 840-FIND-POSSET1.
301900     IF (PAPOSITION-NOTFOUND)
302000         MOVE "A"                  TO PA02F1-FC
302100         MOVE 148                  TO CRT-ERROR-NBR
302200         GO TO 700-END.
302300
302400     IF (PA02F1-FC = "T")
302500         MOVE "I"                   TO CRT-PASS-FC
302600         MOVE CRT-MANUAL-CF         TO CRT-REQUEST
302700         MOVE PA02F1-TOTALS-BUTTON-FN
302800                                    TO CRT-FIELD-NBR
302900         MOVE "PA791"               TO CRT-SCREEN-CODE
303000         GO TO 700-END.
303100
           MOVE "HR152"                   TO CRT-SCREEN-CODE.
           MOVE "I"                       TO CRT-PASS-FC.
           MOVE PA02F1-FC                 TO CRT-DISPLAY-FC.
           MOVE 1                         TO PA02F1-POS-TYPE.
           MOVE PA02WS-MSG-NBR            TO CRT-MSG-NBR.
           MOVE PA02WS-ERR-VAR1           TO CRT-ERR-VAR1.
           MOVE CRT-MANUAL-CF             TO CRT-REQUEST.

305100 700-END.
305200
305300******************************************************************
305400 PA02S1-TRANSACTION-END.
305500******************************************************************
ACS001     PERFORM 1000-OPEN-WORKFLOW-DB.
ACS001
ACS001     INITIALIZE WFAPI-I-SERVICE.
ACS001
ACS001     MOVE PA02F1-POS-COMPANY       TO WFAPI-CRITERION-1.
ACS001     MOVE "COMPANY"                TO WFAPI-I-VARIABLE-NAME (1).
ACS001     MOVE PA02F1-POS-COMPANY       TO WFAPI-I-VARIABLE-VAL  (1).
ACS001     MOVE "POSITION"               TO WFAPI-I-VARIABLE-NAME (2).
ACS001     MOVE PA02F1-POS-POSITION      TO WFAPI-I-VARIABLE-VAL  (2).
ACS001     MOVE "DATE"                   TO WFAPI-I-VARIABLE-NAME (3).
ACS001     MOVE PA02F1-POS-EFFECT-DATE   TO WFAPI-I-VARIABLE-VAL  (3).
ACS001     MOVE "DESCRIPTION"            TO WFAPI-I-VARIABLE-NAME (4). 
ACS001     MOVE PA02F1-POS-DESCRIPTION   TO WFAPI-I-VARIABLE-VAL  (4).
ACS001
ACS001     PERFORM 1000-PROCESS-FLOW.
ACS001
      ******************************************************************
       PA02S2-TRANSACTION              SECTION 10.
      ******************************************************************
       PA02S2-START.

           IF (PA02F2-FC NOT = "I")
               MOVE CRT-WINDOW-CHANGED TO CRT-MESSAGE.

           MOVE CRT-RETURN-KNS         TO CRT-REQUEST.
           GO TO PA02S2-TRANSACTION-END.

      ******************************************************************
       PA02S2-TRANSACTION-END.
      ******************************************************************

